<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ganeti.mcpu</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ganeti-module.html">Package&nbsp;ganeti</a> ::
        Module&nbsp;mcpu
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ganeti.mcpu-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="ganeti.mcpu-module.html">Module ganeti.mcpu</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2006, 2007, 2011 Google Inc.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software; you can redistribute it and/or modify</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation; either version 2 of the License, or</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful, but</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># WITHOUT ANY WARRANTY; without even the implied warranty of</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># General Public License for more details.</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># along with this program; if not, write to the Free Software</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment"># 02110-1301, USA.</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-docstring">"""Module implementing the logic behind the cluster operations</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-docstring">This module implements the logic for doing operations in the cluster. There</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-docstring">are two kinds of classes defined:</tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-docstring">  - logical units, which know how to deal with their specific opcode only</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-docstring">  - the processor, which dispatches the opcodes to their logical units</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">random</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package ganeti=ganeti-module.html"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-0', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-1" class="py-name" targets="Module ganeti.opcodes=ganeti.opcodes-module.html"><a title="ganeti.opcodes" class="py-name" href="#" onclick="return doclink('link-1', 'opcodes', 'link-1');">opcodes</a></tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-2" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-2', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Module ganeti.constants=ganeti.constants-module.html"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-3', 'constants', 'link-3');">constants</a></tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-4', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Module ganeti.errors=ganeti.errors-module.html"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-5', 'errors', 'link-5');">errors</a></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-6" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-6', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-7" class="py-name" targets="Module ganeti.rpc=ganeti.rpc-module.html"><a title="ganeti.rpc" class="py-name" href="#" onclick="return doclink('link-7', 'rpc', 'link-7');">rpc</a></tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-8', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Module ganeti.cmdlib=ganeti.cmdlib-module.html"><a title="ganeti.cmdlib" class="py-name" href="#" onclick="return doclink('link-9', 'cmdlib', 'link-9');">cmdlib</a></tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-10', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Module ganeti.locking=ganeti.locking-module.html"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-11', 'locking', 'link-11');">locking</a></tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-12" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-12', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Package ganeti.utils=ganeti.utils-module.html"><a title="ganeti.utils" class="py-name" href="#" onclick="return doclink('link-13', 'utils', 'link-13');">utils</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-14" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-14', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-15" class="py-name" targets="Module ganeti.compat=ganeti.compat-module.html"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-15', 'compat', 'link-15');">compat</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"><tt id="link-16" class="py-name" targets="Variable ganeti.mcpu._OP_PREFIX=ganeti.mcpu-module.html#_OP_PREFIX"><a title="ganeti.mcpu._OP_PREFIX" class="py-name" href="#" onclick="return doclink('link-16', '_OP_PREFIX', 'link-16');">_OP_PREFIX</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"Op"</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"><tt id="link-17" class="py-name" targets="Variable ganeti.mcpu._LU_PREFIX=ganeti.mcpu-module.html#_LU_PREFIX"><a title="ganeti.mcpu._LU_PREFIX" class="py-name" href="#" onclick="return doclink('link-17', '_LU_PREFIX', 'link-17');">_LU_PREFIX</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"LU"</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"> </tt>
<a name="LockAcquireTimeout"></a><div id="LockAcquireTimeout-def"><a name="L49"></a><tt class="py-lineno"> 49</tt> <a class="py-toggle" href="#" id="LockAcquireTimeout-toggle" onclick="return toggle('LockAcquireTimeout');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.mcpu.LockAcquireTimeout-class.html">LockAcquireTimeout</a><tt class="py-op">(</tt><tt class="py-base-class">Exception</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="LockAcquireTimeout-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="LockAcquireTimeout-expanded"><a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">  <tt class="py-docstring">"""Exception to report timeouts on acquiring locks.</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
</div><a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line"> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"> </tt>
<a name="_CalculateLockAttemptTimeouts"></a><div id="_CalculateLockAttemptTimeouts-def"><a name="L55"></a><tt class="py-lineno"> 55</tt> <a class="py-toggle" href="#" id="_CalculateLockAttemptTimeouts-toggle" onclick="return toggle('_CalculateLockAttemptTimeouts');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu-module.html#_CalculateLockAttemptTimeouts">_CalculateLockAttemptTimeouts</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="_CalculateLockAttemptTimeouts-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="_CalculateLockAttemptTimeouts-expanded"><a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">  <tt class="py-docstring">"""Calculate timeouts for lock attempts.</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">  <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt id="link-18" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-18', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name" targets="Variable ganeti.constants.LOCK_ATTEMPTS_MINWAIT=ganeti.constants-module.html#LOCK_ATTEMPTS_MINWAIT"><a title="ganeti.constants.LOCK_ATTEMPTS_MINWAIT" class="py-name" href="#" onclick="return doclink('link-19', 'LOCK_ATTEMPTS_MINWAIT', 'link-19');">LOCK_ATTEMPTS_MINWAIT</a></tt><tt class="py-op">]</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">  <tt class="py-name">running_sum</tt> <tt class="py-op">=</tt> <tt class="py-name">result</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">  <tt class="py-comment"># Wait for a total of at least LOCK_ATTEMPTS_TIMEOUT before doing a</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">  <tt class="py-comment"># blocking acquire</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">  <tt class="py-keyword">while</tt> <tt class="py-name">running_sum</tt> <tt class="py-op">&lt;</tt> <tt id="link-20" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-20', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name" targets="Variable ganeti.constants.LOCK_ATTEMPTS_TIMEOUT=ganeti.constants-module.html#LOCK_ATTEMPTS_TIMEOUT"><a title="ganeti.constants.LOCK_ATTEMPTS_TIMEOUT" class="py-name" href="#" onclick="return doclink('link-21', 'LOCK_ATTEMPTS_TIMEOUT', 'link-21');">LOCK_ATTEMPTS_TIMEOUT</a></tt><tt class="py-op">:</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">    <tt class="py-name">timeout</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">result</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt> <tt class="py-op">*</tt> <tt class="py-number">1.05</tt><tt class="py-op">)</tt> <tt class="py-op">**</tt> <tt class="py-number">1.25</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line"> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">    <tt class="py-comment"># Cap max timeout. This gives other jobs a chance to run even if</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">    <tt class="py-comment"># we're still trying to get our locks, before finally moving to a</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">    <tt class="py-comment"># blocking acquire.</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">    <tt class="py-name">timeout</tt> <tt class="py-op">=</tt> <tt class="py-name">min</tt><tt class="py-op">(</tt><tt class="py-name">timeout</tt><tt class="py-op">,</tt> <tt id="link-22" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-22', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name" targets="Variable ganeti.constants.LOCK_ATTEMPTS_MAXWAIT=ganeti.constants-module.html#LOCK_ATTEMPTS_MAXWAIT"><a title="ganeti.constants.LOCK_ATTEMPTS_MAXWAIT" class="py-name" href="#" onclick="return doclink('link-23', 'LOCK_ATTEMPTS_MAXWAIT', 'link-23');">LOCK_ATTEMPTS_MAXWAIT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">    <tt class="py-comment"># And also cap the lower boundary for safety</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">    <tt class="py-name">timeout</tt> <tt class="py-op">=</tt> <tt class="py-name">max</tt><tt class="py-op">(</tt><tt class="py-name">timeout</tt><tt class="py-op">,</tt> <tt id="link-24" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-24', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name"><a title="ganeti.constants.LOCK_ATTEMPTS_MINWAIT" class="py-name" href="#" onclick="return doclink('link-25', 'LOCK_ATTEMPTS_MINWAIT', 'link-19');">LOCK_ATTEMPTS_MINWAIT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line"> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">    <tt class="py-name">result</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">timeout</tt><tt class="py-op">)</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">    <tt class="py-name">running_sum</tt> <tt class="py-op">+=</tt> <tt class="py-name">timeout</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line"> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">  <tt class="py-keyword">return</tt> <tt class="py-name">result</tt> </tt>
</div><a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"> </tt>
<a name="LockAttemptTimeoutStrategy"></a><div id="LockAttemptTimeoutStrategy-def"><a name="L80"></a><tt class="py-lineno"> 80</tt> <a class="py-toggle" href="#" id="LockAttemptTimeoutStrategy-toggle" onclick="return toggle('LockAttemptTimeoutStrategy');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.mcpu.LockAttemptTimeoutStrategy-class.html">LockAttemptTimeoutStrategy</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="LockAttemptTimeoutStrategy-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="LockAttemptTimeoutStrategy-expanded"><a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">  <tt class="py-docstring">"""Class with lock acquire timeout strategy.</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">  <tt class="py-name">__slots__</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">    <tt class="py-string">"_timeouts"</tt><tt class="py-op">,</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">    <tt class="py-string">"_random_fn"</tt><tt class="py-op">,</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">    <tt class="py-string">"_time_fn"</tt><tt class="py-op">,</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">    <tt class="py-op">]</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line"> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">  <tt id="link-26" class="py-name" targets="Variable ganeti.mcpu.LockAttemptTimeoutStrategy._TIMEOUT_PER_ATTEMPT=ganeti.mcpu.LockAttemptTimeoutStrategy-class.html#_TIMEOUT_PER_ATTEMPT"><a title="ganeti.mcpu.LockAttemptTimeoutStrategy._TIMEOUT_PER_ATTEMPT" class="py-name" href="#" onclick="return doclink('link-26', '_TIMEOUT_PER_ATTEMPT', 'link-26');">_TIMEOUT_PER_ATTEMPT</a></tt> <tt class="py-op">=</tt> <tt id="link-27" class="py-name" targets="Function ganeti.mcpu._CalculateLockAttemptTimeouts()=ganeti.mcpu-module.html#_CalculateLockAttemptTimeouts"><a title="ganeti.mcpu._CalculateLockAttemptTimeouts" class="py-name" href="#" onclick="return doclink('link-27', '_CalculateLockAttemptTimeouts', 'link-27');">_CalculateLockAttemptTimeouts</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line"> </tt>
<a name="LockAttemptTimeoutStrategy.__init__"></a><div id="LockAttemptTimeoutStrategy.__init__-def"><a name="L92"></a><tt class="py-lineno"> 92</tt> <a class="py-toggle" href="#" id="LockAttemptTimeoutStrategy.__init__-toggle" onclick="return toggle('LockAttemptTimeoutStrategy.__init__');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.LockAttemptTimeoutStrategy-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">_time_fn</tt><tt class="py-op">=</tt><tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">,</tt> <tt class="py-param">_random_fn</tt><tt class="py-op">=</tt><tt class="py-name">random</tt><tt class="py-op">.</tt><tt class="py-name">random</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="LockAttemptTimeoutStrategy.__init__-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="LockAttemptTimeoutStrategy.__init__-expanded"><a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">    <tt class="py-docstring">"""Initializes this class.</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line"><tt class="py-docstring">    @param _time_fn: Time function for unittests</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line"><tt class="py-docstring">    @param _random_fn: Random number generator for unittests</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">    <tt class="py-name">object</tt><tt class="py-op">.</tt><tt id="link-28" class="py-name" targets="Method ganeti.asyncnotifier.AsyncNotifier.__init__()=ganeti.asyncnotifier.AsyncNotifier-class.html#__init__,Method ganeti.asyncnotifier.FileEventHandlerBase.__init__()=ganeti.asyncnotifier.FileEventHandlerBase-class.html#__init__,Method ganeti.asyncnotifier.SingleFileEventHandler.__init__()=ganeti.asyncnotifier.SingleFileEventHandler-class.html#__init__,Method ganeti.backend.HooksRunner.__init__()=ganeti.backend.HooksRunner-class.html#__init__,Method ganeti.bdev.BlockDev.__init__()=ganeti.bdev.BlockDev-class.html#__init__,Method ganeti.bdev.DRBD8.__init__()=ganeti.bdev.DRBD8-class.html#__init__,Method ganeti.bdev.DRBD8Status.__init__()=ganeti.bdev.DRBD8Status-class.html#__init__,Method ganeti.bdev.FileStorage.__init__()=ganeti.bdev.FileStorage-class.html#__init__,Method ganeti.bdev.LogicalVolume.__init__()=ganeti.bdev.LogicalVolume-class.html#__init__,Method ganeti.bdev.PersistentBlockDevice.__init__()=ganeti.bdev.PersistentBlockDevice-class.html#__init__,Method ganeti.cache.CacheBase.__init__()=ganeti.cache.CacheBase-class.html#__init__,Method ganeti.cache.SimpleCache.__init__()=ganeti.cache.SimpleCache-class.html#__init__,Method ganeti.cli.ArgSuggest.__init__()=ganeti.cli.ArgSuggest-class.html#__init__,Method ganeti.cli.FeedbackFnJobPollReportCb.__init__()=ganeti.cli.FeedbackFnJobPollReportCb-class.html#__init__,Method ganeti.cli.JobExecutor.__init__()=ganeti.cli.JobExecutor-class.html#__init__,Method ganeti.cli.JobPollCbBase.__init__()=ganeti.cli.JobPollCbBase-class.html#__init__,Method ganeti.cli.JobPollReportCbBase.__init__()=ganeti.cli.JobPollReportCbBase-class.html#__init__,Method ganeti.cli.StdioJobPollReportCb.__init__()=ganeti.cli.StdioJobPollReportCb-class.html#__init__,Method ganeti.cli.TableColumn.__init__()=ganeti.cli.TableColumn-class.html#__init__,Method ganeti.cli._Argument.__init__()=ganeti.cli._Argument-class.html#__init__,Method ganeti.cli._LuxiJobPollCb.__init__()=ganeti.cli._LuxiJobPollCb-class.html#__init__,Method ganeti.cli._QueryColumnFormatter.__init__()=ganeti.cli._QueryColumnFormatter-class.html#__init__,Method ganeti.cli._RunWhileClusterStoppedHelper.__init__()=ganeti.cli._RunWhileClusterStoppedHelper-class.html#__init__,Method ganeti.client.gnt_cluster._RunWhenNodesReachableHelper.__init__()=ganeti.client.gnt_cluster._RunWhenNodesReachableHelper-class.html#__init__,Method ganeti.client.gnt_debug._JobQueueTestReporter.__init__()=ganeti.client.gnt_debug._JobQueueTestReporter-class.html#__init__,Method ganeti.cmdlib.IAllocator.__init__()=ganeti.cmdlib.IAllocator-class.html#__init__,Method ganeti.cmdlib.LUClusterVerifyGroup.NodeImage.__init__()=ganeti.cmdlib.LUClusterVerifyGroup.NodeImage-class.html#__init__,Method ganeti.cmdlib.LogicalUnit.__init__()=ganeti.cmdlib.LogicalUnit-class.html#__init__,Method ganeti.cmdlib.ResultWithJobs.__init__()=ganeti.cmdlib.ResultWithJobs-class.html#__init__,Method ganeti.cmdlib.TLMigrateInstance.__init__()=ganeti.cmdlib.TLMigrateInstance-class.html#__init__,Method ganeti.cmdlib.TLReplaceDisks.__init__()=ganeti.cmdlib.TLReplaceDisks-class.html#__init__,Method ganeti.cmdlib.Tasklet.__init__()=ganeti.cmdlib.Tasklet-class.html#__init__,Method ganeti.cmdlib._QueryBase.__init__()=ganeti.cmdlib._QueryBase-class.html#__init__,Method ganeti.confd.client.ConfdAsyncUDPClient.__init__()=ganeti.confd.client.ConfdAsyncUDPClient-class.html#__init__,Method ganeti.confd.client.ConfdClient.__init__()=ganeti.confd.client.ConfdClient-class.html#__init__,Method ganeti.confd.client.ConfdClientRequest.__init__()=ganeti.confd.client.ConfdClientRequest-class.html#__init__,Method ganeti.confd.client.ConfdCountingCallback.__init__()=ganeti.confd.client.ConfdCountingCallback-class.html#__init__,Method ganeti.confd.client.ConfdFilterCallback.__init__()=ganeti.confd.client.ConfdFilterCallback-class.html#__init__,Method ganeti.confd.client.StoreResultCallback.__init__()=ganeti.confd.client.StoreResultCallback-class.html#__init__,Method ganeti.confd.client._Request.__init__()=ganeti.confd.client._Request-class.html#__init__,Method ganeti.confd.querylib.ConfdQuery.__init__()=ganeti.confd.querylib.ConfdQuery-class.html#__init__,Method ganeti.confd.server.ConfdProcessor.__init__()=ganeti.confd.server.ConfdProcessor-class.html#__init__,Method ganeti.config.ConfigWriter.__init__()=ganeti.config.ConfigWriter-class.html#__init__,Method ganeti.config.TemporaryReservationManager.__init__()=ganeti.config.TemporaryReservationManager-class.html#__init__,Method ganeti.daemon.AsyncAwaker.__init__()=ganeti.daemon.AsyncAwaker-class.html#__init__,Method ganeti.daemon.AsyncStreamServer.__init__()=ganeti.daemon.AsyncStreamServer-class.html#__init__,Method ganeti.daemon.AsyncTerminatedMessageStream.__init__()=ganeti.daemon.AsyncTerminatedMessageStream-class.html#__init__,Method ganeti.daemon.AsyncUDPSocket.__init__()=ganeti.daemon.AsyncUDPSocket-class.html#__init__,Method ganeti.daemon.AsyncoreScheduler.__init__()=ganeti.daemon.AsyncoreScheduler-class.html#__init__,Method ganeti.daemon.Mainloop.__init__()=ganeti.daemon.Mainloop-class.html#__init__,Method ganeti.ht._WrapperBase.__init__()=ganeti.ht._WrapperBase-class.html#__init__,Method ganeti.http.HttpBase.__init__()=ganeti.http.HttpBase-class.html#__init__,Method ganeti.http.HttpClientToServerStartLine.__init__()=ganeti.http.HttpClientToServerStartLine-class.html#__init__,Method ganeti.http.HttpException.__init__()=ganeti.http.HttpException-class.html#__init__,Method ganeti.http.HttpMessage.__init__()=ganeti.http.HttpMessage-class.html#__init__,Method ganeti.http.HttpMessageReader.__init__()=ganeti.http.HttpMessageReader-class.html#__init__,Method ganeti.http.HttpMessageWriter.__init__()=ganeti.http.HttpMessageWriter-class.html#__init__,Method ganeti.http.HttpServerToClientStartLine.__init__()=ganeti.http.HttpServerToClientStartLine-class.html#__init__,Method ganeti.http.HttpSslParams.__init__()=ganeti.http.HttpSslParams-class.html#__init__,Method ganeti.http.auth.PasswordFileUser.__init__()=ganeti.http.auth.PasswordFileUser-class.html#__init__,Method ganeti.http.client.HttpClientPool.__init__()=ganeti.http.client.HttpClientPool-class.html#__init__,Method ganeti.http.client.HttpClientRequest.__init__()=ganeti.http.client.HttpClientRequest-class.html#__init__,Method ganeti.http.client._HttpClient.__init__()=ganeti.http.client._HttpClient-class.html#__init__,Method ganeti.http.client._PooledHttpClient.__init__()=ganeti.http.client._PooledHttpClient-class.html#__init__,Method ganeti.http.server.HttpServer.__init__()=ganeti.http.server.HttpServer-class.html#__init__,Method ganeti.http.server.HttpServerRequestExecutor.__init__()=ganeti.http.server.HttpServerRequestExecutor-class.html#__init__,Method ganeti.http.server._HttpServerRequest.__init__()=ganeti.http.server._HttpServerRequest-class.html#__init__,Method ganeti.http.server._HttpServerToClientMessageWriter.__init__()=ganeti.http.server._HttpServerToClientMessageWriter-class.html#__init__,Method ganeti.hypervisor.hv_base.BaseHypervisor.__init__()=ganeti.hypervisor.hv_base.BaseHypervisor-class.html#__init__,Method ganeti.hypervisor.hv_chroot.ChrootManager.__init__()=ganeti.hypervisor.hv_chroot.ChrootManager-class.html#__init__,Method ganeti.hypervisor.hv_fake.FakeHypervisor.__init__()=ganeti.hypervisor.hv_fake.FakeHypervisor-class.html#__init__,Method ganeti.hypervisor.hv_kvm.KVMHypervisor.__init__()=ganeti.hypervisor.hv_kvm.KVMHypervisor-class.html#__init__,Method ganeti.hypervisor.hv_lxc.LXCHypervisor.__init__()=ganeti.hypervisor.hv_lxc.LXCHypervisor-class.html#__init__,Method ganeti.impexpd.ChildIOProcessor.__init__()=ganeti.impexpd.ChildIOProcessor-class.html#__init__,Method ganeti.impexpd.CommandBuilder.__init__()=ganeti.impexpd.CommandBuilder-class.html#__init__,Method ganeti.jqueue.JobQueue.__init__()=ganeti.jqueue.JobQueue-class.html#__init__,Method ganeti.jqueue._JobChangesChecker.__init__()=ganeti.jqueue._JobChangesChecker-class.html#__init__,Method ganeti.jqueue._JobChangesWaiter.__init__()=ganeti.jqueue._JobChangesWaiter-class.html#__init__,Method ganeti.jqueue._JobDependencyManager.__init__()=ganeti.jqueue._JobDependencyManager-class.html#__init__,Method ganeti.jqueue._JobFileChangesWaiter.__init__()=ganeti.jqueue._JobFileChangesWaiter-class.html#__init__,Method ganeti.jqueue._JobProcessor.__init__()=ganeti.jqueue._JobProcessor-class.html#__init__,Method ganeti.jqueue._JobQueueWorkerPool.__init__()=ganeti.jqueue._JobQueueWorkerPool-class.html#__init__,Method ganeti.jqueue._OpExecCallbacks.__init__()=ganeti.jqueue._OpExecCallbacks-class.html#__init__,Method ganeti.jqueue._OpExecContext.__init__()=ganeti.jqueue._OpExecContext-class.html#__init__,Method ganeti.jqueue._QueuedJob.__init__()=ganeti.jqueue._QueuedJob-class.html#__init__,Method ganeti.jqueue._QueuedOpCode.__init__()=ganeti.jqueue._QueuedOpCode-class.html#__init__,Method ganeti.jqueue._TimeoutStrategyWrapper.__init__()=ganeti.jqueue._TimeoutStrategyWrapper-class.html#__init__,Method ganeti.locking.GanetiLockManager.__init__()=ganeti.locking.GanetiLockManager-class.html#__init__,Method ganeti.locking.LockMonitor.__init__()=ganeti.locking.LockMonitor-class.html#__init__,Method ganeti.locking.LockSet.__init__()=ganeti.locking.LockSet-class.html#__init__,Method ganeti.locking.PipeCondition.__init__()=ganeti.locking.PipeCondition-class.html#__init__,Method ganeti.locking.SharedLock.__init__()=ganeti.locking.SharedLock-class.html#__init__,Method ganeti.locking.SingleNotifyPipeCondition.__init__()=ganeti.locking.SingleNotifyPipeCondition-class.html#__init__,Method ganeti.locking._BaseCondition.__init__()=ganeti.locking._BaseCondition-class.html#__init__,Method ganeti.locking._PipeConditionWithMode.__init__()=ganeti.locking._PipeConditionWithMode-class.html#__init__,Method ganeti.locking._SingleNotifyPipeConditionWaiter.__init__()=ganeti.locking._SingleNotifyPipeConditionWaiter-class.html#__init__,Method ganeti.luxi.Client.__init__()=ganeti.luxi.Client-class.html#__init__,Method ganeti.luxi.Transport.__init__()=ganeti.luxi.Transport-class.html#__init__,Method ganeti.masterd.instance.DiskExport.__init__()=ganeti.masterd.instance.DiskExport-class.html#__init__,Method ganeti.masterd.instance.DiskImport.__init__()=ganeti.masterd.instance.DiskImport-class.html#__init__,Method ganeti.masterd.instance.DiskTransfer.__init__()=ganeti.masterd.instance.DiskTransfer-class.html#__init__,Method ganeti.masterd.instance.ExportInstanceHelper.__init__()=ganeti.masterd.instance.ExportInstanceHelper-class.html#__init__,Method ganeti.masterd.instance.ImportExportLoop.__init__()=ganeti.masterd.instance.ImportExportLoop-class.html#__init__,Method ganeti.masterd.instance.ImportExportTimeouts.__init__()=ganeti.masterd.instance.ImportExportTimeouts-class.html#__init__,Method ganeti.masterd.instance._DiskImportExportBase.__init__()=ganeti.masterd.instance._DiskImportExportBase-class.html#__init__,Method ganeti.masterd.instance._DiskTransferPrivate.__init__()=ganeti.masterd.instance._DiskTransferPrivate-class.html#__init__,Method ganeti.masterd.instance._RemoteExportCb.__init__()=ganeti.masterd.instance._RemoteExportCb-class.html#__init__,Method ganeti.masterd.instance._RemoteImportCb.__init__()=ganeti.masterd.instance._RemoteImportCb-class.html#__init__,Method ganeti.masterd.instance._TransferInstCbBase.__init__()=ganeti.masterd.instance._TransferInstCbBase-class.html#__init__,Method ganeti.mcpu.HooksMaster.__init__()=ganeti.mcpu.HooksMaster-class.html#__init__,Method ganeti.mcpu.LockAttemptTimeoutStrategy.__init__()=ganeti.mcpu.LockAttemptTimeoutStrategy-class.html#__init__,Method ganeti.mcpu.Processor.__init__()=ganeti.mcpu.Processor-class.html#__init__,Method ganeti.netutils.Hostname.__init__()=ganeti.netutils.Hostname-class.html#__init__,Method ganeti.netutils.IP4Address.__init__()=ganeti.netutils.IP4Address-class.html#__init__,Method ganeti.netutils.IP6Address.__init__()=ganeti.netutils.IP6Address-class.html#__init__,Method ganeti.objects.ConfigObject.__init__()=ganeti.objects.ConfigObject-class.html#__init__,Method ganeti.opcodes.BaseOpCode.__init__()=ganeti.opcodes.BaseOpCode-class.html#__init__,Method ganeti.query.GroupQueryData.__init__()=ganeti.query.GroupQueryData-class.html#__init__,Method ganeti.query.InstanceQueryData.__init__()=ganeti.query.InstanceQueryData-class.html#__init__,Method ganeti.query.LockQueryData.__init__()=ganeti.query.LockQueryData-class.html#__init__,Method ganeti.query.NodeQueryData.__init__()=ganeti.query.NodeQueryData-class.html#__init__,Method ganeti.query.Query.__init__()=ganeti.query.Query-class.html#__init__,Method ganeti.query._FilterCompilerHelper.__init__()=ganeti.query._FilterCompilerHelper-class.html#__init__,Method ganeti.query._FilterHints.__init__()=ganeti.query._FilterHints-class.html#__init__,Method ganeti.rapi.baserlib.R_Generic.__init__()=ganeti.rapi.baserlib.R_Generic-class.html#__init__,Method ganeti.rapi.client.GanetiApiError.__init__()=ganeti.rapi.client.GanetiApiError-class.html#__init__,Method ganeti.rapi.client.GanetiRapiClient.__init__()=ganeti.rapi.client.GanetiRapiClient-class.html#__init__,Method ganeti.rapi.client_utils.RapiJobPollCb.__init__()=ganeti.rapi.client_utils.RapiJobPollCb-class.html#__init__,Method ganeti.rapi.connector.Mapper.__init__()=ganeti.rapi.connector.Mapper-class.html#__init__,Method ganeti.rapi.rlib2._R_Tags.__init__()=ganeti.rapi.rlib2._R_Tags-class.html#__init__,Method ganeti.rpc.Client.__init__()=ganeti.rpc.Client-class.html#__init__,Method ganeti.rpc.RpcResult.__init__()=ganeti.rpc.RpcResult-class.html#__init__,Method ganeti.rpc.RpcRunner.__init__()=ganeti.rpc.RpcRunner-class.html#__init__,Method ganeti.runtime.GetentResolver.__init__()=ganeti.runtime.GetentResolver-class.html#__init__,Method ganeti.server.confd.ConfdAsyncUDPServer.__init__()=ganeti.server.confd.ConfdAsyncUDPServer-class.html#__init__,Method ganeti.server.confd.ConfdConfigurationReloader.__init__()=ganeti.server.confd.ConfdConfigurationReloader-class.html#__init__,Method ganeti.server.masterd.ClientOps.__init__()=ganeti.server.masterd.ClientOps-class.html#__init__,Method ganeti.server.masterd.GanetiContext.__init__()=ganeti.server.masterd.GanetiContext-class.html#__init__,Method ganeti.server.masterd.MasterClientHandler.__init__()=ganeti.server.masterd.MasterClientHandler-class.html#__init__,Method ganeti.server.masterd.MasterServer.__init__()=ganeti.server.masterd.MasterServer-class.html#__init__,Method ganeti.server.noded.MlockallRequestExecutor.__init__()=ganeti.server.noded.MlockallRequestExecutor-class.html#__init__,Method ganeti.server.noded.NodeHttpServer.__init__()=ganeti.server.noded.NodeHttpServer-class.html#__init__,Method ganeti.server.rapi.FileEventHandler.__init__()=ganeti.server.rapi.FileEventHandler-class.html#__init__,Method ganeti.server.rapi.RemoteApiHttpServer.__init__()=ganeti.server.rapi.RemoteApiHttpServer-class.html#__init__,Method ganeti.server.rapi.RemoteApiRequestContext.__init__()=ganeti.server.rapi.RemoteApiRequestContext-class.html#__init__,Method ganeti.ssconf.SimpleConfigReader.__init__()=ganeti.ssconf.SimpleConfigReader-class.html#__init__,Method ganeti.ssconf.SimpleStore.__init__()=ganeti.ssconf.SimpleStore-class.html#__init__,Method ganeti.ssh.SshRunner.__init__()=ganeti.ssh.SshRunner-class.html#__init__,Method ganeti.storage.FileStorage.__init__()=ganeti.storage.FileStorage-class.html#__init__,Method ganeti.uidpool.LockedUid.__init__()=ganeti.uidpool.LockedUid-class.html#__init__,Method ganeti.utils.FdConditionWaiterHelper.__init__()=ganeti.utils.FdConditionWaiterHelper-class.html#__init__,Method ganeti.utils.FieldSet.__init__()=ganeti.utils.FieldSet-class.html#__init__,Method ganeti.utils.SignalHandler.__init__()=ganeti.utils.SignalHandler-class.html#__init__,Method ganeti.utils.SignalWakeupFd.__init__()=ganeti.utils.SignalWakeupFd-class.html#__init__,Method ganeti.utils.algo.RunningTimeout.__init__()=ganeti.utils.algo.RunningTimeout-class.html#__init__,Method ganeti.utils.filelock.FileLock.__init__()=ganeti.utils.filelock.FileLock-class.html#__init__,Method ganeti.utils.log._ReopenableLogHandler.__init__()=ganeti.utils.log._ReopenableLogHandler-class.html#__init__,Method ganeti.utils.process.RunResult.__init__()=ganeti.utils.process.RunResult-class.html#__init__,Method ganeti.utils.retry._RetryDelayCalculator.__init__()=ganeti.utils.retry._RetryDelayCalculator-class.html#__init__,Method ganeti.utils.text.LineSplitter.__init__()=ganeti.utils.text.LineSplitter-class.html#__init__,Method ganeti.utils.text.ShellWriter.__init__()=ganeti.utils.text.ShellWriter-class.html#__init__,Method ganeti.watcher.Instance.__init__()=ganeti.watcher.Instance-class.html#__init__,Method ganeti.watcher.Node.__init__()=ganeti.watcher.Node-class.html#__init__,Method ganeti.watcher._StatCb.__init__()=ganeti.watcher._StatCb-class.html#__init__,Method ganeti.watcher.nodemaint.NodeMaintenance.__init__()=ganeti.watcher.nodemaint.NodeMaintenance-class.html#__init__,Method ganeti.watcher.state.WatcherState.__init__()=ganeti.watcher.state.WatcherState-class.html#__init__,Method ganeti.workerpool.BaseWorker.__init__()=ganeti.workerpool.BaseWorker-class.html#__init__,Method ganeti.workerpool.DeferTask.__init__()=ganeti.workerpool.DeferTask-class.html#__init__,Method ganeti.workerpool.WorkerPool.__init__()=ganeti.workerpool.WorkerPool-class.html#__init__,Method script-build_bash_completion.CompletionWriter.__init__()=script-build_bash_completion.CompletionWriter-class.html#__init__,Method script-burnin.Burner.__init__()=script-burnin.Burner-class.html#__init__,Method script-cfgshell.ConfigShell.__init__()=script-cfgshell.ConfigShell-class.html#__init__,Method script-cluster_merge.Merger.__init__()=script-cluster_merge.Merger-class.html#__init__,Method script-cluster_merge.MergerData.__init__()=script-cluster_merge.MergerData-class.html#__init__,Method script-import_export.ChildProcess.__init__()=script-import_export.ChildProcess-class.html#__init__,Method script-import_export.StatusFile.__init__()=script-import_export.StatusFile-class.html#__init__,Method script-move_instance.InstanceMove.__init__()=script-move_instance.InstanceMove-class.html#__init__,Method script-move_instance.MoveDestExecutor.__init__()=script-move_instance.MoveDestExecutor-class.html#__init__,Method script-move_instance.MoveJobPollReportCb.__init__()=script-move_instance.MoveJobPollReportCb-class.html#__init__,Method script-move_instance.MoveRuntime.__init__()=script-move_instance.MoveRuntime-class.html#__init__,Method script-move_instance.MoveSourceExecutor.__init__()=script-move_instance.MoveSourceExecutor-class.html#__init__,Method script-move_instance.RapiClientFactory.__init__()=script-move_instance.RapiClientFactory-class.html#__init__"><a title="ganeti.asyncnotifier.AsyncNotifier.__init__
ganeti.asyncnotifier.FileEventHandlerBase.__init__
ganeti.asyncnotifier.SingleFileEventHandler.__init__
ganeti.backend.HooksRunner.__init__
ganeti.bdev.BlockDev.__init__
ganeti.bdev.DRBD8.__init__
ganeti.bdev.DRBD8Status.__init__
ganeti.bdev.FileStorage.__init__
ganeti.bdev.LogicalVolume.__init__
ganeti.bdev.PersistentBlockDevice.__init__
ganeti.cache.CacheBase.__init__
ganeti.cache.SimpleCache.__init__
ganeti.cli.ArgSuggest.__init__
ganeti.cli.FeedbackFnJobPollReportCb.__init__
ganeti.cli.JobExecutor.__init__
ganeti.cli.JobPollCbBase.__init__
ganeti.cli.JobPollReportCbBase.__init__
ganeti.cli.StdioJobPollReportCb.__init__
ganeti.cli.TableColumn.__init__
ganeti.cli._Argument.__init__
ganeti.cli._LuxiJobPollCb.__init__
ganeti.cli._QueryColumnFormatter.__init__
ganeti.cli._RunWhileClusterStoppedHelper.__init__
ganeti.client.gnt_cluster._RunWhenNodesReachableHelper.__init__
ganeti.client.gnt_debug._JobQueueTestReporter.__init__
ganeti.cmdlib.IAllocator.__init__
ganeti.cmdlib.LUClusterVerifyGroup.NodeImage.__init__
ganeti.cmdlib.LogicalUnit.__init__
ganeti.cmdlib.ResultWithJobs.__init__
ganeti.cmdlib.TLMigrateInstance.__init__
ganeti.cmdlib.TLReplaceDisks.__init__
ganeti.cmdlib.Tasklet.__init__
ganeti.cmdlib._QueryBase.__init__
ganeti.confd.client.ConfdAsyncUDPClient.__init__
ganeti.confd.client.ConfdClient.__init__
ganeti.confd.client.ConfdClientRequest.__init__
ganeti.confd.client.ConfdCountingCallback.__init__
ganeti.confd.client.ConfdFilterCallback.__init__
ganeti.confd.client.StoreResultCallback.__init__
ganeti.confd.client._Request.__init__
ganeti.confd.querylib.ConfdQuery.__init__
ganeti.confd.server.ConfdProcessor.__init__
ganeti.config.ConfigWriter.__init__
ganeti.config.TemporaryReservationManager.__init__
ganeti.daemon.AsyncAwaker.__init__
ganeti.daemon.AsyncStreamServer.__init__
ganeti.daemon.AsyncTerminatedMessageStream.__init__
ganeti.daemon.AsyncUDPSocket.__init__
ganeti.daemon.AsyncoreScheduler.__init__
ganeti.daemon.Mainloop.__init__
ganeti.ht._WrapperBase.__init__
ganeti.http.HttpBase.__init__
ganeti.http.HttpClientToServerStartLine.__init__
ganeti.http.HttpException.__init__
ganeti.http.HttpMessage.__init__
ganeti.http.HttpMessageReader.__init__
ganeti.http.HttpMessageWriter.__init__
ganeti.http.HttpServerToClientStartLine.__init__
ganeti.http.HttpSslParams.__init__
ganeti.http.auth.PasswordFileUser.__init__
ganeti.http.client.HttpClientPool.__init__
ganeti.http.client.HttpClientRequest.__init__
ganeti.http.client._HttpClient.__init__
ganeti.http.client._PooledHttpClient.__init__
ganeti.http.server.HttpServer.__init__
ganeti.http.server.HttpServerRequestExecutor.__init__
ganeti.http.server._HttpServerRequest.__init__
ganeti.http.server._HttpServerToClientMessageWriter.__init__
ganeti.hypervisor.hv_base.BaseHypervisor.__init__
ganeti.hypervisor.hv_chroot.ChrootManager.__init__
ganeti.hypervisor.hv_fake.FakeHypervisor.__init__
ganeti.hypervisor.hv_kvm.KVMHypervisor.__init__
ganeti.hypervisor.hv_lxc.LXCHypervisor.__init__
ganeti.impexpd.ChildIOProcessor.__init__
ganeti.impexpd.CommandBuilder.__init__
ganeti.jqueue.JobQueue.__init__
ganeti.jqueue._JobChangesChecker.__init__
ganeti.jqueue._JobChangesWaiter.__init__
ganeti.jqueue._JobDependencyManager.__init__
ganeti.jqueue._JobFileChangesWaiter.__init__
ganeti.jqueue._JobProcessor.__init__
ganeti.jqueue._JobQueueWorkerPool.__init__
ganeti.jqueue._OpExecCallbacks.__init__
ganeti.jqueue._OpExecContext.__init__
ganeti.jqueue._QueuedJob.__init__
ganeti.jqueue._QueuedOpCode.__init__
ganeti.jqueue._TimeoutStrategyWrapper.__init__
ganeti.locking.GanetiLockManager.__init__
ganeti.locking.LockMonitor.__init__
ganeti.locking.LockSet.__init__
ganeti.locking.PipeCondition.__init__
ganeti.locking.SharedLock.__init__
ganeti.locking.SingleNotifyPipeCondition.__init__
ganeti.locking._BaseCondition.__init__
ganeti.locking._PipeConditionWithMode.__init__
ganeti.locking._SingleNotifyPipeConditionWaiter.__init__
ganeti.luxi.Client.__init__
ganeti.luxi.Transport.__init__
ganeti.masterd.instance.DiskExport.__init__
ganeti.masterd.instance.DiskImport.__init__
ganeti.masterd.instance.DiskTransfer.__init__
ganeti.masterd.instance.ExportInstanceHelper.__init__
ganeti.masterd.instance.ImportExportLoop.__init__
ganeti.masterd.instance.ImportExportTimeouts.__init__
ganeti.masterd.instance._DiskImportExportBase.__init__
ganeti.masterd.instance._DiskTransferPrivate.__init__
ganeti.masterd.instance._RemoteExportCb.__init__
ganeti.masterd.instance._RemoteImportCb.__init__
ganeti.masterd.instance._TransferInstCbBase.__init__
ganeti.mcpu.HooksMaster.__init__
ganeti.mcpu.LockAttemptTimeoutStrategy.__init__
ganeti.mcpu.Processor.__init__
ganeti.netutils.Hostname.__init__
ganeti.netutils.IP4Address.__init__
ganeti.netutils.IP6Address.__init__
ganeti.objects.ConfigObject.__init__
ganeti.opcodes.BaseOpCode.__init__
ganeti.query.GroupQueryData.__init__
ganeti.query.InstanceQueryData.__init__
ganeti.query.LockQueryData.__init__
ganeti.query.NodeQueryData.__init__
ganeti.query.Query.__init__
ganeti.query._FilterCompilerHelper.__init__
ganeti.query._FilterHints.__init__
ganeti.rapi.baserlib.R_Generic.__init__
ganeti.rapi.client.GanetiApiError.__init__
ganeti.rapi.client.GanetiRapiClient.__init__
ganeti.rapi.client_utils.RapiJobPollCb.__init__
ganeti.rapi.connector.Mapper.__init__
ganeti.rapi.rlib2._R_Tags.__init__
ganeti.rpc.Client.__init__
ganeti.rpc.RpcResult.__init__
ganeti.rpc.RpcRunner.__init__
ganeti.runtime.GetentResolver.__init__
ganeti.server.confd.ConfdAsyncUDPServer.__init__
ganeti.server.confd.ConfdConfigurationReloader.__init__
ganeti.server.masterd.ClientOps.__init__
ganeti.server.masterd.GanetiContext.__init__
ganeti.server.masterd.MasterClientHandler.__init__
ganeti.server.masterd.MasterServer.__init__
ganeti.server.noded.MlockallRequestExecutor.__init__
ganeti.server.noded.NodeHttpServer.__init__
ganeti.server.rapi.FileEventHandler.__init__
ganeti.server.rapi.RemoteApiHttpServer.__init__
ganeti.server.rapi.RemoteApiRequestContext.__init__
ganeti.ssconf.SimpleConfigReader.__init__
ganeti.ssconf.SimpleStore.__init__
ganeti.ssh.SshRunner.__init__
ganeti.storage.FileStorage.__init__
ganeti.uidpool.LockedUid.__init__
ganeti.utils.FdConditionWaiterHelper.__init__
ganeti.utils.FieldSet.__init__
ganeti.utils.SignalHandler.__init__
ganeti.utils.SignalWakeupFd.__init__
ganeti.utils.algo.RunningTimeout.__init__
ganeti.utils.filelock.FileLock.__init__
ganeti.utils.log._ReopenableLogHandler.__init__
ganeti.utils.process.RunResult.__init__
ganeti.utils.retry._RetryDelayCalculator.__init__
ganeti.utils.text.LineSplitter.__init__
ganeti.utils.text.ShellWriter.__init__
ganeti.watcher.Instance.__init__
ganeti.watcher.Node.__init__
ganeti.watcher._StatCb.__init__
ganeti.watcher.nodemaint.NodeMaintenance.__init__
ganeti.watcher.state.WatcherState.__init__
ganeti.workerpool.BaseWorker.__init__
ganeti.workerpool.DeferTask.__init__
ganeti.workerpool.WorkerPool.__init__
script-build_bash_completion.CompletionWriter.__init__
script-burnin.Burner.__init__
script-cfgshell.ConfigShell.__init__
script-cluster_merge.Merger.__init__
script-cluster_merge.MergerData.__init__
script-import_export.ChildProcess.__init__
script-import_export.StatusFile.__init__
script-move_instance.InstanceMove.__init__
script-move_instance.MoveDestExecutor.__init__
script-move_instance.MoveJobPollReportCb.__init__
script-move_instance.MoveRuntime.__init__
script-move_instance.MoveSourceExecutor.__init__
script-move_instance.RapiClientFactory.__init__" class="py-name" href="#" onclick="return doclink('link-28', '__init__', 'link-28');">__init__</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">)</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_timeouts</tt> <tt class="py-op">=</tt> <tt class="py-name">iter</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-29" class="py-name"><a title="ganeti.mcpu.LockAttemptTimeoutStrategy._TIMEOUT_PER_ATTEMPT" class="py-name" href="#" onclick="return doclink('link-29', '_TIMEOUT_PER_ATTEMPT', 'link-26');">_TIMEOUT_PER_ATTEMPT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_time_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">_time_fn</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_random_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">_random_fn</tt> </tt>
</div><a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line"> </tt>
<a name="LockAttemptTimeoutStrategy.NextAttempt"></a><div id="LockAttemptTimeoutStrategy.NextAttempt-def"><a name="L105"></a><tt class="py-lineno">105</tt> <a class="py-toggle" href="#" id="LockAttemptTimeoutStrategy.NextAttempt-toggle" onclick="return toggle('LockAttemptTimeoutStrategy.NextAttempt');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.LockAttemptTimeoutStrategy-class.html#NextAttempt">NextAttempt</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="LockAttemptTimeoutStrategy.NextAttempt-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="LockAttemptTimeoutStrategy.NextAttempt-expanded"><a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">    <tt class="py-docstring">"""Returns the timeout for the next attempt.</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">      <tt class="py-name">timeout</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_timeouts</tt><tt class="py-op">.</tt><tt class="py-name">next</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">StopIteration</tt><tt class="py-op">:</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">      <tt class="py-comment"># No more timeouts, do blocking acquire</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">      <tt class="py-name">timeout</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line"> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">timeout</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">      <tt class="py-comment"># Add a small variation (-/+ 5%) to timeout. This helps in situations</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">      <tt class="py-comment"># where two or more jobs are fighting for the same lock(s).</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">      <tt class="py-name">variation_range</tt> <tt class="py-op">=</tt> <tt class="py-name">timeout</tt> <tt class="py-op">*</tt> <tt class="py-number">0.1</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">      <tt class="py-name">timeout</tt> <tt class="py-op">+=</tt> <tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_random_fn</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">*</tt> <tt class="py-name">variation_range</tt><tt class="py-op">)</tt> <tt class="py-op">-</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">                  <tt class="py-op">(</tt><tt class="py-name">variation_range</tt> <tt class="py-op">*</tt> <tt class="py-number">0.5</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line"> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">timeout</tt> </tt>
</div></div><a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line"> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line"> </tt>
<a name="OpExecCbBase"></a><div id="OpExecCbBase-def"><a name="L125"></a><tt class="py-lineno">125</tt> <a class="py-toggle" href="#" id="OpExecCbBase-toggle" onclick="return toggle('OpExecCbBase');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.mcpu.OpExecCbBase-class.html">OpExecCbBase</a><tt class="py-op">:</tt> <tt class="py-comment"># pylint: disable=W0232</tt> </tt>
</div><a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">  <tt class="py-docstring">"""Base class for OpCode execution callbacks.</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="OpExecCbBase.NotifyStart"></a><div id="OpExecCbBase.NotifyStart-def"><a name="L129"></a><tt class="py-lineno">129</tt> <a class="py-toggle" href="#" id="OpExecCbBase.NotifyStart-toggle" onclick="return toggle('OpExecCbBase.NotifyStart');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.OpExecCbBase-class.html#NotifyStart">NotifyStart</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OpExecCbBase.NotifyStart-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="OpExecCbBase.NotifyStart-expanded"><a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">    <tt class="py-docstring">"""Called when we are about to execute the LU.</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line"><tt class="py-docstring">    This function is called when we're about to start the lu's Exec() method,</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line"><tt class="py-docstring">    that is, after we have acquired all locks.</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
</div><a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line"> </tt>
<a name="OpExecCbBase.Feedback"></a><div id="OpExecCbBase.Feedback-def"><a name="L137"></a><tt class="py-lineno">137</tt> <a class="py-toggle" href="#" id="OpExecCbBase.Feedback-toggle" onclick="return toggle('OpExecCbBase.Feedback');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.OpExecCbBase-class.html#Feedback">Feedback</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OpExecCbBase.Feedback-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="OpExecCbBase.Feedback-expanded"><a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">    <tt class="py-docstring">"""Sends feedback from the LU code to the end-user.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
</div><a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"> </tt>
<a name="OpExecCbBase.CheckCancel"></a><div id="OpExecCbBase.CheckCancel-def"><a name="L142"></a><tt class="py-lineno">142</tt> <a class="py-toggle" href="#" id="OpExecCbBase.CheckCancel-toggle" onclick="return toggle('OpExecCbBase.CheckCancel');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.OpExecCbBase-class.html#CheckCancel">CheckCancel</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OpExecCbBase.CheckCancel-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="OpExecCbBase.CheckCancel-expanded"><a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">    <tt class="py-docstring">"""Check whether job has been cancelled.</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
</div><a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line"> </tt>
<a name="OpExecCbBase.SubmitManyJobs"></a><div id="OpExecCbBase.SubmitManyJobs-def"><a name="L147"></a><tt class="py-lineno">147</tt> <a class="py-toggle" href="#" id="OpExecCbBase.SubmitManyJobs-toggle" onclick="return toggle('OpExecCbBase.SubmitManyJobs');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.OpExecCbBase-class.html#SubmitManyJobs">SubmitManyJobs</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">jobs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OpExecCbBase.SubmitManyJobs-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="OpExecCbBase.SubmitManyJobs-expanded"><a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">    <tt class="py-docstring">"""Submits jobs for processing.</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line"><tt class="py-docstring">    See L{jqueue.JobQueue.SubmitManyJobs}.</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">    <tt class="py-keyword">raise</tt> <tt class="py-name">NotImplementedError</tt> </tt>
</div></div><a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line"> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line"> </tt>
<a name="_LUNameForOpName"></a><div id="_LUNameForOpName-def"><a name="L156"></a><tt class="py-lineno">156</tt> <a class="py-toggle" href="#" id="_LUNameForOpName-toggle" onclick="return toggle('_LUNameForOpName');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu-module.html#_LUNameForOpName">_LUNameForOpName</a><tt class="py-op">(</tt><tt class="py-param">opname</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="_LUNameForOpName-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="_LUNameForOpName-expanded"><a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">  <tt class="py-docstring">"""Computes the LU name for a given OpCode name.</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">  <tt class="py-keyword">assert</tt> <tt class="py-name">opname</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt id="link-30" class="py-name"><a title="ganeti.mcpu._OP_PREFIX" class="py-name" href="#" onclick="return doclink('link-30', '_OP_PREFIX', 'link-16');">_OP_PREFIX</a></tt><tt class="py-op">)</tt><tt class="py-op">,</tt> \ </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">      <tt class="py-string">"Invalid OpCode name, doesn't start with %s: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-31" class="py-name"><a title="ganeti.mcpu._OP_PREFIX" class="py-name" href="#" onclick="return doclink('link-31', '_OP_PREFIX', 'link-16');">_OP_PREFIX</a></tt><tt class="py-op">,</tt> <tt class="py-name">opname</tt><tt class="py-op">)</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">  <tt class="py-keyword">return</tt> <tt id="link-32" class="py-name"><a title="ganeti.mcpu._LU_PREFIX" class="py-name" href="#" onclick="return doclink('link-32', '_LU_PREFIX', 'link-17');">_LU_PREFIX</a></tt> <tt class="py-op">+</tt> <tt class="py-name">opname</tt><tt class="py-op">[</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-33" class="py-name"><a title="ganeti.mcpu._OP_PREFIX" class="py-name" href="#" onclick="return doclink('link-33', '_OP_PREFIX', 'link-16');">_OP_PREFIX</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
</div><a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line"> </tt>
<a name="_ComputeDispatchTable"></a><div id="_ComputeDispatchTable-def"><a name="L166"></a><tt class="py-lineno">166</tt> <a class="py-toggle" href="#" id="_ComputeDispatchTable-toggle" onclick="return toggle('_ComputeDispatchTable');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu-module.html#_ComputeDispatchTable">_ComputeDispatchTable</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="_ComputeDispatchTable-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="_ComputeDispatchTable-expanded"><a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">  <tt class="py-docstring">"""Computes the opcode-to-lu dispatch table.</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">  <tt class="py-keyword">return</tt> <tt class="py-name">dict</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">op</tt><tt class="py-op">,</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-34" class="py-name"><a title="ganeti.cmdlib" class="py-name" href="#" onclick="return doclink('link-34', 'cmdlib', 'link-9');">cmdlib</a></tt><tt class="py-op">,</tt> <tt id="link-35" class="py-name" targets="Function ganeti.mcpu._LUNameForOpName()=ganeti.mcpu-module.html#_LUNameForOpName"><a title="ganeti.mcpu._LUNameForOpName" class="py-name" href="#" onclick="return doclink('link-35', '_LUNameForOpName', 'link-35');">_LUNameForOpName</a></tt><tt class="py-op">(</tt><tt class="py-name">op</tt><tt class="py-op">.</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">              <tt class="py-keyword">for</tt> <tt class="py-name">op</tt> <tt class="py-keyword">in</tt> <tt id="link-36" class="py-name"><a title="ganeti.opcodes" class="py-name" href="#" onclick="return doclink('link-36', 'opcodes', 'link-1');">opcodes</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name" targets="Variable ganeti.opcodes.OP_MAPPING=ganeti.opcodes-module.html#OP_MAPPING"><a title="ganeti.opcodes.OP_MAPPING" class="py-name" href="#" onclick="return doclink('link-37', 'OP_MAPPING', 'link-37');">OP_MAPPING</a></tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">              <tt class="py-keyword">if</tt> <tt class="py-name">op</tt><tt class="py-op">.</tt><tt id="link-38" class="py-name" targets="Variable ganeti.opcodes.OpCode.WITH_LU=ganeti.opcodes.OpCode-class.html#WITH_LU,Variable ganeti.opcodes.OpTestDummy.WITH_LU=ganeti.opcodes.OpTestDummy-class.html#WITH_LU"><a title="ganeti.opcodes.OpCode.WITH_LU
ganeti.opcodes.OpTestDummy.WITH_LU" class="py-name" href="#" onclick="return doclink('link-38', 'WITH_LU', 'link-38');">WITH_LU</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line"> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line"> </tt>
<a name="Processor"></a><div id="Processor-def"><a name="L175"></a><tt class="py-lineno">175</tt> <a class="py-toggle" href="#" id="Processor-toggle" onclick="return toggle('Processor');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html">Processor</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="Processor-expanded"><a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">  <tt class="py-docstring">"""Object which runs OpCodes"""</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">  <tt id="link-39" class="py-name" targets="Variable ganeti.confd.server.ConfdProcessor.DISPATCH_TABLE=ganeti.confd.server.ConfdProcessor-class.html#DISPATCH_TABLE,Variable ganeti.mcpu.Processor.DISPATCH_TABLE=ganeti.mcpu.Processor-class.html#DISPATCH_TABLE"><a title="ganeti.confd.server.ConfdProcessor.DISPATCH_TABLE
ganeti.mcpu.Processor.DISPATCH_TABLE" class="py-name" href="#" onclick="return doclink('link-39', 'DISPATCH_TABLE', 'link-39');">DISPATCH_TABLE</a></tt> <tt class="py-op">=</tt> <tt id="link-40" class="py-name" targets="Function ganeti.mcpu._ComputeDispatchTable()=ganeti.mcpu-module.html#_ComputeDispatchTable"><a title="ganeti.mcpu._ComputeDispatchTable" class="py-name" href="#" onclick="return doclink('link-40', '_ComputeDispatchTable', 'link-40');">_ComputeDispatchTable</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"> </tt>
<a name="Processor.__init__"></a><div id="Processor.__init__-def"><a name="L179"></a><tt class="py-lineno">179</tt> <a class="py-toggle" href="#" id="Processor.__init__-toggle" onclick="return toggle('Processor.__init__');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">context</tt><tt class="py-op">,</tt> <tt class="py-param">ec_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.__init__-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.__init__-expanded"><a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">    <tt class="py-docstring">"""Constructor for Processor</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line"><tt class="py-docstring">    @type context: GanetiContext</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line"><tt class="py-docstring">    @param context: global Ganeti context</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line"><tt class="py-docstring">    @type ec_id: string</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line"><tt class="py-docstring">    @param ec_id: execution context identifier</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt> <tt class="py-op">=</tt> <tt class="py-name">context</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_ec_id</tt> <tt class="py-op">=</tt> <tt class="py-name">ec_id</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-41" class="py-name"><a title="ganeti.rpc" class="py-name" href="#" onclick="return doclink('link-41', 'rpc', 'link-7');">rpc</a></tt> <tt class="py-op">=</tt> <tt id="link-42" class="py-name"><a title="ganeti.rpc" class="py-name" href="#" onclick="return doclink('link-42', 'rpc', 'link-7');">rpc</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name" targets="Class ganeti.rpc.RpcRunner=ganeti.rpc.RpcRunner-class.html"><a title="ganeti.rpc.RpcRunner" class="py-name" href="#" onclick="return doclink('link-43', 'RpcRunner', 'link-43');">RpcRunner</a></tt><tt class="py-op">(</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hmclass</tt> <tt class="py-op">=</tt> <tt id="link-44" class="py-name" targets="Class ganeti.mcpu.HooksMaster=ganeti.mcpu.HooksMaster-class.html"><a title="ganeti.mcpu.HooksMaster" class="py-name" href="#" onclick="return doclink('link-44', 'HooksMaster', 'link-44');">HooksMaster</a></tt> </tt>
</div><a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line"> </tt>
<a name="Processor._AcquireLocks"></a><div id="Processor._AcquireLocks-def"><a name="L194"></a><tt class="py-lineno">194</tt> <a class="py-toggle" href="#" id="Processor._AcquireLocks-toggle" onclick="return toggle('Processor._AcquireLocks');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#_AcquireLocks">_AcquireLocks</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">level</tt><tt class="py-op">,</tt> <tt class="py-param">names</tt><tt class="py-op">,</tt> <tt class="py-param">shared</tt><tt class="py-op">,</tt> <tt class="py-param">timeout</tt><tt class="py-op">,</tt> <tt class="py-param">priority</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor._AcquireLocks-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor._AcquireLocks-expanded"><a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">    <tt class="py-docstring">"""Acquires locks via the Ganeti lock manager.</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line"><tt class="py-docstring">    @type level: int</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line"><tt class="py-docstring">    @param level: Lock level</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line"><tt class="py-docstring">    @type names: list or string</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line"><tt class="py-docstring">    @param names: Lock names</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line"><tt class="py-docstring">    @type shared: bool</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line"><tt class="py-docstring">    @param shared: Whether the locks should be acquired in shared mode</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line"><tt class="py-docstring">    @type timeout: None or float</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line"><tt class="py-docstring">    @param timeout: Timeout for acquiring the locks</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line"><tt class="py-docstring">    @raise LockAcquireTimeout: In case locks couldn't be acquired in specified</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"><tt class="py-docstring">        amount of time</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">:</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">.</tt><tt id="link-45" class="py-name" targets="Method ganeti.jqueue._OpExecCallbacks.CheckCancel()=ganeti.jqueue._OpExecCallbacks-class.html#CheckCancel,Method ganeti.mcpu.OpExecCbBase.CheckCancel()=ganeti.mcpu.OpExecCbBase-class.html#CheckCancel"><a title="ganeti.jqueue._OpExecCallbacks.CheckCancel
ganeti.mcpu.OpExecCbBase.CheckCancel" class="py-name" href="#" onclick="return doclink('link-45', 'CheckCancel', 'link-45');">CheckCancel</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">    <tt class="py-name">acquired</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt id="link-46" class="py-name" targets="Method ganeti.locking.GanetiLockManager.acquire()=ganeti.locking.GanetiLockManager-class.html#acquire,Method ganeti.locking.LockSet.acquire()=ganeti.locking.LockSet-class.html#acquire,Method ganeti.locking.SharedLock.acquire()=ganeti.locking.SharedLock-class.html#acquire"><a title="ganeti.locking.GanetiLockManager.acquire
ganeti.locking.LockSet.acquire
ganeti.locking.SharedLock.acquire" class="py-name" href="#" onclick="return doclink('link-46', 'acquire', 'link-46');">acquire</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">,</tt> <tt class="py-name">names</tt><tt class="py-op">,</tt> <tt class="py-name">shared</tt><tt class="py-op">=</tt><tt class="py-name">shared</tt><tt class="py-op">,</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">                                        <tt class="py-name">timeout</tt><tt class="py-op">=</tt><tt class="py-name">timeout</tt><tt class="py-op">,</tt> <tt class="py-name">priority</tt><tt class="py-op">=</tt><tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line"> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">acquired</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-47" class="py-name" targets="Class ganeti.mcpu.LockAcquireTimeout=ganeti.mcpu.LockAcquireTimeout-class.html"><a title="ganeti.mcpu.LockAcquireTimeout" class="py-name" href="#" onclick="return doclink('link-47', 'LockAcquireTimeout', 'link-47');">LockAcquireTimeout</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">acquired</tt> </tt>
</div><a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line"> </tt>
<a name="Processor._ProcessResult"></a><div id="Processor._ProcessResult-def"><a name="L220"></a><tt class="py-lineno">220</tt> <a class="py-toggle" href="#" id="Processor._ProcessResult-toggle" onclick="return toggle('Processor._ProcessResult');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#_ProcessResult">_ProcessResult</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">result</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor._ProcessResult-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor._ProcessResult-expanded"><a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">    <tt class="py-docstring">"""Examines opcode result.</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line"><tt class="py-docstring">    If necessary, additional processing on the result is done.</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">result</tt><tt class="py-op">,</tt> <tt id="link-48" class="py-name"><a title="ganeti.cmdlib" class="py-name" href="#" onclick="return doclink('link-48', 'cmdlib', 'link-9');">cmdlib</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Class ganeti.cmdlib.ResultWithJobs=ganeti.cmdlib.ResultWithJobs-class.html"><a title="ganeti.cmdlib.ResultWithJobs" class="py-name" href="#" onclick="return doclink('link-49', 'ResultWithJobs', 'link-49');">ResultWithJobs</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">      <tt class="py-comment"># Submit jobs</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">      <tt class="py-name">job_submission</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">.</tt><tt id="link-50" class="py-name" targets="Method ganeti.jqueue.JobQueue.SubmitManyJobs()=ganeti.jqueue.JobQueue-class.html#SubmitManyJobs,Method ganeti.jqueue._OpExecCallbacks.SubmitManyJobs()=ganeti.jqueue._OpExecCallbacks-class.html#SubmitManyJobs,Method ganeti.luxi.Client.SubmitManyJobs()=ganeti.luxi.Client-class.html#SubmitManyJobs,Method ganeti.mcpu.OpExecCbBase.SubmitManyJobs()=ganeti.mcpu.OpExecCbBase-class.html#SubmitManyJobs"><a title="ganeti.jqueue.JobQueue.SubmitManyJobs
ganeti.jqueue._OpExecCallbacks.SubmitManyJobs
ganeti.luxi.Client.SubmitManyJobs
ganeti.mcpu.OpExecCbBase.SubmitManyJobs" class="py-name" href="#" onclick="return doclink('link-50', 'SubmitManyJobs', 'link-50');">SubmitManyJobs</a></tt><tt class="py-op">(</tt><tt class="py-name">result</tt><tt class="py-op">.</tt><tt class="py-name">jobs</tt><tt class="py-op">)</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">      <tt class="py-comment"># Build dictionary</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">      <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">result</tt><tt class="py-op">.</tt><tt class="py-name">other</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt id="link-51" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-51', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-52" class="py-name" targets="Variable ganeti.constants.JOB_IDS_KEY=ganeti.constants-module.html#JOB_IDS_KEY"><a title="ganeti.constants.JOB_IDS_KEY" class="py-name" href="#" onclick="return doclink('link-52', 'JOB_IDS_KEY', 'link-52');">JOB_IDS_KEY</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">result</tt><tt class="py-op">,</tt> \ </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">        <tt class="py-string">"Key '%s' found in additional return values"</tt> <tt class="py-op">%</tt> <tt id="link-53" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-53', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="ganeti.constants.JOB_IDS_KEY" class="py-name" href="#" onclick="return doclink('link-54', 'JOB_IDS_KEY', 'link-52');">JOB_IDS_KEY</a></tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line"> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">      <tt class="py-name">result</tt><tt class="py-op">[</tt><tt id="link-55" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-55', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name"><a title="ganeti.constants.JOB_IDS_KEY" class="py-name" href="#" onclick="return doclink('link-56', 'JOB_IDS_KEY', 'link-52');">JOB_IDS_KEY</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">job_submission</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line"> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">result</tt> </tt>
</div><a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line"> </tt>
<a name="Processor._ExecLU"></a><div id="Processor._ExecLU-def"><a name="L240"></a><tt class="py-lineno">240</tt> <a class="py-toggle" href="#" id="Processor._ExecLU-toggle" onclick="return toggle('Processor._ExecLU');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#_ExecLU">_ExecLU</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">lu</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor._ExecLU-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor._ExecLU-expanded"><a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">    <tt class="py-docstring">"""Logical Unit execution sequence.</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">    <tt class="py-name">write_count</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt class="py-name">write_count</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">    <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.CheckPrereq()=ganeti.cmdlib.LUBackupExport-class.html#CheckPrereq,Method ganeti.cmdlib.LUBackupPrepare.CheckPrereq()=ganeti.cmdlib.LUBackupPrepare-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterDestroy.CheckPrereq()=ganeti.cmdlib.LUClusterDestroy-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterRename.CheckPrereq()=ganeti.cmdlib.LUClusterRename-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterRepairDiskSizes.CheckPrereq()=ganeti.cmdlib.LUClusterRepairDiskSizes-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterSetParams.CheckPrereq()=ganeti.cmdlib.LUClusterSetParams-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterVerifyConfig.CheckPrereq()=ganeti.cmdlib.LUClusterVerifyConfig-class.html#CheckPrereq,Method ganeti.cmdlib.LUClusterVerifyGroup.CheckPrereq()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupAdd.CheckPrereq()=ganeti.cmdlib.LUGroupAdd-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupAssignNodes.CheckPrereq()=ganeti.cmdlib.LUGroupAssignNodes-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupEvacuate.CheckPrereq()=ganeti.cmdlib.LUGroupEvacuate-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupRemove.CheckPrereq()=ganeti.cmdlib.LUGroupRemove-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupRename.CheckPrereq()=ganeti.cmdlib.LUGroupRename-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupSetParams.CheckPrereq()=ganeti.cmdlib.LUGroupSetParams-class.html#CheckPrereq,Method ganeti.cmdlib.LUGroupVerifyDisks.CheckPrereq()=ganeti.cmdlib.LUGroupVerifyDisks-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceActivateDisks.CheckPrereq()=ganeti.cmdlib.LUInstanceActivateDisks-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceChangeGroup.CheckPrereq()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceConsole.CheckPrereq()=ganeti.cmdlib.LUInstanceConsole-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceCreate.CheckPrereq()=ganeti.cmdlib.LUInstanceCreate-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceDeactivateDisks.CheckPrereq()=ganeti.cmdlib.LUInstanceDeactivateDisks-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceGrowDisk.CheckPrereq()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceMove.CheckPrereq()=ganeti.cmdlib.LUInstanceMove-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceQueryData.CheckPrereq()=ganeti.cmdlib.LUInstanceQueryData-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceReboot.CheckPrereq()=ganeti.cmdlib.LUInstanceReboot-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceRecreateDisks.CheckPrereq()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceReinstall.CheckPrereq()=ganeti.cmdlib.LUInstanceReinstall-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceRemove.CheckPrereq()=ganeti.cmdlib.LUInstanceRemove-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceRename.CheckPrereq()=ganeti.cmdlib.LUInstanceRename-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceReplaceDisks.CheckPrereq()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceSetParams.CheckPrereq()=ganeti.cmdlib.LUInstanceSetParams-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceShutdown.CheckPrereq()=ganeti.cmdlib.LUInstanceShutdown-class.html#CheckPrereq,Method ganeti.cmdlib.LUInstanceStartup.CheckPrereq()=ganeti.cmdlib.LUInstanceStartup-class.html#CheckPrereq,Method ganeti.cmdlib.LUNodeAdd.CheckPrereq()=ganeti.cmdlib.LUNodeAdd-class.html#CheckPrereq,Method ganeti.cmdlib.LUNodeEvacuate.CheckPrereq()=ganeti.cmdlib.LUNodeEvacuate-class.html#CheckPrereq,Method ganeti.cmdlib.LUNodeMigrate.CheckPrereq()=ganeti.cmdlib.LUNodeMigrate-class.html#CheckPrereq,Method ganeti.cmdlib.LUNodeRemove.CheckPrereq()=ganeti.cmdlib.LUNodeRemove-class.html#CheckPrereq,Method ganeti.cmdlib.LUNodeSetParams.CheckPrereq()=ganeti.cmdlib.LUNodeSetParams-class.html#CheckPrereq,Method ganeti.cmdlib.LUOobCommand.CheckPrereq()=ganeti.cmdlib.LUOobCommand-class.html#CheckPrereq,Method ganeti.cmdlib.LURepairNodeStorage.CheckPrereq()=ganeti.cmdlib.LURepairNodeStorage-class.html#CheckPrereq,Method ganeti.cmdlib.LUTagsDel.CheckPrereq()=ganeti.cmdlib.LUTagsDel-class.html#CheckPrereq,Method ganeti.cmdlib.LUTagsSearch.CheckPrereq()=ganeti.cmdlib.LUTagsSearch-class.html#CheckPrereq,Method ganeti.cmdlib.LUTagsSet.CheckPrereq()=ganeti.cmdlib.LUTagsSet-class.html#CheckPrereq,Method ganeti.cmdlib.LUTestAllocator.CheckPrereq()=ganeti.cmdlib.LUTestAllocator-class.html#CheckPrereq,Method ganeti.cmdlib.LogicalUnit.CheckPrereq()=ganeti.cmdlib.LogicalUnit-class.html#CheckPrereq,Method ganeti.cmdlib.TLMigrateInstance.CheckPrereq()=ganeti.cmdlib.TLMigrateInstance-class.html#CheckPrereq,Method ganeti.cmdlib.TLReplaceDisks.CheckPrereq()=ganeti.cmdlib.TLReplaceDisks-class.html#CheckPrereq,Method ganeti.cmdlib.TagsLU.CheckPrereq()=ganeti.cmdlib.TagsLU-class.html#CheckPrereq,Method ganeti.cmdlib.Tasklet.CheckPrereq()=ganeti.cmdlib.Tasklet-class.html#CheckPrereq,Function script-lvmstrap.CheckPrereq()=script-lvmstrap-module.html#CheckPrereq"><a title="ganeti.cmdlib.LUBackupExport.CheckPrereq
ganeti.cmdlib.LUBackupPrepare.CheckPrereq
ganeti.cmdlib.LUClusterDestroy.CheckPrereq
ganeti.cmdlib.LUClusterRename.CheckPrereq
ganeti.cmdlib.LUClusterRepairDiskSizes.CheckPrereq
ganeti.cmdlib.LUClusterSetParams.CheckPrereq
ganeti.cmdlib.LUClusterVerifyConfig.CheckPrereq
ganeti.cmdlib.LUClusterVerifyGroup.CheckPrereq
ganeti.cmdlib.LUGroupAdd.CheckPrereq
ganeti.cmdlib.LUGroupAssignNodes.CheckPrereq
ganeti.cmdlib.LUGroupEvacuate.CheckPrereq
ganeti.cmdlib.LUGroupRemove.CheckPrereq
ganeti.cmdlib.LUGroupRename.CheckPrereq
ganeti.cmdlib.LUGroupSetParams.CheckPrereq
ganeti.cmdlib.LUGroupVerifyDisks.CheckPrereq
ganeti.cmdlib.LUInstanceActivateDisks.CheckPrereq
ganeti.cmdlib.LUInstanceChangeGroup.CheckPrereq
ganeti.cmdlib.LUInstanceConsole.CheckPrereq
ganeti.cmdlib.LUInstanceCreate.CheckPrereq
ganeti.cmdlib.LUInstanceDeactivateDisks.CheckPrereq
ganeti.cmdlib.LUInstanceGrowDisk.CheckPrereq
ganeti.cmdlib.LUInstanceMove.CheckPrereq
ganeti.cmdlib.LUInstanceQueryData.CheckPrereq
ganeti.cmdlib.LUInstanceReboot.CheckPrereq
ganeti.cmdlib.LUInstanceRecreateDisks.CheckPrereq
ganeti.cmdlib.LUInstanceReinstall.CheckPrereq
ganeti.cmdlib.LUInstanceRemove.CheckPrereq
ganeti.cmdlib.LUInstanceRename.CheckPrereq
ganeti.cmdlib.LUInstanceReplaceDisks.CheckPrereq
ganeti.cmdlib.LUInstanceSetParams.CheckPrereq
ganeti.cmdlib.LUInstanceShutdown.CheckPrereq
ganeti.cmdlib.LUInstanceStartup.CheckPrereq
ganeti.cmdlib.LUNodeAdd.CheckPrereq
ganeti.cmdlib.LUNodeEvacuate.CheckPrereq
ganeti.cmdlib.LUNodeMigrate.CheckPrereq
ganeti.cmdlib.LUNodeRemove.CheckPrereq
ganeti.cmdlib.LUNodeSetParams.CheckPrereq
ganeti.cmdlib.LUOobCommand.CheckPrereq
ganeti.cmdlib.LURepairNodeStorage.CheckPrereq
ganeti.cmdlib.LUTagsDel.CheckPrereq
ganeti.cmdlib.LUTagsSearch.CheckPrereq
ganeti.cmdlib.LUTagsSet.CheckPrereq
ganeti.cmdlib.LUTestAllocator.CheckPrereq
ganeti.cmdlib.LogicalUnit.CheckPrereq
ganeti.cmdlib.TLMigrateInstance.CheckPrereq
ganeti.cmdlib.TLReplaceDisks.CheckPrereq
ganeti.cmdlib.TagsLU.CheckPrereq
ganeti.cmdlib.Tasklet.CheckPrereq
script-lvmstrap.CheckPrereq" class="py-name" href="#" onclick="return doclink('link-57', 'CheckPrereq', 'link-57');">CheckPrereq</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">    <tt class="py-name">hm</tt> <tt class="py-op">=</tt> <tt id="link-58" class="py-name"><a title="ganeti.mcpu.HooksMaster" class="py-name" href="#" onclick="return doclink('link-58', 'HooksMaster', 'link-44');">HooksMaster</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-59" class="py-name"><a title="ganeti.rpc" class="py-name" href="#" onclick="return doclink('link-59', 'rpc', 'link-7');">rpc</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name" targets="Method ganeti.rpc.RpcRunner.call_hooks_runner()=ganeti.rpc.RpcRunner-class.html#call_hooks_runner"><a title="ganeti.rpc.RpcRunner.call_hooks_runner" class="py-name" href="#" onclick="return doclink('link-60', 'call_hooks_runner', 'link-60');">call_hooks_runner</a></tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">)</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">    <tt class="py-name">h_results</tt> <tt class="py-op">=</tt> <tt class="py-name">hm</tt><tt class="py-op">.</tt><tt id="link-61" class="py-name" targets="Method ganeti.mcpu.HooksMaster.RunPhase()=ganeti.mcpu.HooksMaster-class.html#RunPhase"><a title="ganeti.mcpu.HooksMaster.RunPhase" class="py-name" href="#" onclick="return doclink('link-61', 'RunPhase', 'link-61');">RunPhase</a></tt><tt class="py-op">(</tt><tt id="link-62" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-62', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Variable ganeti.constants.HOOKS_PHASE_PRE=ganeti.constants-module.html#HOOKS_PHASE_PRE"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-63', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">)</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">    <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-64" class="py-name" targets="Method ganeti.cmdlib.LUClusterVerifyGroup.HooksCallBack()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#HooksCallBack,Method ganeti.cmdlib.LogicalUnit.HooksCallBack()=ganeti.cmdlib.LogicalUnit-class.html#HooksCallBack"><a title="ganeti.cmdlib.LUClusterVerifyGroup.HooksCallBack
ganeti.cmdlib.LogicalUnit.HooksCallBack" class="py-name" href="#" onclick="return doclink('link-64', 'HooksCallBack', 'link-64');">HooksCallBack</a></tt><tt class="py-op">(</tt><tt id="link-65" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-65', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-66', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">,</tt> <tt class="py-name">h_results</tt><tt class="py-op">,</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">                     <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Method ganeti.mcpu.Processor.Log()=ganeti.mcpu.Processor-class.html#Log,Function script-burnin.Log()=script-burnin-module.html#Log"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-67', 'Log', 'link-67');">Log</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line"> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">op</tt><tt class="py-op">,</tt> <tt class="py-string">"dry_run"</tt><tt class="py-op">,</tt> <tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">      <tt class="py-comment"># in this mode, no post-hooks are run, and the config is not</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">      <tt class="py-comment"># written (as it might have been modified by another LU, and we</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">      <tt class="py-comment"># shouldn't do writeout on behalf of other threads</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-68" class="py-name" targets="Method ganeti.mcpu.Processor.LogInfo()=ganeti.mcpu.Processor-class.html#LogInfo"><a title="ganeti.mcpu.Processor.LogInfo" class="py-name" href="#" onclick="return doclink('link-68', 'LogInfo', 'link-68');">LogInfo</a></tt><tt class="py-op">(</tt><tt class="py-string">"dry-run mode requested, not actually executing"</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">                   <tt class="py-string">" the operation"</tt><tt class="py-op">)</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">      <tt class="py-keyword">return</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">dry_run_result</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">      <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-69" class="py-name" targets="Method ganeti.mcpu.Processor._ProcessResult()=ganeti.mcpu.Processor-class.html#_ProcessResult,Function ganeti.query._ProcessResult()=ganeti.query-module.html#_ProcessResult"><a title="ganeti.mcpu.Processor._ProcessResult
ganeti.query._ProcessResult" class="py-name" href="#" onclick="return doclink('link-69', '_ProcessResult', 'link-69');">_ProcessResult</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.Exec()=ganeti.cmdlib.LUBackupExport-class.html#Exec,Method ganeti.cmdlib.LUBackupPrepare.Exec()=ganeti.cmdlib.LUBackupPrepare-class.html#Exec,Method ganeti.cmdlib.LUBackupQuery.Exec()=ganeti.cmdlib.LUBackupQuery-class.html#Exec,Method ganeti.cmdlib.LUBackupRemove.Exec()=ganeti.cmdlib.LUBackupRemove-class.html#Exec,Method ganeti.cmdlib.LUClusterConfigQuery.Exec()=ganeti.cmdlib.LUClusterConfigQuery-class.html#Exec,Method ganeti.cmdlib.LUClusterDestroy.Exec()=ganeti.cmdlib.LUClusterDestroy-class.html#Exec,Method ganeti.cmdlib.LUClusterPostInit.Exec()=ganeti.cmdlib.LUClusterPostInit-class.html#Exec,Method ganeti.cmdlib.LUClusterQuery.Exec()=ganeti.cmdlib.LUClusterQuery-class.html#Exec,Method ganeti.cmdlib.LUClusterRedistConf.Exec()=ganeti.cmdlib.LUClusterRedistConf-class.html#Exec,Method ganeti.cmdlib.LUClusterRename.Exec()=ganeti.cmdlib.LUClusterRename-class.html#Exec,Method ganeti.cmdlib.LUClusterRepairDiskSizes.Exec()=ganeti.cmdlib.LUClusterRepairDiskSizes-class.html#Exec,Method ganeti.cmdlib.LUClusterSetParams.Exec()=ganeti.cmdlib.LUClusterSetParams-class.html#Exec,Method ganeti.cmdlib.LUClusterVerify.Exec()=ganeti.cmdlib.LUClusterVerify-class.html#Exec,Method ganeti.cmdlib.LUClusterVerifyConfig.Exec()=ganeti.cmdlib.LUClusterVerifyConfig-class.html#Exec,Method ganeti.cmdlib.LUClusterVerifyDisks.Exec()=ganeti.cmdlib.LUClusterVerifyDisks-class.html#Exec,Method ganeti.cmdlib.LUClusterVerifyGroup.Exec()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#Exec,Method ganeti.cmdlib.LUGroupAdd.Exec()=ganeti.cmdlib.LUGroupAdd-class.html#Exec,Method ganeti.cmdlib.LUGroupAssignNodes.Exec()=ganeti.cmdlib.LUGroupAssignNodes-class.html#Exec,Method ganeti.cmdlib.LUGroupEvacuate.Exec()=ganeti.cmdlib.LUGroupEvacuate-class.html#Exec,Method ganeti.cmdlib.LUGroupQuery.Exec()=ganeti.cmdlib.LUGroupQuery-class.html#Exec,Method ganeti.cmdlib.LUGroupRemove.Exec()=ganeti.cmdlib.LUGroupRemove-class.html#Exec,Method ganeti.cmdlib.LUGroupRename.Exec()=ganeti.cmdlib.LUGroupRename-class.html#Exec,Method ganeti.cmdlib.LUGroupSetParams.Exec()=ganeti.cmdlib.LUGroupSetParams-class.html#Exec,Method ganeti.cmdlib.LUGroupVerifyDisks.Exec()=ganeti.cmdlib.LUGroupVerifyDisks-class.html#Exec,Method ganeti.cmdlib.LUInstanceActivateDisks.Exec()=ganeti.cmdlib.LUInstanceActivateDisks-class.html#Exec,Method ganeti.cmdlib.LUInstanceChangeGroup.Exec()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#Exec,Method ganeti.cmdlib.LUInstanceConsole.Exec()=ganeti.cmdlib.LUInstanceConsole-class.html#Exec,Method ganeti.cmdlib.LUInstanceCreate.Exec()=ganeti.cmdlib.LUInstanceCreate-class.html#Exec,Method ganeti.cmdlib.LUInstanceDeactivateDisks.Exec()=ganeti.cmdlib.LUInstanceDeactivateDisks-class.html#Exec,Method ganeti.cmdlib.LUInstanceGrowDisk.Exec()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#Exec,Method ganeti.cmdlib.LUInstanceMove.Exec()=ganeti.cmdlib.LUInstanceMove-class.html#Exec,Method ganeti.cmdlib.LUInstanceQuery.Exec()=ganeti.cmdlib.LUInstanceQuery-class.html#Exec,Method ganeti.cmdlib.LUInstanceQueryData.Exec()=ganeti.cmdlib.LUInstanceQueryData-class.html#Exec,Method ganeti.cmdlib.LUInstanceReboot.Exec()=ganeti.cmdlib.LUInstanceReboot-class.html#Exec,Method ganeti.cmdlib.LUInstanceRecreateDisks.Exec()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#Exec,Method ganeti.cmdlib.LUInstanceReinstall.Exec()=ganeti.cmdlib.LUInstanceReinstall-class.html#Exec,Method ganeti.cmdlib.LUInstanceRemove.Exec()=ganeti.cmdlib.LUInstanceRemove-class.html#Exec,Method ganeti.cmdlib.LUInstanceRename.Exec()=ganeti.cmdlib.LUInstanceRename-class.html#Exec,Method ganeti.cmdlib.LUInstanceSetParams.Exec()=ganeti.cmdlib.LUInstanceSetParams-class.html#Exec,Method ganeti.cmdlib.LUInstanceShutdown.Exec()=ganeti.cmdlib.LUInstanceShutdown-class.html#Exec,Method ganeti.cmdlib.LUInstanceStartup.Exec()=ganeti.cmdlib.LUInstanceStartup-class.html#Exec,Method ganeti.cmdlib.LUNodeAdd.Exec()=ganeti.cmdlib.LUNodeAdd-class.html#Exec,Method ganeti.cmdlib.LUNodeEvacuate.Exec()=ganeti.cmdlib.LUNodeEvacuate-class.html#Exec,Method ganeti.cmdlib.LUNodeMigrate.Exec()=ganeti.cmdlib.LUNodeMigrate-class.html#Exec,Method ganeti.cmdlib.LUNodeModifyStorage.Exec()=ganeti.cmdlib.LUNodeModifyStorage-class.html#Exec,Method ganeti.cmdlib.LUNodePowercycle.Exec()=ganeti.cmdlib.LUNodePowercycle-class.html#Exec,Method ganeti.cmdlib.LUNodeQuery.Exec()=ganeti.cmdlib.LUNodeQuery-class.html#Exec,Method ganeti.cmdlib.LUNodeQueryStorage.Exec()=ganeti.cmdlib.LUNodeQueryStorage-class.html#Exec,Method ganeti.cmdlib.LUNodeQueryvols.Exec()=ganeti.cmdlib.LUNodeQueryvols-class.html#Exec,Method ganeti.cmdlib.LUNodeRemove.Exec()=ganeti.cmdlib.LUNodeRemove-class.html#Exec,Method ganeti.cmdlib.LUNodeSetParams.Exec()=ganeti.cmdlib.LUNodeSetParams-class.html#Exec,Method ganeti.cmdlib.LUOobCommand.Exec()=ganeti.cmdlib.LUOobCommand-class.html#Exec,Method ganeti.cmdlib.LUOsDiagnose.Exec()=ganeti.cmdlib.LUOsDiagnose-class.html#Exec,Method ganeti.cmdlib.LUQuery.Exec()=ganeti.cmdlib.LUQuery-class.html#Exec,Method ganeti.cmdlib.LUQueryFields.Exec()=ganeti.cmdlib.LUQueryFields-class.html#Exec,Method ganeti.cmdlib.LURepairNodeStorage.Exec()=ganeti.cmdlib.LURepairNodeStorage-class.html#Exec,Method ganeti.cmdlib.LUTagsDel.Exec()=ganeti.cmdlib.LUTagsDel-class.html#Exec,Method ganeti.cmdlib.LUTagsGet.Exec()=ganeti.cmdlib.LUTagsGet-class.html#Exec,Method ganeti.cmdlib.LUTagsSearch.Exec()=ganeti.cmdlib.LUTagsSearch-class.html#Exec,Method ganeti.cmdlib.LUTagsSet.Exec()=ganeti.cmdlib.LUTagsSet-class.html#Exec,Method ganeti.cmdlib.LUTestAllocator.Exec()=ganeti.cmdlib.LUTestAllocator-class.html#Exec,Method ganeti.cmdlib.LUTestDelay.Exec()=ganeti.cmdlib.LUTestDelay-class.html#Exec,Method ganeti.cmdlib.LUTestJqueue.Exec()=ganeti.cmdlib.LUTestJqueue-class.html#Exec,Method ganeti.cmdlib.LogicalUnit.Exec()=ganeti.cmdlib.LogicalUnit-class.html#Exec,Method ganeti.cmdlib.TLMigrateInstance.Exec()=ganeti.cmdlib.TLMigrateInstance-class.html#Exec,Method ganeti.cmdlib.TLReplaceDisks.Exec()=ganeti.cmdlib.TLReplaceDisks-class.html#Exec,Method ganeti.cmdlib.Tasklet.Exec()=ganeti.cmdlib.Tasklet-class.html#Exec,Method ganeti.confd.querylib.ClusterMasterQuery.Exec()=ganeti.confd.querylib.ClusterMasterQuery-class.html#Exec,Method ganeti.confd.querylib.ConfdQuery.Exec()=ganeti.confd.querylib.ConfdQuery-class.html#Exec,Method ganeti.confd.querylib.InstanceIpToNodePrimaryIpQuery.Exec()=ganeti.confd.querylib.InstanceIpToNodePrimaryIpQuery-class.html#Exec,Method ganeti.confd.querylib.InstancesIpsQuery.Exec()=ganeti.confd.querylib.InstancesIpsQuery-class.html#Exec,Method ganeti.confd.querylib.MasterCandidatesPipsQuery.Exec()=ganeti.confd.querylib.MasterCandidatesPipsQuery-class.html#Exec,Method ganeti.confd.querylib.NodeRoleQuery.Exec()=ganeti.confd.querylib.NodeRoleQuery-class.html#Exec,Method ganeti.confd.querylib.NodesPipsQuery.Exec()=ganeti.confd.querylib.NodesPipsQuery-class.html#Exec,Method ganeti.confd.querylib.PingQuery.Exec()=ganeti.confd.querylib.PingQuery-class.html#Exec,Method ganeti.watcher.nodemaint.NodeMaintenance.Exec()=ganeti.watcher.nodemaint.NodeMaintenance-class.html#Exec"><a title="ganeti.cmdlib.LUBackupExport.Exec
ganeti.cmdlib.LUBackupPrepare.Exec
ganeti.cmdlib.LUBackupQuery.Exec
ganeti.cmdlib.LUBackupRemove.Exec
ganeti.cmdlib.LUClusterConfigQuery.Exec
ganeti.cmdlib.LUClusterDestroy.Exec
ganeti.cmdlib.LUClusterPostInit.Exec
ganeti.cmdlib.LUClusterQuery.Exec
ganeti.cmdlib.LUClusterRedistConf.Exec
ganeti.cmdlib.LUClusterRename.Exec
ganeti.cmdlib.LUClusterRepairDiskSizes.Exec
ganeti.cmdlib.LUClusterSetParams.Exec
ganeti.cmdlib.LUClusterVerify.Exec
ganeti.cmdlib.LUClusterVerifyConfig.Exec
ganeti.cmdlib.LUClusterVerifyDisks.Exec
ganeti.cmdlib.LUClusterVerifyGroup.Exec
ganeti.cmdlib.LUGroupAdd.Exec
ganeti.cmdlib.LUGroupAssignNodes.Exec
ganeti.cmdlib.LUGroupEvacuate.Exec
ganeti.cmdlib.LUGroupQuery.Exec
ganeti.cmdlib.LUGroupRemove.Exec
ganeti.cmdlib.LUGroupRename.Exec
ganeti.cmdlib.LUGroupSetParams.Exec
ganeti.cmdlib.LUGroupVerifyDisks.Exec
ganeti.cmdlib.LUInstanceActivateDisks.Exec
ganeti.cmdlib.LUInstanceChangeGroup.Exec
ganeti.cmdlib.LUInstanceConsole.Exec
ganeti.cmdlib.LUInstanceCreate.Exec
ganeti.cmdlib.LUInstanceDeactivateDisks.Exec
ganeti.cmdlib.LUInstanceGrowDisk.Exec
ganeti.cmdlib.LUInstanceMove.Exec
ganeti.cmdlib.LUInstanceQuery.Exec
ganeti.cmdlib.LUInstanceQueryData.Exec
ganeti.cmdlib.LUInstanceReboot.Exec
ganeti.cmdlib.LUInstanceRecreateDisks.Exec
ganeti.cmdlib.LUInstanceReinstall.Exec
ganeti.cmdlib.LUInstanceRemove.Exec
ganeti.cmdlib.LUInstanceRename.Exec
ganeti.cmdlib.LUInstanceSetParams.Exec
ganeti.cmdlib.LUInstanceShutdown.Exec
ganeti.cmdlib.LUInstanceStartup.Exec
ganeti.cmdlib.LUNodeAdd.Exec
ganeti.cmdlib.LUNodeEvacuate.Exec
ganeti.cmdlib.LUNodeMigrate.Exec
ganeti.cmdlib.LUNodeModifyStorage.Exec
ganeti.cmdlib.LUNodePowercycle.Exec
ganeti.cmdlib.LUNodeQuery.Exec
ganeti.cmdlib.LUNodeQueryStorage.Exec
ganeti.cmdlib.LUNodeQueryvols.Exec
ganeti.cmdlib.LUNodeRemove.Exec
ganeti.cmdlib.LUNodeSetParams.Exec
ganeti.cmdlib.LUOobCommand.Exec
ganeti.cmdlib.LUOsDiagnose.Exec
ganeti.cmdlib.LUQuery.Exec
ganeti.cmdlib.LUQueryFields.Exec
ganeti.cmdlib.LURepairNodeStorage.Exec
ganeti.cmdlib.LUTagsDel.Exec
ganeti.cmdlib.LUTagsGet.Exec
ganeti.cmdlib.LUTagsSearch.Exec
ganeti.cmdlib.LUTagsSet.Exec
ganeti.cmdlib.LUTestAllocator.Exec
ganeti.cmdlib.LUTestDelay.Exec
ganeti.cmdlib.LUTestJqueue.Exec
ganeti.cmdlib.LogicalUnit.Exec
ganeti.cmdlib.TLMigrateInstance.Exec
ganeti.cmdlib.TLReplaceDisks.Exec
ganeti.cmdlib.Tasklet.Exec
ganeti.confd.querylib.ClusterMasterQuery.Exec
ganeti.confd.querylib.ConfdQuery.Exec
ganeti.confd.querylib.InstanceIpToNodePrimaryIpQuery.Exec
ganeti.confd.querylib.InstancesIpsQuery.Exec
ganeti.confd.querylib.MasterCandidatesPipsQuery.Exec
ganeti.confd.querylib.NodeRoleQuery.Exec
ganeti.confd.querylib.NodesPipsQuery.Exec
ganeti.confd.querylib.PingQuery.Exec
ganeti.watcher.nodemaint.NodeMaintenance.Exec" class="py-name" href="#" onclick="return doclink('link-70', 'Exec', 'link-70');">Exec</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-71" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-71', 'Log', 'link-67');">Log</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">      <tt class="py-name">h_results</tt> <tt class="py-op">=</tt> <tt class="py-name">hm</tt><tt class="py-op">.</tt><tt id="link-72" class="py-name"><a title="ganeti.mcpu.HooksMaster.RunPhase" class="py-name" href="#" onclick="return doclink('link-72', 'RunPhase', 'link-61');">RunPhase</a></tt><tt class="py-op">(</tt><tt id="link-73" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-73', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-74" class="py-name" targets="Variable ganeti.constants.HOOKS_PHASE_POST=ganeti.constants-module.html#HOOKS_PHASE_POST"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-74', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt><tt class="py-op">)</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">      <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="ganeti.cmdlib.LUClusterVerifyGroup.HooksCallBack
ganeti.cmdlib.LogicalUnit.HooksCallBack" class="py-name" href="#" onclick="return doclink('link-75', 'HooksCallBack', 'link-64');">HooksCallBack</a></tt><tt class="py-op">(</tt><tt id="link-76" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-76', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-77" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-77', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt><tt class="py-op">,</tt> <tt class="py-name">h_results</tt><tt class="py-op">,</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">                                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-78" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-78', 'Log', 'link-67');">Log</a></tt><tt class="py-op">,</tt> <tt class="py-name">result</tt><tt class="py-op">)</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">    <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">      <tt class="py-comment"># FIXME: This needs locks if not lu_class.REQ_BGL</tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">write_count</tt> <tt class="py-op">!=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt class="py-name">write_count</tt><tt class="py-op">:</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">        <tt class="py-name">hm</tt><tt class="py-op">.</tt><tt id="link-79" class="py-name" targets="Method ganeti.mcpu.HooksMaster.RunConfigUpdate()=ganeti.mcpu.HooksMaster-class.html#RunConfigUpdate"><a title="ganeti.mcpu.HooksMaster.RunConfigUpdate" class="py-name" href="#" onclick="return doclink('link-79', 'RunConfigUpdate', 'link-79');">RunConfigUpdate</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line"> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">result</tt> </tt>
</div><a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line"> </tt>
<a name="Processor._LockAndExecLU"></a><div id="Processor._LockAndExecLU-def"><a name="L271"></a><tt class="py-lineno">271</tt> <a class="py-toggle" href="#" id="Processor._LockAndExecLU-toggle" onclick="return toggle('Processor._LockAndExecLU');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#_LockAndExecLU">_LockAndExecLU</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">lu</tt><tt class="py-op">,</tt> <tt class="py-param">level</tt><tt class="py-op">,</tt> <tt class="py-param">calc_timeout</tt><tt class="py-op">,</tt> <tt class="py-param">priority</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor._LockAndExecLU-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor._LockAndExecLU-expanded"><a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">    <tt class="py-docstring">"""Execute a Logical Unit, with the needed locks.</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line"><tt class="py-docstring">    This is a recursive function that starts locking the given level, and</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"><tt class="py-docstring">    proceeds up, till there are no more locks to acquire. Then it executes the</tt> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line"><tt class="py-docstring">    given LU and its opcodes.</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">    <tt class="py-name">adding_locks</tt> <tt class="py-op">=</tt> <tt class="py-name">level</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">add_locks</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">    <tt class="py-name">acquiring_locks</tt> <tt class="py-op">=</tt> <tt class="py-name">level</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">needed_locks</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">level</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-80" class="py-name"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-80', 'locking', 'link-11');">locking</a></tt><tt class="py-op">.</tt><tt id="link-81" class="py-name" targets="Variable ganeti.locking.LEVELS=ganeti.locking-module.html#LEVELS"><a title="ganeti.locking.LEVELS" class="py-name" href="#" onclick="return doclink('link-81', 'LEVELS', 'link-81');">LEVELS</a></tt><tt class="py-op">:</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">:</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">.</tt><tt id="link-82" class="py-name" targets="Method ganeti.jqueue._OpExecCallbacks.NotifyStart()=ganeti.jqueue._OpExecCallbacks-class.html#NotifyStart,Method ganeti.mcpu.OpExecCbBase.NotifyStart()=ganeti.mcpu.OpExecCbBase-class.html#NotifyStart"><a title="ganeti.jqueue._OpExecCallbacks.NotifyStart
ganeti.mcpu.OpExecCbBase.NotifyStart" class="py-name" href="#" onclick="return doclink('link-82', 'NotifyStart', 'link-82');">NotifyStart</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line"> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">      <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-83" class="py-name" targets="Method ganeti.mcpu.Processor._ExecLU()=ganeti.mcpu.Processor-class.html#_ExecLU"><a title="ganeti.mcpu.Processor._ExecLU" class="py-name" href="#" onclick="return doclink('link-83', '_ExecLU', 'link-83');">_ExecLU</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line"> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">adding_locks</tt> <tt class="py-keyword">and</tt> <tt class="py-name">acquiring_locks</tt><tt class="py-op">:</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">      <tt class="py-comment"># We could both acquire and add locks at the same level, but for now we</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">      <tt class="py-comment"># don't need this, so we'll avoid the complicated code needed.</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">NotImplementedError</tt><tt class="py-op">(</tt><tt class="py-string">"Can't declare locks to acquire when adding"</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">                                <tt class="py-string">" others"</tt><tt class="py-op">)</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line"> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">adding_locks</tt> <tt class="py-keyword">or</tt> <tt class="py-name">acquiring_locks</tt><tt class="py-op">:</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line">      <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-84" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.DeclareLocks()=ganeti.cmdlib.LUBackupExport-class.html#DeclareLocks,Method ganeti.cmdlib.LUClusterRepairDiskSizes.DeclareLocks()=ganeti.cmdlib.LUClusterRepairDiskSizes-class.html#DeclareLocks,Method ganeti.cmdlib.LUClusterVerifyGroup.DeclareLocks()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#DeclareLocks,Method ganeti.cmdlib.LUGroupAssignNodes.DeclareLocks()=ganeti.cmdlib.LUGroupAssignNodes-class.html#DeclareLocks,Method ganeti.cmdlib.LUGroupEvacuate.DeclareLocks()=ganeti.cmdlib.LUGroupEvacuate-class.html#DeclareLocks,Method ganeti.cmdlib.LUGroupQuery.DeclareLocks()=ganeti.cmdlib.LUGroupQuery-class.html#DeclareLocks,Method ganeti.cmdlib.LUGroupVerifyDisks.DeclareLocks()=ganeti.cmdlib.LUGroupVerifyDisks-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceActivateDisks.DeclareLocks()=ganeti.cmdlib.LUInstanceActivateDisks-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceChangeGroup.DeclareLocks()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceDeactivateDisks.DeclareLocks()=ganeti.cmdlib.LUInstanceDeactivateDisks-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceFailover.DeclareLocks()=ganeti.cmdlib.LUInstanceFailover-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceGrowDisk.DeclareLocks()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceMigrate.DeclareLocks()=ganeti.cmdlib.LUInstanceMigrate-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceMove.DeclareLocks()=ganeti.cmdlib.LUInstanceMove-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceQuery.DeclareLocks()=ganeti.cmdlib.LUInstanceQuery-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceQueryData.DeclareLocks()=ganeti.cmdlib.LUInstanceQueryData-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceRecreateDisks.DeclareLocks()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceRemove.DeclareLocks()=ganeti.cmdlib.LUInstanceRemove-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceReplaceDisks.DeclareLocks()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#DeclareLocks,Method ganeti.cmdlib.LUInstanceSetParams.DeclareLocks()=ganeti.cmdlib.LUInstanceSetParams-class.html#DeclareLocks,Method ganeti.cmdlib.LUNodeEvacuate.DeclareLocks()=ganeti.cmdlib.LUNodeEvacuate-class.html#DeclareLocks,Method ganeti.cmdlib.LUNodeSetParams.DeclareLocks()=ganeti.cmdlib.LUNodeSetParams-class.html#DeclareLocks,Method ganeti.cmdlib.LUQuery.DeclareLocks()=ganeti.cmdlib.LUQuery-class.html#DeclareLocks,Method ganeti.cmdlib.LogicalUnit.DeclareLocks()=ganeti.cmdlib.LogicalUnit-class.html#DeclareLocks,Method ganeti.cmdlib._GroupQuery.DeclareLocks()=ganeti.cmdlib._GroupQuery-class.html#DeclareLocks,Method ganeti.cmdlib._InstanceQuery.DeclareLocks()=ganeti.cmdlib._InstanceQuery-class.html#DeclareLocks,Method ganeti.cmdlib._NodeQuery.DeclareLocks()=ganeti.cmdlib._NodeQuery-class.html#DeclareLocks,Method ganeti.cmdlib._OsQuery.DeclareLocks()=ganeti.cmdlib._OsQuery-class.html#DeclareLocks,Method ganeti.cmdlib._QueryBase.DeclareLocks()=ganeti.cmdlib._QueryBase-class.html#DeclareLocks"><a title="ganeti.cmdlib.LUBackupExport.DeclareLocks
ganeti.cmdlib.LUClusterRepairDiskSizes.DeclareLocks
ganeti.cmdlib.LUClusterVerifyGroup.DeclareLocks
ganeti.cmdlib.LUGroupAssignNodes.DeclareLocks
ganeti.cmdlib.LUGroupEvacuate.DeclareLocks
ganeti.cmdlib.LUGroupQuery.DeclareLocks
ganeti.cmdlib.LUGroupVerifyDisks.DeclareLocks
ganeti.cmdlib.LUInstanceActivateDisks.DeclareLocks
ganeti.cmdlib.LUInstanceChangeGroup.DeclareLocks
ganeti.cmdlib.LUInstanceDeactivateDisks.DeclareLocks
ganeti.cmdlib.LUInstanceFailover.DeclareLocks
ganeti.cmdlib.LUInstanceGrowDisk.DeclareLocks
ganeti.cmdlib.LUInstanceMigrate.DeclareLocks
ganeti.cmdlib.LUInstanceMove.DeclareLocks
ganeti.cmdlib.LUInstanceQuery.DeclareLocks
ganeti.cmdlib.LUInstanceQueryData.DeclareLocks
ganeti.cmdlib.LUInstanceRecreateDisks.DeclareLocks
ganeti.cmdlib.LUInstanceRemove.DeclareLocks
ganeti.cmdlib.LUInstanceReplaceDisks.DeclareLocks
ganeti.cmdlib.LUInstanceSetParams.DeclareLocks
ganeti.cmdlib.LUNodeEvacuate.DeclareLocks
ganeti.cmdlib.LUNodeSetParams.DeclareLocks
ganeti.cmdlib.LUQuery.DeclareLocks
ganeti.cmdlib.LogicalUnit.DeclareLocks
ganeti.cmdlib._GroupQuery.DeclareLocks
ganeti.cmdlib._InstanceQuery.DeclareLocks
ganeti.cmdlib._NodeQuery.DeclareLocks
ganeti.cmdlib._OsQuery.DeclareLocks
ganeti.cmdlib._QueryBase.DeclareLocks" class="py-name" href="#" onclick="return doclink('link-84', 'DeclareLocks', 'link-84');">DeclareLocks</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">)</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">      <tt class="py-name">share</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">share_locks</tt><tt class="py-op">[</tt><tt class="py-name">level</tt><tt class="py-op">]</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line"> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">      <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-keyword">assert</tt> <tt class="py-name">adding_locks</tt> <tt class="py-op">^</tt> <tt class="py-name">acquiring_locks</tt><tt class="py-op">,</tt> \ </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">          <tt class="py-string">"Locks must be either added or acquired"</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line"> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">acquiring_locks</tt><tt class="py-op">:</tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">          <tt class="py-comment"># Acquiring locks</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">          <tt class="py-name">needed_locks</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">needed_locks</tt><tt class="py-op">[</tt><tt class="py-name">level</tt><tt class="py-op">]</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line"> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">          <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-85" class="py-name" targets="Method ganeti.mcpu.Processor._AcquireLocks()=ganeti.mcpu.Processor-class.html#_AcquireLocks"><a title="ganeti.mcpu.Processor._AcquireLocks" class="py-name" href="#" onclick="return doclink('link-85', '_AcquireLocks', 'link-85');">_AcquireLocks</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">,</tt> <tt class="py-name">needed_locks</tt><tt class="py-op">,</tt> <tt class="py-name">share</tt><tt class="py-op">,</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">                             <tt class="py-name">calc_timeout</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">          <tt class="py-comment"># Adding locks</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">          <tt class="py-name">add_locks</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">add_locks</tt><tt class="py-op">[</tt><tt class="py-name">level</tt><tt class="py-op">]</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">          <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">remove_locks</tt><tt class="py-op">[</tt><tt class="py-name">level</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">add_locks</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line"> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">          <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt id="link-86" class="py-name" targets="Method ganeti.locking.GanetiLockManager.add()=ganeti.locking.GanetiLockManager-class.html#add,Method ganeti.locking.LockSet.add()=ganeti.locking.LockSet-class.html#add"><a title="ganeti.locking.GanetiLockManager.add
ganeti.locking.LockSet.add" class="py-name" href="#" onclick="return doclink('link-86', 'add', 'link-86');">add</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">,</tt> <tt class="py-name">add_locks</tt><tt class="py-op">,</tt> <tt class="py-name">acquired</tt><tt class="py-op">=</tt><tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">shared</tt><tt class="py-op">=</tt><tt class="py-name">share</tt><tt class="py-op">)</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">          <tt class="py-keyword">except</tt> <tt id="link-87" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-87', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-88" class="py-name" targets="Class ganeti.errors.LockError=ganeti.errors.LockError-class.html"><a title="ganeti.errors.LockError" class="py-name" href="#" onclick="return doclink('link-88', 'LockError', 'link-88');">LockError</a></tt><tt class="py-op">:</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-89" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-89', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-90" class="py-name" targets="Class ganeti.errors.OpPrereqError=ganeti.errors.OpPrereqError-class.html"><a title="ganeti.errors.OpPrereqError" class="py-name" href="#" onclick="return doclink('link-90', 'OpPrereqError', 'link-90');">OpPrereqError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">              <tt class="py-string">"Couldn't add locks (%s), probably because of a race condition"</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">              <tt class="py-string">" with another job, who added them first"</tt> <tt class="py-op">%</tt> <tt class="py-name">add_locks</tt><tt class="py-op">,</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">              <tt id="link-91" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-91', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-92" class="py-name" targets="Variable ganeti.errors.ECODE_FAULT=ganeti.errors-module.html#ECODE_FAULT"><a title="ganeti.errors.ECODE_FAULT" class="py-name" href="#" onclick="return doclink('link-92', 'ECODE_FAULT', 'link-92');">ECODE_FAULT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line"> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">          <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-93" class="py-name" targets="Method ganeti.mcpu.Processor._LockAndExecLU()=ganeti.mcpu.Processor-class.html#_LockAndExecLU"><a title="ganeti.mcpu.Processor._LockAndExecLU" class="py-name" href="#" onclick="return doclink('link-93', '_LockAndExecLU', 'link-93');">_LockAndExecLU</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">,</tt> <tt class="py-name">level</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">calc_timeout</tt><tt class="py-op">,</tt> <tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">        <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">          <tt class="py-keyword">if</tt> <tt class="py-name">level</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">remove_locks</tt><tt class="py-op">:</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt id="link-94" class="py-name" targets="Method ganeti.locking.GanetiLockManager.remove()=ganeti.locking.GanetiLockManager-class.html#remove,Method ganeti.locking.LockSet.remove()=ganeti.locking.LockSet-class.html#remove"><a title="ganeti.locking.GanetiLockManager.remove
ganeti.locking.LockSet.remove" class="py-name" href="#" onclick="return doclink('link-94', 'remove', 'link-94');">remove</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">remove_locks</tt><tt class="py-op">[</tt><tt class="py-name">level</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">      <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt class="py-name">is_owned</tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">          <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt id="link-95" class="py-name" targets="Method ganeti.locking.GanetiLockManager.release()=ganeti.locking.GanetiLockManager-class.html#release,Method ganeti.locking.LockSet.release()=ganeti.locking.LockSet-class.html#release,Method ganeti.locking.SharedLock.release()=ganeti.locking.SharedLock-class.html#release"><a title="ganeti.locking.GanetiLockManager.release
ganeti.locking.LockSet.release
ganeti.locking.SharedLock.release" class="py-name" href="#" onclick="return doclink('link-95', 'release', 'link-95');">release</a></tt><tt class="py-op">(</tt><tt class="py-name">level</tt><tt class="py-op">)</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line"> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">      <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-96" class="py-name"><a title="ganeti.mcpu.Processor._LockAndExecLU" class="py-name" href="#" onclick="return doclink('link-96', '_LockAndExecLU', 'link-93');">_LockAndExecLU</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">,</tt> <tt class="py-name">level</tt> <tt class="py-op">+</tt> <tt class="py-number">1</tt><tt class="py-op">,</tt> <tt class="py-name">calc_timeout</tt><tt class="py-op">,</tt> <tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line"> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">result</tt> </tt>
</div><a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line"> </tt>
<a name="Processor.ExecOpCode"></a><div id="Processor.ExecOpCode-def"><a name="L334"></a><tt class="py-lineno">334</tt> <a class="py-toggle" href="#" id="Processor.ExecOpCode-toggle" onclick="return toggle('Processor.ExecOpCode');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#ExecOpCode">ExecOpCode</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">op</tt><tt class="py-op">,</tt> <tt class="py-param">cbs</tt><tt class="py-op">,</tt> <tt class="py-param">timeout</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">priority</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.ExecOpCode-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.ExecOpCode-expanded"><a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">    <tt class="py-docstring">"""Execute an opcode.</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line"><tt class="py-docstring">    @type op: an OpCode instance</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line"><tt class="py-docstring">    @param op: the opcode to be executed</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line"><tt class="py-docstring">    @type cbs: L{OpExecCbBase}</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line"><tt class="py-docstring">    @param cbs: Runtime callbacks</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line"><tt class="py-docstring">    @type timeout: float or None</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line"><tt class="py-docstring">    @param timeout: Maximum time to acquire all locks, None for no timeout</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line"><tt class="py-docstring">    @type priority: number or None</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line"><tt class="py-docstring">    @param priority: Priority for acquiring lock(s)</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line"><tt class="py-docstring">    @raise LockAcquireTimeout: In case locks couldn't be acquired in specified</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line"><tt class="py-docstring">        amount of time</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">op</tt><tt class="py-op">,</tt> <tt id="link-97" class="py-name"><a title="ganeti.opcodes" class="py-name" href="#" onclick="return doclink('link-97', 'opcodes', 'link-1');">opcodes</a></tt><tt class="py-op">.</tt><tt id="link-98" class="py-name" targets="Class ganeti.opcodes.OpCode=ganeti.opcodes.OpCode-class.html"><a title="ganeti.opcodes.OpCode" class="py-name" href="#" onclick="return doclink('link-98', 'OpCode', 'link-98');">OpCode</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-99" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-99', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-100" class="py-name" targets="Class ganeti.errors.ProgrammerError=ganeti.errors.ProgrammerError-class.html"><a title="ganeti.errors.ProgrammerError" class="py-name" href="#" onclick="return doclink('link-100', 'ProgrammerError', 'link-100');">ProgrammerError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Non-opcode instance passed"</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">                                   <tt class="py-string">" to ExecOpcode (%s)"</tt> <tt class="py-op">%</tt> <tt class="py-name">type</tt><tt class="py-op">(</tt><tt class="py-name">op</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line"> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">    <tt class="py-name">lu_class</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="ganeti.confd.server.ConfdProcessor.DISPATCH_TABLE
ganeti.mcpu.Processor.DISPATCH_TABLE" class="py-name" href="#" onclick="return doclink('link-101', 'DISPATCH_TABLE', 'link-39');">DISPATCH_TABLE</a></tt><tt class="py-op">.</tt><tt class="py-name">get</tt><tt class="py-op">(</tt><tt class="py-name">op</tt><tt class="py-op">.</tt><tt class="py-name">__class__</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">lu_class</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-102" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-102', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-103" class="py-name" targets="Class ganeti.errors.OpCodeUnknown=ganeti.errors.OpCodeUnknown-class.html"><a title="ganeti.errors.OpCodeUnknown" class="py-name" href="#" onclick="return doclink('link-103', 'OpCodeUnknown', 'link-103');">OpCodeUnknown</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unknown opcode"</tt><tt class="py-op">)</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line"> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">timeout</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">      <tt class="py-name">calc_timeout</tt> <tt class="py-op">=</tt> <tt class="py-keyword">lambda</tt><tt class="py-op">:</tt> <tt class="py-name">None</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">      <tt class="py-name">calc_timeout</tt> <tt class="py-op">=</tt> <tt id="link-104" class="py-name"><a title="ganeti.utils" class="py-name" href="#" onclick="return doclink('link-104', 'utils', 'link-13');">utils</a></tt><tt class="py-op">.</tt><tt id="link-105" class="py-name" targets="Class ganeti.utils.algo.RunningTimeout=ganeti.utils.algo.RunningTimeout-class.html"><a title="ganeti.utils.algo.RunningTimeout" class="py-name" href="#" onclick="return doclink('link-105', 'RunningTimeout', 'link-105');">RunningTimeout</a></tt><tt class="py-op">(</tt><tt class="py-name">timeout</tt><tt class="py-op">,</tt> <tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-106" class="py-name" targets="Method ganeti.utils.algo.RunningTimeout.Remaining()=ganeti.utils.algo.RunningTimeout-class.html#Remaining"><a title="ganeti.utils.algo.RunningTimeout.Remaining" class="py-name" href="#" onclick="return doclink('link-106', 'Remaining', 'link-106');">Remaining</a></tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line"> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt> <tt class="py-op">=</tt> <tt class="py-name">cbs</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">      <tt class="py-comment"># Acquire the Big Ganeti Lock exclusively if this LU requires it,</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">      <tt class="py-comment"># and in a shared fashion otherwise (to prevent concurrent run with</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">      <tt class="py-comment"># an exclusive LU.</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name"><a title="ganeti.mcpu.Processor._AcquireLocks" class="py-name" href="#" onclick="return doclink('link-107', '_AcquireLocks', 'link-85');">_AcquireLocks</a></tt><tt class="py-op">(</tt><tt id="link-108" class="py-name"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-108', 'locking', 'link-11');">locking</a></tt><tt class="py-op">.</tt><tt id="link-109" class="py-name" targets="Variable ganeti.locking.LEVEL_CLUSTER=ganeti.locking-module.html#LEVEL_CLUSTER"><a title="ganeti.locking.LEVEL_CLUSTER" class="py-name" href="#" onclick="return doclink('link-109', 'LEVEL_CLUSTER', 'link-109');">LEVEL_CLUSTER</a></tt><tt class="py-op">,</tt> <tt id="link-110" class="py-name"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-110', 'locking', 'link-11');">locking</a></tt><tt class="py-op">.</tt><tt id="link-111" class="py-name" targets="Variable ganeti.locking.BGL=ganeti.locking-module.html#BGL"><a title="ganeti.locking.BGL" class="py-name" href="#" onclick="return doclink('link-111', 'BGL', 'link-111');">BGL</a></tt><tt class="py-op">,</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">                          <tt class="py-keyword">not</tt> <tt class="py-name">lu_class</tt><tt class="py-op">.</tt><tt id="link-112" class="py-name" targets="Variable ganeti.cmdlib.LUBackupExport.REQ_BGL=ganeti.cmdlib.LUBackupExport-class.html#REQ_BGL,Variable ganeti.cmdlib.LUBackupPrepare.REQ_BGL=ganeti.cmdlib.LUBackupPrepare-class.html#REQ_BGL,Variable ganeti.cmdlib.LUBackupQuery.REQ_BGL=ganeti.cmdlib.LUBackupQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUBackupRemove.REQ_BGL=ganeti.cmdlib.LUBackupRemove-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterConfigQuery.REQ_BGL=ganeti.cmdlib.LUClusterConfigQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterQuery.REQ_BGL=ganeti.cmdlib.LUClusterQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterRedistConf.REQ_BGL=ganeti.cmdlib.LUClusterRedistConf-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterRepairDiskSizes.REQ_BGL=ganeti.cmdlib.LUClusterRepairDiskSizes-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterSetParams.REQ_BGL=ganeti.cmdlib.LUClusterSetParams-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterVerify.REQ_BGL=ganeti.cmdlib.LUClusterVerify-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterVerifyConfig.REQ_BGL=ganeti.cmdlib.LUClusterVerifyConfig-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterVerifyDisks.REQ_BGL=ganeti.cmdlib.LUClusterVerifyDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUClusterVerifyGroup.REQ_BGL=ganeti.cmdlib.LUClusterVerifyGroup-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupAdd.REQ_BGL=ganeti.cmdlib.LUGroupAdd-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupAssignNodes.REQ_BGL=ganeti.cmdlib.LUGroupAssignNodes-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupEvacuate.REQ_BGL=ganeti.cmdlib.LUGroupEvacuate-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupQuery.REQ_BGL=ganeti.cmdlib.LUGroupQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupRemove.REQ_BGL=ganeti.cmdlib.LUGroupRemove-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupRename.REQ_BGL=ganeti.cmdlib.LUGroupRename-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupSetParams.REQ_BGL=ganeti.cmdlib.LUGroupSetParams-class.html#REQ_BGL,Variable ganeti.cmdlib.LUGroupVerifyDisks.REQ_BGL=ganeti.cmdlib.LUGroupVerifyDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceActivateDisks.REQ_BGL=ganeti.cmdlib.LUInstanceActivateDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceChangeGroup.REQ_BGL=ganeti.cmdlib.LUInstanceChangeGroup-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceConsole.REQ_BGL=ganeti.cmdlib.LUInstanceConsole-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceCreate.REQ_BGL=ganeti.cmdlib.LUInstanceCreate-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceDeactivateDisks.REQ_BGL=ganeti.cmdlib.LUInstanceDeactivateDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceFailover.REQ_BGL=ganeti.cmdlib.LUInstanceFailover-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceGrowDisk.REQ_BGL=ganeti.cmdlib.LUInstanceGrowDisk-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceMigrate.REQ_BGL=ganeti.cmdlib.LUInstanceMigrate-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceMove.REQ_BGL=ganeti.cmdlib.LUInstanceMove-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceQuery.REQ_BGL=ganeti.cmdlib.LUInstanceQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceQueryData.REQ_BGL=ganeti.cmdlib.LUInstanceQueryData-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceReboot.REQ_BGL=ganeti.cmdlib.LUInstanceReboot-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceRecreateDisks.REQ_BGL=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceReinstall.REQ_BGL=ganeti.cmdlib.LUInstanceReinstall-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceRemove.REQ_BGL=ganeti.cmdlib.LUInstanceRemove-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceReplaceDisks.REQ_BGL=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceSetParams.REQ_BGL=ganeti.cmdlib.LUInstanceSetParams-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceShutdown.REQ_BGL=ganeti.cmdlib.LUInstanceShutdown-class.html#REQ_BGL,Variable ganeti.cmdlib.LUInstanceStartup.REQ_BGL=ganeti.cmdlib.LUInstanceStartup-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeEvacuate.REQ_BGL=ganeti.cmdlib.LUNodeEvacuate-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeMigrate.REQ_BGL=ganeti.cmdlib.LUNodeMigrate-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeModifyStorage.REQ_BGL=ganeti.cmdlib.LUNodeModifyStorage-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodePowercycle.REQ_BGL=ganeti.cmdlib.LUNodePowercycle-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeQuery.REQ_BGL=ganeti.cmdlib.LUNodeQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeQueryStorage.REQ_BGL=ganeti.cmdlib.LUNodeQueryStorage-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeQueryvols.REQ_BGL=ganeti.cmdlib.LUNodeQueryvols-class.html#REQ_BGL,Variable ganeti.cmdlib.LUNodeSetParams.REQ_BGL=ganeti.cmdlib.LUNodeSetParams-class.html#REQ_BGL,Variable ganeti.cmdlib.LUOobCommand.REQ_BGL=ganeti.cmdlib.LUOobCommand-class.html#REQ_BGL,Variable ganeti.cmdlib.LUOsDiagnose.REQ_BGL=ganeti.cmdlib.LUOsDiagnose-class.html#REQ_BGL,Variable ganeti.cmdlib.LUQuery.REQ_BGL=ganeti.cmdlib.LUQuery-class.html#REQ_BGL,Variable ganeti.cmdlib.LUQueryFields.REQ_BGL=ganeti.cmdlib.LUQueryFields-class.html#REQ_BGL,Variable ganeti.cmdlib.LURepairNodeStorage.REQ_BGL=ganeti.cmdlib.LURepairNodeStorage-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTagsDel.REQ_BGL=ganeti.cmdlib.LUTagsDel-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTagsGet.REQ_BGL=ganeti.cmdlib.LUTagsGet-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTagsSearch.REQ_BGL=ganeti.cmdlib.LUTagsSearch-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTagsSet.REQ_BGL=ganeti.cmdlib.LUTagsSet-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTestDelay.REQ_BGL=ganeti.cmdlib.LUTestDelay-class.html#REQ_BGL,Variable ganeti.cmdlib.LUTestJqueue.REQ_BGL=ganeti.cmdlib.LUTestJqueue-class.html#REQ_BGL,Variable ganeti.cmdlib.LogicalUnit.REQ_BGL=ganeti.cmdlib.LogicalUnit-class.html#REQ_BGL"><a title="ganeti.cmdlib.LUBackupExport.REQ_BGL
ganeti.cmdlib.LUBackupPrepare.REQ_BGL
ganeti.cmdlib.LUBackupQuery.REQ_BGL
ganeti.cmdlib.LUBackupRemove.REQ_BGL
ganeti.cmdlib.LUClusterConfigQuery.REQ_BGL
ganeti.cmdlib.LUClusterQuery.REQ_BGL
ganeti.cmdlib.LUClusterRedistConf.REQ_BGL
ganeti.cmdlib.LUClusterRepairDiskSizes.REQ_BGL
ganeti.cmdlib.LUClusterSetParams.REQ_BGL
ganeti.cmdlib.LUClusterVerify.REQ_BGL
ganeti.cmdlib.LUClusterVerifyConfig.REQ_BGL
ganeti.cmdlib.LUClusterVerifyDisks.REQ_BGL
ganeti.cmdlib.LUClusterVerifyGroup.REQ_BGL
ganeti.cmdlib.LUGroupAdd.REQ_BGL
ganeti.cmdlib.LUGroupAssignNodes.REQ_BGL
ganeti.cmdlib.LUGroupEvacuate.REQ_BGL
ganeti.cmdlib.LUGroupQuery.REQ_BGL
ganeti.cmdlib.LUGroupRemove.REQ_BGL
ganeti.cmdlib.LUGroupRename.REQ_BGL
ganeti.cmdlib.LUGroupSetParams.REQ_BGL
ganeti.cmdlib.LUGroupVerifyDisks.REQ_BGL
ganeti.cmdlib.LUInstanceActivateDisks.REQ_BGL
ganeti.cmdlib.LUInstanceChangeGroup.REQ_BGL
ganeti.cmdlib.LUInstanceConsole.REQ_BGL
ganeti.cmdlib.LUInstanceCreate.REQ_BGL
ganeti.cmdlib.LUInstanceDeactivateDisks.REQ_BGL
ganeti.cmdlib.LUInstanceFailover.REQ_BGL
ganeti.cmdlib.LUInstanceGrowDisk.REQ_BGL
ganeti.cmdlib.LUInstanceMigrate.REQ_BGL
ganeti.cmdlib.LUInstanceMove.REQ_BGL
ganeti.cmdlib.LUInstanceQuery.REQ_BGL
ganeti.cmdlib.LUInstanceQueryData.REQ_BGL
ganeti.cmdlib.LUInstanceReboot.REQ_BGL
ganeti.cmdlib.LUInstanceRecreateDisks.REQ_BGL
ganeti.cmdlib.LUInstanceReinstall.REQ_BGL
ganeti.cmdlib.LUInstanceRemove.REQ_BGL
ganeti.cmdlib.LUInstanceReplaceDisks.REQ_BGL
ganeti.cmdlib.LUInstanceSetParams.REQ_BGL
ganeti.cmdlib.LUInstanceShutdown.REQ_BGL
ganeti.cmdlib.LUInstanceStartup.REQ_BGL
ganeti.cmdlib.LUNodeEvacuate.REQ_BGL
ganeti.cmdlib.LUNodeMigrate.REQ_BGL
ganeti.cmdlib.LUNodeModifyStorage.REQ_BGL
ganeti.cmdlib.LUNodePowercycle.REQ_BGL
ganeti.cmdlib.LUNodeQuery.REQ_BGL
ganeti.cmdlib.LUNodeQueryStorage.REQ_BGL
ganeti.cmdlib.LUNodeQueryvols.REQ_BGL
ganeti.cmdlib.LUNodeSetParams.REQ_BGL
ganeti.cmdlib.LUOobCommand.REQ_BGL
ganeti.cmdlib.LUOsDiagnose.REQ_BGL
ganeti.cmdlib.LUQuery.REQ_BGL
ganeti.cmdlib.LUQueryFields.REQ_BGL
ganeti.cmdlib.LURepairNodeStorage.REQ_BGL
ganeti.cmdlib.LUTagsDel.REQ_BGL
ganeti.cmdlib.LUTagsGet.REQ_BGL
ganeti.cmdlib.LUTagsSearch.REQ_BGL
ganeti.cmdlib.LUTagsSet.REQ_BGL
ganeti.cmdlib.LUTestDelay.REQ_BGL
ganeti.cmdlib.LUTestJqueue.REQ_BGL
ganeti.cmdlib.LogicalUnit.REQ_BGL" class="py-name" href="#" onclick="return doclink('link-112', 'REQ_BGL', 'link-112');">REQ_BGL</a></tt><tt class="py-op">,</tt> <tt class="py-name">calc_timeout</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">                          <tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">      <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">        <tt class="py-name">lu</tt> <tt class="py-op">=</tt> <tt class="py-name">lu_class</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">,</tt> <tt class="py-name">op</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-113" class="py-name"><a title="ganeti.rpc" class="py-name" href="#" onclick="return doclink('link-113', 'rpc', 'link-7');">rpc</a></tt><tt class="py-op">)</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">        <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-114" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.ExpandNames()=ganeti.cmdlib.LUBackupExport-class.html#ExpandNames,Method ganeti.cmdlib.LUBackupPrepare.ExpandNames()=ganeti.cmdlib.LUBackupPrepare-class.html#ExpandNames,Method ganeti.cmdlib.LUBackupQuery.ExpandNames()=ganeti.cmdlib.LUBackupQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUBackupRemove.ExpandNames()=ganeti.cmdlib.LUBackupRemove-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterConfigQuery.ExpandNames()=ganeti.cmdlib.LUClusterConfigQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterQuery.ExpandNames()=ganeti.cmdlib.LUClusterQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterRedistConf.ExpandNames()=ganeti.cmdlib.LUClusterRedistConf-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterRepairDiskSizes.ExpandNames()=ganeti.cmdlib.LUClusterRepairDiskSizes-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterSetParams.ExpandNames()=ganeti.cmdlib.LUClusterSetParams-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterVerify.ExpandNames()=ganeti.cmdlib.LUClusterVerify-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterVerifyConfig.ExpandNames()=ganeti.cmdlib.LUClusterVerifyConfig-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterVerifyDisks.ExpandNames()=ganeti.cmdlib.LUClusterVerifyDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUClusterVerifyGroup.ExpandNames()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupAdd.ExpandNames()=ganeti.cmdlib.LUGroupAdd-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupAssignNodes.ExpandNames()=ganeti.cmdlib.LUGroupAssignNodes-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupEvacuate.ExpandNames()=ganeti.cmdlib.LUGroupEvacuate-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupQuery.ExpandNames()=ganeti.cmdlib.LUGroupQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupRemove.ExpandNames()=ganeti.cmdlib.LUGroupRemove-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupRename.ExpandNames()=ganeti.cmdlib.LUGroupRename-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupSetParams.ExpandNames()=ganeti.cmdlib.LUGroupSetParams-class.html#ExpandNames,Method ganeti.cmdlib.LUGroupVerifyDisks.ExpandNames()=ganeti.cmdlib.LUGroupVerifyDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceActivateDisks.ExpandNames()=ganeti.cmdlib.LUInstanceActivateDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceChangeGroup.ExpandNames()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceConsole.ExpandNames()=ganeti.cmdlib.LUInstanceConsole-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceCreate.ExpandNames()=ganeti.cmdlib.LUInstanceCreate-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceDeactivateDisks.ExpandNames()=ganeti.cmdlib.LUInstanceDeactivateDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceFailover.ExpandNames()=ganeti.cmdlib.LUInstanceFailover-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceGrowDisk.ExpandNames()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceMigrate.ExpandNames()=ganeti.cmdlib.LUInstanceMigrate-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceMove.ExpandNames()=ganeti.cmdlib.LUInstanceMove-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceQuery.ExpandNames()=ganeti.cmdlib.LUInstanceQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceQueryData.ExpandNames()=ganeti.cmdlib.LUInstanceQueryData-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceReboot.ExpandNames()=ganeti.cmdlib.LUInstanceReboot-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceRecreateDisks.ExpandNames()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceReinstall.ExpandNames()=ganeti.cmdlib.LUInstanceReinstall-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceRemove.ExpandNames()=ganeti.cmdlib.LUInstanceRemove-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceReplaceDisks.ExpandNames()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceSetParams.ExpandNames()=ganeti.cmdlib.LUInstanceSetParams-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceShutdown.ExpandNames()=ganeti.cmdlib.LUInstanceShutdown-class.html#ExpandNames,Method ganeti.cmdlib.LUInstanceStartup.ExpandNames()=ganeti.cmdlib.LUInstanceStartup-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeEvacuate.ExpandNames()=ganeti.cmdlib.LUNodeEvacuate-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeMigrate.ExpandNames()=ganeti.cmdlib.LUNodeMigrate-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeModifyStorage.ExpandNames()=ganeti.cmdlib.LUNodeModifyStorage-class.html#ExpandNames,Method ganeti.cmdlib.LUNodePowercycle.ExpandNames()=ganeti.cmdlib.LUNodePowercycle-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeQuery.ExpandNames()=ganeti.cmdlib.LUNodeQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeQueryStorage.ExpandNames()=ganeti.cmdlib.LUNodeQueryStorage-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeQueryvols.ExpandNames()=ganeti.cmdlib.LUNodeQueryvols-class.html#ExpandNames,Method ganeti.cmdlib.LUNodeSetParams.ExpandNames()=ganeti.cmdlib.LUNodeSetParams-class.html#ExpandNames,Method ganeti.cmdlib.LUOobCommand.ExpandNames()=ganeti.cmdlib.LUOobCommand-class.html#ExpandNames,Method ganeti.cmdlib.LUOsDiagnose.ExpandNames()=ganeti.cmdlib.LUOsDiagnose-class.html#ExpandNames,Method ganeti.cmdlib.LUQuery.ExpandNames()=ganeti.cmdlib.LUQuery-class.html#ExpandNames,Method ganeti.cmdlib.LUQueryFields.ExpandNames()=ganeti.cmdlib.LUQueryFields-class.html#ExpandNames,Method ganeti.cmdlib.LURepairNodeStorage.ExpandNames()=ganeti.cmdlib.LURepairNodeStorage-class.html#ExpandNames,Method ganeti.cmdlib.LUTagsGet.ExpandNames()=ganeti.cmdlib.LUTagsGet-class.html#ExpandNames,Method ganeti.cmdlib.LUTagsSearch.ExpandNames()=ganeti.cmdlib.LUTagsSearch-class.html#ExpandNames,Method ganeti.cmdlib.LUTestDelay.ExpandNames()=ganeti.cmdlib.LUTestDelay-class.html#ExpandNames,Method ganeti.cmdlib.LUTestJqueue.ExpandNames()=ganeti.cmdlib.LUTestJqueue-class.html#ExpandNames,Method ganeti.cmdlib.LogicalUnit.ExpandNames()=ganeti.cmdlib.LogicalUnit-class.html#ExpandNames,Method ganeti.cmdlib.TagsLU.ExpandNames()=ganeti.cmdlib.TagsLU-class.html#ExpandNames,Method ganeti.cmdlib._GroupQuery.ExpandNames()=ganeti.cmdlib._GroupQuery-class.html#ExpandNames,Method ganeti.cmdlib._InstanceQuery.ExpandNames()=ganeti.cmdlib._InstanceQuery-class.html#ExpandNames,Method ganeti.cmdlib._NodeQuery.ExpandNames()=ganeti.cmdlib._NodeQuery-class.html#ExpandNames,Method ganeti.cmdlib._OsQuery.ExpandNames()=ganeti.cmdlib._OsQuery-class.html#ExpandNames,Method ganeti.cmdlib._QueryBase.ExpandNames()=ganeti.cmdlib._QueryBase-class.html#ExpandNames"><a title="ganeti.cmdlib.LUBackupExport.ExpandNames
ganeti.cmdlib.LUBackupPrepare.ExpandNames
ganeti.cmdlib.LUBackupQuery.ExpandNames
ganeti.cmdlib.LUBackupRemove.ExpandNames
ganeti.cmdlib.LUClusterConfigQuery.ExpandNames
ganeti.cmdlib.LUClusterQuery.ExpandNames
ganeti.cmdlib.LUClusterRedistConf.ExpandNames
ganeti.cmdlib.LUClusterRepairDiskSizes.ExpandNames
ganeti.cmdlib.LUClusterSetParams.ExpandNames
ganeti.cmdlib.LUClusterVerify.ExpandNames
ganeti.cmdlib.LUClusterVerifyConfig.ExpandNames
ganeti.cmdlib.LUClusterVerifyDisks.ExpandNames
ganeti.cmdlib.LUClusterVerifyGroup.ExpandNames
ganeti.cmdlib.LUGroupAdd.ExpandNames
ganeti.cmdlib.LUGroupAssignNodes.ExpandNames
ganeti.cmdlib.LUGroupEvacuate.ExpandNames
ganeti.cmdlib.LUGroupQuery.ExpandNames
ganeti.cmdlib.LUGroupRemove.ExpandNames
ganeti.cmdlib.LUGroupRename.ExpandNames
ganeti.cmdlib.LUGroupSetParams.ExpandNames
ganeti.cmdlib.LUGroupVerifyDisks.ExpandNames
ganeti.cmdlib.LUInstanceActivateDisks.ExpandNames
ganeti.cmdlib.LUInstanceChangeGroup.ExpandNames
ganeti.cmdlib.LUInstanceConsole.ExpandNames
ganeti.cmdlib.LUInstanceCreate.ExpandNames
ganeti.cmdlib.LUInstanceDeactivateDisks.ExpandNames
ganeti.cmdlib.LUInstanceFailover.ExpandNames
ganeti.cmdlib.LUInstanceGrowDisk.ExpandNames
ganeti.cmdlib.LUInstanceMigrate.ExpandNames
ganeti.cmdlib.LUInstanceMove.ExpandNames
ganeti.cmdlib.LUInstanceQuery.ExpandNames
ganeti.cmdlib.LUInstanceQueryData.ExpandNames
ganeti.cmdlib.LUInstanceReboot.ExpandNames
ganeti.cmdlib.LUInstanceRecreateDisks.ExpandNames
ganeti.cmdlib.LUInstanceReinstall.ExpandNames
ganeti.cmdlib.LUInstanceRemove.ExpandNames
ganeti.cmdlib.LUInstanceReplaceDisks.ExpandNames
ganeti.cmdlib.LUInstanceSetParams.ExpandNames
ganeti.cmdlib.LUInstanceShutdown.ExpandNames
ganeti.cmdlib.LUInstanceStartup.ExpandNames
ganeti.cmdlib.LUNodeEvacuate.ExpandNames
ganeti.cmdlib.LUNodeMigrate.ExpandNames
ganeti.cmdlib.LUNodeModifyStorage.ExpandNames
ganeti.cmdlib.LUNodePowercycle.ExpandNames
ganeti.cmdlib.LUNodeQuery.ExpandNames
ganeti.cmdlib.LUNodeQueryStorage.ExpandNames
ganeti.cmdlib.LUNodeQueryvols.ExpandNames
ganeti.cmdlib.LUNodeSetParams.ExpandNames
ganeti.cmdlib.LUOobCommand.ExpandNames
ganeti.cmdlib.LUOsDiagnose.ExpandNames
ganeti.cmdlib.LUQuery.ExpandNames
ganeti.cmdlib.LUQueryFields.ExpandNames
ganeti.cmdlib.LURepairNodeStorage.ExpandNames
ganeti.cmdlib.LUTagsGet.ExpandNames
ganeti.cmdlib.LUTagsSearch.ExpandNames
ganeti.cmdlib.LUTestDelay.ExpandNames
ganeti.cmdlib.LUTestJqueue.ExpandNames
ganeti.cmdlib.LogicalUnit.ExpandNames
ganeti.cmdlib.TagsLU.ExpandNames
ganeti.cmdlib._GroupQuery.ExpandNames
ganeti.cmdlib._InstanceQuery.ExpandNames
ganeti.cmdlib._NodeQuery.ExpandNames
ganeti.cmdlib._OsQuery.ExpandNames
ganeti.cmdlib._QueryBase.ExpandNames" class="py-name" href="#" onclick="return doclink('link-114', 'ExpandNames', 'link-114');">ExpandNames</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">        <tt class="py-keyword">assert</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">needed_locks</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-string">"needed_locks not set by LU"</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line"> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">          <tt class="py-name">result</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-115" class="py-name"><a title="ganeti.mcpu.Processor._LockAndExecLU" class="py-name" href="#" onclick="return doclink('link-115', '_LockAndExecLU', 'link-93');">_LockAndExecLU</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">,</tt> <tt id="link-116" class="py-name"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-116', 'locking', 'link-11');">locking</a></tt><tt class="py-op">.</tt><tt id="link-117" class="py-name" targets="Variable ganeti.locking.LEVEL_INSTANCE=ganeti.locking-module.html#LEVEL_INSTANCE"><a title="ganeti.locking.LEVEL_INSTANCE" class="py-name" href="#" onclick="return doclink('link-117', 'LEVEL_INSTANCE', 'link-117');">LEVEL_INSTANCE</a></tt><tt class="py-op">,</tt> <tt class="py-name">calc_timeout</tt><tt class="py-op">,</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">                                       <tt class="py-name">priority</tt><tt class="py-op">)</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">        <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">          <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_ec_id</tt><tt class="py-op">:</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-118" class="py-name" targets="Method ganeti.config.ConfigWriter.DropECReservations()=ganeti.config.ConfigWriter-class.html#DropECReservations,Method ganeti.config.TemporaryReservationManager.DropECReservations()=ganeti.config.TemporaryReservationManager-class.html#DropECReservations"><a title="ganeti.config.ConfigWriter.DropECReservations
ganeti.config.TemporaryReservationManager.DropECReservations" class="py-name" href="#" onclick="return doclink('link-118', 'DropECReservations', 'link-118');">DropECReservations</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_ec_id</tt><tt class="py-op">)</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">      <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">context</tt><tt class="py-op">.</tt><tt class="py-name">glm</tt><tt class="py-op">.</tt><tt id="link-119" class="py-name"><a title="ganeti.locking.GanetiLockManager.release
ganeti.locking.LockSet.release
ganeti.locking.SharedLock.release" class="py-name" href="#" onclick="return doclink('link-119', 'release', 'link-95');">release</a></tt><tt class="py-op">(</tt><tt id="link-120" class="py-name"><a title="ganeti.locking" class="py-name" href="#" onclick="return doclink('link-120', 'locking', 'link-11');">locking</a></tt><tt class="py-op">.</tt><tt id="link-121" class="py-name"><a title="ganeti.locking.LEVEL_CLUSTER" class="py-name" href="#" onclick="return doclink('link-121', 'LEVEL_CLUSTER', 'link-109');">LEVEL_CLUSTER</a></tt><tt class="py-op">)</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">    <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line"> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">    <tt class="py-name">resultcheck_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">op</tt><tt class="py-op">.</tt><tt id="link-122" class="py-name" targets="Variable ganeti.opcodes.OpClusterVerify.OP_RESULT=ganeti.opcodes.OpClusterVerify-class.html#OP_RESULT,Variable ganeti.opcodes.OpClusterVerifyDisks.OP_RESULT=ganeti.opcodes.OpClusterVerifyDisks-class.html#OP_RESULT,Variable ganeti.opcodes.OpCode.OP_RESULT=ganeti.opcodes.OpCode-class.html#OP_RESULT,Variable ganeti.opcodes.OpGroupEvacuate.OP_RESULT=ganeti.opcodes.OpGroupEvacuate-class.html#OP_RESULT,Variable ganeti.opcodes.OpGroupRename.OP_RESULT=ganeti.opcodes.OpGroupRename-class.html#OP_RESULT,Variable ganeti.opcodes.OpGroupSetParams.OP_RESULT=ganeti.opcodes.OpGroupSetParams-class.html#OP_RESULT,Variable ganeti.opcodes.OpGroupVerifyDisks.OP_RESULT=ganeti.opcodes.OpGroupVerifyDisks-class.html#OP_RESULT,Variable ganeti.opcodes.OpInstanceChangeGroup.OP_RESULT=ganeti.opcodes.OpInstanceChangeGroup-class.html#OP_RESULT,Variable ganeti.opcodes.OpInstanceCreate.OP_RESULT=ganeti.opcodes.OpInstanceCreate-class.html#OP_RESULT,Variable ganeti.opcodes.OpInstanceRename.OP_RESULT=ganeti.opcodes.OpInstanceRename-class.html#OP_RESULT,Variable ganeti.opcodes.OpInstanceSetParams.OP_RESULT=ganeti.opcodes.OpInstanceSetParams-class.html#OP_RESULT,Variable ganeti.opcodes.OpNodeEvacuate.OP_RESULT=ganeti.opcodes.OpNodeEvacuate-class.html#OP_RESULT,Variable ganeti.opcodes.OpNodeMigrate.OP_RESULT=ganeti.opcodes.OpNodeMigrate-class.html#OP_RESULT,Variable ganeti.opcodes.OpNodeSetParams.OP_RESULT=ganeti.opcodes.OpNodeSetParams-class.html#OP_RESULT"><a title="ganeti.opcodes.OpClusterVerify.OP_RESULT
ganeti.opcodes.OpClusterVerifyDisks.OP_RESULT
ganeti.opcodes.OpCode.OP_RESULT
ganeti.opcodes.OpGroupEvacuate.OP_RESULT
ganeti.opcodes.OpGroupRename.OP_RESULT
ganeti.opcodes.OpGroupSetParams.OP_RESULT
ganeti.opcodes.OpGroupVerifyDisks.OP_RESULT
ganeti.opcodes.OpInstanceChangeGroup.OP_RESULT
ganeti.opcodes.OpInstanceCreate.OP_RESULT
ganeti.opcodes.OpInstanceRename.OP_RESULT
ganeti.opcodes.OpInstanceSetParams.OP_RESULT
ganeti.opcodes.OpNodeEvacuate.OP_RESULT
ganeti.opcodes.OpNodeMigrate.OP_RESULT
ganeti.opcodes.OpNodeSetParams.OP_RESULT" class="py-name" href="#" onclick="return doclink('link-122', 'OP_RESULT', 'link-122');">OP_RESULT</a></tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-op">(</tt><tt class="py-name">resultcheck_fn</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt> <tt class="py-keyword">or</tt> <tt class="py-name">resultcheck_fn</tt><tt class="py-op">(</tt><tt class="py-name">result</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">      <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Expected opcode result matching %s, got %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">                    <tt class="py-name">resultcheck_fn</tt><tt class="py-op">,</tt> <tt class="py-name">result</tt><tt class="py-op">)</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-123" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-123', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-124" class="py-name" targets="Class ganeti.errors.OpResultError=ganeti.errors.OpResultError-class.html"><a title="ganeti.errors.OpResultError" class="py-name" href="#" onclick="return doclink('link-124', 'OpResultError', 'link-124');">OpResultError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Opcode result does not match %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">                                 <tt class="py-name">resultcheck_fn</tt><tt class="py-op">)</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line"> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">result</tt> </tt>
</div><a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line"> </tt>
<a name="Processor.Log"></a><div id="Processor.Log-def"><a name="L395"></a><tt class="py-lineno">395</tt> <a class="py-toggle" href="#" id="Processor.Log-toggle" onclick="return toggle('Processor.Log');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#Log">Log</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.Log-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.Log-expanded"><a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">    <tt class="py-docstring">"""Forward call to feedback callback function.</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">:</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_cbs</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name" targets="Method ganeti.jqueue._OpExecCallbacks.Feedback()=ganeti.jqueue._OpExecCallbacks-class.html#Feedback,Method ganeti.mcpu.OpExecCbBase.Feedback()=ganeti.mcpu.OpExecCbBase-class.html#Feedback,Method script-burnin.Burner.Feedback()=script-burnin.Burner-class.html#Feedback"><a title="ganeti.jqueue._OpExecCallbacks.Feedback
ganeti.mcpu.OpExecCbBase.Feedback
script-burnin.Burner.Feedback" class="py-name" href="#" onclick="return doclink('link-125', 'Feedback', 'link-125');">Feedback</a></tt><tt class="py-op">(</tt><tt class="py-op">*</tt><tt id="link-126" class="py-name" targets="Variable script-cfgupgrade.args=script-cfgupgrade-module.html#args,Variable script-cfgupgrade12.args=script-cfgupgrade12-module.html#args"><a title="script-cfgupgrade.args
script-cfgupgrade12.args" class="py-name" href="#" onclick="return doclink('link-126', 'args', 'link-126');">args</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line"> </tt>
<a name="Processor.LogStep"></a><div id="Processor.LogStep-def"><a name="L402"></a><tt class="py-lineno">402</tt> <a class="py-toggle" href="#" id="Processor.LogStep-toggle" onclick="return toggle('Processor.LogStep');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#LogStep">LogStep</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">current</tt><tt class="py-op">,</tt> <tt class="py-param">total</tt><tt class="py-op">,</tt> <tt class="py-param">message</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.LogStep-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.LogStep-expanded"><a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">    <tt class="py-docstring">"""Log a change in LU execution progress.</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line">    <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">debug</tt><tt class="py-op">(</tt><tt class="py-string">"Step %d/%d %s"</tt><tt class="py-op">,</tt> <tt class="py-name">current</tt><tt class="py-op">,</tt> <tt class="py-name">total</tt><tt class="py-op">,</tt> <tt id="link-127" class="py-name" targets="Variable ganeti.http.HttpException.message=ganeti.http.HttpException-class.html#message"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-127', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-128" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-128', 'Log', 'link-67');">Log</a></tt><tt class="py-op">(</tt><tt class="py-string">"STEP %d/%d %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">current</tt><tt class="py-op">,</tt> <tt class="py-name">total</tt><tt class="py-op">,</tt> <tt id="link-129" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-129', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line"> </tt>
<a name="Processor.LogWarning"></a><div id="Processor.LogWarning-def"><a name="L409"></a><tt class="py-lineno">409</tt> <a class="py-toggle" href="#" id="Processor.LogWarning-toggle" onclick="return toggle('Processor.LogWarning');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#LogWarning">LogWarning</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">message</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-param">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.LogWarning-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.LogWarning-expanded"><a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line">    <tt class="py-docstring">"""Log a warning to the logs and the user.</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line"><tt class="py-docstring">    The optional keyword argument is 'hint' and can be used to show a</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line"><tt class="py-docstring">    hint to the user (presumably related to the warning). If the</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line"><tt class="py-docstring">    message is empty, it will not be printed at all, allowing one to</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line"><tt class="py-docstring">    show only a hint.</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">    <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt class="py-name">kwargs</tt> <tt class="py-keyword">or</tt> <tt class="py-op">(</tt><tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-string">"hint"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> \ </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">           <tt class="py-string">"Invalid keyword arguments for LogWarning (%s)"</tt> <tt class="py-op">%</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-130" class="py-name"><a title="script-cfgupgrade.args
script-cfgupgrade12.args" class="py-name" href="#" onclick="return doclink('link-130', 'args', 'link-126');">args</a></tt><tt class="py-op">:</tt> </tt>
<a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">      <tt id="link-131" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-131', 'message', 'link-127');">message</a></tt> <tt class="py-op">=</tt> <tt id="link-132" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-132', 'message', 'link-127');">message</a></tt> <tt class="py-op">%</tt> <tt class="py-name">tuple</tt><tt class="py-op">(</tt><tt id="link-133" class="py-name"><a title="script-cfgupgrade.args
script-cfgupgrade12.args" class="py-name" href="#" onclick="return doclink('link-133', 'args', 'link-126');">args</a></tt><tt class="py-op">)</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-134" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-134', 'message', 'link-127');">message</a></tt><tt class="py-op">:</tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line">      <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt id="link-135" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-135', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-136', 'Log', 'link-67');">Log</a></tt><tt class="py-op">(</tt><tt class="py-string">" - WARNING: %s"</tt> <tt class="py-op">%</tt> <tt id="link-137" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-137', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-string">"hint"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">kwargs</tt><tt class="py-op">:</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line">      <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-138" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-138', 'Log', 'link-67');">Log</a></tt><tt class="py-op">(</tt><tt class="py-string">"      Hint: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">kwargs</tt><tt class="py-op">[</tt><tt class="py-string">"hint"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
</div><a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line"> </tt>
<a name="Processor.LogInfo"></a><div id="Processor.LogInfo-def"><a name="L428"></a><tt class="py-lineno">428</tt> <a class="py-toggle" href="#" id="Processor.LogInfo-toggle" onclick="return toggle('Processor.LogInfo');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#LogInfo">LogInfo</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">message</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.LogInfo-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.LogInfo-expanded"><a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line">    <tt class="py-docstring">"""Log an informational message to the logs and the user.</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-139" class="py-name"><a title="script-cfgupgrade.args
script-cfgupgrade12.args" class="py-name" href="#" onclick="return doclink('link-139', 'args', 'link-126');">args</a></tt><tt class="py-op">:</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">      <tt id="link-140" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-140', 'message', 'link-127');">message</a></tt> <tt class="py-op">=</tt> <tt id="link-141" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-141', 'message', 'link-127');">message</a></tt> <tt class="py-op">%</tt> <tt class="py-name">tuple</tt><tt class="py-op">(</tt><tt id="link-142" class="py-name"><a title="script-cfgupgrade.args
script-cfgupgrade12.args" class="py-name" href="#" onclick="return doclink('link-142', 'args', 'link-126');">args</a></tt><tt class="py-op">)</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">    <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt id="link-143" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-143', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-144" class="py-name"><a title="ganeti.mcpu.Processor.Log
script-burnin.Log" class="py-name" href="#" onclick="return doclink('link-144', 'Log', 'link-67');">Log</a></tt><tt class="py-op">(</tt><tt class="py-string">" - INFO: %s"</tt> <tt class="py-op">%</tt> <tt id="link-145" class="py-name"><a title="ganeti.http.HttpException.message" class="py-name" href="#" onclick="return doclink('link-145', 'message', 'link-127');">message</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="Processor.GetECId"></a><div id="Processor.GetECId-def"><a name="L437"></a><tt class="py-lineno">437</tt> <a class="py-toggle" href="#" id="Processor.GetECId-toggle" onclick="return toggle('Processor.GetECId');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.Processor-class.html#GetECId">GetECId</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Processor.GetECId-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="Processor.GetECId-expanded"><a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">    <tt class="py-docstring">"""Returns the current execution context ID.</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_ec_id</tt><tt class="py-op">:</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-146" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-146', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-147" class="py-name"><a title="ganeti.errors.ProgrammerError" class="py-name" href="#" onclick="return doclink('link-147', 'ProgrammerError', 'link-100');">ProgrammerError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Tried to use execution context id when"</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line">                                   <tt class="py-string">" not set"</tt><tt class="py-op">)</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">_ec_id</tt> </tt>
</div></div><a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line"> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster"></a><div id="HooksMaster-def"><a name="L447"></a><tt class="py-lineno">447</tt> <a class="py-toggle" href="#" id="HooksMaster-toggle" onclick="return toggle('HooksMaster');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html">HooksMaster</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="HooksMaster-expanded"><a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line">  <tt class="py-docstring">"""Hooks master.</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"><tt class="py-docstring">  This class distributes the run commands to the nodes based on the</tt> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line"><tt class="py-docstring">  specific LU class.</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line"><tt class="py-docstring">  In order to remove the direct dependency on the rpc module, the</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line"><tt class="py-docstring">  constructor needs a function which actually does the remote</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line"><tt class="py-docstring">  call. This will usually be rpc.call_hooks_runner, but any function</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line"><tt class="py-docstring">  which behaves the same works.</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="HooksMaster.__init__"></a><div id="HooksMaster.__init__-def"><a name="L459"></a><tt class="py-lineno">459</tt> <a class="py-toggle" href="#" id="HooksMaster.__init__-toggle" onclick="return toggle('HooksMaster.__init__');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">callfn</tt><tt class="py-op">,</tt> <tt class="py-param">lu</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.__init__-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.__init__-expanded"><a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">callfn</tt> <tt class="py-op">=</tt> <tt class="py-name">callfn</tt> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">op</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">op</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-148" class="py-name" targets="Method ganeti.mcpu.HooksMaster._BuildEnv()=ganeti.mcpu.HooksMaster-class.html#_BuildEnv"><a title="ganeti.mcpu.HooksMaster._BuildEnv" class="py-name" href="#" onclick="return doclink('link-148', '_BuildEnv', 'link-148');">_BuildEnv</a></tt><tt class="py-op">(</tt><tt id="link-149" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-149', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-150', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">)</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line"> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-151" class="py-name" targets="Variable ganeti.cmdlib.LUBackupExport.HPATH=ganeti.cmdlib.LUBackupExport-class.html#HPATH,Variable ganeti.cmdlib.LUClusterDestroy.HPATH=ganeti.cmdlib.LUClusterDestroy-class.html#HPATH,Variable ganeti.cmdlib.LUClusterPostInit.HPATH=ganeti.cmdlib.LUClusterPostInit-class.html#HPATH,Variable ganeti.cmdlib.LUClusterRename.HPATH=ganeti.cmdlib.LUClusterRename-class.html#HPATH,Variable ganeti.cmdlib.LUClusterSetParams.HPATH=ganeti.cmdlib.LUClusterSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUClusterVerifyGroup.HPATH=ganeti.cmdlib.LUClusterVerifyGroup-class.html#HPATH,Variable ganeti.cmdlib.LUGroupAdd.HPATH=ganeti.cmdlib.LUGroupAdd-class.html#HPATH,Variable ganeti.cmdlib.LUGroupEvacuate.HPATH=ganeti.cmdlib.LUGroupEvacuate-class.html#HPATH,Variable ganeti.cmdlib.LUGroupRemove.HPATH=ganeti.cmdlib.LUGroupRemove-class.html#HPATH,Variable ganeti.cmdlib.LUGroupRename.HPATH=ganeti.cmdlib.LUGroupRename-class.html#HPATH,Variable ganeti.cmdlib.LUGroupSetParams.HPATH=ganeti.cmdlib.LUGroupSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceChangeGroup.HPATH=ganeti.cmdlib.LUInstanceChangeGroup-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceCreate.HPATH=ganeti.cmdlib.LUInstanceCreate-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceFailover.HPATH=ganeti.cmdlib.LUInstanceFailover-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceGrowDisk.HPATH=ganeti.cmdlib.LUInstanceGrowDisk-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceMigrate.HPATH=ganeti.cmdlib.LUInstanceMigrate-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceMove.HPATH=ganeti.cmdlib.LUInstanceMove-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReboot.HPATH=ganeti.cmdlib.LUInstanceReboot-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRecreateDisks.HPATH=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReinstall.HPATH=ganeti.cmdlib.LUInstanceReinstall-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRemove.HPATH=ganeti.cmdlib.LUInstanceRemove-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRename.HPATH=ganeti.cmdlib.LUInstanceRename-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReplaceDisks.HPATH=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceSetParams.HPATH=ganeti.cmdlib.LUInstanceSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceShutdown.HPATH=ganeti.cmdlib.LUInstanceShutdown-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceStartup.HPATH=ganeti.cmdlib.LUInstanceStartup-class.html#HPATH,Variable ganeti.cmdlib.LUNodeAdd.HPATH=ganeti.cmdlib.LUNodeAdd-class.html#HPATH,Variable ganeti.cmdlib.LUNodeMigrate.HPATH=ganeti.cmdlib.LUNodeMigrate-class.html#HPATH,Variable ganeti.cmdlib.LUNodeRemove.HPATH=ganeti.cmdlib.LUNodeRemove-class.html#HPATH,Variable ganeti.cmdlib.LUNodeSetParams.HPATH=ganeti.cmdlib.LUNodeSetParams-class.html#HPATH,Variable ganeti.cmdlib.LogicalUnit.HPATH=ganeti.cmdlib.LogicalUnit-class.html#HPATH,Variable ganeti.cmdlib.NoHooksLU.HPATH=ganeti.cmdlib.NoHooksLU-class.html#HPATH"><a title="ganeti.cmdlib.LUBackupExport.HPATH
ganeti.cmdlib.LUClusterDestroy.HPATH
ganeti.cmdlib.LUClusterPostInit.HPATH
ganeti.cmdlib.LUClusterRename.HPATH
ganeti.cmdlib.LUClusterSetParams.HPATH
ganeti.cmdlib.LUClusterVerifyGroup.HPATH
ganeti.cmdlib.LUGroupAdd.HPATH
ganeti.cmdlib.LUGroupEvacuate.HPATH
ganeti.cmdlib.LUGroupRemove.HPATH
ganeti.cmdlib.LUGroupRename.HPATH
ganeti.cmdlib.LUGroupSetParams.HPATH
ganeti.cmdlib.LUInstanceChangeGroup.HPATH
ganeti.cmdlib.LUInstanceCreate.HPATH
ganeti.cmdlib.LUInstanceFailover.HPATH
ganeti.cmdlib.LUInstanceGrowDisk.HPATH
ganeti.cmdlib.LUInstanceMigrate.HPATH
ganeti.cmdlib.LUInstanceMove.HPATH
ganeti.cmdlib.LUInstanceReboot.HPATH
ganeti.cmdlib.LUInstanceRecreateDisks.HPATH
ganeti.cmdlib.LUInstanceReinstall.HPATH
ganeti.cmdlib.LUInstanceRemove.HPATH
ganeti.cmdlib.LUInstanceRename.HPATH
ganeti.cmdlib.LUInstanceReplaceDisks.HPATH
ganeti.cmdlib.LUInstanceSetParams.HPATH
ganeti.cmdlib.LUInstanceShutdown.HPATH
ganeti.cmdlib.LUInstanceStartup.HPATH
ganeti.cmdlib.LUNodeAdd.HPATH
ganeti.cmdlib.LUNodeMigrate.HPATH
ganeti.cmdlib.LUNodeRemove.HPATH
ganeti.cmdlib.LUNodeSetParams.HPATH
ganeti.cmdlib.LogicalUnit.HPATH
ganeti.cmdlib.NoHooksLU.HPATH" class="py-name" href="#" onclick="return doclink('link-151', 'HPATH', 'link-151');">HPATH</a></tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">      <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">      <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">map</tt><tt class="py-op">(</tt><tt class="py-name">frozenset</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-152" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.BuildHooksNodes()=ganeti.cmdlib.LUBackupExport-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterDestroy.BuildHooksNodes()=ganeti.cmdlib.LUClusterDestroy-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterPostInit.BuildHooksNodes()=ganeti.cmdlib.LUClusterPostInit-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterRename.BuildHooksNodes()=ganeti.cmdlib.LUClusterRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterSetParams.BuildHooksNodes()=ganeti.cmdlib.LUClusterSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksNodes()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupAdd.BuildHooksNodes()=ganeti.cmdlib.LUGroupAdd-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupEvacuate.BuildHooksNodes()=ganeti.cmdlib.LUGroupEvacuate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupRemove.BuildHooksNodes()=ganeti.cmdlib.LUGroupRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupRename.BuildHooksNodes()=ganeti.cmdlib.LUGroupRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupSetParams.BuildHooksNodes()=ganeti.cmdlib.LUGroupSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksNodes()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceCreate.BuildHooksNodes()=ganeti.cmdlib.LUInstanceCreate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceFailover.BuildHooksNodes()=ganeti.cmdlib.LUInstanceFailover-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksNodes()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceMigrate.BuildHooksNodes()=ganeti.cmdlib.LUInstanceMigrate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceMove.BuildHooksNodes()=ganeti.cmdlib.LUInstanceMove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReboot.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReboot-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReinstall.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReinstall-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRemove.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRename.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceSetParams.BuildHooksNodes()=ganeti.cmdlib.LUInstanceSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceShutdown.BuildHooksNodes()=ganeti.cmdlib.LUInstanceShutdown-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceStartup.BuildHooksNodes()=ganeti.cmdlib.LUInstanceStartup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeAdd.BuildHooksNodes()=ganeti.cmdlib.LUNodeAdd-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeMigrate.BuildHooksNodes()=ganeti.cmdlib.LUNodeMigrate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeRemove.BuildHooksNodes()=ganeti.cmdlib.LUNodeRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeSetParams.BuildHooksNodes()=ganeti.cmdlib.LUNodeSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LogicalUnit.BuildHooksNodes()=ganeti.cmdlib.LogicalUnit-class.html#BuildHooksNodes,Method ganeti.cmdlib.NoHooksLU.BuildHooksNodes()=ganeti.cmdlib.NoHooksLU-class.html#BuildHooksNodes"><a title="ganeti.cmdlib.LUBackupExport.BuildHooksNodes
ganeti.cmdlib.LUClusterDestroy.BuildHooksNodes
ganeti.cmdlib.LUClusterPostInit.BuildHooksNodes
ganeti.cmdlib.LUClusterRename.BuildHooksNodes
ganeti.cmdlib.LUClusterSetParams.BuildHooksNodes
ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksNodes
ganeti.cmdlib.LUGroupAdd.BuildHooksNodes
ganeti.cmdlib.LUGroupEvacuate.BuildHooksNodes
ganeti.cmdlib.LUGroupRemove.BuildHooksNodes
ganeti.cmdlib.LUGroupRename.BuildHooksNodes
ganeti.cmdlib.LUGroupSetParams.BuildHooksNodes
ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksNodes
ganeti.cmdlib.LUInstanceCreate.BuildHooksNodes
ganeti.cmdlib.LUInstanceFailover.BuildHooksNodes
ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksNodes
ganeti.cmdlib.LUInstanceMigrate.BuildHooksNodes
ganeti.cmdlib.LUInstanceMove.BuildHooksNodes
ganeti.cmdlib.LUInstanceReboot.BuildHooksNodes
ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksNodes
ganeti.cmdlib.LUInstanceReinstall.BuildHooksNodes
ganeti.cmdlib.LUInstanceRemove.BuildHooksNodes
ganeti.cmdlib.LUInstanceRename.BuildHooksNodes
ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksNodes
ganeti.cmdlib.LUInstanceSetParams.BuildHooksNodes
ganeti.cmdlib.LUInstanceShutdown.BuildHooksNodes
ganeti.cmdlib.LUInstanceStartup.BuildHooksNodes
ganeti.cmdlib.LUNodeAdd.BuildHooksNodes
ganeti.cmdlib.LUNodeMigrate.BuildHooksNodes
ganeti.cmdlib.LUNodeRemove.BuildHooksNodes
ganeti.cmdlib.LUNodeSetParams.BuildHooksNodes
ganeti.cmdlib.LogicalUnit.BuildHooksNodes
ganeti.cmdlib.NoHooksLU.BuildHooksNodes" class="py-name" href="#" onclick="return doclink('link-152', 'BuildHooksNodes', 'link-152');">BuildHooksNodes</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line"> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">    <tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_nodes</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">post_nodes</tt><tt class="py-op">)</tt> <tt class="py-op">=</tt> <tt class="py-name">nodes</tt> </tt>
</div><a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster._BuildEnv"></a><div id="HooksMaster._BuildEnv-def"><a name="L472"></a><tt class="py-lineno">472</tt> <a class="py-toggle" href="#" id="HooksMaster._BuildEnv-toggle" onclick="return toggle('HooksMaster._BuildEnv');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html#_BuildEnv">_BuildEnv</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster._BuildEnv-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster._BuildEnv-expanded"><a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">    <tt class="py-docstring">"""Compute the environment and the target nodes.</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line"><tt class="py-docstring">    Based on the opcode and the current node list, this builds the</tt> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line"><tt class="py-docstring">    environment for the hooks and the target node list for the run.</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-153" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-153', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-154" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-154', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">      <tt class="py-name">prefix</tt> <tt class="py-op">=</tt> <tt class="py-string">"GANETI_"</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-155" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-155', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-156" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-156', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">      <tt class="py-name">prefix</tt> <tt class="py-op">=</tt> <tt class="py-string">"GANETI_POST_"</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line"> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-157" class="py-name"><a title="ganeti.cmdlib.LUBackupExport.HPATH
ganeti.cmdlib.LUClusterDestroy.HPATH
ganeti.cmdlib.LUClusterPostInit.HPATH
ganeti.cmdlib.LUClusterRename.HPATH
ganeti.cmdlib.LUClusterSetParams.HPATH
ganeti.cmdlib.LUClusterVerifyGroup.HPATH
ganeti.cmdlib.LUGroupAdd.HPATH
ganeti.cmdlib.LUGroupEvacuate.HPATH
ganeti.cmdlib.LUGroupRemove.HPATH
ganeti.cmdlib.LUGroupRename.HPATH
ganeti.cmdlib.LUGroupSetParams.HPATH
ganeti.cmdlib.LUInstanceChangeGroup.HPATH
ganeti.cmdlib.LUInstanceCreate.HPATH
ganeti.cmdlib.LUInstanceFailover.HPATH
ganeti.cmdlib.LUInstanceGrowDisk.HPATH
ganeti.cmdlib.LUInstanceMigrate.HPATH
ganeti.cmdlib.LUInstanceMove.HPATH
ganeti.cmdlib.LUInstanceReboot.HPATH
ganeti.cmdlib.LUInstanceRecreateDisks.HPATH
ganeti.cmdlib.LUInstanceReinstall.HPATH
ganeti.cmdlib.LUInstanceRemove.HPATH
ganeti.cmdlib.LUInstanceRename.HPATH
ganeti.cmdlib.LUInstanceReplaceDisks.HPATH
ganeti.cmdlib.LUInstanceSetParams.HPATH
ganeti.cmdlib.LUInstanceShutdown.HPATH
ganeti.cmdlib.LUInstanceStartup.HPATH
ganeti.cmdlib.LUNodeAdd.HPATH
ganeti.cmdlib.LUNodeMigrate.HPATH
ganeti.cmdlib.LUNodeRemove.HPATH
ganeti.cmdlib.LUNodeSetParams.HPATH
ganeti.cmdlib.LogicalUnit.HPATH
ganeti.cmdlib.NoHooksLU.HPATH" class="py-name" href="#" onclick="return doclink('link-157', 'HPATH', 'link-151');">HPATH</a></tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line">      <tt class="py-name">lu_env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-158" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.BuildHooksEnv()=ganeti.cmdlib.LUBackupExport-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterDestroy.BuildHooksEnv()=ganeti.cmdlib.LUClusterDestroy-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterPostInit.BuildHooksEnv()=ganeti.cmdlib.LUClusterPostInit-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterRename.BuildHooksEnv()=ganeti.cmdlib.LUClusterRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterSetParams.BuildHooksEnv()=ganeti.cmdlib.LUClusterSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksEnv()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupAdd.BuildHooksEnv()=ganeti.cmdlib.LUGroupAdd-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupEvacuate.BuildHooksEnv()=ganeti.cmdlib.LUGroupEvacuate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupRemove.BuildHooksEnv()=ganeti.cmdlib.LUGroupRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupRename.BuildHooksEnv()=ganeti.cmdlib.LUGroupRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupSetParams.BuildHooksEnv()=ganeti.cmdlib.LUGroupSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksEnv()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceCreate.BuildHooksEnv()=ganeti.cmdlib.LUInstanceCreate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceFailover.BuildHooksEnv()=ganeti.cmdlib.LUInstanceFailover-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksEnv()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceMigrate.BuildHooksEnv()=ganeti.cmdlib.LUInstanceMigrate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceMove.BuildHooksEnv()=ganeti.cmdlib.LUInstanceMove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReboot.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReboot-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReinstall.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReinstall-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRemove.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRename.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceSetParams.BuildHooksEnv()=ganeti.cmdlib.LUInstanceSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceShutdown.BuildHooksEnv()=ganeti.cmdlib.LUInstanceShutdown-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceStartup.BuildHooksEnv()=ganeti.cmdlib.LUInstanceStartup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeAdd.BuildHooksEnv()=ganeti.cmdlib.LUNodeAdd-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeMigrate.BuildHooksEnv()=ganeti.cmdlib.LUNodeMigrate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeRemove.BuildHooksEnv()=ganeti.cmdlib.LUNodeRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeSetParams.BuildHooksEnv()=ganeti.cmdlib.LUNodeSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LogicalUnit.BuildHooksEnv()=ganeti.cmdlib.LogicalUnit-class.html#BuildHooksEnv,Method ganeti.cmdlib.NoHooksLU.BuildHooksEnv()=ganeti.cmdlib.NoHooksLU-class.html#BuildHooksEnv"><a title="ganeti.cmdlib.LUBackupExport.BuildHooksEnv
ganeti.cmdlib.LUClusterDestroy.BuildHooksEnv
ganeti.cmdlib.LUClusterPostInit.BuildHooksEnv
ganeti.cmdlib.LUClusterRename.BuildHooksEnv
ganeti.cmdlib.LUClusterSetParams.BuildHooksEnv
ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksEnv
ganeti.cmdlib.LUGroupAdd.BuildHooksEnv
ganeti.cmdlib.LUGroupEvacuate.BuildHooksEnv
ganeti.cmdlib.LUGroupRemove.BuildHooksEnv
ganeti.cmdlib.LUGroupRename.BuildHooksEnv
ganeti.cmdlib.LUGroupSetParams.BuildHooksEnv
ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksEnv
ganeti.cmdlib.LUInstanceCreate.BuildHooksEnv
ganeti.cmdlib.LUInstanceFailover.BuildHooksEnv
ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksEnv
ganeti.cmdlib.LUInstanceMigrate.BuildHooksEnv
ganeti.cmdlib.LUInstanceMove.BuildHooksEnv
ganeti.cmdlib.LUInstanceReboot.BuildHooksEnv
ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksEnv
ganeti.cmdlib.LUInstanceReinstall.BuildHooksEnv
ganeti.cmdlib.LUInstanceRemove.BuildHooksEnv
ganeti.cmdlib.LUInstanceRename.BuildHooksEnv
ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksEnv
ganeti.cmdlib.LUInstanceSetParams.BuildHooksEnv
ganeti.cmdlib.LUInstanceShutdown.BuildHooksEnv
ganeti.cmdlib.LUInstanceStartup.BuildHooksEnv
ganeti.cmdlib.LUNodeAdd.BuildHooksEnv
ganeti.cmdlib.LUNodeMigrate.BuildHooksEnv
ganeti.cmdlib.LUNodeRemove.BuildHooksEnv
ganeti.cmdlib.LUNodeSetParams.BuildHooksEnv
ganeti.cmdlib.LogicalUnit.BuildHooksEnv
ganeti.cmdlib.NoHooksLU.BuildHooksEnv" class="py-name" href="#" onclick="return doclink('link-158', 'BuildHooksEnv', 'link-158');">BuildHooksEnv</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">lu_env</tt><tt class="py-op">:</tt> </tt>
<a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line">        <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt id="link-159" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-159', 'compat', 'link-15');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">upper</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-name">prefix</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lu_env</tt><tt class="py-op">)</tt> </tt>
<a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line">        <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"%s%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">prefix</tt><tt class="py-op">,</tt> <tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">)</tt> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line">                   <tt class="py-keyword">for</tt> <tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">lu_env</tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line"> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-160" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-160', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-161" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-161', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt id="link-162" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-162', 'compat', 'link-15');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_"</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line">                         <tt class="py-keyword">not</tt> <tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line"> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-163" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-163', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-164" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-164', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt id="link-165" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-165', 'compat', 'link-15');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">,</tt> <tt class="py-name">dict</tt><tt class="py-op">)</tt> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line"> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">      <tt class="py-comment"># Merge with pre-phase environment</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt id="link-166" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-166', 'compat', 'link-15');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line">                            <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
<a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line"> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">env</tt> </tt>
</div><a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster._RunWrapper"></a><div id="HooksMaster._RunWrapper-def"><a name="L513"></a><tt class="py-lineno">513</tt> <a class="py-toggle" href="#" id="HooksMaster._RunWrapper-toggle" onclick="return toggle('HooksMaster._RunWrapper');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html#_RunWrapper">_RunWrapper</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">node_list</tt><tt class="py-op">,</tt> <tt class="py-param">hpath</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">,</tt> <tt class="py-param">phase_env</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster._RunWrapper-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster._RunWrapper-expanded"><a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line">    <tt class="py-docstring">"""Simple wrapper over self.callfn.</tt> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line"><tt class="py-docstring">    This method fixes the environment before doing the rpc call.</tt> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line">    <tt class="py-name">cfg</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line"> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line">      <tt class="py-string">"PATH"</tt><tt class="py-op">:</tt> <tt id="link-167" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-167', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-168" class="py-name" targets="Variable ganeti.constants.HOOKS_PATH=ganeti.constants-module.html#HOOKS_PATH"><a title="ganeti.constants.HOOKS_PATH" class="py-name" href="#" onclick="return doclink('link-168', 'HOOKS_PATH', 'link-168');">HOOKS_PATH</a></tt><tt class="py-op">,</tt> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_VERSION"</tt><tt class="py-op">:</tt> <tt id="link-169" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-169', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-170" class="py-name" targets="Variable ganeti.constants.HOOKS_VERSION=ganeti.constants-module.html#HOOKS_VERSION"><a title="ganeti.constants.HOOKS_VERSION" class="py-name" href="#" onclick="return doclink('link-170', 'HOOKS_VERSION', 'link-170');">HOOKS_VERSION</a></tt><tt class="py-op">,</tt> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_OP_CODE"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">op</tt><tt class="py-op">.</tt><tt class="py-name">OP_ID</tt><tt class="py-op">,</tt> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_DATA_DIR"</tt><tt class="py-op">:</tt> <tt id="link-171" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-171', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-172" class="py-name" targets="Variable ganeti.constants.DATA_DIR=ganeti.constants-module.html#DATA_DIR"><a title="ganeti.constants.DATA_DIR" class="py-name" href="#" onclick="return doclink('link-172', 'DATA_DIR', 'link-172');">DATA_DIR</a></tt><tt class="py-op">,</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_PHASE"</tt><tt class="py-op">:</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_PATH"</tt><tt class="py-op">:</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line">      <tt class="py-op">}</tt> </tt>
<a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line"> </tt>
<a name="L530"></a><tt class="py-lineno">530</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-173" class="py-name" targets="Variable ganeti.cmdlib.LUBackupExport.HTYPE=ganeti.cmdlib.LUBackupExport-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterDestroy.HTYPE=ganeti.cmdlib.LUClusterDestroy-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterPostInit.HTYPE=ganeti.cmdlib.LUClusterPostInit-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterRename.HTYPE=ganeti.cmdlib.LUClusterRename-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterSetParams.HTYPE=ganeti.cmdlib.LUClusterSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterVerifyGroup.HTYPE=ganeti.cmdlib.LUClusterVerifyGroup-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupAdd.HTYPE=ganeti.cmdlib.LUGroupAdd-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupEvacuate.HTYPE=ganeti.cmdlib.LUGroupEvacuate-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupRemove.HTYPE=ganeti.cmdlib.LUGroupRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupRename.HTYPE=ganeti.cmdlib.LUGroupRename-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupSetParams.HTYPE=ganeti.cmdlib.LUGroupSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceChangeGroup.HTYPE=ganeti.cmdlib.LUInstanceChangeGroup-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceCreate.HTYPE=ganeti.cmdlib.LUInstanceCreate-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceFailover.HTYPE=ganeti.cmdlib.LUInstanceFailover-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceGrowDisk.HTYPE=ganeti.cmdlib.LUInstanceGrowDisk-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceMigrate.HTYPE=ganeti.cmdlib.LUInstanceMigrate-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceMove.HTYPE=ganeti.cmdlib.LUInstanceMove-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReboot.HTYPE=ganeti.cmdlib.LUInstanceReboot-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRecreateDisks.HTYPE=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReinstall.HTYPE=ganeti.cmdlib.LUInstanceReinstall-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRemove.HTYPE=ganeti.cmdlib.LUInstanceRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRename.HTYPE=ganeti.cmdlib.LUInstanceRename-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReplaceDisks.HTYPE=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceSetParams.HTYPE=ganeti.cmdlib.LUInstanceSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceShutdown.HTYPE=ganeti.cmdlib.LUInstanceShutdown-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceStartup.HTYPE=ganeti.cmdlib.LUInstanceStartup-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeAdd.HTYPE=ganeti.cmdlib.LUNodeAdd-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeMigrate.HTYPE=ganeti.cmdlib.LUNodeMigrate-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeRemove.HTYPE=ganeti.cmdlib.LUNodeRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeSetParams.HTYPE=ganeti.cmdlib.LUNodeSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LogicalUnit.HTYPE=ganeti.cmdlib.LogicalUnit-class.html#HTYPE,Variable ganeti.cmdlib.NoHooksLU.HTYPE=ganeti.cmdlib.NoHooksLU-class.html#HTYPE"><a title="ganeti.cmdlib.LUBackupExport.HTYPE
ganeti.cmdlib.LUClusterDestroy.HTYPE
ganeti.cmdlib.LUClusterPostInit.HTYPE
ganeti.cmdlib.LUClusterRename.HTYPE
ganeti.cmdlib.LUClusterSetParams.HTYPE
ganeti.cmdlib.LUClusterVerifyGroup.HTYPE
ganeti.cmdlib.LUGroupAdd.HTYPE
ganeti.cmdlib.LUGroupEvacuate.HTYPE
ganeti.cmdlib.LUGroupRemove.HTYPE
ganeti.cmdlib.LUGroupRename.HTYPE
ganeti.cmdlib.LUGroupSetParams.HTYPE
ganeti.cmdlib.LUInstanceChangeGroup.HTYPE
ganeti.cmdlib.LUInstanceCreate.HTYPE
ganeti.cmdlib.LUInstanceFailover.HTYPE
ganeti.cmdlib.LUInstanceGrowDisk.HTYPE
ganeti.cmdlib.LUInstanceMigrate.HTYPE
ganeti.cmdlib.LUInstanceMove.HTYPE
ganeti.cmdlib.LUInstanceReboot.HTYPE
ganeti.cmdlib.LUInstanceRecreateDisks.HTYPE
ganeti.cmdlib.LUInstanceReinstall.HTYPE
ganeti.cmdlib.LUInstanceRemove.HTYPE
ganeti.cmdlib.LUInstanceRename.HTYPE
ganeti.cmdlib.LUInstanceReplaceDisks.HTYPE
ganeti.cmdlib.LUInstanceSetParams.HTYPE
ganeti.cmdlib.LUInstanceShutdown.HTYPE
ganeti.cmdlib.LUInstanceStartup.HTYPE
ganeti.cmdlib.LUNodeAdd.HTYPE
ganeti.cmdlib.LUNodeMigrate.HTYPE
ganeti.cmdlib.LUNodeRemove.HTYPE
ganeti.cmdlib.LUNodeSetParams.HTYPE
ganeti.cmdlib.LogicalUnit.HTYPE
ganeti.cmdlib.NoHooksLU.HTYPE" class="py-name" href="#" onclick="return doclink('link-173', 'HTYPE', 'link-173');">HTYPE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L531"></a><tt class="py-lineno">531</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_OBJECT_TYPE"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-174" class="py-name"><a title="ganeti.cmdlib.LUBackupExport.HTYPE
ganeti.cmdlib.LUClusterDestroy.HTYPE
ganeti.cmdlib.LUClusterPostInit.HTYPE
ganeti.cmdlib.LUClusterRename.HTYPE
ganeti.cmdlib.LUClusterSetParams.HTYPE
ganeti.cmdlib.LUClusterVerifyGroup.HTYPE
ganeti.cmdlib.LUGroupAdd.HTYPE
ganeti.cmdlib.LUGroupEvacuate.HTYPE
ganeti.cmdlib.LUGroupRemove.HTYPE
ganeti.cmdlib.LUGroupRename.HTYPE
ganeti.cmdlib.LUGroupSetParams.HTYPE
ganeti.cmdlib.LUInstanceChangeGroup.HTYPE
ganeti.cmdlib.LUInstanceCreate.HTYPE
ganeti.cmdlib.LUInstanceFailover.HTYPE
ganeti.cmdlib.LUInstanceGrowDisk.HTYPE
ganeti.cmdlib.LUInstanceMigrate.HTYPE
ganeti.cmdlib.LUInstanceMove.HTYPE
ganeti.cmdlib.LUInstanceReboot.HTYPE
ganeti.cmdlib.LUInstanceRecreateDisks.HTYPE
ganeti.cmdlib.LUInstanceReinstall.HTYPE
ganeti.cmdlib.LUInstanceRemove.HTYPE
ganeti.cmdlib.LUInstanceRename.HTYPE
ganeti.cmdlib.LUInstanceReplaceDisks.HTYPE
ganeti.cmdlib.LUInstanceSetParams.HTYPE
ganeti.cmdlib.LUInstanceShutdown.HTYPE
ganeti.cmdlib.LUInstanceStartup.HTYPE
ganeti.cmdlib.LUNodeAdd.HTYPE
ganeti.cmdlib.LUNodeMigrate.HTYPE
ganeti.cmdlib.LUNodeRemove.HTYPE
ganeti.cmdlib.LUNodeSetParams.HTYPE
ganeti.cmdlib.LogicalUnit.HTYPE
ganeti.cmdlib.NoHooksLU.HTYPE" class="py-name" href="#" onclick="return doclink('link-174', 'HTYPE', 'link-173');">HTYPE</a></tt> </tt>
<a name="L532"></a><tt class="py-lineno">532</tt>  <tt class="py-line"> </tt>
<a name="L533"></a><tt class="py-lineno">533</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">cfg</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L534"></a><tt class="py-lineno">534</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_CLUSTER"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-175" class="py-name" targets="Method ganeti.config.ConfigWriter.GetClusterName()=ganeti.config.ConfigWriter-class.html#GetClusterName,Method ganeti.ssconf.SimpleConfigReader.GetClusterName()=ganeti.ssconf.SimpleConfigReader-class.html#GetClusterName,Method ganeti.ssconf.SimpleStore.GetClusterName()=ganeti.ssconf.SimpleStore-class.html#GetClusterName"><a title="ganeti.config.ConfigWriter.GetClusterName
ganeti.ssconf.SimpleConfigReader.GetClusterName
ganeti.ssconf.SimpleStore.GetClusterName" class="py-name" href="#" onclick="return doclink('link-175', 'GetClusterName', 'link-175');">GetClusterName</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L535"></a><tt class="py-lineno">535</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_MASTER"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-176" class="py-name" targets="Method ganeti.config.ConfigWriter.GetMasterNode()=ganeti.config.ConfigWriter-class.html#GetMasterNode,Method ganeti.ssconf.SimpleConfigReader.GetMasterNode()=ganeti.ssconf.SimpleConfigReader-class.html#GetMasterNode,Method ganeti.ssconf.SimpleStore.GetMasterNode()=ganeti.ssconf.SimpleStore-class.html#GetMasterNode"><a title="ganeti.config.ConfigWriter.GetMasterNode
ganeti.ssconf.SimpleConfigReader.GetMasterNode
ganeti.ssconf.SimpleStore.GetMasterNode" class="py-name" href="#" onclick="return doclink('link-176', 'GetMasterNode', 'link-176');">GetMasterNode</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L536"></a><tt class="py-lineno">536</tt>  <tt class="py-line"> </tt>
<a name="L537"></a><tt class="py-lineno">537</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase_env</tt><tt class="py-op">:</tt> </tt>
<a name="L538"></a><tt class="py-lineno">538</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt class="py-op">(</tt><tt class="py-name">set</tt><tt class="py-op">(</tt><tt class="py-name">env</tt><tt class="py-op">)</tt> <tt class="py-op">&amp;</tt> <tt class="py-name">set</tt><tt class="py-op">(</tt><tt class="py-name">phase_env</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-string">"Environment variables conflict"</tt> </tt>
<a name="L539"></a><tt class="py-lineno">539</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-name">phase_env</tt><tt class="py-op">)</tt> </tt>
<a name="L540"></a><tt class="py-lineno">540</tt>  <tt class="py-line"> </tt>
<a name="L541"></a><tt class="py-lineno">541</tt>  <tt class="py-line">    <tt class="py-comment"># Convert everything to strings</tt> </tt>
<a name="L542"></a><tt class="py-lineno">542</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">dict</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">(</tt><tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">val</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt><tt class="py-op">,</tt> <tt class="py-name">val</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">iteritems</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L543"></a><tt class="py-lineno">543</tt>  <tt class="py-line"> </tt>
<a name="L544"></a><tt class="py-lineno">544</tt>  <tt class="py-line">    <tt class="py-keyword">assert</tt> <tt id="link-177" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-177', 'compat', 'link-15');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-name">key</tt> <tt class="py-op">==</tt> <tt class="py-string">"PATH"</tt> <tt class="py-keyword">or</tt> <tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_"</tt><tt class="py-op">)</tt> </tt>
<a name="L545"></a><tt class="py-lineno">545</tt>  <tt class="py-line">                      <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L546"></a><tt class="py-lineno">546</tt>  <tt class="py-line"> </tt>
<a name="L547"></a><tt class="py-lineno">547</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">callfn</tt><tt class="py-op">(</tt><tt class="py-name">node_list</tt><tt class="py-op">,</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
</div><a name="L548"></a><tt class="py-lineno">548</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster.RunPhase"></a><div id="HooksMaster.RunPhase-def"><a name="L549"></a><tt class="py-lineno">549</tt> <a class="py-toggle" href="#" id="HooksMaster.RunPhase-toggle" onclick="return toggle('HooksMaster.RunPhase');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html#RunPhase">RunPhase</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">,</tt> <tt class="py-param">nodes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.RunPhase-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.RunPhase-expanded"><a name="L550"></a><tt class="py-lineno">550</tt>  <tt class="py-line">    <tt class="py-docstring">"""Run all the scripts for a phase.</tt> </tt>
<a name="L551"></a><tt class="py-lineno">551</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L552"></a><tt class="py-lineno">552</tt>  <tt class="py-line"><tt class="py-docstring">    This is the main function of the HookMaster.</tt> </tt>
<a name="L553"></a><tt class="py-lineno">553</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L554"></a><tt class="py-lineno">554</tt>  <tt class="py-line"><tt class="py-docstring">    @param phase: one of L{constants.HOOKS_PHASE_POST} or</tt> </tt>
<a name="L555"></a><tt class="py-lineno">555</tt>  <tt class="py-line"><tt class="py-docstring">        L{constants.HOOKS_PHASE_PRE}; it denotes the hooks phase</tt> </tt>
<a name="L556"></a><tt class="py-lineno">556</tt>  <tt class="py-line"><tt class="py-docstring">    @param nodes: overrides the predefined list of nodes for the given phase</tt> </tt>
<a name="L557"></a><tt class="py-lineno">557</tt>  <tt class="py-line"><tt class="py-docstring">    @return: the processed results of the hooks multi-node rpc call</tt> </tt>
<a name="L558"></a><tt class="py-lineno">558</tt>  <tt class="py-line"><tt class="py-docstring">    @raise errors.HooksFailure: on communication failure to the nodes</tt> </tt>
<a name="L559"></a><tt class="py-lineno">559</tt>  <tt class="py-line"><tt class="py-docstring">    @raise errors.HooksAbort: on failure of one of the hooks</tt> </tt>
<a name="L560"></a><tt class="py-lineno">560</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L561"></a><tt class="py-lineno">561</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L562"></a><tt class="py-lineno">562</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-178" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-178', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-179" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-179', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L563"></a><tt class="py-lineno">563</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">nodes</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L564"></a><tt class="py-lineno">564</tt>  <tt class="py-line">        <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_nodes</tt> </tt>
<a name="L565"></a><tt class="py-lineno">565</tt>  <tt class="py-line">      <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt> </tt>
<a name="L566"></a><tt class="py-lineno">566</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-180" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-180', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-181" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-181', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L567"></a><tt class="py-lineno">567</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">nodes</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L568"></a><tt class="py-lineno">568</tt>  <tt class="py-line">        <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">post_nodes</tt> </tt>
<a name="L569"></a><tt class="py-lineno">569</tt>  <tt class="py-line">      <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-182" class="py-name"><a title="ganeti.mcpu.HooksMaster._BuildEnv" class="py-name" href="#" onclick="return doclink('link-182', '_BuildEnv', 'link-148');">_BuildEnv</a></tt><tt class="py-op">(</tt><tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L570"></a><tt class="py-lineno">570</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L571"></a><tt class="py-lineno">571</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L572"></a><tt class="py-lineno">572</tt>  <tt class="py-line"> </tt>
<a name="L573"></a><tt class="py-lineno">573</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">nodes</tt><tt class="py-op">:</tt> </tt>
<a name="L574"></a><tt class="py-lineno">574</tt>  <tt class="py-line">      <tt class="py-comment"># empty node list, we should not attempt to run this as either</tt> </tt>
<a name="L575"></a><tt class="py-lineno">575</tt>  <tt class="py-line">      <tt class="py-comment"># we're in the cluster init phase and the rpc client part can't</tt> </tt>
<a name="L576"></a><tt class="py-lineno">576</tt>  <tt class="py-line">      <tt class="py-comment"># even attempt to run, or this LU doesn't do hooks at all</tt> </tt>
<a name="L577"></a><tt class="py-lineno">577</tt>  <tt class="py-line">      <tt class="py-keyword">return</tt> </tt>
<a name="L578"></a><tt class="py-lineno">578</tt>  <tt class="py-line"> </tt>
<a name="L579"></a><tt class="py-lineno">579</tt>  <tt class="py-line">    <tt class="py-name">results</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-183" class="py-name" targets="Method ganeti.mcpu.HooksMaster._RunWrapper()=ganeti.mcpu.HooksMaster-class.html#_RunWrapper"><a title="ganeti.mcpu.HooksMaster._RunWrapper" class="py-name" href="#" onclick="return doclink('link-183', '_RunWrapper', 'link-183');">_RunWrapper</a></tt><tt class="py-op">(</tt><tt class="py-name">nodes</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="ganeti.cmdlib.LUBackupExport.HPATH
ganeti.cmdlib.LUClusterDestroy.HPATH
ganeti.cmdlib.LUClusterPostInit.HPATH
ganeti.cmdlib.LUClusterRename.HPATH
ganeti.cmdlib.LUClusterSetParams.HPATH
ganeti.cmdlib.LUClusterVerifyGroup.HPATH
ganeti.cmdlib.LUGroupAdd.HPATH
ganeti.cmdlib.LUGroupEvacuate.HPATH
ganeti.cmdlib.LUGroupRemove.HPATH
ganeti.cmdlib.LUGroupRename.HPATH
ganeti.cmdlib.LUGroupSetParams.HPATH
ganeti.cmdlib.LUInstanceChangeGroup.HPATH
ganeti.cmdlib.LUInstanceCreate.HPATH
ganeti.cmdlib.LUInstanceFailover.HPATH
ganeti.cmdlib.LUInstanceGrowDisk.HPATH
ganeti.cmdlib.LUInstanceMigrate.HPATH
ganeti.cmdlib.LUInstanceMove.HPATH
ganeti.cmdlib.LUInstanceReboot.HPATH
ganeti.cmdlib.LUInstanceRecreateDisks.HPATH
ganeti.cmdlib.LUInstanceReinstall.HPATH
ganeti.cmdlib.LUInstanceRemove.HPATH
ganeti.cmdlib.LUInstanceRename.HPATH
ganeti.cmdlib.LUInstanceReplaceDisks.HPATH
ganeti.cmdlib.LUInstanceSetParams.HPATH
ganeti.cmdlib.LUInstanceShutdown.HPATH
ganeti.cmdlib.LUInstanceStartup.HPATH
ganeti.cmdlib.LUNodeAdd.HPATH
ganeti.cmdlib.LUNodeMigrate.HPATH
ganeti.cmdlib.LUNodeRemove.HPATH
ganeti.cmdlib.LUNodeSetParams.HPATH
ganeti.cmdlib.LogicalUnit.HPATH
ganeti.cmdlib.NoHooksLU.HPATH" class="py-name" href="#" onclick="return doclink('link-184', 'HPATH', 'link-151');">HPATH</a></tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L580"></a><tt class="py-lineno">580</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">results</tt><tt class="py-op">:</tt> </tt>
<a name="L581"></a><tt class="py-lineno">581</tt>  <tt class="py-line">      <tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt class="py-string">"Communication Failure"</tt> </tt>
<a name="L582"></a><tt class="py-lineno">582</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-185" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-185', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-186" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-186', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L583"></a><tt class="py-lineno">583</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-187" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-187', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-188" class="py-name" targets="Class ganeti.errors.HooksFailure=ganeti.errors.HooksFailure-class.html"><a title="ganeti.errors.HooksFailure" class="py-name" href="#" onclick="return doclink('link-188', 'HooksFailure', 'link-188');">HooksFailure</a></tt><tt class="py-op">(</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L584"></a><tt class="py-lineno">584</tt>  <tt class="py-line">      <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L585"></a><tt class="py-lineno">585</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-189" class="py-name" targets="Method ganeti.mcpu.Processor.LogWarning()=ganeti.mcpu.Processor-class.html#LogWarning"><a title="ganeti.mcpu.Processor.LogWarning" class="py-name" href="#" onclick="return doclink('link-189', 'LogWarning', 'link-189');">LogWarning</a></tt><tt class="py-op">(</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L586"></a><tt class="py-lineno">586</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">results</tt> </tt>
<a name="L587"></a><tt class="py-lineno">587</tt>  <tt class="py-line"> </tt>
<a name="L588"></a><tt class="py-lineno">588</tt>  <tt class="py-line">    <tt class="py-name">errs</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L589"></a><tt class="py-lineno">589</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">node_name</tt> <tt class="py-keyword">in</tt> <tt class="py-name">results</tt><tt class="py-op">:</tt> </tt>
<a name="L590"></a><tt class="py-lineno">590</tt>  <tt class="py-line">      <tt class="py-name">res</tt> <tt class="py-op">=</tt> <tt class="py-name">results</tt><tt class="py-op">[</tt><tt class="py-name">node_name</tt><tt class="py-op">]</tt> </tt>
<a name="L591"></a><tt class="py-lineno">591</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">res</tt><tt class="py-op">.</tt><tt class="py-name">offline</tt><tt class="py-op">:</tt> </tt>
<a name="L592"></a><tt class="py-lineno">592</tt>  <tt class="py-line">        <tt class="py-keyword">continue</tt> </tt>
<a name="L593"></a><tt class="py-lineno">593</tt>  <tt class="py-line"> </tt>
<a name="L594"></a><tt class="py-lineno">594</tt>  <tt class="py-line">      <tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt class="py-name">res</tt><tt class="py-op">.</tt><tt class="py-name">fail_msg</tt> </tt>
<a name="L595"></a><tt class="py-lineno">595</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">msg</tt><tt class="py-op">:</tt> </tt>
<a name="L596"></a><tt class="py-lineno">596</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="ganeti.mcpu.Processor.LogWarning" class="py-name" href="#" onclick="return doclink('link-190', 'LogWarning', 'link-189');">LogWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"Communication failure to node %s: %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L597"></a><tt class="py-lineno">597</tt>  <tt class="py-line">                           <tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L598"></a><tt class="py-lineno">598</tt>  <tt class="py-line">        <tt class="py-keyword">continue</tt> </tt>
<a name="L599"></a><tt class="py-lineno">599</tt>  <tt class="py-line"> </tt>
<a name="L600"></a><tt class="py-lineno">600</tt>  <tt class="py-line">      <tt class="py-keyword">for</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt class="py-name">hkr</tt><tt class="py-op">,</tt> <tt id="link-191" class="py-name" targets="Variable ganeti.utils.process.RunResult.output=ganeti.utils.process.RunResult-class.html#output"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-191', 'output', 'link-191');">output</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">res</tt><tt class="py-op">.</tt><tt class="py-name">payload</tt><tt class="py-op">:</tt> </tt>
<a name="L601"></a><tt class="py-lineno">601</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hkr</tt> <tt class="py-op">==</tt> <tt id="link-192" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-192', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-193" class="py-name" targets="Variable ganeti.constants.HKR_FAIL=ganeti.constants-module.html#HKR_FAIL"><a title="ganeti.constants.HKR_FAIL" class="py-name" href="#" onclick="return doclink('link-193', 'HKR_FAIL', 'link-193');">HKR_FAIL</a></tt><tt class="py-op">:</tt> </tt>
<a name="L602"></a><tt class="py-lineno">602</tt>  <tt class="py-line">          <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-194" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-194', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-195', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L603"></a><tt class="py-lineno">603</tt>  <tt class="py-line">            <tt class="py-name">errs</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt id="link-196" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-196', 'output', 'link-191');">output</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L604"></a><tt class="py-lineno">604</tt>  <tt class="py-line">          <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L605"></a><tt class="py-lineno">605</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-197" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-197', 'output', 'link-191');">output</a></tt><tt class="py-op">:</tt> </tt>
<a name="L606"></a><tt class="py-lineno">606</tt>  <tt class="py-line">              <tt id="link-198" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-198', 'output', 'link-191');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"(no output)"</tt> </tt>
<a name="L607"></a><tt class="py-lineno">607</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="ganeti.mcpu.Processor.LogWarning" class="py-name" href="#" onclick="return doclink('link-199', 'LogWarning', 'link-189');">LogWarning</a></tt><tt class="py-op">(</tt><tt class="py-string">"On %s script %s failed, output: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L608"></a><tt class="py-lineno">608</tt>  <tt class="py-line">                               <tt class="py-op">(</tt><tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt id="link-200" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-200', 'output', 'link-191');">output</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L609"></a><tt class="py-lineno">609</tt>  <tt class="py-line"> </tt>
<a name="L610"></a><tt class="py-lineno">610</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">errs</tt> <tt class="py-keyword">and</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-201" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-201', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-202" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-202', 'HOOKS_PHASE_PRE', 'link-63');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L611"></a><tt class="py-lineno">611</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-203" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-203', 'errors', 'link-5');">errors</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name" targets="Class ganeti.errors.HooksAbort=ganeti.errors.HooksAbort-class.html"><a title="ganeti.errors.HooksAbort" class="py-name" href="#" onclick="return doclink('link-204', 'HooksAbort', 'link-204');">HooksAbort</a></tt><tt class="py-op">(</tt><tt class="py-name">errs</tt><tt class="py-op">)</tt> </tt>
<a name="L612"></a><tt class="py-lineno">612</tt>  <tt class="py-line"> </tt>
<a name="L613"></a><tt class="py-lineno">613</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">results</tt> </tt>
</div><a name="L614"></a><tt class="py-lineno">614</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster.RunConfigUpdate"></a><div id="HooksMaster.RunConfigUpdate-def"><a name="L615"></a><tt class="py-lineno">615</tt> <a class="py-toggle" href="#" id="HooksMaster.RunConfigUpdate-toggle" onclick="return toggle('HooksMaster.RunConfigUpdate');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.mcpu.HooksMaster-class.html#RunConfigUpdate">RunConfigUpdate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.RunConfigUpdate-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.RunConfigUpdate-expanded"><a name="L616"></a><tt class="py-lineno">616</tt>  <tt class="py-line">    <tt class="py-docstring">"""Run the special configuration update hook</tt> </tt>
<a name="L617"></a><tt class="py-lineno">617</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L618"></a><tt class="py-lineno">618</tt>  <tt class="py-line"><tt class="py-docstring">    This is a special hook that runs only on the master after each</tt> </tt>
<a name="L619"></a><tt class="py-lineno">619</tt>  <tt class="py-line"><tt class="py-docstring">    top-level LI if the configuration has been updated.</tt> </tt>
<a name="L620"></a><tt class="py-lineno">620</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L621"></a><tt class="py-lineno">621</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L622"></a><tt class="py-lineno">622</tt>  <tt class="py-line">    <tt class="py-name">phase</tt> <tt class="py-op">=</tt> <tt id="link-205" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-205', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-206" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-206', 'HOOKS_PHASE_POST', 'link-74');">HOOKS_PHASE_POST</a></tt> </tt>
<a name="L623"></a><tt class="py-lineno">623</tt>  <tt class="py-line">    <tt class="py-name">hpath</tt> <tt class="py-op">=</tt> <tt id="link-207" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-207', 'constants', 'link-3');">constants</a></tt><tt class="py-op">.</tt><tt id="link-208" class="py-name" targets="Variable ganeti.constants.HOOKS_NAME_CFGUPDATE=ganeti.constants-module.html#HOOKS_NAME_CFGUPDATE"><a title="ganeti.constants.HOOKS_NAME_CFGUPDATE" class="py-name" href="#" onclick="return doclink('link-208', 'HOOKS_NAME_CFGUPDATE', 'link-208');">HOOKS_NAME_CFGUPDATE</a></tt> </tt>
<a name="L624"></a><tt class="py-lineno">624</tt>  <tt class="py-line">    <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-209" class="py-name"><a title="ganeti.config.ConfigWriter.GetMasterNode
ganeti.ssconf.SimpleConfigReader.GetMasterNode
ganeti.ssconf.SimpleStore.GetMasterNode" class="py-name" href="#" onclick="return doclink('link-209', 'GetMasterNode', 'link-176');">GetMasterNode</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt> </tt>
<a name="L625"></a><tt class="py-lineno">625</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-210" class="py-name"><a title="ganeti.mcpu.HooksMaster._RunWrapper" class="py-name" href="#" onclick="return doclink('link-210', '_RunWrapper', 'link-183');">_RunWrapper</a></tt><tt class="py-op">(</tt><tt class="py-name">nodes</tt><tt class="py-op">,</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L626"></a><tt class="py-lineno">626</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Jul 24 16:51:33 2012
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
