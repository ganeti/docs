<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.MaintD.HandleIncidents</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-MaintD-HandleIncidents.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/MaintD/HandleIncidents.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Ganeti.MaintD.HandleIncidents</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Incident handling in the maintenance daemon.
</p><p>This module implements the submission of actions for ongoing
repair events reported by the node-status data collector.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:moreSevereIncident">moreSevereIncident</a> :: <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a></li><li class="src short"><a href="#v:rankIncidents">rankIncidents</a> :: [<a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a>] -&gt; Map String <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a></li><li class="src short"><a href="#v:drainJob">drainJob</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]</li><li class="src short"><a href="#v:handleEvacuation">handleEvacuation</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a> -&gt; Bool -&gt; Set Int -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)</li><li class="src short"><a href="#v:handleLiveRepairs">handleLiveRepairs</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a> -&gt; Set Int -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)</li><li class="src short"><a href="#v:handleIncident">handleIncident</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; Set Int -&gt; (String, <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a>) -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)</li><li class="src short"><a href="#v:handleIncidents">handleIncidents</a> :: IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:moreSevereIncident" class="def">moreSevereIncident</a> :: <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a><a href="Ganeti/MaintD/HandleIncidents.html#moreSevereIncident" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:rankIncidents" class="def">rankIncidents</a> :: [<a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a>] -&gt; Map String <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a><a href="Ganeti/MaintD/HandleIncidents.html#rankIncidents" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:drainJob" class="def">drainJob</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]<a href="Ganeti/MaintD/HandleIncidents.html#drainJob" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:handleEvacuation" class="def">handleEvacuation</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a> -&gt; Bool -&gt; Set Int -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)<a href="Ganeti/MaintD/HandleIncidents.html#handleEvacuation" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:handleLiveRepairs" class="def">handleLiveRepairs</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a> -&gt; Set Int -&gt; <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a> -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)<a href="Ganeti/MaintD/HandleIncidents.html#handleLiveRepairs" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:handleIncident" class="def">handleIncident</a> :: <a href="Ganeti-UDSServer.html#t:Client">Client</a> -&gt; IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; Set Int -&gt; (String, <a href="Ganeti-Objects-Maintenance.html#t:Incident">Incident</a>) -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)<a href="Ganeti/MaintD/HandleIncidents.html#handleIncident" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:handleIncidents" class="def">handleIncidents</a> :: IORef <a href="Ganeti-MaintD-MemoryState.html#t:MemoryState">MemoryState</a> -&gt; (<a href="Ganeti-HTools-Group.html#t:List">List</a>, <a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>) -&gt; <a href="Ganeti-BasicTypes.html#t:ResultT">ResultT</a> String IO (Set Int)<a href="Ganeti/MaintD/HandleIncidents.html#handleIncidents" class="link">Source</a></p><div class="doc"><p>Submit the jobs necessary for the next maintenance step
 for each pending maintenance, i.e., the most radical maintenance
 for each node. Return the set of node indices unaffected by these
 operations. Also, for each job submitted, register it directly.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>