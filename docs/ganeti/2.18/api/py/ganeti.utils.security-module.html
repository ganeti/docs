<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ganeti.utils.security</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ganeti-module.html">Package&nbsp;ganeti</a> ::
        <a href="ganeti.utils-module.html">Package&nbsp;utils</a> ::
        Module&nbsp;security
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ganeti.utils.security-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module security</h1><p class="nomargin-top"><span class="codelink"><a href="ganeti.utils.security-pysrc.html">source&nbsp;code</a></span></p>
<p>Utility functions for security features of Ganeti.</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="UuidToInt"></a><span class="summary-sig-name">UuidToInt</span>(<span class="summary-sig-arg">uuid</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#UuidToInt">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="GetCertificateDigest"></a><span class="summary-sig-name">GetCertificateDigest</span>(<span class="summary-sig-arg">cert_filename</span>=<span class="summary-sig-default">pathutils.NODED_CLIENT_CERT_FILE</span>)</span><br />
      Reads the SSL certificate and returns the sha1 digest.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#GetCertificateDigest">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.security-module.html#GenerateNewSslCert" class="summary-sig-name">GenerateNewSslCert</a>(<span class="summary-sig-arg">new_cert</span>,
        <span class="summary-sig-arg">cert_filename</span>,
        <span class="summary-sig-arg">serial_no</span>,
        <span class="summary-sig-arg">log_msg</span>,
        <span class="summary-sig-arg">uid</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">gid</span>=<span class="summary-sig-default">-1</span>)</span><br />
      Creates a new server SSL certificate and backups the old one.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#GenerateNewSslCert">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.security-module.html#GenerateNewClientSslCert" class="summary-sig-name">GenerateNewClientSslCert</a>(<span class="summary-sig-arg">cert_filename</span>,
        <span class="summary-sig-arg">signing_cert_filename</span>,
        <span class="summary-sig-arg">hostname</span>)</span><br />
      Creates a new server SSL certificate and backups the old one.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#GenerateNewClientSslCert">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.security-module.html#VerifyCertificate" class="summary-sig-name">VerifyCertificate</a>(<span class="summary-sig-arg">filename</span>)</span><br />
      Verifies a SSL certificate.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#VerifyCertificate">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.security-module.html#IsCertificateSelfSigned" class="summary-sig-name">IsCertificateSelfSigned</a>(<span class="summary-sig-arg">cert_filename</span>)</span><br />
      Checks whether the certificate issuer is the same as the owner.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.security-pysrc.html#IsCertificateSelfSigned">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="logging">logging</span>,
  <span title="OpenSSL">OpenSSL</span>,
  <span title="os">os</span>,
  <span title="uuid">uuid_module</span>,
  <span title="time">time</span>,
  <span title="ganeti.utils.io">io</span>,
  <span title="ganeti.utils.x509">x509</span>,
  <a href="ganeti.constants-module.html" title="ganeti.constants">constants</a>,
  <a href="ganeti.errors-module.html" title="ganeti.errors">errors</a>,
  <a href="ganeti.pathutils-module.html" title="ganeti.pathutils">pathutils</a>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="GenerateNewSslCert"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">GenerateNewSslCert</span>(<span class="sig-arg">new_cert</span>,
        <span class="sig-arg">cert_filename</span>,
        <span class="sig-arg">serial_no</span>,
        <span class="sig-arg">log_msg</span>,
        <span class="sig-arg">uid</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">gid</span>=<span class="sig-default">-1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.security-pysrc.html#GenerateNewSslCert">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Creates a new server SSL certificate and backups the old one.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>new_cert</code></strong> (boolean) - whether a new certificate should be created</li>
        <li><strong class="pname"><code>cert_filename</code></strong> (string) - filename of the certificate file</li>
        <li><strong class="pname"><code>serial_no</code></strong> (int) - serial number of the certificate</li>
        <li><strong class="pname"><code>log_msg</code></strong> (string) - log message to be written on certificate creation</li>
        <li><strong class="pname"><code>uid</code></strong> (int) - the user ID of the user who will be owner of the certificate file</li>
        <li><strong class="pname"><code>gid</code></strong> (int) - the group ID of the group who will own the certificate file</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="GenerateNewClientSslCert"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">GenerateNewClientSslCert</span>(<span class="sig-arg">cert_filename</span>,
        <span class="sig-arg">signing_cert_filename</span>,
        <span class="sig-arg">hostname</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.security-pysrc.html#GenerateNewClientSslCert">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Creates a new server SSL certificate and backups the old one.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>cert_filename</code></strong> (string) - filename of the certificate file</li>
        <li><strong class="pname"><code>signing_cert_filename</code></strong> (string) - name of the certificate to be used for signing</li>
        <li><strong class="pname"><code>hostname</code></strong> (string) - name of the machine whose cert is created</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="VerifyCertificate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">VerifyCertificate</span>(<span class="sig-arg">filename</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.security-pysrc.html#VerifyCertificate">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Verifies a SSL certificate.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>filename</code></strong> (string) - Path to PEM file</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="IsCertificateSelfSigned"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">IsCertificateSelfSigned</span>(<span class="sig-arg">cert_filename</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.security-pysrc.html#IsCertificateSelfSigned">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Checks whether the certificate issuer is the same as the owner.</p>
  <p>Note that this does not actually verify the signature, it simply 
  compares the certificates common name and the issuer's common name. This 
  is sufficient, because now that Ganeti started creating non-self-signed 
  client-certificates, it uses their hostnames as common names and thus 
  they are distinguishable by common name from the server certificates.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>cert_filename</code></strong> (string) - filename of the certificate to examine</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Fri Mar 11 11:23:32 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
