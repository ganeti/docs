<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.THH</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-THH.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/THH.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.THH</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Exported types
</a></li><li><a href="#g:2">Internal types
</a></li><li><a href="#g:3">Helper functions
</a></li><li><a href="#g:4">Template code for simple raw type-equivalent ADTs
</a></li><li><a href="#g:5">Template code for opcodes
</a></li><li><a href="#g:6">Python code generation
</a></li><li><a href="#g:7">Template code for luxi
</a></li><li><a href="#g:8"><a href="Objects.html">Objects</a> functionality
</a></li><li><a href="#g:9">Inheritable parameter tables implementation
</a></li><li><a href="#g:10">Template code for exceptions
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>TemplateHaskell helper for Ganeti Haskell code.
</p><p>As TemplateHaskell require that splices be defined in a separate
module, we combine all the TemplateHaskell functionality that HTools
needs in this module (except the one for unittests).
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:OptionalType">OptionalType</a> <ul class="subs"><li>= <a href="#v:NotOptional">NotOptional</a>  </li><li>| <a href="#v:OptionalOmitNull">OptionalOmitNull</a>  </li><li>| <a href="#v:OptionalSerializeNull">OptionalSerializeNull</a>  </li><li>| <a href="#v:AndRestArguments">AndRestArguments</a>  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Field">Field</a>  = <a href="#v:Field">Field</a> {<ul class="subs"><li><a href="#v:fieldName">fieldName</a> :: String</li><li><a href="#v:fieldType">fieldType</a> :: Q Type</li><li><a href="#v:fieldRead">fieldRead</a> :: Maybe (Q Exp)</li><li><a href="#v:fieldShow">fieldShow</a> :: Maybe (Q Exp)</li><li><a href="#v:fieldExtraKeys">fieldExtraKeys</a> :: [String]</li><li><a href="#v:fieldDefault">fieldDefault</a> :: Maybe (Q Exp)</li><li><a href="#v:fieldSerializeDefault">fieldSerializeDefault</a> :: Bool</li><li><a href="#v:fieldConstr">fieldConstr</a> :: Maybe String</li><li><a href="#v:fieldIsOptional">fieldIsOptional</a> :: <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a></li><li><a href="#v:fieldDoc">fieldDoc</a> :: String</li></ul>}</li><li class="src short"><a href="#v:simpleField">simpleField</a> :: String -&gt; Q Type -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:andRestArguments">andRestArguments</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:withDoc">withDoc</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:renameField">renameField</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:defaultField">defaultField</a> :: Q Exp -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:notSerializeDefaultField">notSerializeDefaultField</a> :: Q Exp -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:optionalField">optionalField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:optionalNullSerField">optionalNullSerField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:customField">customField</a> :: Name -&gt; Name -&gt; [String] -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a></li><li class="src short"><a href="#v:fieldRecordName">fieldRecordName</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; String</li><li class="src short"><a href="#v:fieldVariable">fieldVariable</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; String</li><li class="src short"><a href="#v:actualFieldType">actualFieldType</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Type</li><li class="src short"><a href="#v:checkNonOptDef">checkNonOptDef</a> :: Monad m =&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; m ()</li><li class="src short"><a href="#v:parseFn">parseFn</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp</li><li class="src short"><a href="#v:loadFn">loadFn</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp</li><li class="src short"><a href="#v:loadFnOpt">loadFnOpt</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp</li><li class="src short"><span class="keyword">type</span> <a href="#t:SimpleField">SimpleField</a> = (String, Q Type)</li><li class="src short"><span class="keyword">type</span> <a href="#t:SimpleConstructor">SimpleConstructor</a> = (String, [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>])</li><li class="src short"><span class="keyword">type</span> <a href="#t:SimpleObject">SimpleObject</a> = [<a href="Ganeti-THH.html#t:SimpleConstructor">SimpleConstructor</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:OpCodeConstructor">OpCodeConstructor</a> = (String, Q Type, String, [<a href="Ganeti-THH.html#t:Field">Field</a>], String)</li><li class="src short"><span class="keyword">type</span> <a href="#t:LuxiConstructor">LuxiConstructor</a> = (String, [<a href="Ganeti-THH.html#t:Field">Field</a>])</li><li class="src short"><a href="#v:ensureLower">ensureLower</a> :: String -&gt; String</li><li class="src short"><a href="#v:ensureUpper">ensureUpper</a> :: String -&gt; String</li><li class="src short"><a href="#v:varNameE">varNameE</a> :: String -&gt; Q Exp</li><li class="src short"><a href="#v:showJSONE">showJSONE</a> :: Q Exp</li><li class="src short"><a href="#v:makeObjE">makeObjE</a> :: Q Exp</li><li class="src short"><a href="#v:fromObjE">fromObjE</a> :: Q Exp</li><li class="src short"><a href="#v:toRawName">toRawName</a> :: String -&gt; Name</li><li class="src short"><a href="#v:fromRawName">fromRawName</a> :: String -&gt; Name</li><li class="src short"><a href="#v:reprE">reprE</a> :: Either String Name -&gt; Q Exp</li><li class="src short"><a href="#v:appFn">appFn</a> :: Exp -&gt; Exp -&gt; Exp</li><li class="src short"><a href="#v:appCons">appCons</a> :: Name -&gt; [Exp] -&gt; Exp</li><li class="src short"><a href="#v:appConsApp">appConsApp</a> :: Name -&gt; [Exp] -&gt; Exp</li><li class="src short"><a href="#v:buildConsField">buildConsField</a> :: Q Type -&gt; StrictTypeQ</li><li class="src short"><a href="#v:buildSimpleCons">buildSimpleCons</a> :: Name -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; Q Dec</li><li class="src short"><a href="#v:genSaveSimpleObj">genSaveSimpleObj</a> :: Name -&gt; String -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; (<a href="Ganeti-THH.html#t:SimpleConstructor">SimpleConstructor</a> -&gt; Q Clause) -&gt; Q (Dec, Dec)</li><li class="src short"><a href="#v:strADTDecl">strADTDecl</a> :: Name -&gt; [String] -&gt; Dec</li><li class="src short"><a href="#v:genToRaw">genToRaw</a> :: Name -&gt; Name -&gt; Name -&gt; [(String, Either String Name)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:genFromRaw">genFromRaw</a> :: Name -&gt; Name -&gt; Name -&gt; [(String, Either String Name)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:declareADT">declareADT</a> ::  (a -&gt; Either String Name) -&gt; Name -&gt; String -&gt; [(String, a)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:declareLADT">declareLADT</a> :: Name -&gt; String -&gt; [(String, String)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:declareILADT">declareILADT</a> :: String -&gt; [(String, Int)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:declareIADT">declareIADT</a> :: String -&gt; [(String, Name)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:declareSADT">declareSADT</a> :: String -&gt; [(String, Name)] -&gt; Q [Dec]</li><li class="src short"><a href="#v:genShowJSON">genShowJSON</a> :: String -&gt; Q Dec</li><li class="src short"><a href="#v:genReadJSON">genReadJSON</a> :: String -&gt; Q Dec</li><li class="src short"><a href="#v:makeJSONInstance">makeJSONInstance</a> :: Name -&gt; Q [Dec]</li><li class="src short"><a href="#v:deCamelCase">deCamelCase</a> :: String -&gt; String</li><li class="src short"><a href="#v:camelCase">camelCase</a> :: String -&gt; String</li><li class="src short"><a href="#v:constructorName">constructorName</a> :: Con -&gt; Q Name</li><li class="src short"><a href="#v:reifyConsNames">reifyConsNames</a> :: Name -&gt; Q [String]</li><li class="src short"><a href="#v:genConstrToStr">genConstrToStr</a> :: (String -&gt; Q String) -&gt; Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genOpID">genOpID</a> :: Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genOpLowerStrip">genOpLowerStrip</a> :: String -&gt; Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genAllConstr">genAllConstr</a> :: (String -&gt; String) -&gt; Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genAllOpIDs">genAllOpIDs</a> :: Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><span class="keyword">type</span> <a href="#t:OpParam">OpParam</a> = (String, Q Type, Q Exp)</li><li class="src short"><span class="keyword">data</span>  <a href="#t:OpCodeField">OpCodeField</a>  = <a href="#v:OpCodeField">OpCodeField</a> {<ul class="subs"><li><a href="#v:ocfName">ocfName</a> :: String</li><li><a href="#v:ocfType">ocfType</a> :: <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></li><li><a href="#v:ocfDefl">ocfDefl</a> :: Maybe <a href="Ganeti-PyValue.html#t:PyValueEx">PyValueEx</a></li><li><a href="#v:ocfDoc">ocfDoc</a> :: String</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:OpCodeDescriptor">OpCodeDescriptor</a>  = <a href="#v:OpCodeDescriptor">OpCodeDescriptor</a> {<ul class="subs"><li><a href="#v:ocdName">ocdName</a> :: String</li><li><a href="#v:ocdType">ocdType</a> :: <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></li><li><a href="#v:ocdDoc">ocdDoc</a> :: String</li><li><a href="#v:ocdFields">ocdFields</a> :: [<a href="Ganeti-THH.html#t:OpCodeField">OpCodeField</a>]</li><li><a href="#v:ocdDescr">ocdDescr</a> :: String</li></ul>}</li><li class="src short"><a href="#v:maybeApp">maybeApp</a> :: Maybe (Q Exp) -&gt; Q Type -&gt; Q Exp</li><li class="src short"><a href="#v:genPyType-39-">genPyType'</a> :: <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a> -&gt; Q Type -&gt; Q <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></li><li class="src short"><a href="#v:genPyType">genPyType</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></li><li class="src short"><a href="#v:genPyDefault">genPyDefault</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:pyField">pyField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:pyClass">pyClass</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; Q Exp</li><li class="src short"><a href="#v:pyClasses">pyClasses</a> :: [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:opcodeConsToLuxiCons">opcodeConsToLuxiCons</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a></li><li class="src short"><a href="#v:genOpCodeDictObject">genOpCodeDictObject</a> :: Name -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause) -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp) -&gt; [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:genOpCode">genOpCode</a> :: String -&gt; [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:genOpConsFields">genOpConsFields</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; Clause</li><li class="src short"><a href="#v:genAllOpFields">genAllOpFields</a> :: String -&gt; [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>] -&gt; (Dec, Dec)</li><li class="src short"><a href="#v:saveConstructor">saveConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause</li><li class="src short"><a href="#v:genSaveOpCode">genSaveOpCode</a> :: [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause) -&gt; Q [Clause]</li><li class="src short"><a href="#v:loadConstructor">loadConstructor</a> :: Name -&gt; (<a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp</li><li class="src short"><a href="#v:loadOpConstructor">loadOpConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp</li><li class="src short"><a href="#v:genLoadOpCode">genLoadOpCode</a> :: [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp) -&gt; Q [Clause]</li><li class="src short"><a href="#v:genStrOfOp">genStrOfOp</a> :: Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genStrOfKey">genStrOfKey</a> :: Name -&gt; String -&gt; Q [Dec]</li><li class="src short"><a href="#v:genLuxiOp">genLuxiOp</a> :: String -&gt; [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:saveLuxiConstructor">saveLuxiConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause</li><li class="src short"><a href="#v:fieldTypeInfo">fieldTypeInfo</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q (Name, Strict, Type)</li><li class="src short"><a href="#v:buildObject">buildObject</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:buildObjectSerialisation">buildObjectSerialisation</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:objVarName">objVarName</a> :: Name</li><li class="src short"><a href="#v:defaultToJSArray">defaultToJSArray</a> :: <a href="Ganeti-JSON.html#t:DictObject">DictObject</a> a =&gt; [String] -&gt; a -&gt; [JSValue]</li><li class="src short"><a href="#v:defaultFromJSArray">defaultFromJSArray</a> :: <a href="Ganeti-JSON.html#t:DictObject">DictObject</a> a =&gt; [String] -&gt; [JSValue] -&gt; Result a</li><li class="src short"><a href="#v:genArrayObjectInstance">genArrayObjectInstance</a> :: Name -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Dec</li><li class="src short"><a href="#v:genDictObject">genDictObject</a> :: (Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; (<a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:genSaveObject">genSaveObject</a> :: String -&gt; Q [Dec]</li><li class="src short"><a href="#v:saveObjectField">saveObjectField</a> :: Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:objectShowJSON">objectShowJSON</a> :: String -&gt; Q Dec</li><li class="src short"><a href="#v:genLoadObject">genLoadObject</a> :: String -&gt; Q (Dec, Dec)</li><li class="src short"><a href="#v:loadObjectField">loadObjectField</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:fieldDictKeys">fieldDictKeys</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Exp</li><li class="src short"><a href="#v:fieldsDictKeys">fieldsDictKeys</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Exp</li><li class="src short"><a href="#v:fieldsDictKeysQ">fieldsDictKeysQ</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp</li><li class="src short"><a href="#v:fieldsUsedKeysQ">fieldsUsedKeysQ</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp</li><li class="src short"><a href="#v:objectReadJSON">objectReadJSON</a> :: String -&gt; Q Dec</li><li class="src short"><a href="#v:paramTypeNames">paramTypeNames</a> :: String -&gt; (String, String)</li><li class="src short"><a href="#v:paramFieldTypeInfo">paramFieldTypeInfo</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q (Name, Strict, Type)</li><li class="src short"><a href="#v:buildParam">buildParam</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:buildParamAllFields">buildParamAllFields</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; [Dec]</li><li class="src short"><a href="#v:buildPParamSerialisation">buildPParamSerialisation</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:savePParamField">savePParamField</a> :: Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:loadPParamField">loadPParamField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp</li><li class="src short"><a href="#v:buildFromMaybe">buildFromMaybe</a> :: String -&gt; Q Dec</li><li class="src short"><a href="#v:fillParam">fillParam</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]</li><li class="src short"><a href="#v:excErrMsg">excErrMsg</a> :: (String, Q Type)</li><li class="src short"><a href="#v:genException">genException</a> :: String -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; Q [Dec]</li><li class="src short"><a href="#v:saveExcCons">saveExcCons</a> :: String -&gt; [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>] -&gt; Q Clause</li><li class="src short"><a href="#v:loadExcConstructor">loadExcConstructor</a> :: Name -&gt; String -&gt; [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>] -&gt; Q Exp</li><li class="src short"><a href="#v:genLoadExc">genLoadExc</a> :: Name -&gt; String -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; Q (Dec, Dec)</li></ul></div><div id="interface"><h1 id="g:1">Exported types
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:OptionalType" class="def">OptionalType</a>  <a href="Ganeti/THH.html#OptionalType" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:NotOptional" class="def">NotOptional</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OptionalOmitNull" class="def">OptionalOmitNull</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OptionalSerializeNull" class="def">OptionalSerializeNull</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:AndRestArguments" class="def">AndRestArguments</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:OptionalType" class="caption collapser" onclick="toggleSection('i:OptionalType')">Instances</p><div id="section.i:OptionalType" class="show"><table><tr><td class="src">Eq <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Field" class="def">Field</a>  <a href="Ganeti/THH.html#Field" class="link">Source</a></p><div class="doc"><p>Serialised field data type describing how to generate code for the field.
 Each field has a type, which isn't captured in the type of the data type,
 but is saved in the <code>Q</code> monad in <code><a href="Ganeti-THH.html#v:fieldType">fieldType</a></code>.
</p><p>Let <code>t</code> be a type we want to parametrize the field with. There are the
 following possible types of fields:
</p><dl><dt>Mandatory with no default.</dt><dd> Then <code>fieldType</code> holds <code>t</code>,
     <code>fieldDefault = Nothing</code> and <code>fieldIsOptional = NotOptional</code>.
</dd><dt>Field with a default value.</dt><dd> Then <code>fieldType</code> holds <code>t</code> and
     <code>fieldDefault = Just exp</code> where <code>exp</code> is an expression of type <code>t</code> and
    <code>fieldIsOptional = NotOptional</code>.
</dd><dt>Optional, no default value.</dt><dd> Then <code>fieldType</code> holds <code>Maybe t</code>,
     <code>fieldDefault = Nothing</code> and <code>fieldIsOptional</code> is either
     <code>OptionalOmitNull</code> or <code>OptionalSerializeNull</code>.
</dd></dl><p>Optional fields with a default value are prohibited, as their main
 intention is to represent the information that a request didn't contain
 the field data.
</p><p><em>Custom (de)serialization:</em>
 Field can have custom (de)serialization functions that are stored in
 <code><a href="Ganeti-THH.html#v:fieldRead">fieldRead</a></code> and <code><a href="Ganeti-THH.html#v:fieldShow">fieldShow</a></code>. If they aren't provided, the default is to use
 <code>readJSON</code> and <code>showJSON</code> for the field's type <code>t</code>. If they are provided,
 the type of the contained deserializing expression must be
</p><pre>
   [(String, JSON.JSValue)] -&gt; JSON.JSValue -&gt; JSON.Result t
</pre><p>where the first argument carries the whole record in the case the
 deserializing function needs to process additional information.
</p><p>The type of the contained serializing experssion must be
</p><pre>
   t -&gt; (JSON.JSValue, [(String, JSON.JSValue)])
</pre><p>where the result can provide extra JSON fields to include in the output
 record (or just return <code>[]</code> if they're not needed).
</p><p>Note that for optional fields the type appearing in the custom functions
 is still <code>t</code>. Therefore making a field optional doesn't change the
 functions.
</p><p>There is also a special type of optional field <code>AndRestArguments</code> which
 allows to parse any additional arguments not covered by other fields. There
 can be at most one such special field and it's type must be
 <code>Map String JSON.JSValue</code>. See also <code><a href="Ganeti-THH.html#v:andRestArguments">andRestArguments</a></code>.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Field" class="def">Field</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:fieldName" class="def">fieldName</a> :: String</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:fieldType" class="def">fieldType</a> :: Q Type</dt><dd class="doc"><p>the type of the field, <code>t</code> for non-optional fields,
 <code>Maybe t</code> for optional ones.
</p></dd><dt class="src"><a name="v:fieldRead" class="def">fieldRead</a> :: Maybe (Q Exp)</dt><dd class="doc"><p>an optional custom deserialization function of type
 <code>[(String, JSON.JSValue)] -&gt; JSON.JSValue -&gt;
 JSON.Result t</code>
</p></dd><dt class="src"><a name="v:fieldShow" class="def">fieldShow</a> :: Maybe (Q Exp)</dt><dd class="doc"><p>an optional custom serialization function of type
 <code>t -&gt; (JSON.JSValue, [(String, JSON.JSValue)])</code>
</p></dd><dt class="src"><a name="v:fieldExtraKeys" class="def">fieldExtraKeys</a> :: [String]</dt><dd class="doc"><p>a list of extra keys added by <code><a href="Ganeti-THH.html#v:fieldShow">fieldShow</a></code>
</p></dd><dt class="src"><a name="v:fieldDefault" class="def">fieldDefault</a> :: Maybe (Q Exp)</dt><dd class="doc"><p>an optional default value of type <code>t</code>
</p></dd><dt class="src"><a name="v:fieldSerializeDefault" class="def">fieldSerializeDefault</a> :: Bool</dt><dd class="doc"><p>whether not presented default value will be
 serialized
</p></dd><dt class="src"><a name="v:fieldConstr" class="def">fieldConstr</a> :: Maybe String</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:fieldIsOptional" class="def">fieldIsOptional</a> :: <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a></dt><dd class="doc"><p>determines if a field is optional, and if yes,
 how
</p></dd><dt class="src"><a name="v:fieldDoc" class="def">fieldDoc</a> :: String</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><a name="v:simpleField" class="def">simpleField</a> :: String -&gt; Q Type -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#simpleField" class="link">Source</a></p><div class="doc"><p>Generates a simple field.
</p></div></div><div class="top"><p class="src"><a name="v:andRestArguments" class="def">andRestArguments</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#andRestArguments" class="link">Source</a></p><div class="doc"><p>Generate an AndRestArguments catch-all field.
</p></div></div><div class="top"><p class="src"><a name="v:withDoc" class="def">withDoc</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#withDoc" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:renameField" class="def">renameField</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#renameField" class="link">Source</a></p><div class="doc"><p>Sets the renamed constructor field.
</p></div></div><div class="top"><p class="src"><a name="v:defaultField" class="def">defaultField</a> :: Q Exp -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#defaultField" class="link">Source</a></p><div class="doc"><p>Sets the default value on a field (makes it optional with a
 default value).
</p></div></div><div class="top"><p class="src"><a name="v:notSerializeDefaultField" class="def">notSerializeDefaultField</a> :: Q Exp -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#notSerializeDefaultField" class="link">Source</a></p><div class="doc"><p>A defaultField which will be serialized only if it's value differs from
 a default value.
</p></div></div><div class="top"><p class="src"><a name="v:optionalField" class="def">optionalField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#optionalField" class="link">Source</a></p><div class="doc"><p>Marks a field optional (turning its base type into a Maybe).
</p></div></div><div class="top"><p class="src"><a name="v:optionalNullSerField" class="def">optionalNullSerField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; <a href="Ganeti-THH.html#t:Field">Field</a><a href="Ganeti/THH.html#optionalNullSerField" class="link">Source</a></p><div class="doc"><p>Marks a field optional (turning its base type into a Maybe), but
 with <code>Nothing</code> serialised explicitly as <em>null</em>.
</p></div></div><div class="top"><p class="src"><a name="v:customField" class="def">customField</a><a href="Ganeti/THH.html#customField" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Name</td><td class="doc"><p>The name of the read function
</p></td></tr><tr><td class="src">-&gt; Name</td><td class="doc"><p>The name of the show function
</p></td></tr><tr><td class="src">-&gt; [String]</td><td class="doc"><p>The name of extra field keys
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-THH.html#t:Field">Field</a></td><td class="doc"><p>The original field
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-THH.html#t:Field">Field</a></td><td class="doc"><p>Updated field
</p></td></tr></table></div><div class="doc"><p>Sets custom functions on a field.
</p></div></div><div class="top"><p class="src"><a name="v:fieldRecordName" class="def">fieldRecordName</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; String<a href="Ganeti/THH.html#fieldRecordName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fieldVariable" class="def">fieldVariable</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; String<a href="Ganeti/THH.html#fieldVariable" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:actualFieldType" class="def">actualFieldType</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Type<a href="Ganeti/THH.html#actualFieldType" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:checkNonOptDef" class="def">checkNonOptDef</a> :: Monad m =&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; m ()<a href="Ganeti/THH.html#checkNonOptDef" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:parseFn" class="def">parseFn</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp<a href="Ganeti/THH.html#parseFn" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadFn" class="def">loadFn</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp<a href="Ganeti/THH.html#loadFn" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadFnOpt" class="def">loadFnOpt</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp<a href="Ganeti/THH.html#loadFnOpt" class="link">Source</a></p></div><h1 id="g:2">Internal types
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SimpleField" class="def">SimpleField</a> = (String, Q Type)<a href="Ganeti/THH.html#SimpleField" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SimpleConstructor" class="def">SimpleConstructor</a> = (String, [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>])<a href="Ganeti/THH.html#SimpleConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SimpleObject" class="def">SimpleObject</a> = [<a href="Ganeti-THH.html#t:SimpleConstructor">SimpleConstructor</a>]<a href="Ganeti/THH.html#SimpleObject" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:OpCodeConstructor" class="def">OpCodeConstructor</a> = (String, Q Type, String, [<a href="Ganeti-THH.html#t:Field">Field</a>], String)<a href="Ganeti/THH.html#OpCodeConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:LuxiConstructor" class="def">LuxiConstructor</a> = (String, [<a href="Ganeti-THH.html#t:Field">Field</a>])<a href="Ganeti/THH.html#LuxiConstructor" class="link">Source</a></p></div><h1 id="g:3">Helper functions
</h1><div class="top"><p class="src"><a name="v:ensureLower" class="def">ensureLower</a> :: String -&gt; String<a href="Ganeti/THH.html#ensureLower" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:ensureUpper" class="def">ensureUpper</a> :: String -&gt; String<a href="Ganeti/THH.html#ensureUpper" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:varNameE" class="def">varNameE</a> :: String -&gt; Q Exp<a href="Ganeti/THH.html#varNameE" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:showJSONE" class="def">showJSONE</a> :: Q Exp<a href="Ganeti/THH.html#showJSONE" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:makeObjE" class="def">makeObjE</a> :: Q Exp<a href="Ganeti/THH.html#makeObjE" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fromObjE" class="def">fromObjE</a> :: Q Exp<a href="Ganeti/THH.html#fromObjE" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:toRawName" class="def">toRawName</a> :: String -&gt; Name<a href="Ganeti/THH.html#toRawName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fromRawName" class="def">fromRawName</a> :: String -&gt; Name<a href="Ganeti/THH.html#fromRawName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:reprE" class="def">reprE</a> :: Either String Name -&gt; Q Exp<a href="Ganeti/THH.html#reprE" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:appFn" class="def">appFn</a> :: Exp -&gt; Exp -&gt; Exp<a href="Ganeti/THH.html#appFn" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:appCons" class="def">appCons</a> :: Name -&gt; [Exp] -&gt; Exp<a href="Ganeti/THH.html#appCons" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:appConsApp" class="def">appConsApp</a> :: Name -&gt; [Exp] -&gt; Exp<a href="Ganeti/THH.html#appConsApp" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildConsField" class="def">buildConsField</a> :: Q Type -&gt; StrictTypeQ<a href="Ganeti/THH.html#buildConsField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildSimpleCons" class="def">buildSimpleCons</a> :: Name -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; Q Dec<a href="Ganeti/THH.html#buildSimpleCons" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genSaveSimpleObj" class="def">genSaveSimpleObj</a> :: Name -&gt; String -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; (<a href="Ganeti-THH.html#t:SimpleConstructor">SimpleConstructor</a> -&gt; Q Clause) -&gt; Q (Dec, Dec)<a href="Ganeti/THH.html#genSaveSimpleObj" class="link">Source</a></p></div><h1 id="g:4">Template code for simple raw type-equivalent ADTs
</h1><div class="top"><p class="src"><a name="v:strADTDecl" class="def">strADTDecl</a> :: Name -&gt; [String] -&gt; Dec<a href="Ganeti/THH.html#strADTDecl" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genToRaw" class="def">genToRaw</a> :: Name -&gt; Name -&gt; Name -&gt; [(String, Either String Name)] -&gt; Q [Dec]<a href="Ganeti/THH.html#genToRaw" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genFromRaw" class="def">genFromRaw</a> :: Name -&gt; Name -&gt; Name -&gt; [(String, Either String Name)] -&gt; Q [Dec]<a href="Ganeti/THH.html#genFromRaw" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:declareADT" class="def">declareADT</a> ::  (a -&gt; Either String Name) -&gt; Name -&gt; String -&gt; [(String, a)] -&gt; Q [Dec]<a href="Ganeti/THH.html#declareADT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:declareLADT" class="def">declareLADT</a> :: Name -&gt; String -&gt; [(String, String)] -&gt; Q [Dec]<a href="Ganeti/THH.html#declareLADT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:declareILADT" class="def">declareILADT</a> :: String -&gt; [(String, Int)] -&gt; Q [Dec]<a href="Ganeti/THH.html#declareILADT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:declareIADT" class="def">declareIADT</a> :: String -&gt; [(String, Name)] -&gt; Q [Dec]<a href="Ganeti/THH.html#declareIADT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:declareSADT" class="def">declareSADT</a> :: String -&gt; [(String, Name)] -&gt; Q [Dec]<a href="Ganeti/THH.html#declareSADT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genShowJSON" class="def">genShowJSON</a> :: String -&gt; Q Dec<a href="Ganeti/THH.html#genShowJSON" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genReadJSON" class="def">genReadJSON</a> :: String -&gt; Q Dec<a href="Ganeti/THH.html#genReadJSON" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:makeJSONInstance" class="def">makeJSONInstance</a> :: Name -&gt; Q [Dec]<a href="Ganeti/THH.html#makeJSONInstance" class="link">Source</a></p><div class="doc"><p>Generates a JSON instance for a given type.
</p><p>This assumes that the <em>name</em>ToRaw and <em>name</em>FromRaw functions
 have been defined as by the <code><a href="Ganeti-THH.html#v:declareSADT">declareSADT</a></code> function.
</p></div></div><h1 id="g:5">Template code for opcodes
</h1><div class="top"><p class="src"><a name="v:deCamelCase" class="def">deCamelCase</a> :: String -&gt; String<a href="Ganeti/THH.html#deCamelCase" class="link">Source</a></p><div class="doc"><p>Transforms a CamelCase string into an_underscore_based_one.
</p></div></div><div class="top"><p class="src"><a name="v:camelCase" class="def">camelCase</a> :: String -&gt; String<a href="Ganeti/THH.html#camelCase" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:constructorName" class="def">constructorName</a> :: Con -&gt; Q Name<a href="Ganeti/THH.html#constructorName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:reifyConsNames" class="def">reifyConsNames</a> :: Name -&gt; Q [String]<a href="Ganeti/THH.html#reifyConsNames" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genConstrToStr" class="def">genConstrToStr</a> :: (String -&gt; Q String) -&gt; Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genConstrToStr" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genOpID" class="def">genOpID</a> :: Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genOpID" class="link">Source</a></p><div class="doc"><p>Constructor-to-string for OpCode.
</p></div></div><div class="top"><p class="src"><a name="v:genOpLowerStrip" class="def">genOpLowerStrip</a> :: String -&gt; Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genOpLowerStrip" class="link">Source</a></p><div class="doc"><p>Strips <code>Op</code> from the constructor name, converts to lower-case
 and adds a given prefix.
</p></div></div><div class="top"><p class="src"><a name="v:genAllConstr" class="def">genAllConstr</a> :: (String -&gt; String) -&gt; Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genAllConstr" class="link">Source</a></p><div class="doc"><p>Builds a list with all defined constructor names for a type.
</p><pre>
 vstr :: String
 vstr = [...]
</pre><p>Where the actual values of the string are the constructor names
 mapped via <code>trans_fun</code>.
</p></div></div><div class="top"><p class="src"><a name="v:genAllOpIDs" class="def">genAllOpIDs</a> :: Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genAllOpIDs" class="link">Source</a></p><div class="doc"><p>Generates a list of all defined opcode IDs.
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:OpParam" class="def">OpParam</a> = (String, Q Type, Q Exp)<a href="Ganeti/THH.html#OpParam" class="link">Source</a></p></div><h1 id="g:6">Python code generation
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:OpCodeField" class="def">OpCodeField</a>  <a href="Ganeti/THH.html#OpCodeField" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:OpCodeField" class="def">OpCodeField</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:ocfName" class="def">ocfName</a> :: String</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocfType" class="def">ocfType</a> :: <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocfDefl" class="def">ocfDefl</a> :: Maybe <a href="Ganeti-PyValue.html#t:PyValueEx">PyValueEx</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocfDoc" class="def">ocfDoc</a> :: String</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:OpCodeDescriptor" class="def">OpCodeDescriptor</a>  <a href="Ganeti/THH.html#OpCodeDescriptor" class="link">Source</a></p><div class="doc"><p>Transfers opcode data between the opcode description (through
 <code>genOpCode</code>) and the Python code generation functions.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:OpCodeDescriptor" class="def">OpCodeDescriptor</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:ocdName" class="def">ocdName</a> :: String</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocdType" class="def">ocdType</a> :: <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocdDoc" class="def">ocdDoc</a> :: String</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocdFields" class="def">ocdFields</a> :: [<a href="Ganeti-THH.html#t:OpCodeField">OpCodeField</a>]</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ocdDescr" class="def">ocdDescr</a> :: String</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><a name="v:maybeApp" class="def">maybeApp</a> :: Maybe (Q Exp) -&gt; Q Type -&gt; Q Exp<a href="Ganeti/THH.html#maybeApp" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genPyType-39-" class="def">genPyType'</a> :: <a href="Ganeti-THH.html#t:OptionalType">OptionalType</a> -&gt; Q Type -&gt; Q <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a><a href="Ganeti/THH.html#genPyType%27" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genPyType" class="def">genPyType</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q <a href="Ganeti-THH-PyType.html#t:PyType">PyType</a><a href="Ganeti/THH.html#genPyType" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genPyDefault" class="def">genPyDefault</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#genPyDefault" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:pyField" class="def">pyField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#pyField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:pyClass" class="def">pyClass</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; Q Exp<a href="Ganeti/THH.html#pyClass" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:pyClasses" class="def">pyClasses</a> :: [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#pyClasses" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:opcodeConsToLuxiCons" class="def">opcodeConsToLuxiCons</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a><a href="Ganeti/THH.html#opcodeConsToLuxiCons" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genOpCodeDictObject" class="def">genOpCodeDictObject</a> :: Name -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause) -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp) -&gt; [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#genOpCodeDictObject" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genOpCode" class="def">genOpCode</a><a href="Ganeti/THH.html#genOpCode" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: String</td><td class="doc"><p>Type name to use
</p></td></tr><tr><td class="src">-&gt; [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>]</td><td class="doc"><p>Constructor name and parameters
</p></td></tr><tr><td class="src">-&gt; Q [Dec]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Generates the OpCode data type.
</p><p>This takes an opcode logical definition, and builds both the
 datatype and the JSON serialisation out of it. We can't use a
 generic serialisation since we need to be compatible with Ganeti's
 own, so we have a few quirks to work around.
</p></div></div><div class="top"><p class="src"><a name="v:genOpConsFields" class="def">genOpConsFields</a> :: <a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a> -&gt; Clause<a href="Ganeti/THH.html#genOpConsFields" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genAllOpFields" class="def">genAllOpFields</a> :: String -&gt; [<a href="Ganeti-THH.html#t:OpCodeConstructor">OpCodeConstructor</a>] -&gt; (Dec, Dec)<a href="Ganeti/THH.html#genAllOpFields" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:saveConstructor" class="def">saveConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause<a href="Ganeti/THH.html#saveConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genSaveOpCode" class="def">genSaveOpCode</a> :: [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause) -&gt; Q [Clause]<a href="Ganeti/THH.html#genSaveOpCode" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadConstructor" class="def">loadConstructor</a> :: Name -&gt; (<a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp<a href="Ganeti/THH.html#loadConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadOpConstructor" class="def">loadOpConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp<a href="Ganeti/THH.html#loadOpConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genLoadOpCode" class="def">genLoadOpCode</a> :: [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; (<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Exp) -&gt; Q [Clause]<a href="Ganeti/THH.html#genLoadOpCode" class="link">Source</a></p></div><h1 id="g:7">Template code for luxi
</h1><div class="top"><p class="src"><a name="v:genStrOfOp" class="def">genStrOfOp</a> :: Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genStrOfOp" class="link">Source</a></p><div class="doc"><p>Constructor-to-string for LuxiOp.
</p></div></div><div class="top"><p class="src"><a name="v:genStrOfKey" class="def">genStrOfKey</a> :: Name -&gt; String -&gt; Q [Dec]<a href="Ganeti/THH.html#genStrOfKey" class="link">Source</a></p><div class="doc"><p>Constructor-to-string for MsgKeys.
</p></div></div><div class="top"><p class="src"><a name="v:genLuxiOp" class="def">genLuxiOp</a> :: String -&gt; [<a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#genLuxiOp" class="link">Source</a></p><div class="doc"><p>Generates the LuxiOp data type.
</p><p>This takes a Luxi operation definition and builds both the
 datatype and the function transforming the arguments to JSON.
 We can't use anything less generic, because the way different
 operations are serialized differs on both parameter- and top-level.
</p><p>There are two things to be defined for each parameter:
</p><ul><li> name
</li><li> type
</li></ul></div></div><div class="top"><p class="src"><a name="v:saveLuxiConstructor" class="def">saveLuxiConstructor</a> :: <a href="Ganeti-THH.html#t:LuxiConstructor">LuxiConstructor</a> -&gt; Q Clause<a href="Ganeti/THH.html#saveLuxiConstructor" class="link">Source</a></p></div><h1 id="g:8"><a href="Objects.html">Objects</a> functionality
</h1><div class="top"><p class="src"><a name="v:fieldTypeInfo" class="def">fieldTypeInfo</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q (Name, Strict, Type)<a href="Ganeti/THH.html#fieldTypeInfo" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildObject" class="def">buildObject</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#buildObject" class="link">Source</a></p><div class="doc"><p>Build an object declaration.
</p></div></div><div class="top"><p class="src"><a name="v:buildObjectSerialisation" class="def">buildObjectSerialisation</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#buildObjectSerialisation" class="link">Source</a></p><div class="doc"><p>Generates an object definition: data type and its JSON instance.
</p></div></div><div class="top"><p class="src"><a name="v:objVarName" class="def">objVarName</a> :: Name<a href="Ganeti/THH.html#objVarName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:defaultToJSArray" class="def">defaultToJSArray</a> :: <a href="Ganeti-JSON.html#t:DictObject">DictObject</a> a =&gt; [String] -&gt; a -&gt; [JSValue]<a href="Ganeti/THH.html#defaultToJSArray" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:defaultFromJSArray" class="def">defaultFromJSArray</a> :: <a href="Ganeti-JSON.html#t:DictObject">DictObject</a> a =&gt; [String] -&gt; [JSValue] -&gt; Result a<a href="Ganeti/THH.html#defaultFromJSArray" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genArrayObjectInstance" class="def">genArrayObjectInstance</a> :: Name -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Dec<a href="Ganeti/THH.html#genArrayObjectInstance" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genDictObject" class="def">genDictObject</a> :: (Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; (<a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp) -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#genDictObject" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genSaveObject" class="def">genSaveObject</a> :: String -&gt; Q [Dec]<a href="Ganeti/THH.html#genSaveObject" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:saveObjectField" class="def">saveObjectField</a> :: Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#saveObjectField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:objectShowJSON" class="def">objectShowJSON</a> :: String -&gt; Q Dec<a href="Ganeti/THH.html#objectShowJSON" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genLoadObject" class="def">genLoadObject</a> :: String -&gt; Q (Dec, Dec)<a href="Ganeti/THH.html#genLoadObject" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadObjectField" class="def">loadObjectField</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#loadObjectField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fieldDictKeys" class="def">fieldDictKeys</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Exp<a href="Ganeti/THH.html#fieldDictKeys" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fieldsDictKeys" class="def">fieldsDictKeys</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Exp<a href="Ganeti/THH.html#fieldsDictKeys" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fieldsDictKeysQ" class="def">fieldsDictKeysQ</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp<a href="Ganeti/THH.html#fieldsDictKeysQ" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fieldsUsedKeysQ" class="def">fieldsUsedKeysQ</a> :: [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q Exp<a href="Ganeti/THH.html#fieldsUsedKeysQ" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:objectReadJSON" class="def">objectReadJSON</a> :: String -&gt; Q Dec<a href="Ganeti/THH.html#objectReadJSON" class="link">Source</a></p></div><h1 id="g:9">Inheritable parameter tables implementation
</h1><div class="top"><p class="src"><a name="v:paramTypeNames" class="def">paramTypeNames</a> :: String -&gt; (String, String)<a href="Ganeti/THH.html#paramTypeNames" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:paramFieldTypeInfo" class="def">paramFieldTypeInfo</a> :: String -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q (Name, Strict, Type)<a href="Ganeti/THH.html#paramFieldTypeInfo" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildParam" class="def">buildParam</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#buildParam" class="link">Source</a></p><div class="doc"><p>Build a parameter declaration.
</p><p>This function builds two different data structures: a <em>filled</em> one,
 in which all fields are required, and a <em>partial</em> one, in which all
 fields are optional. Due to the current record syntax issues, the
 fields need to be named differrently for the two structures, so the
 partial ones get a <em>P</em> suffix.
</p></div></div><div class="top"><p class="src"><a name="v:buildParamAllFields" class="def">buildParamAllFields</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; [Dec]<a href="Ganeti/THH.html#buildParamAllFields" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildPParamSerialisation" class="def">buildPParamSerialisation</a> :: String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#buildPParamSerialisation" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:savePParamField" class="def">savePParamField</a> :: Name -&gt; <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#savePParamField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadPParamField" class="def">loadPParamField</a> :: <a href="Ganeti-THH.html#t:Field">Field</a> -&gt; Q Exp<a href="Ganeti/THH.html#loadPParamField" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:buildFromMaybe" class="def">buildFromMaybe</a> :: String -&gt; Q Dec<a href="Ganeti/THH.html#buildFromMaybe" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:fillParam" class="def">fillParam</a> :: String -&gt; String -&gt; [<a href="Ganeti-THH.html#t:Field">Field</a>] -&gt; Q [Dec]<a href="Ganeti/THH.html#fillParam" class="link">Source</a></p></div><h1 id="g:10">Template code for exceptions
</h1><div class="top"><p class="src"><a name="v:excErrMsg" class="def">excErrMsg</a> :: (String, Q Type)<a href="Ganeti/THH.html#excErrMsg" class="link">Source</a></p><div class="doc"><p>Exception simple error message field.
</p></div></div><div class="top"><p class="src"><a name="v:genException" class="def">genException</a><a href="Ganeti/THH.html#genException" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: String</td><td class="doc"><p>Name of new type
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a></td><td class="doc"><p>Constructor name and parameters
</p></td></tr><tr><td class="src">-&gt; Q [Dec]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Builds an exception type definition.
</p></div></div><div class="top"><p class="src"><a name="v:saveExcCons" class="def">saveExcCons</a> :: String -&gt; [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>] -&gt; Q Clause<a href="Ganeti/THH.html#saveExcCons" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:loadExcConstructor" class="def">loadExcConstructor</a> :: Name -&gt; String -&gt; [<a href="Ganeti-THH.html#t:SimpleField">SimpleField</a>] -&gt; Q Exp<a href="Ganeti/THH.html#loadExcConstructor" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:genLoadExc" class="def">genLoadExc</a> :: Name -&gt; String -&gt; <a href="Ganeti-THH.html#t:SimpleObject">SimpleObject</a> -&gt; Q (Dec, Dec)<a href="Ganeti/THH.html#genLoadExc" class="link">Source</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>