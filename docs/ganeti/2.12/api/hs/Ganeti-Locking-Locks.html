<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.Locking.Locks</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-Locking-Locks.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/Locking/Locks.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Ganeti.Locking.Locks</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Ganeti lock structure
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:GanetiLocks">GanetiLocks</a> <ul class="subs"><li>= <a href="#v:ClusterLockSet">ClusterLockSet</a>  </li><li>| <a href="#v:BGL">BGL</a>  </li><li>| <a href="#v:InstanceLockSet">InstanceLockSet</a>  </li><li>| <a href="#v:Instance">Instance</a> String  </li><li>| <a href="#v:NodeAllocLockSet">NodeAllocLockSet</a>  </li><li>| <a href="#v:NAL">NAL</a>  </li><li>| <a href="#v:NodeGroupLockSet">NodeGroupLockSet</a>  </li><li>| <a href="#v:NodeGroup">NodeGroup</a> String  </li><li>| <a href="#v:NodeLockSet">NodeLockSet</a>  </li><li>| <a href="#v:Node">Node</a> String  </li><li>| <a href="#v:NodeResLockSet">NodeResLockSet</a>  </li><li>| <a href="#v:NodeRes">NodeRes</a> String  </li><li>| <a href="#v:NetworkLockSet">NetworkLockSet</a>  </li><li>| <a href="#v:Network">Network</a> String  </li><li>| <a href="#v:ConfigLock">ConfigLock</a>  </li></ul></li><li class="src short"><a href="#v:lockName">lockName</a> :: <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> -&gt; String</li><li class="src short"><a href="#v:lockFromName">lockFromName</a> :: String -&gt; Result <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:LockLevel">LockLevel</a> <ul class="subs"><li>= <a href="#v:LevelCluster">LevelCluster</a>  </li><li>| <a href="#v:LevelInstance">LevelInstance</a>  </li><li>| <a href="#v:LevelNodeAlloc">LevelNodeAlloc</a>  </li><li>| <a href="#v:LevelNodeGroup">LevelNodeGroup</a>  </li><li>| <a href="#v:LevelNode">LevelNode</a>  </li><li>| <a href="#v:LevelNodeRes">LevelNodeRes</a>  </li><li>| <a href="#v:LevelNetwork">LevelNetwork</a>  </li><li>| <a href="#v:LevelConfig">LevelConfig</a>  </li></ul></li><li class="src short"><a href="#v:lockLevelName">lockLevelName</a> :: <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a> -&gt; String</li><li class="src short"><a href="#v:lockLevelFromName">lockLevelFromName</a> :: String -&gt; Result <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></li><li class="src short"><a href="#v:lockLevel">lockLevel</a> :: <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> -&gt; <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:ClientType">ClientType</a> <ul class="subs"><li>= <a href="#v:ClientOther">ClientOther</a> String  </li><li>| <a href="#v:ClientJob">ClientJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a>  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:ClientId">ClientId</a>  = <a href="#v:ClientId">ClientId</a> {<ul class="subs"><li><a href="#v:ciIdentifier">ciIdentifier</a> :: <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></li><li><a href="#v:ciLockFile">ciLockFile</a> :: FilePath</li><li><a href="#v:ciPid">ciPid</a> :: ProcessID</li></ul>}</li><li class="src short"><a href="#v:clientIdFromJSON">clientIdFromJSON</a> :: JSValue -&gt; Result <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:GanetiLockWaiting">GanetiLockWaiting</a> = <a href="Ganeti-Locking-Waiting.html#t:LockWaiting">LockWaiting</a> <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a> Integer</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:GanetiLocks" class="def">GanetiLocks</a>  <a href="Ganeti/Locking/Locks.html#GanetiLocks" class="link">Source</a></p><div class="doc"><p>The type of Locks available in Ganeti. The order of this type
 is the lock oder.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ClusterLockSet" class="def">ClusterLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:BGL" class="def">BGL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:InstanceLockSet" class="def">InstanceLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Instance" class="def">Instance</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeAllocLockSet" class="def">NodeAllocLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NAL" class="def">NAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeGroupLockSet" class="def">NodeGroupLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeGroup" class="def">NodeGroup</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeLockSet" class="def">NodeLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Node" class="def">Node</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeResLockSet" class="def">NodeResLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NodeRes" class="def">NodeRes</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NetworkLockSet" class="def">NetworkLockSet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Network" class="def">Network</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ConfigLock" class="def">ConfigLock</a></td><td class="doc"><p>A lock used for a transitional period when WConfd
 keeps the state of the configuration, but all the
 operations are still performed on the Python side.
</p></td></tr></table></div><div class="subs instances"><p id="control.i:GanetiLocks" class="caption collapser" onclick="toggleSection('i:GanetiLocks')">Instances</p><div id="section.i:GanetiLocks" class="show"><table><tr><td class="src">Eq <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Ord <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">JSON <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Ganeti-Locking-Types.html#t:Lock">Lock</a> <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:lockName" class="def">lockName</a> :: <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> -&gt; String<a href="Ganeti/Locking/Locks.html#lockName" class="link">Source</a></p><div class="doc"><p>Provide the String representation of a lock
</p></div></div><div class="top"><p class="src"><a name="v:lockFromName" class="def">lockFromName</a> :: String -&gt; Result <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a><a href="Ganeti/Locking/Locks.html#lockFromName" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:LockLevel" class="def">LockLevel</a>  <a href="Ganeti/Locking/Locks.html#LockLevel" class="link">Source</a></p><div class="doc"><p>The levels, the locks belong to.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:LevelCluster" class="def">LevelCluster</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelInstance" class="def">LevelInstance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelNodeAlloc" class="def">LevelNodeAlloc</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelNodeGroup" class="def">LevelNodeGroup</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelNode" class="def">LevelNode</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelNodeRes" class="def">LevelNodeRes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelNetwork" class="def">LevelNetwork</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LevelConfig" class="def">LevelConfig</a></td><td class="doc"><p>A transitional level for internal configuration locks
</p></td></tr></table></div><div class="subs instances"><p id="control.i:LockLevel" class="caption collapser" onclick="toggleSection('i:LockLevel')">Instances</p><div id="section.i:LockLevel" class="show"><table><tr><td class="src">Enum <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Eq <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">JSON <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:lockLevelName" class="def">lockLevelName</a> :: <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a> -&gt; String<a href="Ganeti/Locking/Locks.html#lockLevelName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:lockLevelFromName" class="def">lockLevelFromName</a> :: String -&gt; Result <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a><a href="Ganeti/Locking/Locks.html#lockLevelFromName" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:lockLevel" class="def">lockLevel</a> :: <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> -&gt; <a href="Ganeti-Locking-Locks.html#t:LockLevel">LockLevel</a><a href="Ganeti/Locking/Locks.html#lockLevel" class="link">Source</a></p><div class="doc"><p>For a lock, provide its level.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:ClientType" class="def">ClientType</a>  <a href="Ganeti/Locking/Locks.html#ClientType" class="link">Source</a></p><div class="doc"><p>Type of entities capable of owning locks. Usually, locks are owned
 by jobs. However, occassionally other tasks need locks (currently, e.g.,
 to lock the configuration). These are identified by a unique name,
 reported to WConfD as a strig.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ClientOther" class="def">ClientOther</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ClientJob" class="def">ClientJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ClientType" class="caption collapser" onclick="toggleSection('i:ClientType')">Instances</p><div id="section.i:ClientType" class="show"><table><tr><td class="src">Eq <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Ord <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">JSON <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:ClientId" class="def">ClientId</a>  <a href="Ganeti/Locking/Locks.html#ClientId" class="link">Source</a></p><div class="doc"><p>A client is identified as a job id, thread id, a path to its process
 identifier file, and its process id.
</p><p>The JobId isn't enough to identify a client as the master daemon
 also handles client calls that aren't jobs, but which use the configuration.
 These taks are identified by a unique name, reported to WConfD as a string.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ClientId" class="def">ClientId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:ciIdentifier" class="def">ciIdentifier</a> :: <a href="Ganeti-Locking-Locks.html#t:ClientType">ClientType</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ciLockFile" class="def">ciLockFile</a> :: FilePath</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:ciPid" class="def">ciPid</a> :: ProcessID</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ClientId" class="caption collapser" onclick="toggleSection('i:ClientId')">Instances</p><div id="section.i:ClientId" class="show"><table><tr><td class="src">Eq <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Ord <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">JSON <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:clientIdFromJSON" class="def">clientIdFromJSON</a> :: JSValue -&gt; Result <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a><a href="Ganeti/Locking/Locks.html#clientIdFromJSON" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:GanetiLockWaiting" class="def">GanetiLockWaiting</a> = <a href="Ganeti-Locking-Waiting.html#t:LockWaiting">LockWaiting</a> <a href="Ganeti-Locking-Locks.html#t:GanetiLocks">GanetiLocks</a> <a href="Ganeti-Locking-Locks.html#t:ClientId">ClientId</a> Integer<a href="Ganeti/Locking/Locks.html#GanetiLockWaiting" class="link">Source</a></p><div class="doc"><p>The type of lock Allocations in Ganeti. In Ganeti, the owner of
 locks are jobs.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>