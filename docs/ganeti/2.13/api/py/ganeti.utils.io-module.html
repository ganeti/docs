<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ganeti.utils.io</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ganeti-module.html">Package&nbsp;ganeti</a> ::
        <a href="ganeti.utils-module.html">Package&nbsp;utils</a> ::
        Module&nbsp;io
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ganeti.utils.io-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module io</h1><p class="nomargin-top"><span class="codelink"><a href="ganeti.utils.io-pysrc.html">source&nbsp;code</a></span></p>
<p>Utility functions for I/O.</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.utils.io.FileStatHelper-class.html" class="summary-name">FileStatHelper</a><br />
      Helper to store file handle's <code>fstat</code>.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.utils.io.TemporaryFileManager-class.html" class="summary-name">TemporaryFileManager</a><br />
      Stores the list of files to be deleted and removes them on demand.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ErrnoOrStr" class="summary-sig-name">ErrnoOrStr</a>(<span class="summary-sig-arg">err</span>)</span><br />
      Format an EnvironmentError exception.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ErrnoOrStr">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">str</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ReadFile" class="summary-sig-name">ReadFile</a>(<span class="summary-sig-arg">file_name</span>,
        <span class="summary-sig-arg">size</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">preread</span>=<span class="summary-sig-default">None</span>)</span><br />
      Reads a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">None or int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#WriteFile" class="summary-sig-name">WriteFile</a>(<span class="summary-sig-arg">file_name</span>,
        <span class="summary-sig-arg">fn</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">data</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">mode</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">uid</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">gid</span>=<span class="summary-sig-default">-1</span>,
        <span class="summary-sig-arg">atime</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">mtime</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">close</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">dry_run</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">backup</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">prewrite</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">postwrite</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">keep_perms</span>=<span class="summary-sig-default">KP_NEVER</span>)</span><br />
      (Over)write a file atomically.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#WriteFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#GetFileID" class="summary-sig-name">GetFileID</a>(<span class="summary-sig-arg">path</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">fd</span>=<span class="summary-sig-default">None</span>)</span><br />
      Returns the file 'id', i.e.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#GetFileID">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">boolean</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#VerifyFileID" class="summary-sig-name">VerifyFileID</a>(<span class="summary-sig-arg">fi_disk</span>,
        <span class="summary-sig-arg">fi_ours</span>)</span><br />
      Verifies that two file IDs are matching.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#VerifyFileID">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#SafeWriteFile" class="summary-sig-name">SafeWriteFile</a>(<span class="summary-sig-arg">file_name</span>,
        <span class="summary-sig-arg">file_id</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Wraper over WriteFile that locks the target file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#SafeWriteFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ReadOneLineFile" class="summary-sig-name">ReadOneLineFile</a>(<span class="summary-sig-arg">file_name</span>,
        <span class="summary-sig-arg">strict</span>=<span class="summary-sig-default">False</span>)</span><br />
      Return the first non-empty line from a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadOneLineFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#RemoveFile" class="summary-sig-name">RemoveFile</a>(<span class="summary-sig-arg">filename</span>)</span><br />
      Remove a file ignoring some errors.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#RemoveFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#RemoveDir" class="summary-sig-name">RemoveDir</a>(<span class="summary-sig-arg">dirname</span>)</span><br />
      Remove an empty directory.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#RemoveDir">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#RenameFile" class="summary-sig-name">RenameFile</a>(<span class="summary-sig-arg">old</span>,
        <span class="summary-sig-arg">new</span>,
        <span class="summary-sig-arg">mkdir</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">mkdir_mode</span>=<span class="summary-sig-default">0750</span>,
        <span class="summary-sig-arg">dir_uid</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">dir_gid</span>=<span class="summary-sig-default">None</span>)</span><br />
      Renames a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#RenameFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#EnforcePermission" class="summary-sig-name">EnforcePermission</a>(<span class="summary-sig-arg">path</span>,
        <span class="summary-sig-arg">mode</span>,
        <span class="summary-sig-arg">uid</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">gid</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">must_exist</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">_chmod_fn</span>=<span class="summary-sig-default">os.chmod</span>,
        <span class="summary-sig-arg">_chown_fn</span>=<span class="summary-sig-default">os.chown</span>,
        <span class="summary-sig-arg">_stat_fn</span>=<span class="summary-sig-default">os.stat</span>)</span><br />
      Enforces that given path has given permissions.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#EnforcePermission">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#MakeDirWithPerm" class="summary-sig-name">MakeDirWithPerm</a>(<span class="summary-sig-arg">path</span>,
        <span class="summary-sig-arg">mode</span>,
        <span class="summary-sig-arg">uid</span>,
        <span class="summary-sig-arg">gid</span>,
        <span class="summary-sig-arg">_lstat_fn</span>=<span class="summary-sig-default">os.lstat</span>,
        <span class="summary-sig-arg">_mkdir_fn</span>=<span class="summary-sig-default">os.mkdir</span>,
        <span class="summary-sig-arg">_perm_fn</span>=<span class="summary-sig-default">EnforcePermission</span>)</span><br />
      Enforces that given path is a dir and has given mode, uid and gid 
      set.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#MakeDirWithPerm">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#Makedirs" class="summary-sig-name">Makedirs</a>(<span class="summary-sig-arg">path</span>,
        <span class="summary-sig-arg">mode</span>=<span class="summary-sig-default">0750</span>)</span><br />
      Super-mkdir; create a leaf directory and all intermediate ones.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#Makedirs">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#TimestampForFilename" class="summary-sig-name">TimestampForFilename</a>()</span><br />
      Returns the current time formatted for filenames.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#TimestampForFilename">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">str</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#CreateBackup" class="summary-sig-name">CreateBackup</a>(<span class="summary-sig-arg">file_name</span>)</span><br />
      Creates a backup of a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#CreateBackup">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ListVisibleFiles" class="summary-sig-name">ListVisibleFiles</a>(<span class="summary-sig-arg">path</span>,
        <span class="summary-sig-arg">_is_mountpoint</span>=<span class="summary-sig-default">os.path.ismount</span>)</span><br />
      Returns a list of visible files in a directory.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ListVisibleFiles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#EnsureDirs" class="summary-sig-name">EnsureDirs</a>(<span class="summary-sig-arg">dirs</span>)</span><br />
      Make required directories, if they don't exist.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#EnsureDirs">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">str or None</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#FindFile" class="summary-sig-name">FindFile</a>(<span class="summary-sig-arg">name</span>,
        <span class="summary-sig-arg">search_path</span>,
        <span class="summary-sig-arg">test</span>=<span class="summary-sig-default">os.path.exists</span>)</span><br />
      Look for a filesystem object in a given path.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#FindFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#IsNormAbsPath" class="summary-sig-name">IsNormAbsPath</a>(<span class="summary-sig-arg">path</span>)</span><br />
      Check whether a path is absolute and also normalized</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsNormAbsPath">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#IsBelowDir" class="summary-sig-name">IsBelowDir</a>(<span class="summary-sig-arg">root</span>,
        <span class="summary-sig-arg">other_path</span>)</span><br />
      Check whether a path is below a root dir.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsBelowDir">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="IsUrl"></a><span class="summary-sig-name">IsUrl</span>(<span class="summary-sig-arg">path</span>)</span><br />
      Check whether a path is a HTTP URL.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsUrl">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#PathJoin" class="summary-sig-name">PathJoin</a>(<span class="summary-sig-arg">*args</span>)</span><br />
      Safe-join a list of path components.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#PathJoin">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#TailFile" class="summary-sig-name">TailFile</a>(<span class="summary-sig-arg">fname</span>,
        <span class="summary-sig-arg">lines</span>=<span class="summary-sig-default">20</span>)</span><br />
      Return the last lines from a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#TailFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#BytesToMebibyte" class="summary-sig-name">BytesToMebibyte</a>(<span class="summary-sig-arg">value</span>)</span><br />
      Converts bytes to mebibytes.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#BytesToMebibyte">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#CalculateDirectorySize" class="summary-sig-name">CalculateDirectorySize</a>(<span class="summary-sig-arg">path</span>)</span><br />
      Calculates the size of a directory recursively.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#CalculateDirectorySize">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#GetFilesystemStats" class="summary-sig-name">GetFilesystemStats</a>(<span class="summary-sig-arg">path</span>)</span><br />
      Returns the total and free space on a filesystem.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#GetFilesystemStats">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ReadPidFile" class="summary-sig-name">ReadPidFile</a>(<span class="summary-sig-arg">pidfile</span>)</span><br />
      Read a pid from a file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadPidFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#_ParsePidFileContents" class="summary-sig-name" onclick="show_private();">_ParsePidFileContents</a>(<span class="summary-sig-arg">data</span>)</span><br />
      Tries to extract a process ID from a PID file's content.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#_ParsePidFileContents">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ReadLockedPidFile" class="summary-sig-name">ReadLockedPidFile</a>(<span class="summary-sig-arg">path</span>)</span><br />
      Reads a locked PID file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadLockedPidFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">str</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#DaemonPidFileName" class="summary-sig-name">DaemonPidFileName</a>(<span class="summary-sig-arg">name</span>)</span><br />
      Compute a ganeti pid file absolute path</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#DaemonPidFileName">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">int</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#WritePidFile" class="summary-sig-name">WritePidFile</a>(<span class="summary-sig-arg">pidfile</span>)</span><br />
      Write the current process pidfile.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#WritePidFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#ReadWatcherPauseFile" class="summary-sig-name">ReadWatcherPauseFile</a>(<span class="summary-sig-arg">filename</span>,
        <span class="summary-sig-arg">now</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">remove_after</span>=<span class="summary-sig-default">3600</span>)</span><br />
      Reads the watcher pause file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadWatcherPauseFile">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">str</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#NewUUID" class="summary-sig-name">NewUUID</a>()</span><br />
      Returns a random UUID.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#NewUUID">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#IsUserInGroup" class="summary-sig-name">IsUserInGroup</a>(<span class="summary-sig-arg">uid</span>,
        <span class="summary-sig-arg">gid</span>)</span><br />
      Returns True if the user belongs to the group.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsUserInGroup">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.utils.io-module.html#CanRead" class="summary-sig-name">CanRead</a>(<span class="summary-sig-arg">username</span>,
        <span class="summary-sig-arg">filename</span>)</span><br />
      Returns True if the user can access (read) the file.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.utils.io-pysrc.html#CanRead">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="_LOST_AND_FOUND"></a><span class="summary-name">_LOST_AND_FOUND</span> = <code title="&quot;lost+found&quot;">&quot;lost+found&quot;</code><br />
      Directory used by fsck(8) to store recovered data, usually at a file 
      system's root directory
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="KP_NEVER"></a><span class="summary-name">KP_NEVER</span> = <code title="0">0</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="KP_ALWAYS"></a><span class="summary-name">KP_ALWAYS</span> = <code title="1">1</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="KP_IF_EXISTS"></a><span class="summary-name">KP_IF_EXISTS</span> = <code title="2">2</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="KEEP_PERMS_VALUES"></a><span class="summary-name">KEEP_PERMS_VALUES</span> = <code title="[KP_NEVER, KP_ALWAYS, KP_IF_EXISTS,]">[KP_NEVER, KP_ALWAYS, KP_IF_EXISTS,]</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="URL_RE"></a><span class="summary-name">URL_RE</span> = <code title="re.compile(r'(https?|ftps?)://')">re.compile(r'(https?|ftps?)://')</code>
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="os">os</span>,
  <span title="re">re</span>,
  <span title="logging">logging</span>,
  <span title="shutil">shutil</span>,
  <span title="tempfile">tempfile</span>,
  <span title="errno">errno</span>,
  <span title="time">time</span>,
  <span title="stat">stat</span>,
  <span title="grp">grp</span>,
  <span title="pwd">pwd</span>,
  <a href="ganeti.errors-module.html" title="ganeti.errors">errors</a>,
  <a href="ganeti.constants-module.html" title="ganeti.constants">constants</a>,
  <a href="ganeti.pathutils-module.html" title="ganeti.pathutils">pathutils</a>,
  <span title="ganeti.utils.filelock">filelock</span>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="ErrnoOrStr"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ErrnoOrStr</span>(<span class="sig-arg">err</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ErrnoOrStr">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Format an EnvironmentError exception.</p>
  <p>If the <code class="link">err</code> argument has an errno attribute, 
  it will be looked up and converted into a textual <code>E...</code> 
  description. Otherwise the string representation of the error will be 
  returned.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>err</code></strong> (<code class="link">EnvironmentError</code>) - the exception to format</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ReadFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReadFile</span>(<span class="sig-arg">file_name</span>,
        <span class="sig-arg">size</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">preread</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Reads a file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>size</code></strong> (int) - Read at most size bytes (if negative, entire file)</li>
        <li><strong class="pname"><code>preread</code></strong> (callable receiving file handle as single parameter) - Function called before file is read</li>
    </ul></dd>
    <dt>Returns: str</dt>
        <dd>the (possibly partial) content of the file</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>IOError</strong></code> - if the file cannot be opened</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="WriteFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">WriteFile</span>(<span class="sig-arg">file_name</span>,
        <span class="sig-arg">fn</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">data</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">mode</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">uid</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">gid</span>=<span class="sig-default">-1</span>,
        <span class="sig-arg">atime</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">mtime</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">close</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">dry_run</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">backup</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">prewrite</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">postwrite</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">keep_perms</span>=<span class="sig-default">KP_NEVER</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#WriteFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>(Over)write a file atomically.</p>
  <p>The file_name and either fn (a function taking one argument, the file 
  descriptor, and which should write the data to it) or data (the contents 
  of the file) must be passed. The other arguments are optional and allow 
  setting the file mode, owner and group, and the mtime/atime of the 
  file.</p>
  <p>If the function doesn't raise an exception, it has succeeded and the 
  target file has the new contents. If the function has raised an 
  exception, an existing target file should be unmodified and the temporary
  file should be removed.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file_name</code></strong> (str) - the target filename</li>
        <li><strong class="pname"><code>fn</code></strong> (callable) - content writing function, called with file descriptor as 
          parameter</li>
        <li><strong class="pname"><code>data</code></strong> (str) - contents of the file</li>
        <li><strong class="pname"><code>mode</code></strong> (int) - file mode</li>
        <li><strong class="pname"><code>uid</code></strong> (int) - the owner of the file</li>
        <li><strong class="pname"><code>gid</code></strong> (int) - the group of the file</li>
        <li><strong class="pname"><code>atime</code></strong> (int) - a custom access time to be set on the file</li>
        <li><strong class="pname"><code>mtime</code></strong> (int) - a custom modification time to be set on the file</li>
        <li><strong class="pname"><code>close</code></strong> (boolean) - whether to close file after writing it</li>
        <li><strong class="pname"><code>prewrite</code></strong> (callable) - function to be called before writing content</li>
        <li><strong class="pname"><code>postwrite</code></strong> (callable) - function to be called after writing content</li>
        <li><strong class="pname"><code>keep_perms</code></strong> (members of <a 
          href="ganeti.utils.io-module.html#KEEP_PERMS_VALUES" 
          class="link">KEEP_PERMS_VALUES</a>) - if <a href="ganeti.utils.io-module.html#KP_NEVER" 
          class="link">KP_NEVER</a> (default), owner, group, and mode are 
          taken from the other parameters; if <a 
          href="ganeti.utils.io-module.html#KP_ALWAYS" 
          class="link">KP_ALWAYS</a>, owner, group, and mode are copied 
          from the existing file; if <a 
          href="ganeti.utils.io-module.html#KP_IF_EXISTS" 
          class="link">KP_IF_EXISTS</a>, owner, group, and mode are taken 
          from the file, and if the file doesn't exist, they are taken from
          the other parameters. It is an error to pass <a 
          href="ganeti.utils.io-module.html#KP_ALWAYS" 
          class="link">KP_ALWAYS</a> when the file doesn't exist or when 
          <code>uid</code>, <code>gid</code>, or <code>mode</code> are set 
          to non-default values.</li>
    </ul></dd>
    <dt>Returns: None or int</dt>
        <dd>None if the 'close' parameter evaluates to True, otherwise the 
          file descriptor</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.ProgrammerError-class.html">errors.ProgrammerError</a></strong></code> - if any of the arguments are not valid</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="GetFileID"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">GetFileID</span>(<span class="sig-arg">path</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">fd</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#GetFileID">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns the file 'id', i.e. the dev/inode and mtime information.</p>
  <p>Either the path to the file or the fd must be given.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> - the file path</li>
        <li><strong class="pname"><code>fd</code></strong> - a file descriptor</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>a tuple of (device number, inode number, mtime)</dd>
  </dl>
</td></tr></table>
</div>
<a name="VerifyFileID"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">VerifyFileID</span>(<span class="sig-arg">fi_disk</span>,
        <span class="sig-arg">fi_ours</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#VerifyFileID">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Verifies that two file IDs are matching.</p>
  <p>Differences in the inode/device are not accepted, but and older 
  timestamp for fi_disk is accepted.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>fi_disk</code></strong> - tuple (dev, inode, mtime) representing the actual file data</li>
        <li><strong class="pname"><code>fi_ours</code></strong> - tuple (dev, inode, mtime) representing the last written file data</li>
    </ul></dd>
    <dt>Returns: boolean</dt>
  </dl>
</td></tr></table>
</div>
<a name="SafeWriteFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">SafeWriteFile</span>(<span class="sig-arg">file_name</span>,
        <span class="sig-arg">file_id</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#SafeWriteFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Wraper over WriteFile that locks the target file.</p>
  <p>By keeping the target file locked during WriteFile, we ensure that 
  cooperating writers will safely serialise access to the file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file_name</code></strong> (str) - the target filename</li>
        <li><strong class="pname"><code>file_id</code></strong> (tuple) - a result from GetFileID</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ReadOneLineFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReadOneLineFile</span>(<span class="sig-arg">file_name</span>,
        <span class="sig-arg">strict</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadOneLineFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the first non-empty line from a file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>strict</code></strong> (boolean) - if True, abort if the file has more than one non-empty line</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="RemoveFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">RemoveFile</span>(<span class="sig-arg">filename</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#RemoveFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Remove a file ignoring some errors.</p>
  <p>Remove a file, ignoring non-existing ones or directories. Other errors
  are passed.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>filename</code></strong> (str) - the file to be removed</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="RemoveDir"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">RemoveDir</span>(<span class="sig-arg">dirname</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#RemoveDir">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Remove an empty directory.</p>
  <p>Remove a directory, ignoring non-existing ones. Other errors are 
  passed. This includes the case, where the directory is not empty, so it 
  can't be removed.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dirname</code></strong> (str) - the empty directory to be removed</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="RenameFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">RenameFile</span>(<span class="sig-arg">old</span>,
        <span class="sig-arg">new</span>,
        <span class="sig-arg">mkdir</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">mkdir_mode</span>=<span class="sig-default">0750</span>,
        <span class="sig-arg">dir_uid</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">dir_gid</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#RenameFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Renames a file.</p>
  <p>This just creates the very least directory if it does not exist and 
  <code>mkdir</code> is set to true.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>old</code></strong> (string) - Original path</li>
        <li><strong class="pname"><code>new</code></strong> (string) - New path</li>
        <li><strong class="pname"><code>mkdir</code></strong> (bool) - Whether to create target directory if it doesn't exist</li>
        <li><strong class="pname"><code>mkdir_mode</code></strong> (int) - Mode for newly created directories</li>
        <li><strong class="pname"><code>dir_uid</code></strong> (int) - The uid for the (if fresh created) dir</li>
        <li><strong class="pname"><code>dir_gid</code></strong> (int) - The gid for the (if fresh created) dir</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="EnforcePermission"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">EnforcePermission</span>(<span class="sig-arg">path</span>,
        <span class="sig-arg">mode</span>,
        <span class="sig-arg">uid</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">gid</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">must_exist</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">_chmod_fn</span>=<span class="sig-default">os.chmod</span>,
        <span class="sig-arg">_chown_fn</span>=<span class="sig-default">os.chown</span>,
        <span class="sig-arg">_stat_fn</span>=<span class="sig-default">os.stat</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#EnforcePermission">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Enforces that given path has given permissions.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> - The path to the file</li>
        <li><strong class="pname"><code>mode</code></strong> - The mode of the file</li>
        <li><strong class="pname"><code>uid</code></strong> - The uid of the owner of this file</li>
        <li><strong class="pname"><code>gid</code></strong> - The gid of the owner of this file</li>
        <li><strong class="pname"><code>must_exist</code></strong> - Specifies if non-existance of path will be an error</li>
        <li><strong class="pname"><code>_chmod_fn</code></strong> - chmod function to use (unittest only)</li>
        <li><strong class="pname"><code>_chown_fn</code></strong> - chown function to use (unittest only)</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="MakeDirWithPerm"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">MakeDirWithPerm</span>(<span class="sig-arg">path</span>,
        <span class="sig-arg">mode</span>,
        <span class="sig-arg">uid</span>,
        <span class="sig-arg">gid</span>,
        <span class="sig-arg">_lstat_fn</span>=<span class="sig-default">os.lstat</span>,
        <span class="sig-arg">_mkdir_fn</span>=<span class="sig-default">os.mkdir</span>,
        <span class="sig-arg">_perm_fn</span>=<span class="sig-default">EnforcePermission</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#MakeDirWithPerm">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Enforces that given path is a dir and has given mode, uid and gid 
  set.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> - The path to the file</li>
        <li><strong class="pname"><code>mode</code></strong> - The mode of the file</li>
        <li><strong class="pname"><code>uid</code></strong> - The uid of the owner of this file</li>
        <li><strong class="pname"><code>gid</code></strong> - The gid of the owner of this file</li>
        <li><strong class="pname"><code>_lstat_fn</code></strong> - Stat function to use (unittest only)</li>
        <li><strong class="pname"><code>_mkdir_fn</code></strong> - mkdir function to use (unittest only)</li>
        <li><strong class="pname"><code>_perm_fn</code></strong> - permission setter function to use (unittest only)</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="Makedirs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">Makedirs</span>(<span class="sig-arg">path</span>,
        <span class="sig-arg">mode</span>=<span class="sig-default">0750</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#Makedirs">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Super-mkdir; create a leaf directory and all intermediate ones.</p>
  <p>This is a wrapper around <code>os.makedirs</code> adding error 
  handling not implemented before Python 2.5.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="TimestampForFilename"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">TimestampForFilename</span>()</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#TimestampForFilename">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns the current time formatted for filenames.</p>
  <p>The format doesn't contain colons as some shells and applications 
  treat them as separators. Uses the local timezone.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="CreateBackup"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CreateBackup</span>(<span class="sig-arg">file_name</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#CreateBackup">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Creates a backup of a file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file_name</code></strong> (str) - file to be backed up</li>
    </ul></dd>
    <dt>Returns: str</dt>
        <dd>the path to the newly created backup</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.ProgrammerError-class.html">errors.ProgrammerError</a></strong></code> - for invalid file names</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ListVisibleFiles"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ListVisibleFiles</span>(<span class="sig-arg">path</span>,
        <span class="sig-arg">_is_mountpoint</span>=<span class="sig-default">os.path.ismount</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ListVisibleFiles">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns a list of visible files in a directory.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> (str) - the directory to enumerate</li>
    </ul></dd>
    <dt>Returns: list</dt>
        <dd>the list of all files not starting with a dot</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.ProgrammerError-class.html">ProgrammerError</a></strong></code> - if <code class="link">path</code> is not an absolue and normalized 
        path</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="EnsureDirs"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">EnsureDirs</span>(<span class="sig-arg">dirs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#EnsureDirs">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Make required directories, if they don't exist.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>dirs</code></strong> (list of (string, integer)) - list of tuples (dir_name, dir_mode)</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="FindFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">FindFile</span>(<span class="sig-arg">name</span>,
        <span class="sig-arg">search_path</span>,
        <span class="sig-arg">test</span>=<span class="sig-default">os.path.exists</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#FindFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Look for a filesystem object in a given path.</p>
  <p>This is an abstract method to search for filesystem object (files, 
  dirs) under a given search path.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>name</code></strong> (str) - the name to look for</li>
        <li><strong class="pname"><code>search_path</code></strong> (iterable of string) - locations to start at</li>
        <li><strong class="pname"><code>test</code></strong> (callable) - a function taking one argument that should return True if the a 
          given object is valid; the default value is os.path.exists, 
          causing only existing files to be returned</li>
    </ul></dd>
    <dt>Returns: str or None</dt>
        <dd>full path to the object if found, None otherwise</dd>
  </dl>
</td></tr></table>
</div>
<a name="IsNormAbsPath"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">IsNormAbsPath</span>(<span class="sig-arg">path</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsNormAbsPath">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check whether a path is absolute and also normalized</p>
  <p>This avoids things like /dir/../../other/path to be valid.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="IsBelowDir"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">IsBelowDir</span>(<span class="sig-arg">root</span>,
        <span class="sig-arg">other_path</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsBelowDir">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check whether a path is below a root dir.</p>
  <p>This works around the nasty byte-byte comparison of commonprefix.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="PathJoin"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">PathJoin</span>(<span class="sig-arg">*args</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#PathJoin">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Safe-join a list of path components.</p>
  <p>Requirements:</p>
  <ul>
    <li>
      the first argument must be an absolute path
    </li>
    <li>
      no component in the path must have backtracking (e.g. /../), since we
      check for normalization at the end
    </li>
  </ul>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>args</code></strong> - the path components to be joined</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - for invalid paths</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="TailFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">TailFile</span>(<span class="sig-arg">fname</span>,
        <span class="sig-arg">lines</span>=<span class="sig-default">20</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#TailFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the last lines from a file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>fname</code></strong> - the file name</li>
        <li><strong class="pname"><code>lines</code></strong> (int) - the (maximum) number of lines to return</li>
    </ul></dd>
  </dl>
<div class="fields">      <p><strong>Note:</strong>
        this function will only read and parse the last 4KB of the file; if
        the lines are very long, it could be that less than the requested 
        number of lines are returned
      </p>
</div></td></tr></table>
</div>
<a name="BytesToMebibyte"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">BytesToMebibyte</span>(<span class="sig-arg">value</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#BytesToMebibyte">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Converts bytes to mebibytes.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>value</code></strong> (int) - Value in bytes</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>Value in mebibytes</dd>
  </dl>
</td></tr></table>
</div>
<a name="CalculateDirectorySize"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CalculateDirectorySize</span>(<span class="sig-arg">path</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#CalculateDirectorySize">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculates the size of a directory recursively.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> (string) - Path to directory</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>Size in mebibytes</dd>
  </dl>
</td></tr></table>
</div>
<a name="GetFilesystemStats"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">GetFilesystemStats</span>(<span class="sig-arg">path</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#GetFilesystemStats">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns the total and free space on a filesystem.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> (string) - Path on filesystem to be examined</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>tuple of (Total space, Free space) in mebibytes</dd>
  </dl>
</td></tr></table>
</div>
<a name="ReadPidFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReadPidFile</span>(<span class="sig-arg">pidfile</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadPidFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Read a pid from a file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>pidfile</code></strong> (string) - path to the file containing the pid</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>The process id, if the file exists and contains a valid PID, 
          otherwise 0</dd>
  </dl>
</td></tr></table>
</div>
<a name="_ParsePidFileContents"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_ParsePidFileContents</span>(<span class="sig-arg">data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#_ParsePidFileContents">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Tries to extract a process ID from a PID file's content.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>data</code></strong> (string)</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>Zero if nothing could be read, PID otherwise</dd>
  </dl>
</td></tr></table>
</div>
<a name="ReadLockedPidFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReadLockedPidFile</span>(<span class="sig-arg">path</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadLockedPidFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Reads a locked PID file.</p>
  <p>This can be used together with <a 
  href="ganeti.utils.process-module.html#StartDaemon" 
  class="link">utils.process.StartDaemon</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>path</code></strong> (string) - Path to PID file</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>PID as integer or, if file was unlocked or couldn't be opened, 
          None</dd>
  </dl>
</td></tr></table>
</div>
<a name="DaemonPidFileName"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">DaemonPidFileName</span>(<span class="sig-arg">name</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#DaemonPidFileName">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Compute a ganeti pid file absolute path</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>name</code></strong> (str) - the daemon name</li>
    </ul></dd>
    <dt>Returns: str</dt>
        <dd>the full path to the pidfile corresponding to the given daemon 
          name</dd>
  </dl>
</td></tr></table>
</div>
<a name="WritePidFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">WritePidFile</span>(<span class="sig-arg">pidfile</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#WritePidFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Write the current process pidfile.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>pidfile</code></strong> (string) - the path to the file to be written</li>
    </ul></dd>
    <dt>Returns: int</dt>
        <dd>the file descriptor of the lock file; do not close this unless 
          you want to unlock the pid file</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.LockError-class.html">errors.LockError</a></strong></code> - if the pid file already exists and points to a live process</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ReadWatcherPauseFile"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ReadWatcherPauseFile</span>(<span class="sig-arg">filename</span>,
        <span class="sig-arg">now</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">remove_after</span>=<span class="sig-default">3600</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#ReadWatcherPauseFile">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Reads the watcher pause file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>filename</code></strong> (string) - Path to watcher pause file</li>
        <li><strong class="pname"><code>now</code></strong> (None, float or int) - Current time as Unix timestamp</li>
        <li><strong class="pname"><code>remove_after</code></strong> (int) - Remove watcher pause file after specified amount of seconds past 
          the pause end time</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="NewUUID"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">NewUUID</span>()</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#NewUUID">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns a random UUID.</p>
  <dl class="fields">
    <dt>Returns: str</dt>
  </dl>
<div class="fields">      <p><strong>Note:</strong>
        This is a Linux-specific method as it uses the /proc filesystem.
      </p>
</div></td></tr></table>
</div>
<a name="IsUserInGroup"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">IsUserInGroup</span>(<span class="sig-arg">uid</span>,
        <span class="sig-arg">gid</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#IsUserInGroup">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns True if the user belongs to the group.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>uid</code></strong> (int) - the user id</li>
        <li><strong class="pname"><code>gid</code></strong> (int) - the group id</li>
    </ul></dd>
    <dt>Returns: bool</dt>
  </dl>
</td></tr></table>
</div>
<a name="CanRead"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CanRead</span>(<span class="sig-arg">username</span>,
        <span class="sig-arg">filename</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.utils.io-pysrc.html#CanRead">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns True if the user can access (read) the file.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>username</code></strong> (string) - the name of the user</li>
        <li><strong class="pname"><code>filename</code></strong> (string) - the name of the file</li>
    </ul></dd>
    <dt>Returns: bool</dt>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Aug 22 10:43:33 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
