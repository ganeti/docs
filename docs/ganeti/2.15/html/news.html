

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>News &mdash; Ganeti 2.15.2 documentation</title>
    
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.15.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Ganeti 2.15.2 documentation" href="index.html" />
    <link rel="next" title="OVF converter" href="ovfconverter.html" />
    <link rel="prev" title="Moving instances between clusters" href="move-instance.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ovfconverter.html" title="OVF converter"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="move-instance.html" title="Moving instances between clusters"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Ganeti 2.15.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="news">
<h1>News<a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h1>
<div class="section" id="version-2-15-2">
<h2>Version 2.15.2<a class="headerlink" href="#version-2-15-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 16 Dec 2015)</em></p>
<div class="section" id="important-changes-and-security-notes">
<h3>Important changes and security notes<a class="headerlink" href="#important-changes-and-security-notes" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="minor-changes">
<h3>Minor changes<a class="headerlink" href="#minor-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Allow disk aittachment to diskless instances</li>
<li>Reduce memory footprint: Compute lock allocation strictly</li>
<li>Calculate correct affected nodes set in InstanceChangeGroup
(Issue 1144)</li>
<li>Reduce memory footprint: Don&#8217;t keep input for error messages</li>
<li>Use bulk-adding of keys in renew-crypto</li>
<li>Reduce memory footprint: Send answers strictly</li>
<li>Reduce memory footprint: Store keys as ByteStrings</li>
<li>Reduce memory footprint: Encode UUIDs as ByteStrings</li>
<li>Do not retry all requests after connection timeouts to prevent
repeated job submission</li>
<li>Fix reason trails of expanding opcodes</li>
<li>Make lockConfig call retryable</li>
<li>Extend timeout for gnt-cluster renew-crypto</li>
<li>Return the correct error code in the post-upgrade script</li>
<li>Make OpenSSL refrain from DH altogether</li>
<li>Fix faulty iallocator type check</li>
<li>Improve cfgupgrade output in case of errors</li>
<li>Fix upgrades of instances with missing creation time</li>
<li>Support force option for deactivate disks on RAPI</li>
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>Fix default for &#8211;default-iallocator-params</li>
<li>Renew-crypto: stop daemons on master node first</li>
<li>Don&#8217;t warn about broken SSH setup of offline nodes (Issue 1131)</li>
<li>Fix computation in network blocks</li>
<li>At IAlloc backend guess state from admin state</li>
<li>Set node tags in iallocator htools backend</li>
<li>Only search for Python-2 interpreters</li>
<li>Handle Xen 4.3 states better</li>
<li>Improve xl socat migrations</li>
</ul>
</div>
</div>
<div class="section" id="version-2-15-1">
<h2>Version 2.15.1<a class="headerlink" href="#version-2-15-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 7 Sep 2015)</em></p>
<div class="section" id="new-features">
<h3>New features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The ext template now allows userspace-only disks to be used</li>
</ul>
</div>
<div class="section" id="bugfixes">
<h3>Bugfixes<a class="headerlink" href="#bugfixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed the silently broken &#8216;gnt-instance replace-disks &#8211;ignore-ipolicy&#8217;
command.</li>
<li>User shutdown reporting can now be disabled on Xen using the
&#8216;&#8211;user-shutdown&#8217; flag.</li>
<li>Remove falsely reported communication NIC error messages on instance start.</li>
<li>Fix &#8216;gnt-node migrate&#8217; behavior when no instances are present on a node.</li>
<li>Fix the multi-allocation functionality for non-DRBD instances.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-15-0">
<h2>Version 2.15.0<a class="headerlink" href="#version-2-15-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 29 Jul 2015)</em></p>
<div class="section" id="incompatible-important-changes">
<h3>Incompatible/important changes<a class="headerlink" href="#incompatible-important-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In order to improve allocation efficiency when using DRBD, the cluster
metric now takes the total reserved memory into account. A consequence
of this change is that the best possible cluster metric is no longer 0.
htools(1) interprets minimal cluster scores to be offsets of the theoretical
lower bound, so only users interpreting the cluster score directly should
be affected.</li>
<li>This release contains a fix for the problem that different encodings in
SSL certificates can break RPC communication (issue 1094). The fix makes
it necessary to rerun &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217;
after the cluster is fully upgraded to 2.14.1</li>
</ul>
</div>
<div class="section" id="id1">
<h3>New features<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>On dedicated clusters, hail will now favour allocations filling up
nodes efficiently over balanced allocations.</li>
</ul>
</div>
<div class="section" id="new-dependencies">
<h3>New dependencies<a class="headerlink" href="#new-dependencies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The indirect dependency on Haskell package &#8216;case-insensitive&#8217; is now
explicit.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-15-0-rc1">
<h2>Version 2.15.0 rc1<a class="headerlink" href="#version-2-15-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 17 Jun 2015)</em></p>
<p>This was the first release candidate in the 2.15 series. All important
changes are listed in the latest 2.15 entry.</p>
<div class="section" id="known-issues">
<h3>Known issues:<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Issue 1094: differences in encodings in SSL certificates due to
different OpenSSL versions can result in rendering a cluster
uncommunicative after a master-failover.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-15-0-beta1">
<h2>Version 2.15.0 beta1<a class="headerlink" href="#version-2-15-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 30 Apr 2015)</em></p>
<p>This was the second beta release in the 2.15 series. All important changes
are listed in the latest 2.15 entry.</p>
</div>
<div class="section" id="version-2-14-2">
<h2>Version 2.14.2<a class="headerlink" href="#version-2-14-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 15 Dec 2015)</em></p>
<div class="section" id="id2">
<h3>Important changes and security notes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id3">
<h3>Minor changes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Allow disk attachment to diskless instances</li>
<li>Calculate correct affected nodes set in InstanceChangeGroup
(Issue 1144)</li>
<li>Do not retry all requests after connection timeouts to prevent
repeated job submission</li>
<li>Fix reason trails of expanding opcodes</li>
<li>Make lockConfig call retryable</li>
<li>Extend timeout for gnt-cluster renew-crypto</li>
<li>Return the correct error code in the post-upgrade script</li>
<li>Make OpenSSL refrain from DH altogether</li>
<li>Fix faulty iallocator type check</li>
<li>Improve cfgupgrade output in case of errors</li>
<li>Fix upgrades of instances with missing creation time</li>
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>Fix default for &#8211;default-iallocator-params</li>
<li>Renew-crypto: stop daemons on master node first</li>
<li>Don&#8217;t warn about broken SSH setup of offline nodes (Issue 1131)</li>
<li>At IAlloc backend guess state from admin state</li>
<li>Set node tags in iallocator htools backend</li>
<li>Only search for Python-2 interpreters</li>
<li>Handle Xen 4.3 states better</li>
<li>Improve xl socat migrations</li>
<li>replace-disks: fix &#8211;ignore-ipolicy</li>
<li>Fix disabling of user shutdown reporting</li>
<li>Allow userspace-only disk templates</li>
<li>Fix instance failover in case of DTS_EXT_MIRROR</li>
<li>Fix operations on empty nodes by accepting allocation of 0 jobs</li>
<li>Fix instance multi allocation for non-DRBD disks</li>
<li>Redistribute master key on downgrade</li>
<li>Allow more failover options when using the &#8211;no-disk-moves flag</li>
</ul>
</div>
</div>
<div class="section" id="version-2-14-1">
<h2>Version 2.14.1<a class="headerlink" href="#version-2-14-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 10 Jul 2015)</em></p>
<div class="section" id="id4">
<h3>Incompatible/important changes<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The SSH security changes reduced the number of nodes which can SSH into
other nodes. Unfortunately enough, the Ganeti implementation of migration
for the xl stack of Xen required SSH to be able to migrate the instance,
leading to a situation where full movement of an instance around the cluster
was not possible. This version fixes the issue by using socat to transfer
instance data. While socat is less secure than SSH, it is about as secure as
xm migrations, and occurs over the secondary network if present. As a
consequence of this change, Xen instance migrations using xl cannot occur
between nodes running 2.14.0 and 2.14.1.</li>
<li>This release contains a fix for the problem that different encodings in
SSL certificates can break RPC communication (issue 1094). The fix makes
it necessary to rerun &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217;
after the cluster is fully upgraded to 2.14.1</li>
</ul>
</div>
<div class="section" id="other-changes">
<h3>Other Changes<a class="headerlink" href="#other-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">htools</span></tt> now properly work also on shared-storage clusters.</li>
<li>Instance moves now work properly also for the plain disk template.</li>
<li>Filter-evaluation for run-time data filter was fixed (issue 1100).</li>
<li>Various improvements to the documentation have been added.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-14-0">
<h2>Version 2.14.0<a class="headerlink" href="#version-2-14-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 2 Jun 2015)</em></p>
<div class="section" id="id5">
<h3>New features<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The build system now enforces external Haskell dependencies to lie in
a supported range as declared by our new ganeti.cabal file.</li>
<li>Basic support for instance reservations has been added. Instance addition
supports a &#8211;forthcoming option telling Ganeti to only reserve the resources
but not create the actual instance. The instance can later be created with
by passing the &#8211;commit option to the instance addition command.</li>
<li>Node tags starting with htools:nlocation: now have a special meaning to htools(1).
They control between which nodes migration is possible, e.g., during hypervisor
upgrades. See hbal(1) for details.</li>
<li>The node-allocation lock as been removed for good, thus speeding up parallel
instance allocation and creation.</li>
<li>The external storage interface has been extended by optional <tt class="docutils literal"><span class="pre">open</span></tt>
and <tt class="docutils literal"><span class="pre">close</span></tt> scripts.</li>
</ul>
</div>
<div class="section" id="id6">
<h3>New dependencies<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Building the Haskell part of Ganeti now requires Cabal and cabal-install.</li>
</ul>
</div>
<div class="section" id="id7">
<h3>Known issues<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Under certain conditions instance doesn&#8217;t get unpaused after live
migration (issue #1050)</li>
</ul>
</div>
<div class="section" id="since-2-14-0-rc1">
<h3>Since 2.14.0 rc1<a class="headerlink" href="#since-2-14-0-rc1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The call to the IAllocator in &#8216;gnt-node evacuate&#8217; has been fixed.</li>
<li>In opportunistic locking, only ask for those node resource locks where
the node lock is held.</li>
<li>Lock requests are repeatable now; this avoids failure of a job in a
race condition with a signal sent to the job.</li>
<li>Various improvements to the QA.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-14-0-rc2">
<h2>Version 2.14.0 rc2<a class="headerlink" href="#version-2-14-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 19 May 2015)</em></p>
<p>This was the second release candidate in the 2.14 series. All important
changes are listed in the 2.14.0 entry.</p>
<div class="section" id="id8">
<h3>Since 2.14.0 rc1<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>private parameters are now properly exported to instance create scripts</li>
<li>unnecessary config unlocks and upgrades have been removed, improving
performance, in particular of cluster verification</li>
<li>some rarely occuring file-descriptor leaks have been fixed</li>
<li>The checks for orphan and lost volumes have been fixed to also work
correctly when multiple volume groups are used.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-14-0-rc1">
<h2>Version 2.14.0 rc1<a class="headerlink" href="#version-2-14-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 29 Apr 2015)</em></p>
<p>This was the first release candidate in the 2.14 series. All important
changes are listed in the latest 2.14 entry.</p>
<div class="section" id="since-2-14-0-beta2">
<h3>Since 2.14.0 beta2<a class="headerlink" href="#since-2-14-0-beta2" title="Permalink to this headline">¶</a></h3>
<p>The following issue has been fixed:</p>
<ul class="simple">
<li>A race condition where a badly timed kill of WConfD could lead to
an incorrect configuration.</li>
</ul>
<p>Fixes inherited from the 2.12 branch:</p>
<ul class="simple">
<li>Upgrade from old versions (2.5 and 2.6) was failing (issues 1070, 1019).</li>
<li>gnt-network info outputs wrong external reservations (issue 1068)</li>
<li>Refuse to demote master from master capability (issue 1023)</li>
</ul>
<p>Fixes inherited from the 2.13 branch:</p>
<ul class="simple">
<li>bugs related to ssh-key handling of master candidate (issues 1045, 1046, 1047)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-14-0-beta2">
<h2>Version 2.14.0 beta2<a class="headerlink" href="#version-2-14-0-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 26 Mar 2015)</em></p>
<p>This was the second beta release in the 2.14 series. All important changes
are listed in the latest 2.14 entry.</p>
<div class="section" id="since-2-14-0-beta1">
<h3>Since 2.14.0 beta1<a class="headerlink" href="#since-2-14-0-beta1" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Issue 1018: Cluster init (and possibly other jobs) occasionally fail to start</li>
</ul>
<p>The extension of the external storage interface was not present in 2.14.0 beta1.</p>
</div>
</div>
<div class="section" id="version-2-14-0-beta1">
<h2>Version 2.14.0 beta1<a class="headerlink" href="#version-2-14-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 13 Feb 2015)</em></p>
<p>This was the first beta release of the 2.14 series. All important changes
are listed in the latest 2.14 entry.</p>
</div>
<div class="section" id="version-2-13-3">
<h2>Version 2.13.3<a class="headerlink" href="#version-2-13-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 14 Dec 2015)</em></p>
<div class="section" id="id9">
<h3>Important changes and security notes<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id10">
<h3>Minor changes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Calculate correct affected nodes set in InstanceChangeGroup
(Issue 1144)</li>
<li>Do not retry all requests after connection timeouts to prevent
repeated job submission</li>
<li>Fix reason trails of expanding opcodes</li>
<li>Make lockConfig call retryable</li>
<li>Extend timeout for gnt-cluster renew-crypto</li>
<li>Return the correct error code in the post-upgrade script</li>
<li>Make OpenSSL refrain from DH altogether</li>
<li>Fix upgrades of instances with missing creation time</li>
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>Fix default for &#8211;default-iallocator-params</li>
<li>Renew-crypto: stop daemons on master node first</li>
<li>Don&#8217;t warn about broken SSH setup of offline nodes (Issue 1131)</li>
<li>At IAlloc backend guess state from admin state</li>
<li>Only search for Python-2 interpreters</li>
<li>Handle Xen 4.3 states better</li>
<li>Improve xl socat migrations</li>
<li>replace-disks: fix &#8211;ignore-ipolicy</li>
<li>Fix disabling of user shutdown reporting</li>
<li>Fix operations on empty nodes by accepting allocation of 0 jobs</li>
<li>Fix instance multi allocation for non-DRBD disks</li>
<li>Redistribute master key on downgrade</li>
<li>Allow more failover options when using the &#8211;no-disk-moves flag</li>
</ul>
</div>
</div>
<div class="section" id="version-2-13-2">
<h2>Version 2.13.2<a class="headerlink" href="#version-2-13-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 13 Jul 2015)</em></p>
<div class="section" id="id11">
<h3>Incompatible/important changes<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>This release contains a fix for the problem that different encodings in
SSL certificates can break RPC communication (issue 1094). The fix makes
it necessary to rerun &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217;
after the cluster is fully upgraded to 2.13.2</li>
</ul>
</div>
<div class="section" id="other-fixes-and-known-issues">
<h3>Other fixes and known issues<a class="headerlink" href="#other-fixes-and-known-issues" title="Permalink to this headline">¶</a></h3>
<p>Inherited from 2.12:</p>
<ul class="simple">
<li>Fixed Issue #1115: Race between starting WConfD and updating the config</li>
<li>Fixed Issue #1114: Binding RAPI to a specific IP makes the watcher
restart the RAPI</li>
<li>Fixed Issue #1100: Filter-evaluation for run-time data filter</li>
<li>Better handling of the &#8220;crashed&#8221; Xen state</li>
<li>The watcher can be instructed to skip disk verification</li>
<li>Reduce amount of logging on successful requests</li>
<li>Prevent multiple communication NICs being created for instances</li>
<li>The <tt class="docutils literal"><span class="pre">htools</span></tt> now properly work also on shared-storage clusters</li>
<li>Instance moves now work properly also for the plain disk template</li>
<li>Various improvements to the documentation have been added</li>
</ul>
<p>Known issues:
- Issue #1104: gnt-backup: dh key too small</p>
</div>
</div>
<div class="section" id="version-2-13-1">
<h2>Version 2.13.1<a class="headerlink" href="#version-2-13-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 16 Jun 2015)</em></p>
<div class="section" id="id12">
<h3>Incompatible/important changes<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The SSH security changes reduced the number of nodes which can SSH into
other nodes. Unfortunately enough, the Ganeti implementation of migration
for the xl stack of Xen required SSH to be able to migrate the instance,
leading to a situation where full movement of an instance around the cluster
was not possible. This version fixes the issue by using socat to transfer
instance data. While socat is less secure than SSH, it is about as secure as
xm migrations, and occurs over the secondary network if present. As a
consequence of this change, Xen instance migrations using xl cannot occur
between nodes running 2.13.0 and 2.13.1.</li>
</ul>
</div>
<div class="section" id="id13">
<h3>Other fixes and known issues<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>Inherited from 2.12:</p>
<ul class="simple">
<li>Fixed Issue #1082: RAPI is unresponsive after master-failover</li>
<li>Fixed Issue #1083: Cluster verify reports existing instance disks on
non-default VGs as missing</li>
<li>Fixed Issue #1101: Modifying the storage directory for the shared-file disk
template doesn&#8217;t work</li>
<li>Fixed a possible file descriptor leak when forking jobs</li>
<li>Fixed missing private parameters in the environment for OS scripts</li>
<li>Fixed a performance regression when handling configuration
(only upgrade it if it changes)</li>
<li>Adapt for compilation with GHC7.8 (compiles with warnings;
cherrypicked from 2.14)</li>
</ul>
<p>Known issues:
- Issue #1094: Mismatch in SSL encodings breaks RPC communication
- Issue #1104: Export fails: key is too small</p>
</div>
</div>
<div class="section" id="version-2-13-0">
<h2>Version 2.13.0<a class="headerlink" href="#version-2-13-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 28 Apr 2015)</em></p>
<div class="section" id="id14">
<h3>Incompatible/important changes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Ganeti now internally retries the instance creation opcode if opportunistic
locking did not acquire nodes with enough free resources. The internal retry
will not use opportunistic locking. In particular, instance creation, even
if opportunistic locking is set, will never fail with ECODE_TEMP_NORES.</li>
<li>The handling of SSH security had undergone a significant change. From
this version on, each node has an individual SSH key pair instead of
sharing one with all nodes of the cluster. From now on, we also
restrict SSH access to master candidates. This means that only master
candidates can ssh into other cluster nodes and all
non-master-candidates cannot. Refer to the UPGRADE notes
for further instructions on the creation and distribution of the keys.</li>
<li>Ganeti now checks hypervisor version compatibility before trying an instance
migration. It errors out if the versions are not compatible. Add the option
&#8211;ignore-hvversions to restore the old behavior of only warning.</li>
<li>Node tags starting with htools:migration: or htools:allowmigration: now have
a special meaning to htools(1). See hbal(1) for details.</li>
<li>The LXC hypervisor code has been repaired and improved. Instances cannot be
migrated and cannot have more than one disk, but should otherwise work as with
other hypervisors. OS script changes should not be necessary. LXC version
1.0.0 or higher required.</li>
</ul>
</div>
<div class="section" id="id15">
<h3>New features<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A new job filter rules system allows to define iptables-like rules for the
job scheduler, making it easier to (soft-)drain the job queue, perform
maintenance, and rate-limit selected job types. See gnt-filter(8) for
details.</li>
<li>Ganeti jobs can now be ad-hoc rate limited via the reason trail.
For a set of jobs queued with &#8220;&#8211;reason=rate-limit:n:label&#8221;, the job
scheduler ensures that not more than n will be scheduled to run at the same
time. See ganeti(7), section &#8220;Options&#8221;, for details.</li>
<li>The monitoring daemon has now variable sleep times for the data
collectors. This currently means that the granularity of cpu-avg-load
can be configured.</li>
<li>The &#8216;gnt-cluster verify&#8217; command now has the option
&#8216;&#8211;verify-ssh-clutter&#8217;, which verifies whether Ganeti (accidentally)
cluttered up the &#8216;authorized_keys&#8217; file.</li>
<li>Instance disks can now be converted from one disk template to another for many
different template combinations. When available, more efficient conversions
will be used, otherwise the disks are simply copied over.</li>
</ul>
</div>
<div class="section" id="id16">
<h3>New dependencies<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The monitoring daemon uses the PSQueue library. Be sure to install it
if you use Mond.</li>
<li>The formerly optional regex-pcre is now an unconditional dependency because
the new job filter rules have regular expressions as a core feature.</li>
</ul>
</div>
<div class="section" id="since-2-13-0-rc1">
<h3>Since 2.13.0 rc1<a class="headerlink" href="#since-2-13-0-rc1" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Bugs related to ssh-key handling of master candidates (issues 1045,
1046, 1047)</li>
</ul>
<p>Fixes inherited from the 2.12 branch:</p>
<ul class="simple">
<li>Upgrade from old versions (2.5 and 2.6) was failing (issues 1070, 1019).</li>
<li>gnt-network info outputs wrong external reservations (issue 1068)</li>
<li>Refuse to demote master from master capability (issue 1023)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-13-0-rc1">
<h2>Version 2.13.0 rc1<a class="headerlink" href="#version-2-13-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 25 Mar 2015)</em></p>
<p>This was the first release candidate of the 2.13 series.
All important changes are listed in the latest 2.13 entry.</p>
<div class="section" id="since-2-13-0-beta1">
<h3>Since 2.13.0 beta1<a class="headerlink" href="#since-2-13-0-beta1" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Issue 1018: Cluster init (and possibly other jobs) occasionally fail to start</li>
</ul>
</div>
</div>
<div class="section" id="version-2-13-0-beta1">
<h2>Version 2.13.0 beta1<a class="headerlink" href="#version-2-13-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 14 Jan 2015)</em></p>
<p>This was the first beta release of the 2.13 series. All important changes
are listed in the latest 2.13 entry.</p>
</div>
<div class="section" id="version-2-12-6">
<h2>Version 2.12.6<a class="headerlink" href="#version-2-12-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 14 Dec 2015)</em></p>
<div class="section" id="id17">
<h3>Important changes and security notes<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id18">
<h3>Minor changes<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Calculate correct affected nodes set in InstanceChangeGroup
(Issue 1144)</li>
<li>Do not retry all requests after connection timeouts to prevent
repeated job submission</li>
<li>Fix reason trails of expanding opcodes</li>
<li>Make lockConfig call retryable</li>
<li>Return the correct error code in the post-upgrade script</li>
<li>Make OpenSSL refrain from DH altogether</li>
<li>Fix upgrades of instances with missing creation time</li>
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>Fix default for &#8211;default-iallocator-params</li>
<li>At IAlloc backend guess state from admin state</li>
<li>Only search for Python-2 interpreters</li>
<li>Handle Xen 4.3 states better</li>
<li>replace-disks: fix &#8211;ignore-ipolicy</li>
<li>Fix disabling of user shutdown reporting</li>
<li>Fix operations on empty nodes by accepting allocation of 0 jobs</li>
<li>Fix instance multi allocation for non-DRBD disks</li>
<li>Allow more failover options when using the &#8211;no-disk-moves flag</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-5">
<h2>Version 2.12.5<a class="headerlink" href="#version-2-12-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 13 Jul 2015)</em></p>
<div class="section" id="id19">
<h3>Incompatible/important changes<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>This release contains a fix for the problem that different encodings in
SSL certificates can break RPC communication (issue 1094). The fix makes
it necessary to rerun &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217;
after the cluster is fully upgraded to 2.12.5.</li>
</ul>
</div>
<div class="section" id="fixed-and-improvements">
<h3>Fixed and improvements<a class="headerlink" href="#fixed-and-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed Issue #1030: GlusterFS support breaks at upgrade to 2.12 -
switches back to shared-file</li>
<li>Fixed Issue #1094 (see the notice in Incompatible/important changes):
Differences in encodings of SSL certificates can render a cluster
uncommunicative after a master-failover</li>
<li>Fixed Issue #1098: Support for ECDSA SSH keys</li>
<li>Fixed Issue #1100: Filter-evaluation for run-time data filter</li>
<li>Fixed Issue #1101: Modifying the storage directory for the shared-file
disk template doesn&#8217;t work</li>
<li>Fixed Issue #1108: Spurious &#8220;NIC name already used&#8221; errors during
instance creation</li>
<li>Fixed Issue #1114: Binding RAPI to a specific IP makes the watcher
restart the RAPI</li>
<li>Fixed Issue #1115: Race between starting WConfD and updating the config</li>
<li>Better handling of the &#8220;crashed&#8221; Xen state</li>
<li>The <tt class="docutils literal"><span class="pre">htools</span></tt> now properly work also on shared-storage clusters</li>
<li>Various improvements to the documentation have been added</li>
</ul>
<p>Inherited from the 2.11 branch:</p>
<ul class="simple">
<li>Fixed Issue #1113: Reduce amount of logging on successful requests</li>
</ul>
</div>
<div class="section" id="id20">
<h3>Known issues<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Issue #1104: gnt-backup: dh key too small</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-4">
<h2>Version 2.12.4<a class="headerlink" href="#version-2-12-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 12 May 2015)</em></p>
<ul class="simple">
<li>Fixed Issue #1082: RAPI is unresponsive after master-failover</li>
<li>Fixed Issue #1083: Cluster verify reports existing instance disks on
non-default VGs as missing</li>
<li>Fixed a possible file descriptor leak when forking jobs</li>
<li>Fixed missing private parameters in the environment for OS scripts</li>
<li>Fixed a performance regression when handling configuration
(only upgrade it if it changes)</li>
<li>Adapt for compilation with GHC7.8 (compiles with warnings;
cherrypicked from 2.14)</li>
</ul>
<div class="section" id="id21">
<h3>Known issues<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>Pending since 2.12.2:</p>
<ul class="simple">
<li>Under certain conditions instance doesn&#8217;t get unpaused after live
migration (issue #1050)</li>
<li>GlusterFS support breaks at upgrade to 2.12 - switches back to
shared-file (issue #1030)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-3">
<h2>Version 2.12.3<a class="headerlink" href="#version-2-12-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 29 Apr 2015)</em></p>
<ul class="simple">
<li>Fixed Issue #1019: upgrade from 2.6.2 to 2.12 fails. cfgupgrade
doesn&#8217;t migrate the config.data file properly</li>
<li>Fixed Issue 1023: Master master-capable option bug</li>
<li>Fixed Issue 1068: gnt-network info outputs wrong external reservations</li>
<li>Fixed Issue 1070: Upgrade of Ganeti 2.5.2 to 2.12.0 fails due to
missing UUIDs for disks</li>
<li>Fixed Issue 1073: ssconf_hvparams_* not distributed with ssconf</li>
</ul>
<p>Inherited from the 2.11 branch:</p>
<ul class="simple">
<li>Fixed Issue 1032: Renew-crypto &#8211;new-node-certificates sometimes does not
complete.
The operation &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217; is
now more robust against intermitten reachability errors. Nodes that
are temporarily not reachable, are contacted with several retries.
Nodes which are marked as offline are omitted right away.</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Fixed Issue 1057: master-failover succeeds, but IP remains assigned to
old master</li>
<li>Fixed Issue 1058: Python&#8217;s os.minor() does not support devices with
high minor numbers</li>
<li>Fixed Issue 1059: Luxid fails if DNS returns an IPv6 address that does
not reverse resolve</li>
</ul>
<div class="section" id="id22">
<h3>Known issues<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>Pending since 2.12.2:</p>
<ul class="simple">
<li>GHC 7.8 introduced some incompatible changes, so currently Ganeti
2.12. doesn&#8217;t compile on GHC 7.8</li>
<li>Under certain conditions instance doesn&#8217;t get unpaused after live
migration (issue #1050)</li>
<li>GlusterFS support breaks at upgrade to 2.12 - switches back to
shared-file (issue #1030)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-2">
<h2>Version 2.12.2<a class="headerlink" href="#version-2-12-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 25 Mar 2015)</em></p>
<ul class="simple">
<li>Support for the lens Haskell library up to version 4.7 (issue #1028)</li>
<li>SSH keys are now distributed only to master and master candidates
(issue #377)</li>
<li>Improved performance for operations that frequently read the
cluster configuration</li>
<li>Improved robustness of spawning job processes that occasionally caused
newly-started jobs to timeout</li>
<li>Fixed race condition during cluster verify which occasionally caused
it to fail</li>
</ul>
<p>Inherited from the 2.11 branch:</p>
<ul class="simple">
<li>Fix failing automatic glusterfs mounts (issue #984)</li>
<li>Fix watcher failing to read its status file after an upgrade
(issue #1022)</li>
<li>Improve Xen instance state handling, in particular of somewhat exotic
transitional states</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Fix failing to change a diskless drbd instance to plain
(issue #1036)</li>
<li>Fixed issues with auto-upgrades from pre-2.6
(hv_state_static and disk_state_static)</li>
<li>Fix memory leak in the monitoring daemon</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Fix file descriptor leak in Confd client</li>
</ul>
<div class="section" id="id23">
<h3>Known issues<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>GHC 7.8 introduced some incompatible changes, so currently Ganeti
2.12. doesn&#8217;t compile on GHC 7.8</li>
<li>Under certain conditions instance doesn&#8217;t get unpaused after live
migration (issue #1050)</li>
<li>GlusterFS support breaks at upgrade to 2.12 - switches back to
shared-file (issue #1030)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-1">
<h2>Version 2.12.1<a class="headerlink" href="#version-2-12-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 14 Jan 2015)</em></p>
<ul class="simple">
<li>Fix users under which the wconfd and metad daemons run (issue #976)</li>
<li>Clean up stale livelock files (issue #865)</li>
<li>Fix setting up the metadata daemon&#8217;s network interface for Xen</li>
<li>Make watcher identify itself on disk activation</li>
<li>Add &#8220;ignore-ipolicy&#8221; option to gnt-instance grow-disk</li>
<li>Check disk size ipolicy during &#8220;gnt-instance grow-disk&#8221; (issue #995)</li>
</ul>
<p>Inherited from the 2.11 branch:</p>
<ul class="simple">
<li>Fix counting votes when doing master failover (issue #962)</li>
<li>Fix broken haskell dependencies (issues #758 and #912)</li>
<li>Check if IPv6 is used directly when running SSH (issue #892)</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Fix typo in gnt_cluster output (issue #1015)</li>
<li>Use the Python path detected at configure time in the top-level Python
scripts.</li>
<li>Fix check for sphinx-build from python2-sphinx</li>
<li>Properly check if an instance exists in &#8216;gnt-instance console&#8217;</li>
</ul>
</div>
<div class="section" id="version-2-12-0">
<h2>Version 2.12.0<a class="headerlink" href="#version-2-12-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 10 Oct 2014)</em></p>
<div class="section" id="id24">
<h3>Incompatible/important changes<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Ganeti is now distributed under the 2-clause BSD license.
See the COPYING file.</li>
<li>Do not use debug mode in production. Certain daemons will issue warnings
when launched in debug mode. Some debug logging violates some of the new
invariants in the system (see &#8220;New features&#8221;). The logging has been kept as
it aids diagnostics and development.</li>
</ul>
</div>
<div class="section" id="id25">
<h3>New features<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>OS install script parameters now come in public, private and secret
varieties:<ul>
<li>Public parameters are like all other parameters in Ganeti.</li>
<li>Ganeti will not log private and secret parameters, <em>unless</em> it is running
in debug mode.</li>
<li>Ganeti will not save secret parameters to configuration. Secret parameters
must be supplied every time you install, or reinstall, an instance.</li>
<li>Attempting to override public parameters with private or secret parameters
results in an error. Similarly, you may not use secret parameters to
override private parameters.</li>
</ul>
</li>
<li>The move-instance tool can now attempt to allocate an instance by using
opportunistic locking when an iallocator is used.</li>
<li>The build system creates sample systemd unit files, available under
doc/examples/systemd. These unit files allow systemd to natively
manage and supervise all Ganeti processes.</li>
<li>Different types of compression can be applied during instance moves, including
user-specified ones.</li>
<li>Ganeti jobs now run as separate processes. The jobs are coordinated by
a new daemon &#8220;WConfd&#8221; that manages cluster&#8217;s configuration and locks
for individual jobs. A consequence is that more jobs can run in parallel;
the number is run-time configurable, see &#8220;New features&#8221; entry
of 2.11.0. To avoid luxid being overloaded with tracking running jobs, it
backs of and only occasionally, in a sequential way, checks if jobs have
finished and schedules new ones. In this way, luxid keeps responsive under
high cluster load. The limit as when to start backing of is also run-time
configurable.</li>
<li>The metadata daemon is now optionally available, as part of the
partial implementation of the OS-installs design. It allows pass
information to OS install scripts or to instances.
It is also possible to run Ganeti without the daemon, if desired.</li>
<li>Detection of user shutdown of instances has been implemented for Xen
as well.</li>
</ul>
</div>
<div class="section" id="id26">
<h3>New dependencies<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The KVM CPU pinning no longer uses the affinity python package, but psutil
instead. The package is still optional and needed only if the feature is to
be used.</li>
</ul>
</div>
<div class="section" id="incomplete-features">
<h3>Incomplete features<a class="headerlink" href="#incomplete-features" title="Permalink to this headline">¶</a></h3>
<p>The following issues are related to features which are not completely
implemented in 2.12:</p>
<ul class="simple">
<li>Issue 885: Network hotplugging on KVM sometimes makes an instance
unresponsive</li>
<li>Issues 708 and 602: The secret parameters are currently still written
to disk in the job queue.</li>
<li>Setting up the metadata network interface under Xen isn&#8217;t fully
implemented yet.</li>
</ul>
</div>
<div class="section" id="id27">
<h3>Known issues<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><em>Wrong UDP checksums in DHCP network packets:</em>
If an instance communicates with the metadata daemon and uses DHCP to
obtain its IP address on the provided virtual network interface,
it can happen that UDP packets have a wrong checksum, due to
a bug in virtio. See for example <a class="reference external" href="https://bugs.launchpad.net/bugs/930962">https://bugs.launchpad.net/bugs/930962</a></p>
<p>Ganeti works around this bug by disabling the UDP checksums on the way
from a host to instances (only on the special metadata communication
network interface) using the ethtool command. Therefore if using
the metadata daemon the host nodes should have this tool available.</p>
</li>
<li><p class="first">The metadata daemon is run as root in the split-user mode, to be able
to bind to port 80.
This should be improved in future versions, see issue #949.</p>
</li>
</ul>
</div>
<div class="section" id="since-2-12-0-rc2">
<h3>Since 2.12.0 rc2<a class="headerlink" href="#since-2-12-0-rc2" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Fixed passing additional parameters to RecreateInstanceDisks over
RAPI.</li>
<li>Fixed the permissions of WConfd when running in the split-user mode.
As WConfd takes over the previous master daemon to manage the
configuration, it currently runs under the masterd user.</li>
<li>Fixed the permissions of the metadata daemon  wn running in the
split-user mode (see Known issues).</li>
<li>Watcher now properly adds a reason trail entry when initiating disk
checks.</li>
<li>Fixed removing KVM parameters introduced in 2.12 when downgrading a
cluster to 2.11: &#8220;migration_caps&#8221;, &#8220;disk_aio&#8221; and &#8220;virtio_net_queues&#8221;.</li>
<li>Improved retrying of RPC calls that fail due to network errors.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-0-rc2">
<h2>Version 2.12.0 rc2<a class="headerlink" href="#version-2-12-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 22 Sep 2014)</em></p>
<p>This was the second release candidate of the 2.12 series.
All important changes are listed in the latest 2.12 entry.</p>
<div class="section" id="since-2-12-0-rc1">
<h3>Since 2.12.0 rc1<a class="headerlink" href="#since-2-12-0-rc1" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Watcher now checks if WConfd is running and functional.</li>
<li>Watcher now properly adds reason trail entries.</li>
<li>Fixed NIC options in Xen&#8217;s config files.</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Fixed handling of the &#8211;online option</li>
<li>Add warning against hvparam changes with live migrations, which might
lead to dangerous situations for instances.</li>
<li>Only the LVs in the configured VG are checked during cluster verify.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-0-rc1">
<h2>Version 2.12.0 rc1<a class="headerlink" href="#version-2-12-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 20 Aug 2014)</em></p>
<p>This was the first release candidate of the 2.12 series.
All important changes are listed in the latest 2.12 entry.</p>
<div class="section" id="since-2-12-0-beta1">
<h3>Since 2.12.0 beta1<a class="headerlink" href="#since-2-12-0-beta1" title="Permalink to this headline">¶</a></h3>
<p>The following issues have been fixed:</p>
<ul class="simple">
<li>Issue 881: Handle communication errors in mcpu</li>
<li>Issue 883: WConfd leaks memory for some long operations</li>
<li>Issue 884: Under heavy load the IAllocator fails with a &#8220;missing
instance&#8221; error</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Improve the recognition of Xen domU states</li>
<li>Automatic upgrades:
- Create the config backup archive in a safe way
- On upgrades, check for upgrades to resume first
- Pause watcher during upgrade</li>
<li>Allow instance disks to be added with &#8211;no-wait-for-sync</li>
</ul>
</div>
</div>
<div class="section" id="version-2-12-0-beta1">
<h2>Version 2.12.0 beta1<a class="headerlink" href="#version-2-12-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 21 Jul 2014)</em></p>
<p>This was the first beta release of the 2.12 series. All important changes
are listed in the latest 2.12 entry.</p>
</div>
<div class="section" id="version-2-11-8">
<h2>Version 2.11.8<a class="headerlink" href="#version-2-11-8" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 14 Dec 2015)</em></p>
<div class="section" id="id28">
<h3>Important changes and security notes<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id29">
<h3>Minor changes<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>Fix default for &#8211;default-iallocator-params</li>
<li>At IAlloc backend guess state from admin state</li>
<li>replace-disks: fix &#8211;ignore-ipolicy</li>
<li>Fix instance multi allocation for non-DRBD disks</li>
<li>Trigger renew-crypto on downgrade to 2.11</li>
<li>Downgrade log-message for rereading job</li>
<li>Downgrade log-level for successful requests</li>
<li>Check for gnt-cluster before running gnt-cluster upgrade</li>
</ul>
</div>
</div>
<div class="section" id="version-2-11-7">
<h2>Version 2.11.7<a class="headerlink" href="#version-2-11-7" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 17 Apr 2015)</em></p>
<ul class="simple">
<li>The operation &#8216;gnt-cluster renew-crypto &#8211;new-node-certificates&#8217; is
now more robust against intermitten reachability errors. Nodes that
are temporarily not reachable, are contacted with several retries.
Nodes which are marked as offline are omitted right away.</li>
</ul>
</div>
<div class="section" id="version-2-11-6">
<h2>Version 2.11.6<a class="headerlink" href="#version-2-11-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 22 Sep 2014)</em></p>
<ul class="simple">
<li>Ganeti is now distributed under the 2-clause BSD license.
See the COPYING file.</li>
<li>Fix userspace access checks.</li>
<li>Various documentation fixes have been added.</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>The &#8211;online option now works as documented.</li>
<li>The watcher is paused during cluster upgrades; also, upgrade
checks for upgrades to resume first.</li>
<li>Instance disks can be added with &#8211;no-wait-for-sync.</li>
</ul>
</div>
<div class="section" id="version-2-11-5">
<h2>Version 2.11.5<a class="headerlink" href="#version-2-11-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 7 Aug 2014)</em></p>
<p>Inherited from the 2.10 branch:</p>
<p>Important security release. In 2.10.0, the
&#8216;gnt-cluster upgrade&#8217; command was introduced. Before
performing an upgrade, the configuration directory of
the cluster is backed up. Unfortunately, the archive was
written with permissions that make it possible for
non-privileged users to read the archive and thus have
access to cluster and RAPI keys. After this release,
the archive will be created with privileged access only.</p>
<p>We strongly advise you to restrict the permissions of
previously created archives. The archives are found in
/var/lib/ganeti*.tar (unless otherwise configured with
&#8211;localstatedir or &#8211;with-backup-dir).</p>
<p>If you suspect that non-privileged users have accessed
your archives already, we advise you to renew the
cluster&#8217;s crypto keys using &#8216;gnt-cluster renew-crypto&#8217;
and to reset the RAPI credentials by editing
/var/lib/ganeti/rapi_users (respectively under a
different path if configured differently with
&#8211;localstatedir).</p>
<p>Other changes included in this release:</p>
<ul class="simple">
<li>Fix handling of Xen instance states.</li>
<li>Fix NIC configuration with absent NIC VLAN</li>
<li>Adapt relative path expansion in PATH to new environment</li>
<li>Exclude archived jobs from configuration backups</li>
<li>Fix RAPI for split query setup</li>
<li>Allow disk hot-remove even with chroot or SM</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make htools tolerate missing &#8216;spfree&#8217; on luxi</li>
</ul>
</div>
<div class="section" id="version-2-11-4">
<h2>Version 2.11.4<a class="headerlink" href="#version-2-11-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 31 Jul 2014)</em></p>
<ul class="simple">
<li>Improved documentation of the instance shutdown behavior.</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>KVM: fix NIC configuration with absent NIC VLAN (Issue 893)</li>
<li>Adapt relative path expansion in PATH to new environment</li>
<li>Exclude archived jobs from configuration backup</li>
<li>Expose early_release for ReplaceInstanceDisks</li>
<li>Add backup directory for configuration backups for upgrades</li>
<li>Fix BlockdevSnapshot in case of non lvm-based disk</li>
<li>Improve RAPI error handling for queries in non-existing items</li>
<li>Allow disk hot-remove even with chroot or SM</li>
<li>Remove superflous loop in instance queries (Issue 875)</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make ganeti-cleaner switch to save working directory (Issue 880)</li>
</ul>
</div>
<div class="section" id="version-2-11-3">
<h2>Version 2.11.3<a class="headerlink" href="#version-2-11-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 9 Jul 2014)</em></p>
<ul class="simple">
<li>Readd nodes to their previous node group</li>
<li>Remove old-style gnt-network connect</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Make network_vlan an optional OpParam</li>
<li>hspace: support &#8211;accept-existing-errors</li>
<li>Make hspace support &#8211;independent-groups</li>
<li>Add a modifier for a group&#8217;s allocation policy</li>
<li>Export VLAN nicparam to NIC configuration scripts</li>
<li>Fix gnt-network client to accept vlan info</li>
<li>Support disk hotplug with userspace access</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make htools tolerate missing &#8220;spfree&#8221; on luxi</li>
<li>Move the design for query splitting to the implemented list</li>
<li>Add tests for DRBD setups with empty first resource</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>DRBD parser: consume initial empty resource lines</li>
</ul>
</div>
<div class="section" id="version-2-11-2">
<h2>Version 2.11.2<a class="headerlink" href="#version-2-11-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 13 Jun 2014)</em></p>
<ul class="simple">
<li>Improvements to KVM wrt to the kvmd and instance shutdown behavior.
WARNING: In contrast to our standard policy, this bug fix update
introduces new parameters to the configuration. This means in
particular that after an upgrade from 2.11.0 or 2.11.1, &#8216;cfgupgrade&#8217;
needs to be run, either manually or explicitly by running
&#8216;gnt-cluster upgrade &#8211;to 2.11.2&#8217; (which requires that they
had configured the cluster with &#8211;enable-versionfull).
This also means, that it is not easily possible to downgrade from
2.11.2 to 2.11.1 or 2.11.0. The only way is to go back to 2.10 and
back.</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Check for SSL encoding inconsistencies</li>
<li>Check drbd helper only in VM capable nodes</li>
<li>Improvements in statistics utils</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>check-man-warnings: use C.UTF-8 and set LC_ALL</li>
</ul>
</div>
<div class="section" id="version-2-11-1">
<h2>Version 2.11.1<a class="headerlink" href="#version-2-11-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 14 May 2014)</em></p>
<ul class="simple">
<li>Add design-node-security.rst to docinput</li>
<li>kvm: use a dedicated QMP socket for kvmd</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Set correct Ganeti version on setup commands</li>
<li>Add a utility to combine shell commands</li>
<li>Add design doc for performance tests</li>
<li>Fix failed DRBD disk creation cleanup</li>
<li>Hooking up verification for shared file storage</li>
<li>Fix &#8211;shared-file-storage-dir option of gnt-cluster modify</li>
<li>Clarify default setting of &#8216;metavg&#8217;</li>
<li>Fix invocation of GetCommandOutput in QA</li>
<li>Clean up RunWithLocks</li>
<li>Add an exception-trapping thread class</li>
<li>Wait for delay to provide interruption information</li>
<li>Add an expected block option to RunWithLocks</li>
<li>Track if a QA test was blocked by locks</li>
<li>Add a RunWithLocks QA utility function</li>
<li>Add restricted migration</li>
<li>Add an example for node evacuation</li>
<li>Add a test for parsing version strings</li>
<li>Tests for parallel job execution</li>
<li>Fail in replace-disks if attaching disks fails</li>
<li>Fix passing of ispecs in cluster init during QA</li>
<li>Move QAThreadGroup to qa_job_utils.py</li>
<li>Extract GetJobStatuses and use an unified version</li>
<li>Run disk template specific tests only if possible</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>If Automake version &gt; 1.11, force serial tests</li>
<li>KVM: set IFF_ONE_QUEUE on created tap interfaces</li>
<li>Add configure option to pass GHC flags</li>
</ul>
</div>
<div class="section" id="version-2-11-0">
<h2>Version 2.11.0<a class="headerlink" href="#version-2-11-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 25 Apr 2014)</em></p>
<div class="section" id="id30">
<h3>Incompatible/important changes<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt> no longer shows disk space information for shared file
disk templates because it is not a node attribute. (For example, if you have
both the file and shared file disk templates enabled, <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt> now
only shows information about the file disk template.)</li>
<li>The shared file disk template is now in the new &#8216;sharedfile&#8217; storage type.
As a result, <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-storage</span> <span class="pre">-t</span> <span class="pre">file</span></tt> now only shows information
about the file disk template and you may use <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-storage</span> <span class="pre">-t</span>
<span class="pre">sharedfile</span></tt> to query storage information for the shared file disk template.</li>
<li>Over luxi, syntactially incorrect queries are now rejected as a whole;
before, a &#8216;SumbmitManyJobs&#8217; request was partially executed, if the outer
structure of the request was syntactically correct. As the luxi protocol
is internal (external applications are expected to use RAPI), the impact
of this incompatible change should be limited.</li>
<li>Queries for nodes, instances, groups, backups and networks are now
exclusively done via the luxi daemon. Legacy python code was removed,
as well as the &#8211;enable-split-queries configuration option.</li>
<li>Orphan volumes errors are demoted to warnings and no longer affect the exit
code of <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt>.</li>
<li>RPC security got enhanced by using different client SSL certificates
for each node. In this context &#8216;gnt-cluster renew-crypto&#8217; got a new
option &#8216;&#8211;new-node-certificates&#8217;, which renews the client
certificates of all nodes. After a cluster upgrade from pre-2.11, run
this to create client certificates and activate this feature.</li>
</ul>
</div>
<div class="section" id="id31">
<h3>New features<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Instance moves, backups and imports can now use compression to transfer the
instance data.</li>
<li>Node groups can be configured to use an SSH port different than the
default 22.</li>
<li>Added experimental support for Gluster distributed file storage as the
<tt class="docutils literal"><span class="pre">gluster</span></tt> disk template under the new <tt class="docutils literal"><span class="pre">sharedfile</span></tt> storage type through
automatic management of per-node FUSE mount points. You can configure the
mount point location at <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">init</span></tt> time by using the new
<tt class="docutils literal"><span class="pre">--gluster-storage-dir</span></tt> switch.</li>
<li>Job scheduling is now handled by luxid, and the maximal number of jobs running
in parallel is a run-time parameter of the cluster.</li>
<li>A new tool for planning dynamic power management, called <tt class="docutils literal"><span class="pre">hsqueeze</span></tt>, has
been added. It suggests nodes to power up or down and corresponding instance
moves.</li>
</ul>
</div>
<div class="section" id="id32">
<h3>New dependencies<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<p>The following new dependencies have been added:</p>
<p>For Haskell:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">zlib</span></tt> library (<a class="reference external" href="http://hackage.haskell.org/package/base64-bytestring">http://hackage.haskell.org/package/base64-bytestring</a>)</li>
<li><tt class="docutils literal"><span class="pre">base64-bytestring</span></tt> library (<a class="reference external" href="http://hackage.haskell.org/package/zlib">http://hackage.haskell.org/package/zlib</a>),
at least version 1.0.0.0</li>
<li><tt class="docutils literal"><span class="pre">lifted-base</span></tt> library (<a class="reference external" href="http://hackage.haskell.org/package/lifted-base">http://hackage.haskell.org/package/lifted-base</a>)</li>
<li><tt class="docutils literal"><span class="pre">lens</span></tt> library (<a class="reference external" href="http://hackage.haskell.org/package/lens">http://hackage.haskell.org/package/lens</a>)</li>
</ul>
</div>
<div class="section" id="since-2-11-0-rc1">
<h3>Since 2.11.0 rc1<a class="headerlink" href="#since-2-11-0-rc1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fix Xen instance state</li>
</ul>
<p>Inherited from the 2.10 branch:</p>
<ul class="simple">
<li>Fix conflict between virtio + spice or soundhw</li>
<li>Fix bitarray ops wrt PCI slots</li>
<li>Allow releases scheduled 5 days in advance</li>
<li>Make watcher submit queries low priority</li>
<li>Fix specification of TIDiskParams</li>
<li>Add unittests for instance modify parameter renaming</li>
<li>Add renaming of instance custom params</li>
<li>Add RAPI symmetry tests for groups</li>
<li>Extend RAPI symmetry tests with RAPI-only aliases</li>
<li>Add test for group custom parameter renaming</li>
<li>Add renaming of group custom ndparams, ipolicy, diskparams</li>
<li>Add the RAPI symmetry test for nodes</li>
<li>Add aliases for nodes</li>
<li>Allow choice of HTTP method for modification</li>
<li>Add cluster RAPI symmetry test</li>
<li>Fix failing cluster query test</li>
<li>Add aliases for cluster parameters</li>
<li>Add support for value aliases to RAPI</li>
<li>Provide tests for GET/PUT symmetry</li>
<li>Sort imports</li>
<li>Also consider filter fields for deciding if using live data</li>
<li>Document the python-fdsend dependency</li>
<li>Verify configuration version number before parsing</li>
<li>KVM: use running HVPs to calc blockdev options</li>
<li>KVM: reserve a PCI slot for the SCSI controller</li>
<li>Check for LVM-based verification results only when enabled</li>
<li>Fix &#8220;existing&#8221; typos</li>
<li>Fix output of gnt-instance info after migration</li>
<li>Warn in UPGRADE about not tar&#8217;ing exported insts</li>
<li>Fix non-running test and remove custom_nicparams rename</li>
<li>Account for NODE_RES lock in opportunistic locking</li>
<li>Fix request flooding of noded during disk sync</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make watcher submit queries low priority</li>
<li>Fix failing gnt-node list-drbd command</li>
<li>Update installation guide wrt to DRBD version</li>
<li>Fix list-drbd QA test</li>
<li>Add messages about skipped QA disk template tests</li>
<li>Allow QA asserts to produce more messages</li>
<li>Set exclusion tags correctly in requested instance</li>
<li>Export extractExTags and updateExclTags</li>
<li>Document spindles in the hbal man page</li>
<li>Sample logrotate conf breaks permissions with split users</li>
<li>Fix &#8216;gnt-cluster&#8217; and &#8216;gnt-node list-storage&#8217; outputs</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Add reason parameter to RAPI client functions</li>
<li>Include qa/patch in Makefile</li>
<li>Handle empty patches better</li>
<li>Move message formatting functions to separate file</li>
<li>Add optional ordering of QA patch files</li>
<li>Allow multiple QA patches</li>
<li>Refactor current patching code</li>
</ul>
</div>
</div>
<div class="section" id="version-2-11-0-rc1">
<h2>Version 2.11.0 rc1<a class="headerlink" href="#version-2-11-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 20 Mar 2014)</em></p>
<p>This was the first RC release of the 2.11 series. Since 2.11.0 beta1:</p>
<ul class="simple">
<li>Convert int to float when checking config. consistency</li>
<li>Rename compression option in gnt-backup export</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Fix error introduced during merge</li>
<li>gnt-cluster copyfile: accept relative paths</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Improve RAPI detection of the watcher</li>
<li>Add patching QA configuration files on buildbots</li>
<li>Enable a timeout for instance shutdown</li>
<li>Allow KVM commands to have a timeout</li>
<li>Allow xen commands to have a timeout</li>
<li>Fix wrong docstring</li>
</ul>
</div>
<div class="section" id="version-2-11-0-beta1">
<h2>Version 2.11.0 beta1<a class="headerlink" href="#version-2-11-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 5 Mar 2014)</em></p>
<p>This was the first beta release of the 2.11 series. All important changes
are listed in the latest 2.11 entry.</p>
</div>
<div class="section" id="version-2-10-8">
<h2>Version 2.10.8<a class="headerlink" href="#version-2-10-8" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 11 Dec 2015)</em></p>
<div class="section" id="id33">
<h3>Important changes and security notes<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id34">
<h3>Minor changes<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Make htools tolerate missing &#8220;dtotal&#8221; and &#8220;dfree&#8221; on luxi</li>
<li>At IAlloc backend guess state from admin state</li>
<li>replace-disks: fix &#8211;ignore-ipolicy</li>
<li>Fix instance multi allocation for non-DRBD disks</li>
<li>Check for gnt-cluster before running gnt-cluster upgrade</li>
<li>Work around a Python os.minor bug</li>
<li>Add IP-related checks after master-failover</li>
<li>Pass correct backend params in move-instance</li>
<li>Allow plain/DRBD conversions regardless of lack of disks</li>
<li>Fix MonD collector thunk leak</li>
<li>Stop MonD when removing a node from a cluster</li>
<li>Finalize backup only if successful</li>
<li>Fix file descriptor leak in Confd Client</li>
<li>Auto-upgrade hv_state_static and disk_state_static</li>
<li>Do not hardcode the Python path in CLI tools</li>
<li>Use the Python interpreter from ENV</li>
<li>ganeti.daemon: fix daemon mode with GnuTLS &gt;= 3.3 (Issues 961, 964)</li>
<li>Ganeti.Daemon: always install SIGHUP handler (Issue 755)</li>
<li>Fix DRBD version check for non VM capable nodes</li>
<li>Fix handling of the &#8211;online option</li>
<li>Add warning against hvparam changes with live migrations</li>
<li>Only verify LVs in configured VG during cluster verify</li>
<li>Fix network info in case of multi NIC instances</li>
<li>On upgrades, check for upgrades to resume first</li>
<li>Pause watcher during upgrade</li>
<li>Allow instance disks to be added with &#8211;no-wait-for-sync</li>
</ul>
</div>
</div>
<div class="section" id="version-2-10-7">
<h2>Version 2.10.7<a class="headerlink" href="#version-2-10-7" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 7 Aug 2014)</em></p>
<p>Important security release. In 2.10.0, the
&#8216;gnt-cluster upgrade&#8217; command was introduced. Before
performing an upgrade, the configuration directory of
the cluster is backed up. Unfortunately, the archive was
written with permissions that make it possible for
non-privileged users to read the archive and thus have
access to cluster and RAPI keys. After this release,
the archive will be created with privileged access only.</p>
<p>We strongly advise you to restrict the permissions of
previously created archives. The archives are found in
/var/lib/ganeti*.tar (unless otherwise configured with
&#8211;localstatedir or &#8211;with-backup-dir).</p>
<p>If you suspect that non-privileged users have accessed
your archives already, we advise you to renew the
cluster&#8217;s crypto keys using &#8216;gnt-cluster renew-crypto&#8217;
and to reset the RAPI credentials by editing
/var/lib/ganeti/rapi_users (respectively under a
different path if configured differently with
&#8211;localstatedir).</p>
<p>Other changes included in this release:</p>
<ul class="simple">
<li>Fix handling of Xen instance states.</li>
<li>Fix NIC configuration with absent NIC VLAN</li>
<li>Adapt relative path expansion in PATH to new environment</li>
<li>Exclude archived jobs from configuration backups</li>
<li>Fix RAPI for split query setup</li>
<li>Allow disk hot-remove even with chroot or SM</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make htools tolerate missing &#8216;spfree&#8217; on luxi</li>
</ul>
</div>
<div class="section" id="version-2-10-6">
<h2>Version 2.10.6<a class="headerlink" href="#version-2-10-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 30 Jun 2014)</em></p>
<ul class="simple">
<li>Make Ganeti tolerant towards differnt openssl library
version on different nodes (issue 853).</li>
<li>Allow hspace to make useful predictions in multi-group
clusters with one group overfull (isse 861).</li>
<li>Various gnt-network related fixes.</li>
<li>Fix disk hotplug with userspace access.</li>
<li>Various documentation errors fixed.</li>
</ul>
</div>
<div class="section" id="version-2-10-5">
<h2>Version 2.10.5<a class="headerlink" href="#version-2-10-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 2 Jun 2014)</em></p>
<ul class="simple">
<li>Two new options have been added to gnt-group evacuate.
The &#8216;sequential&#8217; option forces all the evacuation steps to
be carried out sequentially, thus avoiding congestion on a
slow link between node groups. The &#8216;force-failover&#8217; option
disallows migrations and forces failovers to be used instead.
In this way evacuation to a group with vastly differnet
hypervisor is possible.</li>
<li>In tiered allocation, when looking for ways on how to shrink
an instance, the canoncial path is tried first, i.e., in each
step reduce on the resource most placements are blocked on. Only
if no smaller fitting instance can be found shrinking a single
resource till fit is tried.</li>
<li>For finding the placement of an instance, the duplicate computations
in the computation of the various cluster scores are computed only
once. This significantly improves the performance of hspace for DRBD
on large clusters; for other clusters, a slight performance decrease
might occur. Moreover, due to the changed order, floating point
number inaccuracies accumulate differently, thus resulting in different
cluster scores. It has been verified that the effect of these different
roundings is less than 1e-12.</li>
<li>network queries fixed with respect to instances</li>
<li>relax too strict prerequisite in LUClusterSetParams for DRBD helpers</li>
<li>VArious improvements to QA and build-time tests</li>
</ul>
</div>
<div class="section" id="version-2-10-4">
<h2>Version 2.10.4<a class="headerlink" href="#version-2-10-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 15 May 2014)</em></p>
<ul class="simple">
<li>Support restricted migration in hbal</li>
<li>Fix for the &#8211;shared-file-storage-dir of gnt-cluster modify (issue 811)</li>
<li>Fail in replace-disks if attaching disks fails (issue 814)</li>
<li>Set IFF_ONE_QUEUE on created tap interfaces for KVM</li>
<li>Small fixes and enhancements in the build system</li>
<li>Various documentation fixes (e.g. issue 810)</li>
</ul>
</div>
<div class="section" id="version-2-10-3">
<h2>Version 2.10.3<a class="headerlink" href="#version-2-10-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 16 Apr 2014)</em></p>
<ul class="simple">
<li>Fix filtering of pending jobs with -o id (issue 778)</li>
<li>Make RAPI API calls more symmetric (issue 770)</li>
<li>Make parsing of old cluster configuration more robust (issue 783)</li>
<li>Fix wrong output of gnt-instance info after migrations</li>
<li>Fix reserved PCI slots for KVM hotplugging</li>
<li>Use runtime hypervisor parameters to calculate bockdevice options for KVM</li>
<li>Fix high node daemon load during disk sync if the sync is paused manually
(issue 792)</li>
<li>Improve opportunistic locking during instance creation (issue 791)</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Make watcher submit queries low priority (issue 772)</li>
<li>Add reason parameter to RAPI client functions (issue 776)</li>
<li>Fix failing gnt-node list-drbd command (issue 777)</li>
<li>Properly display fake job locks in gnt-debug.</li>
<li>small fixes in documentation</li>
</ul>
</div>
<div class="section" id="version-2-10-2">
<h2>Version 2.10.2<a class="headerlink" href="#version-2-10-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 24 Mar 2014)</em></p>
<ul class="simple">
<li>Fix conflict between virtio + spice or soundhw (issue 757)</li>
<li>accept relative paths in gnt-cluster copyfile (issue 754)</li>
<li>Introduce shutdown timeout for &#8216;xm shutdown&#8217; command</li>
<li>Improve RAPI detection of the watcher (issue 752)</li>
</ul>
</div>
<div class="section" id="version-2-10-1">
<h2>Version 2.10.1<a class="headerlink" href="#version-2-10-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 5 Mar 2014)</em></p>
<ul class="simple">
<li>Fix incorrect invocation of hooks on offline nodes (issue 742)</li>
<li>Fix incorrect exit code of gnt-cluster verify in certain circumstances
(issue 744)</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Fix overflow problem in hbal that caused it to break when waiting for
jobs for more than 10 minutes (issue 717)</li>
<li>Make hbal properly handle non-LVM storage</li>
<li>Properly export and import NIC parameters, and do so in a backwards
compatible way (issue 716)</li>
<li>Fix net-common script in case of routed mode (issue 728)</li>
<li>Improve documentation (issues 724, 730)</li>
</ul>
</div>
<div class="section" id="version-2-10-0">
<h2>Version 2.10.0<a class="headerlink" href="#version-2-10-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 20 Feb 2014)</em></p>
<div class="section" id="id35">
<h3>Incompatible/important changes<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Adding disks with &#8216;gnt-instance modify&#8217; now waits for the disks to sync per
default. Specify &#8211;no-wait-for-sync to override this behavior.</li>
<li>The Ganeti python code now adheres to a private-module layout. In particular,
the module &#8216;ganeti&#8217; is no longer in the python search path.</li>
<li>On instance allocation, the iallocator now considers non-LVM storage
properly. In particular, actual file storage space information is used
when allocating space for a file/sharedfile instance.</li>
<li>When disabling disk templates cluster-wide, the cluster now first
checks whether there are instances still using those templates.</li>
<li>&#8216;gnt-node list-storage&#8217; now also reports storage information about
file-based storage types.</li>
<li>In case of non drbd instances, export *_SECONDARY environment variables
as empty strings (and not &#8220;None&#8221;) during &#8216;instance-migrate&#8217; related hooks.</li>
</ul>
</div>
<div class="section" id="id36">
<h3>New features<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">KVM hypervisors can now access RBD storage directly without having to
go through a block device.</p>
</li>
<li><p class="first">A new command &#8216;gnt-cluster upgrade&#8217; was added that automates the upgrade
procedure between two Ganeti versions that are both 2.10 or higher.</p>
</li>
<li><p class="first">The move-instance command can now change disk templates when moving
instances, and does not require any node placement options to be
specified if the destination cluster has a default iallocator.</p>
</li>
<li><p class="first">Users can now change the soundhw and cpuid settings for XEN hypervisors.</p>
</li>
<li><p class="first">Hail and hbal now have the (optional) capability of accessing average CPU
load information through the monitoring deamon, and to use it to dynamically
adapt the allocation of instances.</p>
</li>
<li><p class="first">Hotplug support. Introduce new option &#8216;&#8211;hotplug&#8217; to <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt>
so that disk and NIC modifications take effect without the need of actual
reboot. There are a couple of constrains currently for this feature:</p>
<blockquote>
<div><ul class="simple">
<li>only KVM hypervisor (versions &gt;= 1.0) supports it,</li>
<li>one can not (yet) hotplug a disk using userspace access mode for RBD</li>
<li>in case of a downgrade instances should suffer a reboot in order to
be migratable (due to core change of runtime files)</li>
<li><tt class="docutils literal"><span class="pre">python-fdsend</span></tt> is required for NIC hotplugging.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="misc-changes">
<h3>Misc changes<a class="headerlink" href="#misc-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A new test framework for logical units was introduced and the test
coverage for logical units was improved significantly.</li>
<li>Opcodes are entirely generated from Haskell using the tool &#8216;hs2py&#8217; and
the module &#8216;src/Ganeti/OpCodes.hs&#8217;.</li>
<li>Constants are also generated from Haskell using the tool
&#8216;hs2py-constants&#8217; and the module &#8216;src/Ganeti/Constants.hs&#8217;, with the
exception of socket related constants, which require changing the
cluster configuration file, and HVS related constants, because they
are part of a port of instance queries to Haskell.  As a result, these
changes will be part of the next release of Ganeti.</li>
</ul>
</div>
<div class="section" id="id37">
<h3>New dependencies<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>The following new dependencies have been added/updated.</p>
<p>Python</p>
<ul class="simple">
<li>The version requirements for <tt class="docutils literal"><span class="pre">python-mock</span></tt> have increased to at least
version 1.0.1. It is still used for testing only.</li>
<li><tt class="docutils literal"><span class="pre">python-fdsend</span></tt> (<a class="reference external" href="https://gitorious.org/python-fdsend">https://gitorious.org/python-fdsend</a>) is optional
but required for KVM NIC hotplugging to work.</li>
</ul>
</div>
<div class="section" id="since-2-10-0-rc3">
<h3>Since 2.10.0 rc3<a class="headerlink" href="#since-2-10-0-rc3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fix integer overflow problem in hbal</li>
</ul>
</div>
</div>
<div class="section" id="version-2-10-0-rc3">
<h2>Version 2.10.0 rc3<a class="headerlink" href="#version-2-10-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 12 Feb 2014)</em></p>
<p>This was the third RC release of the 2.10 series. Since 2.10.0 rc2:</p>
<ul class="simple">
<li>Improved hotplug robustness</li>
<li>Start Ganeti daemons after ensure-dirs during upgrade</li>
<li>Documentation improvements</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Fix the RAPI instances-multi-alloc call</li>
<li>assign unique filenames to file-based disks</li>
<li>gracefully handle degraded non-diskless instances with 0 disks (issue 697)</li>
<li>noded now runs with its specified group, which is the default group,
defaulting to root (issue 707)</li>
<li>make using UUIDs to identify nodes in gnt-node consistently possible
(issue 703)</li>
</ul>
</div>
<div class="section" id="version-2-10-0-rc2">
<h2>Version 2.10.0 rc2<a class="headerlink" href="#version-2-10-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 31 Jan 2014)</em></p>
<p>This was the second RC release of the 2.10 series. Since 2.10.0 rc1:</p>
<ul class="simple">
<li>Documentation improvements</li>
<li>Run drbdsetup syncer only on network attach</li>
<li>Include target node in hooks nodes for migration</li>
<li>Fix configure dirs</li>
<li>Support post-upgrade hooks during cluster upgrades</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>Ensure that all the hypervisors exist in the config file (Issue 640)</li>
<li>Correctly recognise the role as master node (Issue 687)</li>
<li>configure: allow detection of Sphinx 1.2+ (Issue 502)</li>
<li>gnt-instance now honors the KVM path correctly (Issue 691)</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Change the list separator for the usb_devices parameter from comma to space.
Commas could not work because they are already the hypervisor option
separator (Issue 649)</li>
<li>Add support for blktap2 file-driver (Issue 638)</li>
<li>Add network tag definitions to the haskell codebase (Issue 641)</li>
<li>Fix RAPI network tag handling</li>
<li>Add the network tags to the tags searched by gnt-cluster search-tags</li>
<li>Fix caching bug preventing jobs from being cancelled</li>
<li>Start-master/stop-master was always failing if ConfD was disabled. (Issue 685)</li>
</ul>
</div>
<div class="section" id="version-2-10-0-rc1">
<h2>Version 2.10.0 rc1<a class="headerlink" href="#version-2-10-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 17 Dec 2013)</em></p>
<p>This was the first RC release of the 2.10 series. Since 2.10.0 beta1:</p>
<ul class="simple">
<li>All known issues in 2.10.0 beta1 have been resolved (see changes from
the 2.8 branch).</li>
<li>Improve handling of KVM runtime files from earlier Ganeti versions</li>
<li>Documentation fixes</li>
</ul>
<p>Inherited from the 2.9 branch:</p>
<ul class="simple">
<li>use custom KVM path if set for version checking</li>
<li>SingleNotifyPipeCondition: don&#8217;t share pollers</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Fixed Luxi daemon socket permissions after master-failover</li>
<li>Improve IP version detection code directly checking for colons rather than
passing the family from the cluster object</li>
<li>Fix NODE/NODE_RES locking in LUInstanceCreate by not acquiring NODE_RES locks
opportunistically anymore (Issue 622)</li>
<li>Allow link local IPv6 gateways (Issue 624)</li>
<li>Fix error printing (Issue 616)</li>
<li>Fix a bug in InstanceSetParams concerning names: in case no name is passed in
disk modifications, keep the old one. If name=none then set disk name to
None.</li>
<li>Update build_chroot script to work with the latest hackage packages</li>
<li>Add a packet number limit to &#8220;fping&#8221; in master-ip-setup (Issue 630)</li>
<li>Fix evacuation out of drained node (Issue 615)</li>
<li>Add default file_driver if missing (Issue 571)</li>
<li>Fix job error message after unclean master shutdown (Issue 618)</li>
<li>Lock group(s) when creating instances (Issue 621)</li>
<li>SetDiskID() before accepting an instance (Issue 633)</li>
<li>Allow the ext template disks to receive arbitrary parameters, both at creation
time and while being modified</li>
<li>Xen handle domain shutdown (future proofing cherry-pick)</li>
<li>Refactor reading live data in htools (future proofing cherry-pick)</li>
</ul>
</div>
<div class="section" id="version-2-10-0-beta1">
<h2>Version 2.10.0 beta1<a class="headerlink" href="#version-2-10-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 27 Nov 2013)</em></p>
<p>This was the first beta release of the 2.10 series. All important changes
are listed in the latest 2.10 entry.</p>
<div class="section" id="id38">
<h3>Known issues<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h3>
<p>The following issues are known to be present in the beta and will be fixed
before rc1.</p>
<ul class="simple">
<li>Issue 477: Wrong permissions for confd LUXI socket</li>
<li>Issue 621: Instance related opcodes do not aquire network/group locks</li>
<li>Issue 622: Assertion Error: Node locks differ from node resource locks</li>
<li>Issue 623: IPv6 Masterd &lt;-&gt; Luxid communication error</li>
</ul>
</div>
</div>
<div class="section" id="version-2-9-7">
<h2>Version 2.9.7<a class="headerlink" href="#version-2-9-7" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 11 Dec 2015)</em></p>
<div class="section" id="id39">
<h3>Important changes and security notes<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>Security release.</p>
<p>CVE-2015-7944</p>
<p>Ganeti provides a RESTful control interface called the RAPI. Its HTTPS
implementation is vulnerable to DoS attacks via client-initiated SSL
parameter renegotiation. While the interface is not meant to be exposed
publicly, due to the fact that it binds to all interfaces, we believe
some users might be exposing it unintentionally and are vulnerable. A
DoS attack can consume resources meant for Ganeti daemons and instances
running on the master node, making both perform badly.</p>
<p>Fixes are not feasible due to the OpenSSL Python library not exposing
functionality needed to disable client-side renegotiation. Instead, we
offer instructions on how to control RAPI&#8217;s exposure, along with info
on how RAPI can be setup alongside an HTTPS proxy in case users still
want or need to expose the RAPI interface. The instructions are
outlined in Ganeti&#8217;s security document: doc/html/security.html</p>
<p>CVE-2015-7945</p>
<p>Ganeti leaks the DRBD secret through the RAPI interface. Examining job
results after an instance information job reveals the secret. With the
DRBD secret, access to the local cluster network, and ARP poisoning,
an attacker can impersonate a Ganeti node and clone the disks of a
DRBD-based instance. While an attacker with access to the cluster
network is already capable of accessing any data written as DRBD
traffic is unencrypted, having the secret expedites the process and
allows access to the entire disk.</p>
<p>Fixes contained in this release prevent the secret from being exposed
via the RAPI. The DRBD secret can be changed by converting an instance
to plain and back to DRBD, generating a new secret, but redundancy will
be lost until the process completes.
Since attackers with node access are capable of accessing some and
potentially all data even without the secret, we do not recommend that
the secret be changed for existing instances.</p>
</div>
<div class="section" id="id40">
<h3>Minor changes<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>gnt-instance replace-disks no longer crashes when &#8211;ignore-policy is
passed to it</li>
<li>Stop MonD when removing a node from a cluster</li>
<li>Fix file descriptor leak in Confd client</li>
<li>Always install SIGHUP handler for Haskell daemons (Issue 755)</li>
<li>Make ganeti-cleaner switch to a safe working directory (Issue 880)</li>
<li>Make htools tolerate missing &#8220;spfree&#8221; on Luxi</li>
<li>DRBD parser: consume initial empty resource lines (Issue 869)</li>
<li>KVM: set IFF_ONE_QUEUE on created tap interfaces</li>
<li>Set exclusion tags correctly in requested instance</li>
</ul>
</div>
</div>
<div class="section" id="version-2-9-6">
<h2>Version 2.9.6<a class="headerlink" href="#version-2-9-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 7 Apr 2014)</em></p>
<ul class="simple">
<li>Improve RAPI detection of the watcher (Issue 752)</li>
<li>gnt-cluster copyfile: accept relative paths (Issue 754)</li>
<li>Make watcher submit queries low priority (Issue 772)</li>
<li>Add reason parameter to RAPI client functions (Issue 776)</li>
<li>Fix failing gnt-node list-drbd command (Issue 777)</li>
<li>Properly display fake job locks in gnt-debug.</li>
<li>Enable timeout for instance shutdown</li>
<li>small fixes in documentation</li>
</ul>
</div>
<div class="section" id="version-2-9-5">
<h2>Version 2.9.5<a class="headerlink" href="#version-2-9-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 25 Feb 2014)</em></p>
<ul class="simple">
<li>Fix overflow problem in hbal that caused it to break when waiting for
jobs for more than 10 minutes (issue 717)</li>
<li>Make hbal properly handle non-LVM storage</li>
<li>Properly export and import NIC parameters, and do so in a backwards
compatible way (issue 716)</li>
<li>Fix net-common script in case of routed mode (issue 728)</li>
<li>Improve documentation (issues 724, 730)</li>
</ul>
</div>
<div class="section" id="version-2-9-4">
<h2>Version 2.9.4<a class="headerlink" href="#version-2-9-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 10 Feb 2014)</em></p>
<ul class="simple">
<li>Fix the RAPI instances-multi-alloc call</li>
<li>assign unique filenames to file-based disks</li>
<li>gracefully handle degraded non-diskless instances with 0 disks (issue 697)</li>
<li>noded now runs with its specified group, which is the default group,
defaulting to root (issue 707)</li>
<li>make using UUIDs to identify nodes in gnt-node consistently possible
(issue 703)</li>
</ul>
</div>
<div class="section" id="version-2-9-3">
<h2>Version 2.9.3<a class="headerlink" href="#version-2-9-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 27 Jan 2014)</em></p>
<ul class="simple">
<li>Ensure that all the hypervisors exist in the config file (Issue 640)</li>
<li>Correctly recognise the role as master node (Issue 687)</li>
<li>configure: allow detection of Sphinx 1.2+ (Issue 502)</li>
<li>gnt-instance now honors the KVM path correctly (Issue 691)</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Change the list separator for the usb_devices parameter from comma to space.
Commas could not work because they are already the hypervisor option
separator (Issue 649)</li>
<li>Add support for blktap2 file-driver (Issue 638)</li>
<li>Add network tag definitions to the haskell codebase (Issue 641)</li>
<li>Fix RAPI network tag handling</li>
<li>Add the network tags to the tags searched by gnt-cluster search-tags</li>
<li>Fix caching bug preventing jobs from being cancelled</li>
<li>Start-master/stop-master was always failing if ConfD was disabled. (Issue 685)</li>
</ul>
</div>
<div class="section" id="version-2-9-2">
<h2>Version 2.9.2<a class="headerlink" href="#version-2-9-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 13 Dec 2013)</em></p>
<ul class="simple">
<li>use custom KVM path if set for version checking</li>
<li>SingleNotifyPipeCondition: don&#8217;t share pollers</li>
</ul>
<p>Inherited from the 2.8 branch:</p>
<ul class="simple">
<li>Fixed Luxi daemon socket permissions after master-failover</li>
<li>Improve IP version detection code directly checking for colons rather than
passing the family from the cluster object</li>
<li>Fix NODE/NODE_RES locking in LUInstanceCreate by not acquiring NODE_RES locks
opportunistically anymore (Issue 622)</li>
<li>Allow link local IPv6 gateways (Issue 624)</li>
<li>Fix error printing (Issue 616)</li>
<li>Fix a bug in InstanceSetParams concerning names: in case no name is passed in
disk modifications, keep the old one. If name=none then set disk name to
None.</li>
<li>Update build_chroot script to work with the latest hackage packages</li>
<li>Add a packet number limit to &#8220;fping&#8221; in master-ip-setup (Issue 630)</li>
<li>Fix evacuation out of drained node (Issue 615)</li>
<li>Add default file_driver if missing (Issue 571)</li>
<li>Fix job error message after unclean master shutdown (Issue 618)</li>
<li>Lock group(s) when creating instances (Issue 621)</li>
<li>SetDiskID() before accepting an instance (Issue 633)</li>
<li>Allow the ext template disks to receive arbitrary parameters, both at creation
time and while being modified</li>
<li>Xen handle domain shutdown (future proofing cherry-pick)</li>
<li>Refactor reading live data in htools (future proofing cherry-pick)</li>
</ul>
</div>
<div class="section" id="version-2-9-1">
<h2>Version 2.9.1<a class="headerlink" href="#version-2-9-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 13 Nov 2013)</em></p>
<ul class="simple">
<li>fix bug, that kept nodes offline when readding</li>
<li>when verifying DRBD versions, ignore unavailable nodes</li>
<li>fix bug that made the console unavailable on kvm in split-user
setup (issue 608)</li>
<li>DRBD: ensure peers are UpToDate for dual-primary (inherited 2.8.2)</li>
</ul>
</div>
<div class="section" id="version-2-9-0">
<h2>Version 2.9.0<a class="headerlink" href="#version-2-9-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 5 Nov 2013)</em></p>
<div class="section" id="id41">
<h3>Incompatible/important changes<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>hroller now also plans for capacity to move non-redundant instances off
any node to be rebooted; the old behavior of completely ignoring any
non-redundant instances can be restored by adding the &#8211;ignore-non-redundant
option.</li>
<li>The cluster option &#8216;&#8211;no-lvm-storage&#8217; was removed in favor of the new option
&#8216;&#8211;enabled-disk-templates&#8217;.</li>
<li>On instance creation, disk templates no longer need to be specified
with &#8216;-t&#8217;. The default disk template will be taken from the list of
enabled disk templates.</li>
<li>The monitoring daemon is now running as root, in order to be able to collect
information only available to root (such as the state of Xen instances).</li>
<li>The ConfD client is now IPv6 compatible.</li>
<li>File and shared file storage is no longer dis/enabled at configure time,
but using the option &#8216;&#8211;enabled-disk-templates&#8217; at cluster initialization and
modification.</li>
<li>The default directories for file and shared file storage are not anymore
specified at configure time, but taken from the cluster&#8217;s configuration.
They can be set at cluster initialization and modification with
&#8216;&#8211;file-storage-dir&#8217; and &#8216;&#8211;shared-file-storage-dir&#8217;.</li>
<li>Cluster verification now includes stricter checks regarding the
default file and shared file storage directories. It now checks that
the directories are explicitely allowed in the &#8216;file-storage-paths&#8217; file and
that the directories exist on all nodes.</li>
<li>The list of allowed disk templates in the instance policy and the list
of cluster-wide enabled disk templates is now checked for consistency
on cluster or group modification. On cluster initialization, the ipolicy
disk templates are ensured to be a subset of the cluster-wide enabled
disk templates.</li>
</ul>
</div>
<div class="section" id="id42">
<h3>New features<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>DRBD 8.4 support. Depending on the installed DRBD version, Ganeti now uses
the correct command syntax. It is possible to use different DRBD versions
on different nodes as long as they are compatible to each other. This
enables rolling upgrades of DRBD with no downtime. As permanent operation
of different DRBD versions within a node group is discouraged,
<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> will emit a warning if it detects such a situation.</li>
<li>New &#8220;inst-status-xen&#8221; data collector for the monitoring daemon, providing
information about the state of the xen instances on the nodes.</li>
<li>New &#8220;lv&#8221; data collector for the monitoring daemon, collecting data about the
logical volumes on the nodes, and pairing them with the name of the instances
they belong to.</li>
<li>New &#8220;diskstats&#8221; data collector, collecting the data from /proc/diskstats and
presenting them over the monitoring daemon interface.</li>
<li>The ConfD client is now IPv6 compatible.</li>
</ul>
</div>
<div class="section" id="id43">
<h3>New dependencies<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<p>The following new dependencies have been added.</p>
<p>Python</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">python-mock</span></tt> (<a class="reference external" href="http://www.voidspace.org.uk/python/mock/">http://www.voidspace.org.uk/python/mock/</a>) is now a required
for the unit tests (and only used for testing).</li>
</ul>
<p>Haskell</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">hslogger</span></tt> (<a class="reference external" href="http://software.complete.org/hslogger">http://software.complete.org/hslogger</a>) is now always
required, even if confd is not enabled.</li>
</ul>
</div>
<div class="section" id="since-2-9-0-rc3">
<h3>Since 2.9.0 rc3<a class="headerlink" href="#since-2-9-0-rc3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Correctly start/stop luxid during gnt-cluster master-failover (inherited
from stable-2.8)</li>
<li>Improved error messsages (inherited from stable-2.8)</li>
</ul>
</div>
</div>
<div class="section" id="version-2-9-0-rc3">
<h2>Version 2.9.0 rc3<a class="headerlink" href="#version-2-9-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 15 Oct 2013)</em></p>
<p>The third release candidate in the 2.9 series. Since 2.9.0 rc2:</p>
<ul class="simple">
<li>in implicit configuration upgrade, match ipolicy with enabled disk templates</li>
<li>improved harep documentation (inherited from stable-2.8)</li>
</ul>
</div>
<div class="section" id="version-2-9-0-rc2">
<h2>Version 2.9.0 rc2<a class="headerlink" href="#version-2-9-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 9 Oct 2013)</em></p>
<p>The second release candidate in the 2.9 series. Since 2.9.0 rc1:</p>
<ul class="simple">
<li>Fix bug in cfgupgrade that led to failure when upgrading from 2.8 with
at least one DRBD instance.</li>
<li>Fix bug in cfgupgrade that led to an invalid 2.8 configuration after
downgrading.</li>
</ul>
</div>
<div class="section" id="version-2-9-0-rc1">
<h2>Version 2.9.0 rc1<a class="headerlink" href="#version-2-9-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 1 Oct 2013)</em></p>
<p>The first release candidate in the 2.9 series. Since 2.9.0 beta1:</p>
<ul class="simple">
<li>various bug fixes</li>
<li>update of the documentation, in particular installation instructions</li>
<li>merging of LD_* constants into DT_* constants</li>
<li>python style changes to be compatible with newer versions of pylint</li>
</ul>
</div>
<div class="section" id="version-2-9-0-beta1">
<h2>Version 2.9.0 beta1<a class="headerlink" href="#version-2-9-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 29 Aug 2013)</em></p>
<p>This was the first beta release of the 2.9 series. All important changes
are listed in the latest 2.9 entry.</p>
</div>
<div class="section" id="version-2-8-4">
<h2>Version 2.8.4<a class="headerlink" href="#version-2-8-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 23 Jan 2014)</em></p>
<ul class="simple">
<li>Change the list separator for the usb_devices parameter from comma to space.
Commas could not work because they are already the hypervisor option
separator (Issue 649)</li>
<li>Add support for blktap2 file-driver (Issue 638)</li>
<li>Add network tag definitions to the haskell codebase (Issue 641)</li>
<li>Fix RAPI network tag handling</li>
<li>Add the network tags to the tags searched by gnt-cluster search-tags</li>
<li>Fix caching bug preventing jobs from being cancelled</li>
<li>Start-master/stop-master was always failing if ConfD was disabled. (Issue 685)</li>
</ul>
</div>
<div class="section" id="version-2-8-3">
<h2>Version 2.8.3<a class="headerlink" href="#version-2-8-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 12 Dec 2013)</em></p>
<ul class="simple">
<li>Fixed Luxi daemon socket permissions after master-failover</li>
<li>Improve IP version detection code directly checking for colons rather than
passing the family from the cluster object</li>
<li>Fix NODE/NODE_RES locking in LUInstanceCreate by not acquiring NODE_RES locks
opportunistically anymore (Issue 622)</li>
<li>Allow link local IPv6 gateways (Issue 624)</li>
<li>Fix error printing (Issue 616)</li>
<li>Fix a bug in InstanceSetParams concerning names: in case no name is passed in
disk modifications, keep the old one. If name=none then set disk name to
None.</li>
<li>Update build_chroot script to work with the latest hackage packages</li>
<li>Add a packet number limit to &#8220;fping&#8221; in master-ip-setup (Issue 630)</li>
<li>Fix evacuation out of drained node (Issue 615)</li>
<li>Add default file_driver if missing (Issue 571)</li>
<li>Fix job error message after unclean master shutdown (Issue 618)</li>
<li>Lock group(s) when creating instances (Issue 621)</li>
<li>SetDiskID() before accepting an instance (Issue 633)</li>
<li>Allow the ext template disks to receive arbitrary parameters, both at creation
time and while being modified</li>
<li>Xen handle domain shutdown (future proofing cherry-pick)</li>
<li>Refactor reading live data in htools (future proofing cherry-pick)</li>
</ul>
</div>
<div class="section" id="version-2-8-2">
<h2>Version 2.8.2<a class="headerlink" href="#version-2-8-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 07 Nov 2013)</em></p>
<ul class="simple">
<li>DRBD: ensure peers are UpToDate for dual-primary</li>
<li>Improve error message for replace-disks</li>
<li>More dependency checks at configure time</li>
<li>Placate warnings on ganeti.outils_unittest.py</li>
</ul>
</div>
<div class="section" id="version-2-8-1">
<h2>Version 2.8.1<a class="headerlink" href="#version-2-8-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 17 Oct 2013)</em></p>
<ul class="simple">
<li>Correctly start/stop luxid during gnt-cluster master-failover</li>
<li>Don&#8217;t attempt IPv6 ssh in case of IPv4 cluster (Issue 595)</li>
<li>Fix path for the job queue serial file</li>
<li>Improved harep man page</li>
<li>Minor documentation improvements</li>
</ul>
</div>
<div class="section" id="version-2-8-0">
<h2>Version 2.8.0<a class="headerlink" href="#version-2-8-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 30 Sep 2013)</em></p>
<div class="section" id="id44">
<h3>Incompatible/important changes<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Instance policy can contain multiple instance specs, as described in
the “Constrained instance sizes” section of <a class="reference internal" href="design-partitioned.html"><em>Partitioned Ganeti</em></a>. As a consequence, it&#8217;s not possible to partially change
or override instance specs. Bounding specs (min and max) can be specified as a
whole using the new option <tt class="docutils literal"><span class="pre">--ipolicy-bounds-specs</span></tt>, while standard
specs use the new option <tt class="docutils literal"><span class="pre">--ipolicy-std-specs</span></tt>.</li>
<li>The output of the info command of gnt-cluster, gnt-group, gnt-node,
gnt-instance is a valid YAML object.</li>
<li>hail now honors network restrictions when allocating nodes. This led to an
update of the IAllocator protocol. See the IAllocator documentation for
details.</li>
<li>confd now only answers static configuration request over the network. luxid
was extracted, listens on the local LUXI socket and responds to live queries.
This allows finer grained permissions if using separate users.</li>
</ul>
</div>
<div class="section" id="id45">
<h3>New features<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The <a class="reference internal" href="rapi.html"><em>Remote API</em></a> daemon now supports a command line flag
to always require authentication, <tt class="docutils literal"><span class="pre">--require-authentication</span></tt>. It can
be specified in <tt class="docutils literal"><span class="pre">$sysconfdir/default/ganeti</span></tt>.</li>
<li>A new cluster attribute &#8216;enabled_disk_templates&#8217; is introduced. It will
be used to manage the disk templates to be used by instances in the cluster.
Initially, it will be set to a list that includes plain, drbd, if they were
enabled by specifying a volume group name, and file and sharedfile, if those
were enabled at configure time. Additionally, it will include all disk
templates that are currently used by instances. The order of disk templates
will be based on Ganeti&#8217;s history of supporting them. In the future, the
first entry of the list will be used as a default disk template on instance
creation.</li>
<li><tt class="docutils literal"><span class="pre">cfgupgrade</span></tt> now supports a <tt class="docutils literal"><span class="pre">--downgrade</span></tt> option to bring the
configuration back to the previous stable version.</li>
<li>Disk templates in group ipolicy can be restored to the default value.</li>
<li>Initial support for diskless instances and virtual clusters in QA.</li>
<li>More QA and unit tests for instance policies.</li>
<li>Every opcode now contains a reason trail (visible through <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">info</span></tt>)
describing why the opcode itself was executed.</li>
<li>The monitoring daemon is now available. It allows users to query the cluster
for obtaining information about the status of the system. The daemon is only
responsible for providing the information over the network: the actual data
gathering is performed by data collectors (currently, only the DRBD status
collector is available).</li>
<li>In order to help developers work on Ganeti, a new script
(<tt class="docutils literal"><span class="pre">devel/build_chroot</span></tt>) is provided, for building a chroot that contains all
the required development libraries and tools for compiling Ganeti on a Debian
Squeeze system.</li>
<li>A new tool, <tt class="docutils literal"><span class="pre">harep</span></tt>, for performing self-repair and recreation of instances
in Ganeti has been added.</li>
<li>Split queries are enabled for tags, network, exports, cluster info, groups,
jobs, nodes.</li>
<li>New command <tt class="docutils literal"><span class="pre">show-ispecs-cmd</span></tt> for <tt class="docutils literal"><span class="pre">gnt-cluster</span></tt> and <tt class="docutils literal"><span class="pre">gnt-group</span></tt>.
It prints the command line to set the current policies, to ease
changing them.</li>
<li>Add the <tt class="docutils literal"><span class="pre">vnet_hdr</span></tt> HV parameter for KVM, to control whether the tap
devices for KVM virtio-net interfaces will get created with VNET_HDR
(IFF_VNET_HDR) support. If set to false, it disables offloading on the
virtio-net interfaces, which prevents host kernel tainting and log
flooding, when dealing with broken or malicious virtio-net drivers.
It&#8217;s set to true by default.</li>
<li>Instance failover now supports a <tt class="docutils literal"><span class="pre">--cleanup</span></tt> parameter for fixing previous
failures.</li>
<li>Support &#8216;viridian&#8217; parameter in Xen HVM</li>
<li>Support DSA SSH keys in bootstrap</li>
<li>To simplify the work of packaging frameworks that want to add the needed users
and groups in a split-user setup themselves, at build time three files in
<tt class="docutils literal"><span class="pre">doc/users</span></tt> will be generated. The <tt class="docutils literal"><span class="pre">groups</span></tt> files contains, one per line,
the groups to be generated, the <tt class="docutils literal"><span class="pre">users</span></tt> file contains, one per line, the
users to be generated, optionally followed by their primary group, where
important. The <tt class="docutils literal"><span class="pre">groupmemberships</span></tt> file contains, one per line, additional
user-group membership relations that need to be established. The syntax of
these files will remain stable in all future versions.</li>
</ul>
</div>
<div class="section" id="id46">
<h3>New dependencies<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<p>The following new dependencies have been added:</p>
<p>For Haskell:
- The <tt class="docutils literal"><span class="pre">curl</span></tt> library is not optional anymore for compiling the Haskell code.
- <tt class="docutils literal"><span class="pre">snap-server</span></tt> library (if monitoring is enabled).</p>
<p>For Python:
- The minimum Python version needed to run Ganeti is now 2.6.
- <tt class="docutils literal"><span class="pre">yaml</span></tt> library (only for running the QA).</p>
</div>
<div class="section" id="since-2-8-0-rc3">
<h3>Since 2.8.0 rc3<a class="headerlink" href="#since-2-8-0-rc3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Perform proper cleanup on termination of Haskell daemons</li>
<li>Fix corner-case in handling of remaining retry time</li>
</ul>
</div>
</div>
<div class="section" id="version-2-8-0-rc3">
<h2>Version 2.8.0 rc3<a class="headerlink" href="#version-2-8-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 17 Sep 2013)</em></p>
<ul class="simple">
<li>To simplify the work of packaging frameworks that want to add the needed users
and groups in a split-user setup themselves, at build time three files in
<tt class="docutils literal"><span class="pre">doc/users</span></tt> will be generated. The <tt class="docutils literal"><span class="pre">groups</span></tt> files contains, one per line,
the groups to be generated, the <tt class="docutils literal"><span class="pre">users</span></tt> file contains, one per line, the
users to be generated, optionally followed by their primary group, where
important. The <tt class="docutils literal"><span class="pre">groupmemberships</span></tt> file contains, one per line, additional
user-group membership relations that need to be established. The syntax of
these files will remain stable in all future versions.</li>
<li>Add a default to file-driver when unspecified over RAPI (Issue 571)</li>
<li>Mark the DSA host pubkey as optional, and remove it during config downgrade
(Issue 560)</li>
<li>Some documentation fixes</li>
</ul>
</div>
<div class="section" id="version-2-8-0-rc2">
<h2>Version 2.8.0 rc2<a class="headerlink" href="#version-2-8-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 27 Aug 2013)</em></p>
<p>The second release candidate of the 2.8 series. Since 2.8.0. rc1:</p>
<ul class="simple">
<li>Support &#8216;viridian&#8217; parameter in Xen HVM (Issue 233)</li>
<li>Include VCS version in <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">version</span></tt></li>
<li>Support DSA SSH keys in bootstrap (Issue 338)</li>
<li>Fix batch creation of instances</li>
<li>Use FQDN to check master node status (Issue 551)</li>
<li>Make the DRBD collector more failure-resilient</li>
</ul>
</div>
<div class="section" id="version-2-8-0-rc1">
<h2>Version 2.8.0 rc1<a class="headerlink" href="#version-2-8-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 2 Aug 2013)</em></p>
<p>The first release candidate of the 2.8 series. Since 2.8.0 beta1:</p>
<ul class="simple">
<li>Fix upgrading/downgrading from 2.7</li>
<li>Increase maximum RAPI message size</li>
<li>Documentation updates</li>
<li>Split <tt class="docutils literal"><span class="pre">confd</span></tt> between <tt class="docutils literal"><span class="pre">luxid</span></tt> and <tt class="docutils literal"><span class="pre">confd</span></tt></li>
<li>Merge 2.7 series up to the 2.7.1 release</li>
<li>Allow the <tt class="docutils literal"><span class="pre">modify_etc_hosts</span></tt> option to be changed</li>
<li>Add better debugging for <tt class="docutils literal"><span class="pre">luxid</span></tt> queries</li>
<li>Expose bulk parameter for GetJobs in RAPI client</li>
<li>Expose missing <tt class="docutils literal"><span class="pre">network</span></tt> fields in RAPI</li>
<li>Add some <tt class="docutils literal"><span class="pre">cluster</span> <span class="pre">verify</span></tt> tests</li>
<li>Some unittest fixes</li>
<li>Fix a malfunction in <tt class="docutils literal"><span class="pre">hspace</span></tt>&#8216;s tiered allocation</li>
<li>Fix query compatibility between haskell and python implementations</li>
<li>Add the <tt class="docutils literal"><span class="pre">vnet_hdr</span></tt> HV parameter for KVM</li>
<li>Add <tt class="docutils literal"><span class="pre">--cleanup</span></tt> to instance failover</li>
<li>Change the connected groups format in <tt class="docutils literal"><span class="pre">gnt-network</span> <span class="pre">info</span></tt> output; it
was previously displayed as a raw list by mistake. (Merged from 2.7)</li>
</ul>
</div>
<div class="section" id="version-2-8-0-beta1">
<h2>Version 2.8.0 beta1<a class="headerlink" href="#version-2-8-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 24 Jun 2013)</em></p>
<p>This was the first beta release of the 2.8 series. All important changes
are listed in the latest 2.8 entry.</p>
</div>
<div class="section" id="version-2-7-2">
<h2>Version 2.7.2<a class="headerlink" href="#version-2-7-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 26 Sep 2013)</em></p>
<ul class="simple">
<li>Change the connected groups format in <tt class="docutils literal"><span class="pre">gnt-network</span> <span class="pre">info</span></tt> output; it
was previously displayed as a raw list by mistake</li>
<li>Check disk template in right dict when copying</li>
<li>Support multi-instance allocs without iallocator</li>
<li>Fix some errors in the documentation</li>
<li>Fix formatting of tuple in an error message</li>
</ul>
</div>
<div class="section" id="version-2-7-1">
<h2>Version 2.7.1<a class="headerlink" href="#version-2-7-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 25 Jul 2013)</em></p>
<ul class="simple">
<li>Add logrotate functionality in daemon-util</li>
<li>Add logrotate example file</li>
<li>Add missing fields to network queries over rapi</li>
<li>Fix network object timestamps</li>
<li>Add support for querying network timestamps</li>
<li>Fix a typo in the example crontab</li>
<li>Fix a documentation typo</li>
</ul>
</div>
<div class="section" id="version-2-7-0">
<h2>Version 2.7.0<a class="headerlink" href="#version-2-7-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 04 Jul 2013)</em></p>
<div class="section" id="id47">
<h3>Incompatible/important changes<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Instance policies for disk size were documented to be on a per-disk
basis, but hail applied them to the sum of all disks. This has been
fixed.</li>
<li><tt class="docutils literal"><span class="pre">hbal</span></tt> will now exit with status 0 if, during job execution over
LUXI, early exit has been requested and all jobs are successful;
before, exit status 1 was used, which cannot be differentiated from
&#8220;job error&#8221; case</li>
<li>Compatibility with newer versions of rbd has been fixed</li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">batch-create</span></tt> has been changed to use the bulk create
opcode from Ganeti. This lead to incompatible changes in the format of
the JSON file. It&#8217;s now not a custom dict anymore but a dict
compatible with the <tt class="docutils literal"><span class="pre">OpInstanceCreate</span></tt> opcode.</li>
<li>Parent directories for file storage need to be listed in
<tt class="docutils literal"><span class="pre">$sysconfdir/ganeti/file-storage-paths</span></tt> now. <tt class="docutils literal"><span class="pre">cfgupgrade</span></tt> will
write the file automatically based on old configuration values, but it
can not distribute it across all nodes and the file contents should be
verified. Use <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">copyfile</span>
<span class="pre">$sysconfdir/ganeti/file-storage-paths</span></tt> once the cluster has been
upgraded. The reason for requiring this list of paths now is that
before it would have been possible to inject new paths via RPC,
allowing files to be created in arbitrary locations. The RPC protocol
is protected using SSL/X.509 certificates, but as a design principle
Ganeti does not permit arbitrary paths to be passed.</li>
<li>The parsing of the variants file for OSes (see
<a class="reference internal" href="man-ganeti-os-interface.html"><em>ganeti-os-interface(7)</em></a>) has been slightly changed: now empty
lines and comment lines (starting with <tt class="docutils literal"><span class="pre">#</span></tt>) are ignored for better
readability.</li>
<li>The <tt class="docutils literal"><span class="pre">setup-ssh</span></tt> tool added in Ganeti 2.2 has been replaced and is no
longer available. <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">add</span></tt> now invokes a new tool on the
destination node, named <tt class="docutils literal"><span class="pre">prepare-node-join</span></tt>, to configure the SSH
daemon. Paramiko is no longer necessary to configure nodes&#8217; SSH
daemons via <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">add</span></tt>.</li>
<li>Draining (<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">queue</span> <span class="pre">drain</span></tt>) and un-draining the job queue
(<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">queue</span> <span class="pre">undrain</span></tt>) now affects all nodes in a cluster and
the flag is not reset after a master failover.</li>
<li>Python 2.4 has <em>not</em> been tested with this release. Using 2.6 or above
is recommended. 2.6 will be mandatory from the 2.8 series.</li>
</ul>
</div>
<div class="section" id="id48">
<h3>New features<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>New network management functionality to support automatic allocation
of IP addresses and managing of network parameters. See
<a class="reference internal" href="man-gnt-network.html"><em>gnt-network(8)</em></a> for more details.</li>
<li>New external storage backend, to allow managing arbitrary storage
systems external to the cluster. See
<a class="reference internal" href="man-ganeti-extstorage-interface.html"><em>ganeti-extstorage-interface(7)</em></a>.</li>
<li>New <tt class="docutils literal"><span class="pre">exclusive-storage</span></tt> node parameter added, restricted to
nodegroup level. When it&#8217;s set to true, physical disks are assigned in
an exclusive fashion to instances, as documented in <a class="reference internal" href="design-partitioned.html"><em>Partitioned
Ganeti</em></a>.  Currently, only instances using the
<tt class="docutils literal"><span class="pre">plain</span></tt> disk template are supported.</li>
<li>The KVM hypervisor has been updated with many new hypervisor
parameters, including a generic one for passing arbitrary command line
values. See a complete list in <a class="reference internal" href="man-gnt-instance.html"><em>gnt-instance(8)</em></a>. It is now
compatible up to qemu 1.4.</li>
<li>A new tool, called <tt class="docutils literal"><span class="pre">mon-collector</span></tt>, is the stand-alone executor of
the data collectors for a monitoring system. As of this version, it
just includes the DRBD data collector, that can be executed by calling
<tt class="docutils literal"><span class="pre">mon-collector</span></tt> using the <tt class="docutils literal"><span class="pre">drbd</span></tt> parameter. See
<a class="reference internal" href="man-mon-collector.html"><em>mon-collector(7)</em></a>.</li>
<li>A new user option, <tt class="docutils literal"><span class="pre">read</span></tt>, has been added
for RAPI users. It allows granting permissions to query for
information to a specific user without giving
<tt class="docutils literal"><span class="pre">write</span></tt> permissions.</li>
<li>A new tool named <tt class="docutils literal"><span class="pre">node-cleanup</span></tt> has been added. It cleans remains of
a cluster from a machine by stopping all daemons, removing
certificates and ssconf files. Unless the <tt class="docutils literal"><span class="pre">--no-backup</span></tt> option is
given, copies of the certificates are made.</li>
<li>Instance creations now support the use of opportunistic locking,
potentially speeding up the (parallel) creation of multiple instances.
This feature is currently only available via the <a class="reference internal" href="rapi.html"><em>RAPI</em></a> interface and when an instance allocator is used. If the
<tt class="docutils literal"><span class="pre">opportunistic_locking</span></tt> parameter is set the opcode will try to
acquire as many locks as possible, but will not wait for any locks
held by other opcodes. If not enough resources can be found to
allocate the instance, the temporary error code
<tt class="docutils literal"><span class="pre">temp_insufficient_resources</span></tt> is returned. The operation can be
retried thereafter, with or without opportunistic locking.</li>
<li>New experimental linux-ha resource scripts.</li>
<li>Restricted-commands support: ganeti can now be asked (via command line
or rapi) to perform commands on a node. These are passed via ganeti
RPC rather than ssh. This functionality is restricted to commands
specified on the <tt class="docutils literal"><span class="pre">$sysconfdir/ganeti/restricted-commands</span></tt> for security
reasons. The file is not copied automatically.</li>
</ul>
</div>
<div class="section" id="id49">
<h3>Misc changes<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Diskless instances are now externally mirrored (Issue 237). This for
now has only been tested in conjunction with explicit target nodes for
migration/failover.</li>
<li>Queries not needing locks or RPC access to the node can now be
performed by the confd daemon, making them independent from jobs, and
thus faster to execute. This is selectable at configure time.</li>
<li>The functionality for allocating multiple instances at once has been
overhauled and is now also available through <a class="reference internal" href="rapi.html"><em>RAPI</em></a>.</li>
</ul>
<p>There are no significant changes from version 2.7.0~rc3.</p>
</div>
</div>
<div class="section" id="version-2-7-0-rc3">
<h2>Version 2.7.0 rc3<a class="headerlink" href="#version-2-7-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 25 Jun 2013)</em></p>
<ul class="simple">
<li>Fix permissions on the confd query socket (Issue 477)</li>
<li>Fix permissions on the job archive dir (Issue 498)</li>
<li>Fix handling of an internal exception in replace-disks (Issue 472)</li>
<li>Fix gnt-node info handling of shortened names (Issue 497)</li>
<li>Fix gnt-instance grow-disk when wiping is enabled</li>
<li>Documentation improvements, and support for newer pandoc</li>
<li>Fix hspace honoring ipolicy for disks (Issue 484)</li>
<li>Improve handling of the <tt class="docutils literal"><span class="pre">kvm_extra</span></tt> HV parameter</li>
</ul>
</div>
<div class="section" id="version-2-7-0-rc2">
<h2>Version 2.7.0 rc2<a class="headerlink" href="#version-2-7-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 24 May 2013)</em></p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">devel/upload</span></tt> now works when <tt class="docutils literal"><span class="pre">/var/run</span></tt> on the target nodes is a
symlink.</li>
<li>Disks added through <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt> or created through
<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">recreate-disks</span></tt> are wiped, if the
<tt class="docutils literal"><span class="pre">prealloc_wipe_disks</span></tt> flag is set.</li>
<li>If wiping newly created disks fails, the disks are removed. Also,
partial failures in creating disks through <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt>
triggers a cleanup of the partially-created disks.</li>
<li>Removing the master IP address doesn&#8217;t fail if the address has been
already removed.</li>
<li>Fix ownership of the OS log dir</li>
<li>Workaround missing SO_PEERCRED constant (Issue 191)</li>
</ul>
</div>
<div class="section" id="version-2-7-0-rc1">
<h2>Version 2.7.0 rc1<a class="headerlink" href="#version-2-7-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 3 May 2013)</em></p>
<p>This was the first release candidate of the 2.7 series. Since beta3:</p>
<ul class="simple">
<li>Fix kvm compatibility with qemu 1.4 (Issue 389)</li>
<li>Documentation updates (admin guide, upgrade notes, install
instructions) (Issue 372)</li>
<li>Fix gnt-group list nodes and instances count (Issue 436)</li>
<li>Fix compilation without non-mandatory libraries (Issue 441)</li>
<li>Fix xen-hvm hypervisor forcing nics to type &#8216;ioemu&#8217; (Issue 247)</li>
<li>Make confd logging more verbose at INFO level (Issue 435)</li>
<li>Improve &#8220;networks&#8221; documentation in <a class="reference internal" href="man-gnt-instance.html"><em>gnt-instance(8)</em></a></li>
<li>Fix failure path for instance storage type conversion (Issue 229)</li>
<li>Update htools text backend documentation</li>
<li>Improve the renew-crypto section of <a class="reference internal" href="man-gnt-cluster.html"><em>gnt-cluster(8)</em></a></li>
<li>Disable inter-cluster instance move for file-based instances, because
it is dependant on instance export, which is not supported for
file-based instances. (Issue 414)</li>
<li>Fix gnt-job crashes on non-ascii characters (Issue 427)</li>
<li>Fix volume group checks on non-vm-capable nodes (Issue 432)</li>
</ul>
</div>
<div class="section" id="version-2-7-0-beta3">
<h2>Version 2.7.0 beta3<a class="headerlink" href="#version-2-7-0-beta3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 22 Apr 2013)</em></p>
<p>This was the third beta release of the 2.7 series. Since beta2:</p>
<ul class="simple">
<li>Fix hail to verify disk instance policies on a per-disk basis (Issue 418).</li>
<li>Fix data loss on wrong usage of <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">move</span></tt></li>
<li>Properly export errors in confd-based job queries</li>
<li>Add <tt class="docutils literal"><span class="pre">users-setup</span></tt> tool</li>
<li>Fix iallocator protocol to report 0 as a disk size for diskless
instances. This avoids hail breaking when a diskless instance is
present.</li>
<li>Fix job queue directory permission problem that made confd job queries
fail. This requires running an <tt class="docutils literal"><span class="pre">ensure-dirs</span> <span class="pre">--full-run</span></tt> on upgrade
for access to archived jobs (Issue 406).</li>
<li>Limit the sizes of networks supported by <tt class="docutils literal"><span class="pre">gnt-network</span></tt> to something
between a <tt class="docutils literal"><span class="pre">/16</span></tt> and a <tt class="docutils literal"><span class="pre">/30</span></tt> to prevent memory bloat and crashes.</li>
<li>Fix bugs in instance disk template conversion</li>
<li>Fix GHC 7 compatibility</li>
<li>Fix <tt class="docutils literal"><span class="pre">burnin</span></tt> install path (Issue 426).</li>
<li>Allow very small disk grows (Issue 347).</li>
<li>Fix a <tt class="docutils literal"><span class="pre">ganeti-noded</span></tt> memory bloat introduced in 2.5, by making sure
that noded doesn&#8217;t import masterd code (Issue 419).</li>
<li>Make sure the default metavg at cluster init is the same as the vg, if
unspecified (Issue 358).</li>
<li>Fix cleanup of partially created disks (part of Issue 416)</li>
</ul>
</div>
<div class="section" id="version-2-7-0-beta2">
<h2>Version 2.7.0 beta2<a class="headerlink" href="#version-2-7-0-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 2 Apr 2013)</em></p>
<p>This was the second beta release of the 2.7 series. Since beta1:</p>
<ul class="simple">
<li>Networks no longer have a &#8220;type&#8221; slot, since this information was
unused in Ganeti: instead of it tags should be used.</li>
<li>The rapi client now has a <tt class="docutils literal"><span class="pre">target_node</span></tt> option to MigrateInstance.</li>
<li>Fix early exit return code for hbal (Issue 386).</li>
<li>Fix <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">migrate/failover</span> <span class="pre">-n</span></tt> (Issue 396).</li>
<li>Fix <tt class="docutils literal"><span class="pre">rbd</span> <span class="pre">showmapped</span></tt> output parsing (Issue 312).</li>
<li>Networks are now referenced indexed by UUID, rather than name. This
will require running cfgupgrade, from 2.7.0beta1, if networks are in
use.</li>
<li>The OS environment now includes network information.</li>
<li>Deleting of a network is now disallowed if any instance nic is using
it, to prevent dangling references.</li>
<li>External storage is now documented in man pages.</li>
<li>The exclusive_storage flag can now only be set at nodegroup level.</li>
<li>Hbal can now submit an explicit priority with its jobs.</li>
<li>Many network related locking fixes.</li>
<li>Bump up the required pylint version to 0.25.1.</li>
<li>Fix the <tt class="docutils literal"><span class="pre">no_remember</span></tt> option in RAPI client.</li>
<li>Many ipolicy related tests, qa, and fixes.</li>
<li>Many documentation improvements and fixes.</li>
<li>Fix building with <tt class="docutils literal"><span class="pre">--disable-file-storage</span></tt>.</li>
<li>Fix <tt class="docutils literal"><span class="pre">-q</span></tt> option in htools, which was broken if passed more than
once.</li>
<li>Some haskell/python interaction improvements and fixes.</li>
<li>Fix iallocator in case of missing LVM storage.</li>
<li>Fix confd config load in case of <tt class="docutils literal"><span class="pre">--no-lvm-storage</span></tt>.</li>
<li>The confd/query functionality is now mentioned in the security
documentation.</li>
</ul>
</div>
<div class="section" id="version-2-7-0-beta1">
<h2>Version 2.7.0 beta1<a class="headerlink" href="#version-2-7-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 6 Feb 2013)</em></p>
<p>This was the first beta release of the 2.7 series. All important changes
are listed in the latest 2.7 entry.</p>
</div>
<div class="section" id="version-2-6-2">
<h2>Version 2.6.2<a class="headerlink" href="#version-2-6-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 21 Dec 2012)</em></p>
<p>Important behaviour change: hbal won&#8217;t rebalance anymore instances which
have the <tt class="docutils literal"><span class="pre">auto_balance</span></tt> attribute set to false. This was the intention
all along, but until now it only skipped those from the N+1 memory
reservation (DRBD-specific).</p>
<p>A significant number of bug fixes in this release:</p>
<ul class="simple">
<li>Fixed disk adoption interaction with ipolicy checks.</li>
<li>Fixed networking issues when instances are started, stopped or
migrated, by forcing the tap device&#8217;s MAC prefix to &#8220;fe&#8221; (issue 217).</li>
<li>Fixed the warning in cluster verify for shared storage instances not
being redundant.</li>
<li>Fixed removal of storage directory on shared file storage (issue 262).</li>
<li>Fixed validation of LVM volume group name in OpClusterSetParams
(<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">modify</span></tt>) (issue 285).</li>
<li>Fixed runtime memory increases (<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span> <span class="pre">-m</span></tt>).</li>
<li>Fixed live migration under Xen&#8217;s <tt class="docutils literal"><span class="pre">xl</span></tt> mode.</li>
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">console</span></tt> with <tt class="docutils literal"><span class="pre">xl</span></tt>.</li>
<li>Fixed building with newer Haskell compiler/libraries.</li>
<li>Fixed PID file writing in Haskell daemons (confd); this prevents
restart issues if confd was launched manually (outside of
<tt class="docutils literal"><span class="pre">daemon-util</span></tt>) while another copy of it was running</li>
<li>Fixed a type error when doing live migrations with KVM (issue 297) and
the error messages for failing migrations have been improved.</li>
<li>Fixed opcode validation for the out-of-band commands (<tt class="docutils literal"><span class="pre">gnt-node</span>
<span class="pre">power</span></tt>).</li>
<li>Fixed a type error when unsetting OS hypervisor parameters (issue
311); now it&#8217;s possible to unset all OS-specific hypervisor
parameters.</li>
<li>Fixed the <tt class="docutils literal"><span class="pre">dry-run</span></tt> mode for many operations: verification of
results was over-zealous but didn&#8217;t take into account the <tt class="docutils literal"><span class="pre">dry-run</span></tt>
operation, resulting in &#8220;wrong&#8221; failures.</li>
<li>Fixed bash completion in <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">list</span></tt> when the job queue has
hundreds of entries; especially with older <tt class="docutils literal"><span class="pre">bash</span></tt> versions, this
results in significant CPU usage.</li>
</ul>
<p>And lastly, a few other improvements have been made:</p>
<ul class="simple">
<li>Added option to force master-failover without voting (issue 282).</li>
<li>Clarified error message on lock conflict (issue 287).</li>
<li>Logging of newly submitted jobs has been improved (issue 290).</li>
<li>Hostname checks have been made uniform between instance rename and
create (issue 291).</li>
<li>The <tt class="docutils literal"><span class="pre">--submit</span></tt> option is now supported by <tt class="docutils literal"><span class="pre">gnt-debug</span> <span class="pre">delay</span></tt>.</li>
<li>Shutting down the master daemon by sending SIGTERM now stops it from
processing jobs waiting for locks; instead, those jobs will be started
once again after the master daemon is started the next time (issue
296).</li>
<li>Support for Xen&#8217;s <tt class="docutils literal"><span class="pre">xl</span></tt> program has been improved (besides the fixes
above).</li>
<li>Reduced logging noise in the Haskell confd daemon (only show one log
entry for each config reload, instead of two).</li>
<li>Several man page updates and typo fixes.</li>
</ul>
</div>
<div class="section" id="version-2-6-1">
<h2>Version 2.6.1<a class="headerlink" href="#version-2-6-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 12 Oct 2012)</em></p>
<p>A small bugfix release. Among the bugs fixed:</p>
<ul class="simple">
<li>Fixed double use of <tt class="docutils literal"><span class="pre">PRIORITY_OPT</span></tt> in <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">migrate</span></tt>, that
made the command unusable.</li>
<li>Commands that issue many jobs don&#8217;t fail anymore just because some jobs
take so long that other jobs are archived.</li>
<li>Failures during <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">reinstall</span></tt> are reflected by the exit
status.</li>
<li>Issue 190 fixed. Check for DRBD in cluster verify is enabled only when
DRBD is enabled.</li>
<li>When <tt class="docutils literal"><span class="pre">always_failover</span></tt> is set, <tt class="docutils literal"><span class="pre">--allow-failover</span></tt> is not required
in migrate commands anymore.</li>
<li><tt class="docutils literal"><span class="pre">bash_completion</span></tt> works even if extglob is disabled.</li>
<li>Fixed bug with locks that made failover for RDB-based instances fail.</li>
<li>Fixed bug in non-mirrored instance allocation that made Ganeti choose
a random node instead of one based on the allocator metric.</li>
<li>Support for newer versions of pylint and pep8.</li>
<li>Hail doesn&#8217;t fail anymore when trying to add an instance of type
<tt class="docutils literal"><span class="pre">file</span></tt>, <tt class="docutils literal"><span class="pre">sharedfile</span></tt> or <tt class="docutils literal"><span class="pre">rbd</span></tt>.</li>
<li>Added new Makefile target to rebuild the whole distribution, so that
all files are included.</li>
</ul>
</div>
<div class="section" id="version-2-6-0">
<h2>Version 2.6.0<a class="headerlink" href="#version-2-6-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 27 Jul 2012)</em></p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">The <tt class="docutils literal"><span class="pre">LUXI</span></tt> protocol has been made more consistent
regarding its handling of command arguments. This, however, leads to
incompatibility issues with previous versions. Please ensure that you
restart Ganeti daemons soon after the upgrade, otherwise most
<tt class="docutils literal"><span class="pre">LUXI</span></tt> calls (job submission, setting/resetting the drain flag,
pausing/resuming the watcher, cancelling and archiving jobs, querying
the cluster configuration) will fail.</p>
</div>
<div class="section" id="id50">
<h3>New features<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h3>
<div class="section" id="instance-run-status">
<h4>Instance run status<a class="headerlink" href="#instance-run-status" title="Permalink to this headline">¶</a></h4>
<p>The current <tt class="docutils literal"><span class="pre">admin_up</span></tt> field, which used to denote whether an instance
should be running or not, has been removed. Instead, <tt class="docutils literal"><span class="pre">admin_state</span></tt> is
introduced, with 3 possible values &#8211; <tt class="docutils literal"><span class="pre">up</span></tt>, <tt class="docutils literal"><span class="pre">down</span></tt> and <tt class="docutils literal"><span class="pre">offline</span></tt>.</p>
<p>The rational behind this is that an instance being “down” can have
different meanings:</p>
<ul class="simple">
<li>it could be down during a reboot</li>
<li>it could be temporarily be down for a reinstall</li>
<li>or it could be down because it is deprecated and kept just for its
disk</li>
</ul>
<p>The previous Boolean state was making it difficult to do capacity
calculations: should Ganeti reserve memory for a down instance? Now, the
tri-state field makes it clear:</p>
<ul class="simple">
<li>in <tt class="docutils literal"><span class="pre">up</span></tt> and <tt class="docutils literal"><span class="pre">down</span></tt> state, all resources are reserved for the
instance, and it can be at any time brought up if it is down</li>
<li>in <tt class="docutils literal"><span class="pre">offline</span></tt> state, only disk space is reserved for it, but not
memory or CPUs</li>
</ul>
<p>The field can have an extra use: since the transition between <tt class="docutils literal"><span class="pre">up</span></tt> and
<tt class="docutils literal"><span class="pre">down</span></tt> and vice-versus is done via <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">start/stop</span></tt>, but
transition between <tt class="docutils literal"><span class="pre">offline</span></tt> and <tt class="docutils literal"><span class="pre">down</span></tt> is done via <tt class="docutils literal"><span class="pre">gnt-instance</span>
<span class="pre">modify</span></tt>, it is possible to given different rights to users. For
example, owners of an instance could be allowed to start/stop it, but
not transition it out of the offline state.</p>
</div>
<div class="section" id="instance-policies-and-specs">
<h4>Instance policies and specs<a class="headerlink" href="#instance-policies-and-specs" title="Permalink to this headline">¶</a></h4>
<p>In previous Ganeti versions, an instance creation request was not
limited on the minimum size and on the maximum size just by the cluster
resources. As such, any policy could be implemented only in third-party
clients (RAPI clients, or shell wrappers over <tt class="docutils literal"><span class="pre">gnt-*</span></tt>
tools). Furthermore, calculating cluster capacity via <tt class="docutils literal"><span class="pre">hspace</span></tt> again
required external input with regards to instance sizes.</p>
<p>In order to improve these workflows and to allow for example better
per-node group differentiation, we introduced instance specs, which
allow declaring:</p>
<ul class="simple">
<li>minimum instance disk size, disk count, memory size, cpu count</li>
<li>maximum values for the above metrics</li>
<li>and “standard” values (used in <tt class="docutils literal"><span class="pre">hspace</span></tt> to calculate the standard
sized instances)</li>
</ul>
<p>The minimum/maximum values can be also customised at node-group level,
for example allowing more powerful hardware to support bigger instance
memory sizes.</p>
<p>Beside the instance specs, there are a few other settings belonging to
the instance policy framework. It is possible now to customise, per
cluster and node-group:</p>
<ul class="simple">
<li>the list of allowed disk templates</li>
<li>the maximum ratio of VCPUs per PCPUs (to control CPU oversubscription)</li>
<li>the maximum ratio of instance to spindles (see below for more
information) for local storage</li>
</ul>
<p>All these together should allow all tools that talk to Ganeti to know
what are the ranges of allowed values for instances and the
over-subscription that is allowed.</p>
<p>For the VCPU/PCPU ratio, we already have the VCPU configuration from the
instance configuration, and the physical CPU configuration from the
node. For the spindle ratios however, we didn&#8217;t track before these
values, so new parameters have been added:</p>
<ul class="simple">
<li>a new node parameter <tt class="docutils literal"><span class="pre">spindle_count</span></tt>, defaults to 1, customisable at
node group or node level</li>
<li>at new backend parameter (for instances), <tt class="docutils literal"><span class="pre">spindle_use</span></tt> defaults to 1</li>
</ul>
<p>Note that spindles in this context doesn&#8217;t need to mean actual
mechanical hard-drives; it&#8217;s just a relative number for both the node
I/O capacity and instance I/O consumption.</p>
</div>
<div class="section" id="instance-migration-behaviour">
<h4>Instance migration behaviour<a class="headerlink" href="#instance-migration-behaviour" title="Permalink to this headline">¶</a></h4>
<p>While live-migration is in general desirable over failover, it is
possible that for some workloads it is actually worse, due to the
variable time of the “suspend” phase during live migration.</p>
<p>To allow the tools to work consistently over such instances (without
having to hard-code instance names), a new backend parameter
<tt class="docutils literal"><span class="pre">always_failover</span></tt> has been added to control the migration/failover
behaviour. When set to True, all migration requests for an instance will
instead fall-back to failover.</p>
</div>
<div class="section" id="instance-memory-ballooning">
<h4>Instance memory ballooning<a class="headerlink" href="#instance-memory-ballooning" title="Permalink to this headline">¶</a></h4>
<p>Initial support for memory ballooning has been added. The memory for an
instance is no longer fixed (backend parameter <tt class="docutils literal"><span class="pre">memory</span></tt>), but instead
can vary between minimum and maximum values (backend parameters
<tt class="docutils literal"><span class="pre">minmem</span></tt> and <tt class="docutils literal"><span class="pre">maxmem</span></tt>). Currently we only change an instance&#8217;s
memory when:</p>
<ul class="simple">
<li>live migrating or failing over and instance and the target node
doesn&#8217;t have enough memory</li>
<li>user requests changing the memory via <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span>
<span class="pre">--runtime-memory</span></tt></li>
</ul>
</div>
<div class="section" id="instance-cpu-pinning">
<h4>Instance CPU pinning<a class="headerlink" href="#instance-cpu-pinning" title="Permalink to this headline">¶</a></h4>
<p>In order to control the use of specific CPUs by instance, support for
controlling CPU pinning has been added for the Xen, HVM and LXC
hypervisors. This is controlled by a new hypervisor parameter
<tt class="docutils literal"><span class="pre">cpu_mask</span></tt>; details about possible values for this are in the
<a class="reference internal" href="man-gnt-instance.html"><em>gnt-instance(8)</em></a>. Note that use of the most specific (precise
VCPU-to-CPU mapping) form will work well only when all nodes in your
cluster have the same amount of CPUs.</p>
</div>
<div class="section" id="disk-parameters">
<h4>Disk parameters<a class="headerlink" href="#disk-parameters" title="Permalink to this headline">¶</a></h4>
<p>Another area in which Ganeti was not customisable were the parameters
used for storage configuration, e.g. how many stripes to use for LVM,
DRBD resync configuration, etc.</p>
<p>To improve this area, we&#8217;ve added disks parameters, which are
customisable at cluster and node group level, and which allow to
specify various parameters for disks (DRBD has the most parameters
currently), for example:</p>
<ul class="simple">
<li>DRBD resync algorithm and parameters (e.g. speed)</li>
<li>the default VG for meta-data volumes for DRBD</li>
<li>number of stripes for LVM (plain disk template)</li>
<li>the RBD pool</li>
</ul>
<p>These parameters can be modified via <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">modify</span> <span class="pre">-D</span> <span class="pre">…</span></tt> and
<tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">modify</span> <span class="pre">-D</span> <span class="pre">…</span></tt>, and are used at either instance creation (in
case of LVM stripes, for example) or at disk “activation” time
(e.g. resync speed).</p>
</div>
<div class="section" id="rados-block-device-support">
<h4>Rados block device support<a class="headerlink" href="#rados-block-device-support" title="Permalink to this headline">¶</a></h4>
<p>A Rados (<a class="reference external" href="http://ceph.com/wiki/Rbd">http://ceph.com/wiki/Rbd</a>) storage backend has been added,
denoted by the <tt class="docutils literal"><span class="pre">rbd</span></tt> disk template type. This is considered
experimental, feedback is welcome. For details on configuring it, see
the <a class="reference internal" href="install.html"><em>Ganeti installation tutorial</em></a> document and the <a class="reference internal" href="man-gnt-cluster.html"><em>gnt-cluster(8)</em></a> man page.</p>
</div>
<div class="section" id="master-ip-setup">
<h4>Master IP setup<a class="headerlink" href="#master-ip-setup" title="Permalink to this headline">¶</a></h4>
<p>The existing master IP functionality works well only in simple setups (a
single network shared by all nodes); however, if nodes belong to
different networks, then the <tt class="docutils literal"><span class="pre">/32</span></tt> setup and lack of routing
information is not enough.</p>
<p>To allow the master IP to function well in more complex cases, the
system was reworked as follows:</p>
<ul class="simple">
<li>a master IP netmask setting has been added</li>
<li>the master IP activation/turn-down code was moved from the node daemon
to a separate script</li>
<li>whether to run the Ganeti-supplied master IP script or a user-supplied
on is a <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">init</span></tt> setting</li>
</ul>
<p>Details about the location of the standard and custom setup scripts are
in the man page <a class="reference internal" href="man-gnt-cluster.html"><em>gnt-cluster(8)</em></a>; for information about the
setup script protocol, look at the Ganeti-supplied script.</p>
</div>
<div class="section" id="spice-support">
<h4>SPICE support<a class="headerlink" href="#spice-support" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference external" href="http://www.linux-kvm.org/page/SPICE">SPICE</a> support has been
improved.</p>
<p>It is now possible to use TLS-protected connections, and when renewing
or changing the cluster certificates (via <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">renew-crypto</span></tt>,
it is now possible to specify spice or spice CA certificates. Also, it
is possible to configure a password for SPICE sessions via the
hypervisor parameter <tt class="docutils literal"><span class="pre">spice_password_file</span></tt>.</p>
<p>There are also new parameters to control the compression and streaming
options (e.g. <tt class="docutils literal"><span class="pre">spice_image_compression</span></tt>, <tt class="docutils literal"><span class="pre">spice_streaming_video</span></tt>,
etc.). For details, see the man page <a class="reference internal" href="man-gnt-instance.html"><em>gnt-instance(8)</em></a> and look
for the spice parameters.</p>
<p>Lastly, it is now possible to see the SPICE connection information via
<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">console</span></tt>.</p>
</div>
<div class="section" id="ovf-converter">
<h4>OVF converter<a class="headerlink" href="#ovf-converter" title="Permalink to this headline">¶</a></h4>
<p>A new tool (<tt class="docutils literal"><span class="pre">tools/ovfconverter</span></tt>) has been added that supports
conversion between Ganeti and the <a class="reference external" href="http://en.wikipedia.org/wiki/Open_Virtualization_Format">Open Virtualization Format</a> (both to and
from).</p>
<p>This relies on the <tt class="docutils literal"><span class="pre">qemu-img</span></tt> tool to convert the disk formats, so the
actual compatibility with other virtualization solutions depends on it.</p>
</div>
<div class="section" id="confd-daemon-changes">
<h4>Confd daemon changes<a class="headerlink" href="#confd-daemon-changes" title="Permalink to this headline">¶</a></h4>
<p>The configuration query daemon (<tt class="docutils literal"><span class="pre">ganeti-confd</span></tt>) is now optional, and
has been rewritten in Haskell; whether to use the daemon at all, use the
Python (default) or the Haskell version is selectable at configure time
via the <tt class="docutils literal"><span class="pre">--enable-confd</span></tt> parameter, which can take one of the
<tt class="docutils literal"><span class="pre">haskell</span></tt>, <tt class="docutils literal"><span class="pre">python</span></tt> or <tt class="docutils literal"><span class="pre">no</span></tt> values. If not used, disabling the
daemon will result in a smaller footprint; for larger systems, we
welcome feedback on the Haskell version which might become the default
in future versions.</p>
<p>If you want to use <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-drbd</span></tt> you need to have the Haskell
daemon running. The Python version doesn&#8217;t implement the new call.</p>
</div>
</div>
<div class="section" id="user-interface-changes">
<h3>User interface changes<a class="headerlink" href="#user-interface-changes" title="Permalink to this headline">¶</a></h3>
<p>We have replaced the <tt class="docutils literal"><span class="pre">--disks</span></tt> option of <tt class="docutils literal"><span class="pre">gnt-instance</span>
<span class="pre">replace-disks</span></tt> with a more flexible <tt class="docutils literal"><span class="pre">--disk</span></tt> option, which allows
adding and removing disks at arbitrary indices (Issue 188). Furthermore,
disk size and mode can be changed upon recreation (via <tt class="docutils literal"><span class="pre">gnt-instance</span>
<span class="pre">recreate-disks</span></tt>, which accepts the same <tt class="docutils literal"><span class="pre">--disk</span></tt> option).</p>
<p>As many people are used to a <tt class="docutils literal"><span class="pre">show</span></tt> command, we have added that as an
alias to <tt class="docutils literal"><span class="pre">info</span></tt> on all <tt class="docutils literal"><span class="pre">gnt-*</span></tt> commands.</p>
<p>The <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">grow-disk</span></tt> command has a new mode in which it can
accept the target size of the disk, instead of the delta; this can be
more safe since two runs in absolute mode will be idempotent, and
sometimes it&#8217;s also easier to specify the desired size directly.</p>
<p>Also the handling of instances with regard to offline secondaries has
been improved. Instance operations should not fail because one of it&#8217;s
secondary nodes is offline, even though it&#8217;s safe to proceed.</p>
<p>A new command <tt class="docutils literal"><span class="pre">list-drbd</span></tt> has been added to the <tt class="docutils literal"><span class="pre">gnt-node</span></tt> script to
support debugging of DRBD issues on nodes. It provides a mapping of DRBD
minors to instance name.</p>
</div>
<div class="section" id="api-changes">
<h3>API changes<a class="headerlink" href="#api-changes" title="Permalink to this headline">¶</a></h3>
<p>RAPI coverage has improved, with (for example) new resources for
recreate-disks, node power-cycle, etc.</p>
</div>
<div class="section" id="compatibility">
<h3>Compatibility<a class="headerlink" href="#compatibility" title="Permalink to this headline">¶</a></h3>
<p>There is partial support for <tt class="docutils literal"><span class="pre">xl</span></tt> in the Xen hypervisor; feedback is
welcome.</p>
<p>Python 2.7 is better supported, and after Ganeti 2.6 we will investigate
whether to still support Python 2.4 or move to Python 2.6 as minimum
required version.</p>
<p>Support for Fedora has been slightly improved; the provided example
init.d script should work better on it and the INSTALL file should
document the needed dependencies.</p>
</div>
<div class="section" id="internal-changes">
<h3>Internal changes<a class="headerlink" href="#internal-changes" title="Permalink to this headline">¶</a></h3>
<p>The deprecated <tt class="docutils literal"><span class="pre">QueryLocks</span></tt> LUXI request has been removed. Use
<tt class="docutils literal"><span class="pre">Query(what=QR_LOCK,</span> <span class="pre">...)</span></tt> instead.</p>
<p>The LUXI requests <tt class="docutils literal"><span class="pre">QueryJobs</span></tt>,
<tt class="docutils literal"><span class="pre">QueryInstances</span></tt>, <tt class="docutils literal"><span class="pre">QueryNodes</span></tt>,
<tt class="docutils literal"><span class="pre">QueryGroups</span></tt>, <tt class="docutils literal"><span class="pre">QueryExports</span></tt> and
<tt class="docutils literal"><span class="pre">QueryTags</span></tt> are deprecated and will be removed in a
future version. <tt class="docutils literal"><span class="pre">Query</span></tt> should be used instead.</p>
<p>RAPI client: <tt class="docutils literal"><span class="pre">CertificateError</span></tt> now derives from
<tt class="docutils literal"><span class="pre">GanetiApiError</span></tt>. This should make it more easy to handle Ganeti
errors.</p>
<p>Deprecation warnings due to PyCrypto/paramiko import in
<tt class="docutils literal"><span class="pre">tools/setup-ssh</span></tt> have been silenced, as usually they are safe; please
make sure to run an up-to-date paramiko version, if you use this tool.</p>
<p>The QA scripts now depend on Python 2.5 or above (the main code base
still works with Python 2.4).</p>
<p>The configuration file (<tt class="docutils literal"><span class="pre">config.data</span></tt>) is now written without
indentation for performance reasons; if you want to edit it, it can be
re-formatted via <tt class="docutils literal"><span class="pre">tools/fmtjson</span></tt>.</p>
<p>A number of bugs has been fixed in the cluster merge tool.</p>
<p><tt class="docutils literal"><span class="pre">x509</span></tt> certification verification (used in import-export) has been
changed to allow the same clock skew as permitted by the cluster
verification. This will remove some rare but hard to diagnose errors in
import-export.</p>
</div>
</div>
<div class="section" id="version-2-6-0-rc4">
<h2>Version 2.6.0 rc4<a class="headerlink" href="#version-2-6-0-rc4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 19 Jul 2012)</em></p>
<p>Very few changes from rc4 to the final release, only bugfixes:</p>
<ul class="simple">
<li>integrated fixes from release 2.5.2 (fix general boot flag for KVM
instance, fix CDROM booting for KVM instances)</li>
<li>fixed node group modification of node parameters</li>
<li>fixed issue in LUClusterVerifyGroup with multi-group clusters</li>
<li>fixed generation of bash completion to ensure a stable ordering</li>
<li>fixed a few typos</li>
</ul>
</div>
<div class="section" id="version-2-6-0-rc3">
<h2>Version 2.6.0 rc3<a class="headerlink" href="#version-2-6-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 13 Jul 2012)</em></p>
<p>Third release candidate for 2.6. The following changes were done from
rc3 to rc4:</p>
<ul class="simple">
<li>Fixed <tt class="docutils literal"><span class="pre">UpgradeConfig</span></tt> w.r.t. to disk parameters on disk objects.</li>
<li>Fixed an inconsistency in the LUXI protocol with the provided
arguments (NOT backwards compatible)</li>
<li>Fixed a bug with node groups ipolicy where <tt class="docutils literal"><span class="pre">min</span></tt> was greater than
the cluster <tt class="docutils literal"><span class="pre">std</span></tt> value</li>
<li>Implemented a new <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-drbd</span></tt> call to list DRBD minors for
easier instance debugging on nodes (requires <tt class="docutils literal"><span class="pre">hconfd</span></tt> to work)</li>
</ul>
</div>
<div class="section" id="version-2-6-0-rc2">
<h2>Version 2.6.0 rc2<a class="headerlink" href="#version-2-6-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 03 Jul 2012)</em></p>
<p>Second release candidate for 2.6. The following changes were done from
rc2 to rc3:</p>
<ul class="simple">
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> regarding <tt class="docutils literal"><span class="pre">master-ip-script</span></tt> on non
master candidates</li>
<li>Fixed a RAPI regression on missing beparams/memory</li>
<li>Fixed redistribution of files on offline nodes</li>
<li>Added possibility to run activate-disks even though secondaries are
offline. With this change it relaxes also the strictness on some other
commands which use activate disks internally:
* <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">start|reboot|rename|backup|export</span></tt></li>
<li>Made it possible to remove safely an instance if its secondaries are
offline</li>
<li>Made it possible to reinstall even though secondaries are offline</li>
</ul>
</div>
<div class="section" id="version-2-6-0-rc1">
<h2>Version 2.6.0 rc1<a class="headerlink" href="#version-2-6-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 25 Jun 2012)</em></p>
<p>First release candidate for 2.6. The following changes were done from
rc1 to rc2:</p>
<ul class="simple">
<li>Fixed bugs with disk parameters and <tt class="docutils literal"><span class="pre">rbd</span></tt> templates as well as
<tt class="docutils literal"><span class="pre">instance_os_add</span></tt></li>
<li>Made <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt> more consistent regarding new NIC/Disk
behaviour. It supports now the modify operation</li>
<li><tt class="docutils literal"><span class="pre">hcheck</span></tt> implemented to analyze cluster health and possibility of
improving health by rebalance</li>
<li><tt class="docutils literal"><span class="pre">hbal</span></tt> has been improved in dealing with split instances</li>
</ul>
</div>
<div class="section" id="version-2-6-0-beta2">
<h2>Version 2.6.0 beta2<a class="headerlink" href="#version-2-6-0-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 11 Jun 2012)</em></p>
<p>Second beta release of 2.6. The following changes were done from beta2
to rc1:</p>
<ul class="simple">
<li>Fixed <tt class="docutils literal"><span class="pre">daemon-util</span></tt> with non-root user models</li>
<li>Fixed creation of plain instances with <tt class="docutils literal"><span class="pre">--no-wait-for-sync</span></tt></li>
<li>Fix wrong iv_names when running <tt class="docutils literal"><span class="pre">cfgupgrade</span></tt></li>
<li>Export more information in RAPI group queries</li>
<li>Fixed bug when changing instance network interfaces</li>
<li>Extended burnin to do NIC changes</li>
<li>query: Added <tt class="docutils literal"><span class="pre">&lt;</span></tt>, <tt class="docutils literal"><span class="pre">&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;=</span></tt>, <tt class="docutils literal"><span class="pre">&gt;=</span></tt> comparison operators</li>
<li>Changed default for DRBD barriers</li>
<li>Fixed DRBD error reporting for syncer rate</li>
<li>Verify the options on disk parameters</li>
</ul>
<p>And of course various fixes to documentation and improved unittests and
QA.</p>
</div>
<div class="section" id="version-2-6-0-beta1">
<h2>Version 2.6.0 beta1<a class="headerlink" href="#version-2-6-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 23 May 2012)</em></p>
<p>First beta release of 2.6. The following changes were done from beta1 to
beta2:</p>
<ul class="simple">
<li>integrated patch for distributions without <tt class="docutils literal"><span class="pre">start-stop-daemon</span></tt></li>
<li>adapted example init.d script to work on Fedora</li>
<li>fixed log handling in Haskell daemons</li>
<li>adapted checks in the watcher for pycurl linked against libnss</li>
<li>add partial support for <tt class="docutils literal"><span class="pre">xl</span></tt> instead of <tt class="docutils literal"><span class="pre">xm</span></tt> for Xen</li>
<li>fixed a type issue in cluster verification</li>
<li>fixed ssconf handling in the Haskell code (was breaking confd in IPv6
clusters)</li>
</ul>
<p>Plus integrated fixes from the 2.5 branch:</p>
<ul class="simple">
<li>fixed <tt class="docutils literal"><span class="pre">kvm-ifup</span></tt> to use <tt class="docutils literal"><span class="pre">/bin/bash</span></tt></li>
<li>fixed parallel build failures</li>
<li>KVM live migration when using a custom keymap</li>
</ul>
</div>
<div class="section" id="version-2-5-2">
<h2>Version 2.5.2<a class="headerlink" href="#version-2-5-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 24 Jul 2012)</em></p>
<p>A small bugfix release, with no new features:</p>
<ul class="simple">
<li>fixed bash-isms in kvm-ifup, for compatibility with systems which use a
different default shell (e.g. Debian, Ubuntu)</li>
<li>fixed KVM startup and live migration with a custom keymap (fixes Issue
243 and Debian bug #650664)</li>
<li>fixed compatibility with KVM versions that don&#8217;t support multiple boot
devices (fixes Issue 230 and Debian bug #624256)</li>
</ul>
<p>Additionally, a few fixes were done to the build system (fixed parallel
build failures) and to the unittests (fixed race condition in test for
FileID functions, and the default enable/disable mode for QA test is now
customisable).</p>
</div>
<div class="section" id="version-2-5-1">
<h2>Version 2.5.1<a class="headerlink" href="#version-2-5-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 11 May 2012)</em></p>
<p>A small bugfix release.</p>
<p>The main issues solved are on the topic of compatibility with newer LVM
releases:</p>
<ul class="simple">
<li>fixed parsing of <tt class="docutils literal"><span class="pre">lv_attr</span></tt> field</li>
<li>adapted to new <tt class="docutils literal"><span class="pre">vgreduce</span> <span class="pre">--removemissing</span></tt> behaviour where sometimes
the <tt class="docutils literal"><span class="pre">--force</span></tt> flag is needed</li>
</ul>
<p>Also on the topic of compatibility, <tt class="docutils literal"><span class="pre">tools/lvmstrap</span></tt> has been changed
to accept kernel 3.x too (was hardcoded to 2.6.*).</p>
<p>A regression present in 2.5.0 that broke handling (in the gnt-* scripts)
of hook results and that also made display of other errors suboptimal
was fixed; the code behaves now like 2.4 and earlier.</p>
<p>Another change in 2.5, the cleanup of the OS scripts environment, is too
aggressive: it removed even the <tt class="docutils literal"><span class="pre">PATH</span></tt> variable, which requires the OS
scripts to <em>always</em> need to export it. Since this is a bit too strict,
we now export a minimal PATH, the same that we export for hooks.</p>
<p>The fix for issue 201 (Preserve bridge MTU in KVM ifup script) was
integrated into this release.</p>
<p>Finally, a few other miscellaneous changes were done (no new features,
just small improvements):</p>
<ul class="simple">
<li>Fix <tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">--help</span></tt> display</li>
<li>Fix hardcoded Xen kernel path</li>
<li>Fix grow-disk handling of invalid units</li>
<li>Update synopsis for <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">repair-disk-sizes</span></tt></li>
<li>Accept both PUT and POST in noded (makes future upgrade to 2.6 easier)</li>
</ul>
</div>
<div class="section" id="version-2-5-0">
<h2>Version 2.5.0<a class="headerlink" href="#version-2-5-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 12 Apr 2012)</em></p>
<div class="section" id="incompatible-important-changes-and-bugfixes">
<h3>Incompatible/important changes and bugfixes<a class="headerlink" href="#incompatible-important-changes-and-bugfixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The default of the <tt class="docutils literal"><span class="pre">/2/instances/[instance_name]/rename</span></tt> RAPI
resource&#8217;s <tt class="docutils literal"><span class="pre">ip_check</span></tt> parameter changed from <tt class="docutils literal"><span class="pre">True</span></tt> to <tt class="docutils literal"><span class="pre">False</span></tt>
to match the underlying LUXI interface.</li>
<li>The <tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/evacuate</span></tt> RAPI resource was changed to use
body parameters, see <a class="reference internal" href="rapi.html"><em>RAPI documentation</em></a>. The server does
not maintain backwards-compatibility as the underlying operation
changed in an incompatible way. The RAPI client can talk to old
servers, but it needs to be told so as the return value changed.</li>
<li>When creating file-based instances via RAPI, the <tt class="docutils literal"><span class="pre">file_driver</span></tt>
parameter no longer defaults to <tt class="docutils literal"><span class="pre">loop</span></tt> and must be specified.</li>
<li>The deprecated <tt class="docutils literal"><span class="pre">bridge</span></tt> NIC parameter is no longer supported. Use
<tt class="docutils literal"><span class="pre">link</span></tt> instead.</li>
<li>Support for the undocumented and deprecated RAPI instance creation
request format version 0 has been dropped. Use version 1, supported
since Ganeti 2.1.3 and <a class="reference internal" href="rapi.html"><em>documented</em></a>, instead.</li>
<li>Pyparsing 1.4.6 or above is required, see <a class="reference internal" href="install.html"><em>installation
documentation</em></a>.</li>
<li>The &#8220;cluster-verify&#8221; hooks are now executed per group by the
<tt class="docutils literal"><span class="pre">OP_CLUSTER_VERIFY_GROUP</span></tt> opcode. This maintains the same behavior
if you just run <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt>, which generates one opcode per
group.</li>
<li>The environment as passed to the OS scripts is cleared, and thus no
environment variables defined in the node daemon&#8217;s environment will be
inherited by the scripts.</li>
<li>The <a class="reference internal" href="iallocator.html"><em>iallocator</em></a> mode <tt class="docutils literal"><span class="pre">multi-evacuate</span></tt> has been
deprecated.</li>
<li><a class="reference internal" href="design-multi-reloc.html"><em>New iallocator modes</em></a> have been added to
support operations involving multiple node groups.</li>
<li>Offline nodes are ignored when failing over an instance.</li>
<li>Support for KVM version 1.0, which changed the version reporting format
from 3 to 2 digits.</li>
<li>TCP/IP ports used by DRBD disks are returned to a pool upon instance
removal.</li>
<li><tt class="docutils literal"><span class="pre">Makefile</span></tt> is now compatible with Automake 1.11.2</li>
<li>Includes all bugfixes made in the 2.4 series</li>
</ul>
</div>
<div class="section" id="id51">
<h3>New features<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The ganeti-htools project has been merged into the ganeti-core source
tree and will be built as part of Ganeti (see <a class="reference internal" href="install-quick.html"><em>Ganeti quick installation guide</em></a>).</li>
<li>Implemented support for <a class="reference internal" href="design-shared-storage.html"><em>shared storage</em></a>.</li>
<li>Add support for disks larger than 2 TB in <tt class="docutils literal"><span class="pre">lvmstrap</span></tt> by supporting
GPT-style partition tables (requires <a class="reference external" href="http://www.gnu.org/s/parted/">parted</a>).</li>
<li>Added support for floppy drive and 2nd CD-ROM drive in KVM hypervisor.</li>
<li>Allowed adding tags on instance creation.</li>
<li>Export instance tags to hooks (<tt class="docutils literal"><span class="pre">INSTANCE_TAGS</span></tt>, see <a class="reference internal" href="hooks.html"><em>Ganeti customisation using hooks</em></a>)</li>
<li>Allow instances to be started in a paused state, enabling the user to
see the complete console output on boot using the console.</li>
<li>Added new hypervisor flag to control default reboot behaviour
(<tt class="docutils literal"><span class="pre">reboot_behavior</span></tt>).</li>
<li>Added support for KVM keymaps (hypervisor parameter <tt class="docutils literal"><span class="pre">keymap</span></tt>).</li>
<li>Improved out-of-band management support:<ul>
<li>Added <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">health</span></tt> command reporting the health status of
nodes.</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">power</span></tt> command to manage power status of nodes.</li>
<li>Added command for emergency power-off (EPO), <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">epo</span></tt>.</li>
</ul>
</li>
<li>Instance migration can fall back to failover if instance is not
running.</li>
<li>Filters can be used when listing nodes, instances, groups and locks;
see <a class="reference internal" href="man-ganeti.html"><em>ganeti(7)</em></a> manpage.</li>
<li>Added post-execution status as variables to <a class="reference internal" href="hooks.html"><em>hooks</em></a>
environment.</li>
<li>Instance tags are exported/imported together with the instance.</li>
<li>When given an explicit job ID, <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">info</span></tt> will work for archived
jobs.</li>
<li>Jobs can define dependencies on other jobs (not yet supported via
RAPI or command line, but used by internal commands and usable via
LUXI).<ul>
<li>Lock monitor (<tt class="docutils literal"><span class="pre">gnt-debug</span> <span class="pre">locks</span></tt>) shows jobs waiting for
dependencies.</li>
</ul>
</li>
<li>Instance failover is now available as a RAPI resource
(<tt class="docutils literal"><span class="pre">/2/instances/[instance_name]/failover</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">info</span></tt> defaults to static information if primary node
is offline.</li>
<li>Opcodes have a new <tt class="docutils literal"><span class="pre">comment</span></tt> attribute.</li>
<li>Added basic SPICE support to KVM hypervisor.</li>
<li><tt class="docutils literal"><span class="pre">tools/ganeti-listrunner</span></tt> allows passing of arguments to executable.</li>
</ul>
</div>
<div class="section" id="node-group-improvements">
<h3>Node group improvements<a class="headerlink" href="#node-group-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> has been modified to check groups separately,
thereby improving performance.</li>
<li>Node group support has been added to <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify-disks</span></tt>,
which now operates per node group.</li>
<li>Watcher has been changed to work better with node groups.<ul>
<li>One process and state file per node group.</li>
<li>Slow watcher in one group doesn&#8217;t block other group&#8217;s watcher.</li>
</ul>
</li>
<li>Added new command, <tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">evacuate</span></tt>, to move all instances in a
node group to other groups.</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">change-group</span></tt> to move an instance to another
node group.</li>
<li><tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">command</span></tt> and <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">copyfile</span></tt> now support
per-group operations.</li>
<li>Node groups can be tagged.</li>
<li>Some operations switch from an exclusive to a shared lock as soon as
possible.</li>
<li>Instance&#8217;s primary and secondary nodes&#8217; groups are now available as
query fields (<tt class="docutils literal"><span class="pre">pnode.group</span></tt>, <tt class="docutils literal"><span class="pre">pnode.group.uuid</span></tt>, <tt class="docutils literal"><span class="pre">snodes.group</span></tt>
and <tt class="docutils literal"><span class="pre">snodes.group.uuid</span></tt>).</li>
</ul>
</div>
<div class="section" id="misc">
<h3>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Numerous updates to documentation and manpages.<ul>
<li><a class="reference internal" href="rapi.html"><em>RAPI</em></a> documentation now has detailed parameter
descriptions.</li>
<li>Some opcode/job results are now also documented, see <a class="reference internal" href="rapi.html"><em>RAPI</em></a>.</li>
</ul>
</li>
<li>A lockset&#8217;s internal lock is now also visible in lock monitor.</li>
<li>Log messages from job queue workers now contain information about the
opcode they&#8217;re processing.</li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">console</span></tt> no longer requires the instance lock.</li>
<li>A short delay when waiting for job changes reduces the number of LUXI
requests significantly.</li>
<li>DRBD metadata volumes are overwritten with zeros during disk creation.</li>
<li>Out-of-band commands no longer acquire the cluster lock in exclusive
mode.</li>
<li><tt class="docutils literal"><span class="pre">devel/upload</span></tt> now uses correct permissions for directories.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-5-0-rc6">
<h2>Version 2.5.0 rc6<a class="headerlink" href="#version-2-5-0-rc6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 23 Mar 2012)</em></p>
<p>This was the sixth release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-rc5">
<h2>Version 2.5.0 rc5<a class="headerlink" href="#version-2-5-0-rc5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 9 Jan 2012)</em></p>
<p>This was the fifth release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-rc4">
<h2>Version 2.5.0 rc4<a class="headerlink" href="#version-2-5-0-rc4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 27 Oct 2011)</em></p>
<p>This was the fourth release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-rc3">
<h2>Version 2.5.0 rc3<a class="headerlink" href="#version-2-5-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 26 Oct 2011)</em></p>
<p>This was the third release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-rc2">
<h2>Version 2.5.0 rc2<a class="headerlink" href="#version-2-5-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 18 Oct 2011)</em></p>
<p>This was the second release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-rc1">
<h2>Version 2.5.0 rc1<a class="headerlink" href="#version-2-5-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 4 Oct 2011)</em></p>
<p>This was the first release candidate of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-beta3">
<h2>Version 2.5.0 beta3<a class="headerlink" href="#version-2-5-0-beta3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 31 Aug 2011)</em></p>
<p>This was the third beta release of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-beta2">
<h2>Version 2.5.0 beta2<a class="headerlink" href="#version-2-5-0-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 22 Aug 2011)</em></p>
<p>This was the second beta release of the 2.5 series.</p>
</div>
<div class="section" id="version-2-5-0-beta1">
<h2>Version 2.5.0 beta1<a class="headerlink" href="#version-2-5-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 12 Aug 2011)</em></p>
<p>This was the first beta release of the 2.5 series.</p>
</div>
<div class="section" id="version-2-4-5">
<h2>Version 2.4.5<a class="headerlink" href="#version-2-4-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 27 Oct 2011)</em></p>
<ul class="simple">
<li>Fixed bug when parsing command line parameter values ending in
backslash</li>
<li>Fixed assertion error after unclean master shutdown</li>
<li>Disable HTTP client pool for RPC, significantly reducing memory usage
of master daemon</li>
<li>Fixed queue archive creation with wrong permissions</li>
</ul>
</div>
<div class="section" id="version-2-4-4">
<h2>Version 2.4.4<a class="headerlink" href="#version-2-4-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 23 Aug 2011)</em></p>
<p>Small bug-fixes:</p>
<ul class="simple">
<li>Fixed documentation for importing with <tt class="docutils literal"><span class="pre">--src-dir</span></tt> option</li>
<li>Fixed a bug in <tt class="docutils literal"><span class="pre">ensure-dirs</span></tt> with queue/archive permissions</li>
<li>Fixed a parsing issue with DRBD 8.3.11 in the Linux kernel</li>
</ul>
</div>
<div class="section" id="version-2-4-3">
<h2>Version 2.4.3<a class="headerlink" href="#version-2-4-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 5 Aug 2011)</em></p>
<p>Many bug-fixes and a few small features:</p>
<ul class="simple">
<li>Fixed argument order in <tt class="docutils literal"><span class="pre">ReserveLV</span></tt> and <tt class="docutils literal"><span class="pre">ReserveMAC</span></tt> which caused
issues when you tried to add an instance with two MAC addresses in one
request</li>
<li>KVM: fixed per-instance stored UID value</li>
<li>KVM: configure bridged NICs at migration start</li>
<li>KVM: Fix a bug where instance will not start with never KVM versions
(&gt;= 0.14)</li>
<li>Added OS search path to <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">info</span></tt></li>
<li>Fixed an issue with <tt class="docutils literal"><span class="pre">file_storage_dir</span></tt> where you were forced to
provide an absolute path, but the documentation states it is a
relative path, the documentation was right</li>
<li>Added a new parameter to instance stop/start called <tt class="docutils literal"><span class="pre">--no-remember</span></tt>
that will make the state change to not be remembered</li>
<li>Implemented <tt class="docutils literal"><span class="pre">no_remember</span></tt> at RAPI level</li>
<li>Improved the documentation</li>
<li>Node evacuation: don&#8217;t call IAllocator if node is already empty</li>
<li>Fixed bug in DRBD8 replace disks on current nodes</li>
<li>Fixed bug in recreate-disks for DRBD instances</li>
<li>Moved assertion checking locks in <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">replace-disks</span></tt>
causing it to abort with not owning the right locks for some situation</li>
<li>Job queue: Fixed potential race condition when cancelling queued jobs</li>
<li>Fixed off-by-one bug in job serial generation</li>
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">volumes</span></tt>: Fix instance names</li>
<li>Fixed aliases in bash completion</li>
<li>Fixed a bug in reopening log files after being sent a SIGHUP</li>
<li>Added a flag to burnin to allow specifying VCPU count</li>
<li>Bugfixes to non-root Ganeti configuration</li>
</ul>
</div>
<div class="section" id="version-2-4-2">
<h2>Version 2.4.2<a class="headerlink" href="#version-2-4-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 12 May 2011)</em></p>
<p>Many bug-fixes and a few new small features:</p>
<ul class="simple">
<li>Fixed a bug related to log opening failures</li>
<li>Fixed a bug in instance listing with orphan instances</li>
<li>Fixed a bug which prevented resetting the cluster-level node parameter
<tt class="docutils literal"><span class="pre">oob_program</span></tt> to the default</li>
<li>Many fixes related to the <tt class="docutils literal"><span class="pre">cluster-merge</span></tt> tool</li>
<li>Fixed a race condition in the lock monitor, which caused failures
during (at least) creation of many instances in parallel</li>
<li>Improved output for gnt-job info</li>
<li>Removed the quiet flag on some ssh calls which prevented debugging
failures</li>
<li>Improved the N+1 failure messages in cluster verify by actually
showing the memory values (needed and available)</li>
<li>Increased lock attempt timeouts so that when executing long operations
(e.g. DRBD replace-disks) other jobs do not enter &#8216;blocking acquire&#8217;
too early and thus prevent the use of the &#8216;fair&#8217; mechanism</li>
<li>Changed instance query data (<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">info</span></tt>) to not acquire
locks unless needed, thus allowing its use on locked instance if only
static information is asked for</li>
<li>Improved behaviour with filesystems that do not support rename on an
opened file</li>
<li>Fixed the behaviour of <tt class="docutils literal"><span class="pre">prealloc_wipe_disks</span></tt> cluster parameter which
kept locks on all nodes during the wipe, which is unneeded</li>
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-watcher</span></tt> handling of errors during hooks execution</li>
<li>Fixed bug in <tt class="docutils literal"><span class="pre">prealloc_wipe_disks</span></tt> with small disk sizes (less than
10GiB) which caused the wipe to fail right at the end in some cases</li>
<li>Fixed master IP activation when doing master failover with no-voting</li>
<li>Fixed bug in <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">add</span> <span class="pre">--readd</span></tt> which allowed the re-adding of
the master node itself</li>
<li>Fixed potential data-loss in under disk full conditions, where Ganeti
wouldn&#8217;t check correctly the return code and would consider
partially-written files &#8216;correct&#8217;</li>
<li>Fixed bug related to multiple VGs and DRBD disk replacing</li>
<li>Added new disk parameter <tt class="docutils literal"><span class="pre">metavg</span></tt> that allows placement of the meta
device for DRBD in a different volume group</li>
<li>Fixed error handling in the node daemon when the system libc doesn&#8217;t
have major number 6 (i.e. if <tt class="docutils literal"><span class="pre">libc.so.6</span></tt> is not the actual libc)</li>
<li>Fixed lock release during replace-disks, which kept cluster-wide locks
when doing disk replaces with an iallocator script</li>
<li>Added check for missing bridges in cluster verify</li>
<li>Handle EPIPE errors while writing to the terminal better, so that
piping the output to e.g. <tt class="docutils literal"><span class="pre">less</span></tt> doesn&#8217;t cause a backtrace</li>
<li>Fixed rare case where a ^C during Luxi calls could have been
interpreted as server errors, instead of simply terminating</li>
<li>Fixed a race condition in LUGroupAssignNodes (<tt class="docutils literal"><span class="pre">gnt-group</span>
<span class="pre">assign-nodes</span></tt>)</li>
<li>Added a few more parameters to the KVM hypervisor, allowing a second
CDROM, custom disk type for CDROMs and a floppy image</li>
<li>Removed redundant message in instance rename when the name is given
already as a FQDN</li>
<li>Added option to <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">recreate-disks</span></tt> to allow creating the
disks on new nodes, allowing recreation when the original instance
nodes are completely gone</li>
<li>Added option when converting disk templates to DRBD to skip waiting
for the resync, in order to make the instance available sooner</li>
<li>Added two new variables to the OS scripts environment (containing the
instance&#8217;s nodes)</li>
<li>Made the root_path and optional parameter for the xen-pvm hypervisor,
to allow use of <tt class="docutils literal"><span class="pre">pvgrub</span></tt> as bootloader</li>
<li>Changed the instance memory modifications to only check out-of-memory
conditions on memory increases, and turned the secondary node warnings
into errors (they can still be overridden via <tt class="docutils literal"><span class="pre">--force</span></tt>)</li>
<li>Fixed the handling of a corner case when the Python installation gets
corrupted (e.g. a bad disk) while ganeti-noded is running and we try
to execute a command that doesn&#8217;t exist</li>
<li>Fixed a bug in <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">move</span></tt> (LUInstanceMove) when the primary
node of the instance returned failures during instance shutdown; this
adds the option <tt class="docutils literal"><span class="pre">--ignore-consistency</span></tt> to gnt-instance move</li>
</ul>
<p>And as usual, various improvements to the error messages, documentation
and man pages.</p>
</div>
<div class="section" id="version-2-4-1">
<h2>Version 2.4.1<a class="headerlink" href="#version-2-4-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 09 Mar 2011)</em></p>
<p>Emergency bug-fix release. <tt class="docutils literal"><span class="pre">tools/cfgupgrade</span></tt> was broken and overwrote
the RAPI users file if run twice (even with <tt class="docutils literal"><span class="pre">--dry-run</span></tt>).</p>
<p>The release fixes that bug (nothing else changed).</p>
</div>
<div class="section" id="version-2-4-0">
<h2>Version 2.4.0<a class="headerlink" href="#version-2-4-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 07 Mar 2011)</em></p>
<p>Final 2.4.0 release. Just a few small fixes:</p>
<ul class="simple">
<li>Fixed RAPI node evacuate</li>
<li>Fixed the kvm-ifup script</li>
<li>Fixed internal error handling for special job cases</li>
<li>Updated man page to specify the escaping feature for options</li>
</ul>
</div>
<div class="section" id="version-2-4-0-rc3">
<h2>Version 2.4.0 rc3<a class="headerlink" href="#version-2-4-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 28 Feb 2011)</em></p>
<p>A critical fix for the <tt class="docutils literal"><span class="pre">prealloc_wipe_disks</span></tt> feature: it is possible
that this feature wiped the disks of the wrong instance, leading to loss
of data.</p>
<p>Other changes:</p>
<ul class="simple">
<li>Fixed title of query field containing instance name</li>
<li>Expanded the glossary in the documentation</li>
<li>Fixed one unittest (internal issue)</li>
</ul>
</div>
<div class="section" id="version-2-4-0-rc2">
<h2>Version 2.4.0 rc2<a class="headerlink" href="#version-2-4-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 21 Feb 2011)</em></p>
<p>A number of bug fixes plus just a couple functionality changes.</p>
<p>On the user-visible side, the <tt class="docutils literal"><span class="pre">gnt-*</span> <span class="pre">list</span></tt> command output has changed
with respect to &#8220;special&#8221; field states. The current rc1 style of display
can be re-enabled by passing a new <tt class="docutils literal"><span class="pre">--verbose</span></tt> (<tt class="docutils literal"><span class="pre">-v</span></tt>) flag, but in
the default output mode special fields states are displayed as follows:</p>
<ul class="simple">
<li>Offline resource: <tt class="docutils literal"><span class="pre">*</span></tt></li>
<li>Unavailable/not applicable: <tt class="docutils literal"><span class="pre">-</span></tt></li>
<li>Data missing (RPC failure): <tt class="docutils literal"><span class="pre">?</span></tt></li>
<li>Unknown field: <tt class="docutils literal"><span class="pre">??</span></tt></li>
</ul>
<p>Another user-visible change is the addition of <tt class="docutils literal"><span class="pre">--force-join</span></tt> to
<tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">add</span></tt>.</p>
<p>As for bug fixes:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">tools/cluster-merge</span></tt> has seen many fixes and is now enabled again</li>
<li>Fixed regression in RAPI/instance reinstall where all parameters were
required (instead of optional)</li>
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">repair-disk-sizes</span></tt>, was broken since Ganeti 2.2</li>
<li>Fixed iallocator usage (offline nodes were not considered offline)</li>
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt> with respect to non-vm_capable nodes</li>
<li>Fixed hypervisor and OS parameter validation with respect to
non-vm_capable nodes</li>
<li>Fixed <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> with respect to offline nodes (mostly
cosmetic)</li>
<li>Fixed <tt class="docutils literal"><span class="pre">tools/listrunner</span></tt> with respect to agent-based usage</li>
</ul>
</div>
<div class="section" id="version-2-4-0-rc1">
<h2>Version 2.4.0 rc1<a class="headerlink" href="#version-2-4-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri,  4 Feb 2011)</em></p>
<p>Many changes and fixes since the beta1 release. While there were some
internal changes, the code has been mostly stabilised for the RC
release.</p>
<p>Note: the dumb allocator was removed in this release, as it was not kept
up-to-date with the IAllocator protocol changes. It is recommended to
use the <tt class="docutils literal"><span class="pre">hail</span></tt> command from the ganeti-htools package.</p>
<p>Note: the 2.4 and up versions of Ganeti are not compatible with the
0.2.x branch of ganeti-htools. You need to upgrade to
ganeti-htools-0.3.0 (or later).</p>
<div class="section" id="regressions-fixed-from-2-3">
<h3>Regressions fixed from 2.3<a class="headerlink" href="#regressions-fixed-from-2-3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed the <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify-disks</span></tt> command</li>
<li>Made <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify-disks</span></tt> work in parallel (as opposed to
serially on nodes)</li>
<li>Fixed disk adoption breakage</li>
<li>Fixed wrong headers in instance listing for field aliases</li>
</ul>
</div>
<div class="section" id="other-bugs-fixed">
<h3>Other bugs fixed<a class="headerlink" href="#other-bugs-fixed" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed corner case in KVM handling of NICs</li>
<li>Fixed many cases of wrong handling of non-vm_capable nodes</li>
<li>Fixed a bug where a missing instance symlink was not possible to
recreate with any <tt class="docutils literal"><span class="pre">gnt-*</span></tt> command (now <tt class="docutils literal"><span class="pre">gnt-instance</span>
<span class="pre">activate-disks</span></tt> does it)</li>
<li>Fixed the volume group name as reported by <tt class="docutils literal"><span class="pre">gnt-cluster</span>
<span class="pre">verify-disks</span></tt></li>
<li>Increased timeouts for the import-export code, hopefully leading to
fewer aborts due network or instance timeouts</li>
<li>Fixed bug in <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-storage</span></tt></li>
<li>Fixed bug where not all daemons were started on cluster
initialisation, but only at the first watcher run</li>
<li>Fixed many bugs in the OOB implementation</li>
<li>Fixed watcher behaviour in presence of instances with offline
secondaries</li>
<li>Fixed instance list output for instances running on the wrong node</li>
<li>a few fixes to the cluster-merge tool, but it still cannot merge
multi-node groups (currently it is not recommended to use this tool)</li>
</ul>
</div>
<div class="section" id="improvements">
<h3>Improvements<a class="headerlink" href="#improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Improved network configuration for the KVM hypervisor</li>
<li>Added e1000 as a supported NIC for Xen-HVM</li>
<li>Improved the lvmstrap tool to also be able to use partitions, as
opposed to full disks</li>
<li>Improved speed of disk wiping (the cluster parameter
<tt class="docutils literal"><span class="pre">prealloc_wipe_disks</span></tt>, so that it has a low impact on the total time
of instance creations</li>
<li>Added documentation for the OS parameters</li>
<li>Changed <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">deactivate-disks</span></tt> so that it can work if the
hypervisor is not responding</li>
<li>Added display of blacklisted and hidden OS information in
<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">info</span></tt></li>
<li>Extended <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> to also validate hypervisor, backend,
NIC and node parameters, which might create problems with currently
invalid (but undetected) configuration files, but prevents validation
failures when unrelated parameters are modified</li>
<li>Changed cluster initialisation to wait for the master daemon to become
available</li>
<li>Expanded the RAPI interface:<ul>
<li>Added config redistribution resource</li>
<li>Added activation/deactivation of instance disks</li>
<li>Added export of console information</li>
</ul>
</li>
<li>Implemented log file reopening on SIGHUP, which allows using
logrotate(8) for the Ganeti log files</li>
<li>Added a basic OOB helper script as an example</li>
</ul>
</div>
</div>
<div class="section" id="version-2-4-0-beta1">
<h2>Version 2.4.0 beta1<a class="headerlink" href="#version-2-4-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 14 Jan 2011)</em></p>
<div class="section" id="user-visible">
<h3>User-visible<a class="headerlink" href="#user-visible" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed timezone issues when formatting timestamps</li>
<li>Added support for node groups, available via <tt class="docutils literal"><span class="pre">gnt-group</span></tt> and other
commands</li>
<li>Added out-of-band framework and management, see <a class="reference internal" href="design-oob.html"><em>design
document</em></a></li>
<li>Removed support for roman numbers from <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt> and
<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list</span></tt>.</li>
<li>Allowed modification of master network interface via <tt class="docutils literal"><span class="pre">gnt-cluster</span>
<span class="pre">modify</span> <span class="pre">--master-netdev</span></tt></li>
<li>Accept offline secondaries while shutting down instance disks</li>
<li>Added <tt class="docutils literal"><span class="pre">blockdev_prefix</span></tt> parameter to Xen PVM and HVM hypervisors</li>
<li>Added support for multiple LVM volume groups</li>
<li>Avoid sorting nodes for <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt> if specific nodes are
requested</li>
<li>Added commands to list available fields:<ul>
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-fields</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">list-fields</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list-fields</span></tt></li>
</ul>
</li>
<li>Updated documentation and man pages</li>
</ul>
</div>
<div class="section" id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Moved <tt class="docutils literal"><span class="pre">rapi_users</span></tt> file into separate directory, now named
<tt class="docutils literal"><span class="pre">.../ganeti/rapi/users</span></tt>, <tt class="docutils literal"><span class="pre">cfgupgrade</span></tt> moves the file and creates a
symlink</li>
<li>Added new tool for running commands on many machines,
<tt class="docutils literal"><span class="pre">tools/ganeti-listrunner</span></tt></li>
<li>Implemented more verbose result in <tt class="docutils literal"><span class="pre">OpInstanceConsole</span></tt> opcode, also
improving the <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">console</span></tt> output</li>
<li>Allowed customisation of disk index separator at <tt class="docutils literal"><span class="pre">configure</span></tt> time</li>
<li>Export node group allocation policy to <a class="reference internal" href="iallocator.html"><em>iallocator</em></a></li>
<li>Added support for non-partitioned md disks in <tt class="docutils literal"><span class="pre">lvmstrap</span></tt></li>
<li>Added script to gracefully power off KVM instances</li>
<li>Split <tt class="docutils literal"><span class="pre">utils</span></tt> module into smaller parts</li>
<li>Changed query operations to return more detailed information, e.g.
whether an information is unavailable due to an offline node. To use
this new functionality, the LUXI call <tt class="docutils literal"><span class="pre">Query</span></tt> must be used. Field
information is now stored by the master daemon and can be retrieved
using <tt class="docutils literal"><span class="pre">QueryFields</span></tt>. Instances, nodes and groups can also be queried
using the new opcodes <tt class="docutils literal"><span class="pre">OpQuery</span></tt> and <tt class="docutils literal"><span class="pre">OpQueryFields</span></tt> (not yet
exposed via RAPI). The following commands make use of this
infrastructure change:<ul>
<li><tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">list</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-group</span> <span class="pre">list-fields</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list-fields</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list-fields</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-debug</span> <span class="pre">locks</span></tt></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="remote-api">
<h3>Remote API<a class="headerlink" href="#remote-api" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>New RAPI resources (see <a class="reference internal" href="rapi.html"><em>Ganeti remote API</em></a>):<ul>
<li><tt class="docutils literal"><span class="pre">/2/modify</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/groups</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/groups/[group_name]</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/groups/[group_name]/assign-nodes</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/groups/[group_name]/modify</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/groups/[group_name]/rename</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/instances/[instance_name]/disk/[disk_index]/grow</span></tt></li>
</ul>
</li>
<li>RAPI changes:<ul>
<li>Implemented <tt class="docutils literal"><span class="pre">no_install</span></tt> for instance creation</li>
<li>Implemented OS parameters for instance reinstallation, allowing
use of special settings on reinstallation (e.g. for preserving data)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id52">
<h3>Misc<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Added IPv6 support in import/export</li>
<li>Pause DRBD synchronization while wiping disks on instance creation</li>
<li>Updated unittests and QA scripts</li>
<li>Improved network parameters passed to KVM</li>
<li>Converted man pages from docbook to reStructuredText</li>
</ul>
</div>
</div>
<div class="section" id="version-2-3-1">
<h2>Version 2.3.1<a class="headerlink" href="#version-2-3-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 20 Dec 2010)</em></p>
<p>Released version 2.3.1~rc1 without any changes.</p>
</div>
<div class="section" id="version-2-3-1-rc1">
<h2>Version 2.3.1 rc1<a class="headerlink" href="#version-2-3-1-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 1 Dec 2010)</em></p>
<ul class="simple">
<li>impexpd: Disable OpenSSL compression in socat if possible (backport
from master, commit e90739d625b, see <a class="reference internal" href="install-quick.html"><em>installation guide</em></a> for details)</li>
<li>Changed unittest coverage report to exclude test scripts</li>
<li>Added script to check version format</li>
</ul>
</div>
<div class="section" id="version-2-3-0">
<h2>Version 2.3.0<a class="headerlink" href="#version-2-3-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 1 Dec 2010)</em></p>
<p>Released version 2.3.0~rc1 without any changes.</p>
</div>
<div class="section" id="version-2-3-0-rc1">
<h2>Version 2.3.0 rc1<a class="headerlink" href="#version-2-3-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 19 Nov 2010)</em></p>
<p>A number of bugfixes and documentation updates:</p>
<ul class="simple">
<li>Update ganeti-os-interface documentation</li>
<li>Fixed a bug related to duplicate MACs or similar items which should be
unique</li>
<li>Fix breakage in OS state modify</li>
<li>Reinstall instance: disallow offline secondaries (fixes bug related to
OS changing but reinstall failing)</li>
<li>plus all the other fixes between 2.2.1 and 2.2.2</li>
</ul>
</div>
<div class="section" id="version-2-3-0-rc0">
<h2>Version 2.3.0 rc0<a class="headerlink" href="#version-2-3-0-rc0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 2 Nov 2010)</em></p>
<ul class="simple">
<li>Fixed clearing of the default iallocator using <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">modify</span></tt></li>
<li>Fixed master failover race with watcher</li>
<li>Fixed a bug in <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">modify</span></tt> which could lead to an inconsistent
configuration</li>
<li>Accept previously stopped instance for export with instance removal</li>
<li>Simplify and extend the environment variables for instance OS scripts</li>
<li>Added new node flags, <tt class="docutils literal"><span class="pre">master_capable</span></tt> and <tt class="docutils literal"><span class="pre">vm_capable</span></tt></li>
<li>Added optional instance disk wiping prior during allocation. This is a
cluster-wide option and can be set/modified using
<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">{init,modify}</span> <span class="pre">--prealloc-wipe-disks</span></tt>.</li>
<li>Added IPv6 support, see <a class="reference internal" href="design-2.3.html"><em>design document</em></a> and
<a class="reference internal" href="install-quick.html"><em>Ganeti quick installation guide</em></a></li>
<li>Added a new watcher option (<tt class="docutils literal"><span class="pre">--ignore-pause</span></tt>)</li>
<li>Added option to ignore offline node on instance start/stop
(<tt class="docutils literal"><span class="pre">--ignore-offline</span></tt>)</li>
<li>Allow overriding OS parameters with <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">reinstall</span></tt></li>
<li>Added ability to change node&#8217;s secondary IP address using <tt class="docutils literal"><span class="pre">gnt-node</span>
<span class="pre">modify</span></tt></li>
<li>Implemented privilege separation for all daemons except
<tt class="docutils literal"><span class="pre">ganeti-noded</span></tt>, see <tt class="docutils literal"><span class="pre">configure</span></tt> options</li>
<li>Complain if an instance&#8217;s disk is marked faulty in <tt class="docutils literal"><span class="pre">gnt-cluster</span>
<span class="pre">verify</span></tt></li>
<li>Implemented job priorities (see <tt class="docutils literal"><span class="pre">ganeti(7)</span></tt> manpage)</li>
<li>Ignore failures while shutting down instances during failover from
offline node</li>
<li>Exit daemon&#8217;s bootstrap process only once daemon is ready</li>
<li>Export more information via <tt class="docutils literal"><span class="pre">LUInstanceQuery</span></tt>/remote API</li>
<li>Improved documentation, QA and unittests</li>
<li>RAPI daemon now watches <tt class="docutils literal"><span class="pre">rapi_users</span></tt> all the time and doesn&#8217;t need a
restart if the file was created or changed</li>
<li>Added LUXI protocol version sent with each request and response,
allowing detection of server/client mismatches</li>
<li>Moved the Python scripts among gnt-* and ganeti-* into modules</li>
<li>Moved all code related to setting up SSH to an external script,
<tt class="docutils literal"><span class="pre">setup-ssh</span></tt></li>
<li>Infrastructure changes for node group support in future versions</li>
</ul>
</div>
<div class="section" id="version-2-2-2">
<h2>Version 2.2.2<a class="headerlink" href="#version-2-2-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 19 Nov 2010)</em></p>
<p>A few small bugs fixed, and some improvements to the build system:</p>
<ul class="simple">
<li>Fix documentation regarding conversion to drbd</li>
<li>Fix validation of parameters in cluster modify (<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">modify</span>
<span class="pre">-B</span></tt>)</li>
<li>Fix error handling in node modify with multiple changes</li>
<li>Allow remote imports without checked names</li>
</ul>
</div>
<div class="section" id="version-2-2-1">
<h2>Version 2.2.1<a class="headerlink" href="#version-2-2-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 19 Oct 2010)</em></p>
<ul class="simple">
<li>Disable SSL session ID cache in RPC client</li>
</ul>
</div>
<div class="section" id="version-2-2-1-rc1">
<h2>Version 2.2.1 rc1<a class="headerlink" href="#version-2-2-1-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 14 Oct 2010)</em></p>
<ul class="simple">
<li>Fix interaction between Curl/GnuTLS and the Python&#8217;s HTTP server
(thanks Apollon Oikonomopoulos!), finally allowing the use of Curl
with GnuTLS</li>
<li>Fix problems with interaction between Curl and Python&#8217;s HTTP server,
resulting in increased speed in many RPC calls</li>
<li>Improve our release script to prevent breakage with older aclocal and
Python 2.6</li>
</ul>
</div>
<div class="section" id="version-2-2-1-rc0">
<h2>Version 2.2.1 rc0<a class="headerlink" href="#version-2-2-1-rc0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 7 Oct 2010)</em></p>
<ul class="simple">
<li>Fixed issue 125, replace hardcoded &#8220;xenvg&#8221; in <tt class="docutils literal"><span class="pre">gnt-cluster</span></tt> with
value retrieved from master</li>
<li>Added support for blacklisted or hidden OS definitions</li>
<li>Added simple lock monitor (accessible via (<tt class="docutils literal"><span class="pre">gnt-debug</span> <span class="pre">locks</span></tt>)</li>
<li>Added support for -mem-path in KVM hypervisor abstraction layer</li>
<li>Allow overriding instance parameters in tool for inter-cluster
instance moves (<tt class="docutils literal"><span class="pre">tools/move-instance</span></tt>)</li>
<li>Improved opcode summaries (e.g. in <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">list</span></tt>)</li>
<li>Improve consistency of OS listing by sorting it</li>
<li>Documentation updates</li>
</ul>
</div>
<div class="section" id="version-2-2-0-1">
<h2>Version 2.2.0.1<a class="headerlink" href="#version-2-2-0-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 8 Oct 2010)</em></p>
<ul class="simple">
<li>Rebuild with a newer autotools version, to fix python 2.6 compatibility</li>
</ul>
</div>
<div class="section" id="version-2-2-0">
<h2>Version 2.2.0<a class="headerlink" href="#version-2-2-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 4 Oct 2010)</em></p>
<ul class="simple">
<li>Fixed regression in <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">rename</span></tt></li>
</ul>
</div>
<div class="section" id="version-2-2-0-rc2">
<h2>Version 2.2.0 rc2<a class="headerlink" href="#version-2-2-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 22 Sep 2010)</em></p>
<ul class="simple">
<li>Fixed OS_VARIANT variable for OS scripts</li>
<li>Fixed cluster tag operations via RAPI</li>
<li>Made <tt class="docutils literal"><span class="pre">setup-ssh</span></tt> exit with non-zero code if an error occurred</li>
<li>Disabled RAPI CA checks in watcher</li>
</ul>
</div>
<div class="section" id="version-2-2-0-rc1">
<h2>Version 2.2.0 rc1<a class="headerlink" href="#version-2-2-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 23 Aug 2010)</em></p>
<ul class="simple">
<li>Support DRBD versions of the format &#8220;a.b.c.d&#8221;</li>
<li>Updated manpages</li>
<li>Re-introduce support for usage from multiple threads in RAPI client</li>
<li>Instance renames and modify via RAPI</li>
<li>Work around race condition between processing and archival in job
queue</li>
<li>Mark opcodes following failed one as failed, too</li>
<li>Job field <tt class="docutils literal"><span class="pre">lock_status</span></tt> was removed due to difficulties making it
work with the changed job queue in Ganeti 2.2; a better way to monitor
locks is expected for a later 2.2.x release</li>
<li>Fixed dry-run behaviour with many commands</li>
<li>Support <tt class="docutils literal"><span class="pre">ssh-agent</span></tt> again when adding nodes</li>
<li>Many additional bugfixes</li>
</ul>
</div>
<div class="section" id="version-2-2-0-rc0">
<h2>Version 2.2.0 rc0<a class="headerlink" href="#version-2-2-0-rc0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 30 Jul 2010)</em></p>
<p>Important change: the internal RPC mechanism between Ganeti nodes has
changed from using a home-grown http library (based on the Python base
libraries) to use the PycURL library. This requires that PycURL is
installed on nodes. Please note that on Debian/Ubuntu, PycURL is linked
against GnuTLS by default. cURL&#8217;s support for GnuTLS had known issues
before cURL 7.21.0 and we recommend using the latest cURL release or
linking against OpenSSL. Most other distributions already link PycURL
and cURL against OpenSSL. The command:</p>
<div class="highlight-python"><pre>python -c 'import pycurl; print pycurl.version'</pre>
</div>
<p>can be used to determine the libraries PycURL and cURL are linked
against.</p>
<p>Other significant changes:</p>
<ul class="simple">
<li>Rewrote much of the internals of the job queue, in order to achieve
better parallelism; this decouples job query operations from the job
processing, and it should allow much nicer behaviour of the master
daemon under load, and it also has uncovered some long-standing bugs
related to the job serialisation (now fixed)</li>
<li>Added a default iallocator setting to the cluster parameters,
eliminating the need to always pass nodes or an iallocator for
operations that require selection of new node(s)</li>
<li>Added experimental support for the LXC virtualization method</li>
<li>Added support for OS parameters, which allows the installation of
instances to pass parameter to OS scripts in order to customise the
instance</li>
<li>Added a hypervisor parameter controlling the migration type (live or
non-live), since hypervisors have various levels of reliability; this
has renamed the &#8216;live&#8217; parameter to &#8216;mode&#8217;</li>
<li>Added a cluster parameter <tt class="docutils literal"><span class="pre">reserved_lvs</span></tt> that denotes reserved
logical volumes, meaning that cluster verify will ignore them and not
flag their presence as errors</li>
<li>The watcher will now reset the error count for failed instances after
8 hours, thus allowing self-healing if the problem that caused the
instances to be down/fail to start has cleared in the meantime</li>
<li>Added a cluster parameter <tt class="docutils literal"><span class="pre">drbd_usermode_helper</span></tt> that makes Ganeti
check for, and warn, if the drbd module parameter <tt class="docutils literal"><span class="pre">usermode_helper</span></tt>
is not consistent with the cluster-wide setting; this is needed to
make diagnose easier of failed drbd creations</li>
<li>Started adding base IPv6 support, but this is not yet
enabled/available for use</li>
<li>Rename operations (cluster, instance) will now return the new name,
which is especially useful if a short name was passed in</li>
<li>Added support for instance migration in RAPI</li>
<li>Added a tool to pre-configure nodes for the SSH setup, before joining
them to the cluster; this will allow in the future a simplified model
for node joining (but not yet fully enabled in 2.2); this needs the
paramiko python library</li>
<li>Fixed handling of name-resolving errors</li>
<li>Fixed consistency of job results on the error path</li>
<li>Fixed master-failover race condition when executed multiple times in
sequence</li>
<li>Fixed many bugs related to the job queue (mostly introduced during the
2.2 development cycle, so not all are impacting 2.1)</li>
<li>Fixed instance migration with missing disk symlinks</li>
<li>Fixed handling of unknown jobs in <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">archive</span></tt></li>
<li>And many other small fixes/improvements</li>
</ul>
<p>Internal changes:</p>
<ul class="simple">
<li>Enhanced both the unittest and the QA coverage</li>
<li>Switched the opcode validation to a generic model, and extended the
validation to all opcode parameters</li>
<li>Changed more parts of the code that write shell scripts to use the
same class for this</li>
<li>Switched the master daemon to use the asyncore library for the Luxi
server endpoint</li>
</ul>
</div>
<div class="section" id="version-2-2-0-beta0">
<h2>Version 2.2.0 beta0<a class="headerlink" href="#version-2-2-0-beta0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 17 Jun 2010)</em></p>
<ul class="simple">
<li>Added tool (<tt class="docutils literal"><span class="pre">move-instance</span></tt>) and infrastructure to move instances
between separate clusters (see <a class="reference internal" href="move-instance.html"><em>separate documentation</em></a> and <a class="reference internal" href="design-2.2.html"><em>design document</em></a>)</li>
<li>Added per-request RPC timeout</li>
<li>RAPI now requires a Content-Type header for requests with a body (e.g.
<tt class="docutils literal"><span class="pre">PUT</span></tt> or <tt class="docutils literal"><span class="pre">POST</span></tt>) which must be set to <tt class="docutils literal"><span class="pre">application/json</span></tt> (see
<span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2616.html"><strong>RFC 2616</strong></a> (HTTP/1.1), section 7.2.1)</li>
<li><tt class="docutils literal"><span class="pre">ganeti-watcher</span></tt> attempts to restart <tt class="docutils literal"><span class="pre">ganeti-rapi</span></tt> if RAPI is not
reachable</li>
<li>Implemented initial support for running Ganeti daemons as separate
users, see configure-time flags <tt class="docutils literal"><span class="pre">--with-user-prefix</span></tt> and
<tt class="docutils literal"><span class="pre">--with-group-prefix</span></tt> (only <tt class="docutils literal"><span class="pre">ganeti-rapi</span></tt> is supported at this
time)</li>
<li>Instances can be removed after export (<tt class="docutils literal"><span class="pre">gnt-backup</span> <span class="pre">export</span>
<span class="pre">--remove-instance</span></tt>)</li>
<li>Self-signed certificates generated by Ganeti now use a 2048 bit RSA
key (instead of 1024 bit)</li>
<li>Added new cluster configuration file for cluster domain secret</li>
<li>Import/export now use SSL instead of SSH</li>
<li>Added support for showing estimated time when exporting an instance,
see the <tt class="docutils literal"><span class="pre">ganeti-os-interface(7)</span></tt> manpage and look for
<tt class="docutils literal"><span class="pre">EXP_SIZE_FD</span></tt></li>
</ul>
</div>
<div class="section" id="version-2-1-8">
<h2>Version 2.1.8<a class="headerlink" href="#version-2-1-8" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 16 Nov 2010)</em></p>
<p>Some more bugfixes. Unless critical bugs occur, this will be the last
2.1 release:</p>
<ul class="simple">
<li>Fix case of MAC special-values</li>
<li>Fix mac checker regex</li>
<li>backend: Fix typo causing &#8220;out of range&#8221; error</li>
<li>Add missing &#8211;units in gnt-instance list man page</li>
</ul>
</div>
<div class="section" id="version-2-1-7">
<h2>Version 2.1.7<a class="headerlink" href="#version-2-1-7" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 24 Aug 2010)</em></p>
<dl class="docutils">
<dt>Bugfixes only:</dt>
<dd><ul class="first last simple">
<li>Don&#8217;t ignore secondary node silently on non-mirrored disk templates
(issue 113)</li>
<li>Fix &#8211;master-netdev arg name in gnt-cluster(8) (issue 114)</li>
<li>Fix usb_mouse parameter breaking with vnc_console (issue 109)</li>
<li>Properly document the usb_mouse parameter</li>
<li>Fix path in ganeti-rapi(8) (issue 116)</li>
<li>Adjust error message when the ganeti user&#8217;s .ssh directory is
missing</li>
<li>Add same-node-check when changing the disk template to drbd</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="version-2-1-6">
<h2>Version 2.1.6<a class="headerlink" href="#version-2-1-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 16 Jul 2010)</em></p>
<dl class="docutils">
<dt>Bugfixes only:</dt>
<dd><ul class="first last simple">
<li>Add an option to only select some reboot types during qa/burnin.
(on some hypervisors consequent reboots are not supported)</li>
<li>Fix infrequent race condition in master failover. Sometimes the old
master ip address would be still detected as up for a short time
after it was removed, causing failover to fail.</li>
<li>Decrease mlockall warnings when the ctypes module is missing. On
Python 2.4 we support running even if no ctypes module is installed,
but we were too verbose about this issue.</li>
<li>Fix building on old distributions, on which man doesn&#8217;t have a
&#8211;warnings option.</li>
<li>Fix RAPI not to ignore the MAC address on instance creation</li>
<li>Implement the old instance creation format in the RAPI client.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="version-2-1-5">
<h2>Version 2.1.5<a class="headerlink" href="#version-2-1-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 01 Jul 2010)</em></p>
<dl class="docutils">
<dt>A small bugfix release:</dt>
<dd><ul class="first last simple">
<li>Fix disk adoption: broken by strict &#8211;disk option checking in 2.1.4</li>
<li>Fix batch-create: broken in the whole 2.1 series due to a lookup on
a non-existing option</li>
<li>Fix instance create: the &#8211;force-variant option was ignored</li>
<li>Improve pylint 0.21 compatibility and warnings with Python 2.6</li>
<li>Fix modify node storage with non-FQDN arguments</li>
<li>Fix RAPI client to authenticate under Python 2.6 when used
for more than 5 requests needing authentication</li>
<li>Fix gnt-instance modify -t (storage) giving a wrong error message
when converting a non-shutdown drbd instance to plain</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="version-2-1-4">
<h2>Version 2.1.4<a class="headerlink" href="#version-2-1-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 18 Jun 2010)</em></p>
<p>A small bugfix release:</p>
<blockquote>
<div><ul class="simple">
<li>Fix live migration of KVM instances started with older Ganeti
versions which had fewer hypervisor parameters</li>
<li>Fix gnt-instance grow-disk on down instances</li>
<li>Fix an error-reporting bug during instance migration</li>
<li>Better checking of the <tt class="docutils literal"><span class="pre">--net</span></tt> and <tt class="docutils literal"><span class="pre">--disk</span></tt> values, to avoid
silently ignoring broken ones</li>
<li>Fix an RPC error reporting bug affecting, for example, RAPI client
users</li>
<li>Fix bug triggered by different API version os-es on different nodes</li>
<li>Fix a bug in instance startup with custom hvparams: OS level
parameters would fail to be applied.</li>
<li>Fix the RAPI client under Python 2.6 (but more work is needed to
make it work completely well with OpenSSL)</li>
<li>Fix handling of errors when resolving names from DNS</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="version-2-1-3">
<h2>Version 2.1.3<a class="headerlink" href="#version-2-1-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 3 Jun 2010)</em></p>
<p>A medium sized development cycle. Some new features, and some
fixes/small improvements/cleanups.</p>
<div class="section" id="significant-features">
<h3>Significant features<a class="headerlink" href="#significant-features" title="Permalink to this headline">¶</a></h3>
<p>The node deamon now tries to mlock itself into memory, unless the
<tt class="docutils literal"><span class="pre">--no-mlock</span></tt> flag is passed. It also doesn&#8217;t fail if it can&#8217;t write
its logs, and falls back to console logging. This allows emergency
features such as <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">powercycle</span></tt> to work even in the event of a
broken node disk (tested offlining the disk hosting the node&#8217;s
filesystem and dropping its memory caches; don&#8217;t try this at home)</p>
<p>KVM: add vhost-net acceleration support. It can be tested with a new
enough version of the kernel and of qemu-kvm.</p>
<p>KVM: Add instance chrooting feature. If you use privilege dropping for
your VMs you can also now force them to chroot to an empty directory,
before starting the emulated guest.</p>
<p>KVM: Add maximum migration bandwith and maximum downtime tweaking
support (requires a new-enough version of qemu-kvm).</p>
<p>Cluster verify will now warn if the master node doesn&#8217;t have the master
ip configured on it.</p>
<p>Add a new (incompatible) instance creation request format to RAPI which
supports all parameters (previously only a subset was supported, and it
wasn&#8217;t possible to extend the old format to accomodate all the new
features. The old format is still supported, and a client can check for
this feature, before using it, by checking for its presence in the
<tt class="docutils literal"><span class="pre">features</span></tt> RAPI resource.</p>
<p>Now with ancient latin support. Try it passing the <tt class="docutils literal"><span class="pre">--roman</span></tt> option to
<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">info</span></tt>, <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">info</span></tt> or <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt>
(requires the python-roman module to be installed, in order to work).</p>
</div>
<div class="section" id="id53">
<h3>Other changes<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<p>As usual many internal code refactorings, documentation updates, and
such. Among others:</p>
<blockquote>
<div><ul class="simple">
<li>Lots of improvements and cleanups to the experimental Remote API
(RAPI) client library.</li>
<li>A new unit test suite for the core daemon libraries.</li>
<li>A fix to creating missing directories makes sure the umask is not
applied anymore. This enforces the same directory permissions
everywhere.</li>
<li>Better handling terminating daemons with ctrl+c (used when running
them in debugging mode).</li>
<li>Fix a race condition in live migrating a KVM instance, when stat()
on the old proc status file returned EINVAL, which is an unexpected
value.</li>
<li>Fixed manpage checking with newer man and utf-8 charachters. But now
you need the en_US.UTF-8 locale enabled to build Ganeti from git.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="version-2-1-2-1">
<h2>Version 2.1.2.1<a class="headerlink" href="#version-2-1-2-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 7 May 2010)</em></p>
<p>Fix a bug which prevented untagged KVM instances from starting.</p>
</div>
<div class="section" id="version-2-1-2">
<h2>Version 2.1.2<a class="headerlink" href="#version-2-1-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 7 May 2010)</em></p>
<p>Another release with a long development cycle, during which many
different features were added.</p>
<div class="section" id="id54">
<h3>Significant features<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h3>
<p>The KVM hypervisor now can run the individual instances as non-root, to
reduce the impact of a VM being hijacked due to bugs in the
hypervisor. It is possible to run all instances as a single (non-root)
user, to manually specify a user for each instance, or to dynamically
allocate a user out of a cluster-wide pool to each instance, with the
guarantee that no two instances will run under the same user ID on any
given node.</p>
<p>An experimental RAPI client library, that can be used standalone
(without the other Ganeti libraries), is provided in the source tree as
<tt class="docutils literal"><span class="pre">lib/rapi/client.py</span></tt>. Note this client might change its interface in
the future, as we iterate on its capabilities.</p>
<p>A new command, <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">renew-crypto</span></tt> has been added to easily
replace the cluster&#8217;s certificates and crypto keys. This might help in
case they have been compromised, or have simply expired.</p>
<p>A new disk option for instance creation has been added that allows one
to &#8220;adopt&#8221; currently existing logical volumes, with data
preservation. This should allow easier migration to Ganeti from
unmanaged (or managed via other software) instances.</p>
<p>Another disk improvement is the possibility to convert between redundant
(DRBD) and plain (LVM) disk configuration for an instance. This should
allow better scalability (starting with one node and growing the
cluster, or shrinking a two-node cluster to one node).</p>
<p>A new feature that could help with automated node failovers has been
implemented: if a node sees itself as offline (by querying the master
candidates), it will try to shutdown (hard) all instances and any active
DRBD devices. This reduces the risk of duplicate instances if an
external script automatically failovers the instances on such nodes. To
enable this, the cluster parameter <tt class="docutils literal"><span class="pre">maintain_node_health</span></tt> should be
enabled; in the future this option (per the name) will enable other
automatic maintenance features.</p>
<p>Instance export/import now will reuse the original instance
specifications for all parameters; that means exporting an instance,
deleting it and the importing it back should give an almost identical
instance. Note that the default import behaviour has changed from
before, where it created only one NIC; now it recreates the original
number of NICs.</p>
<p>Cluster verify has added a few new checks: SSL certificates validity,
/etc/hosts consistency across the cluster, etc.</p>
</div>
<div class="section" id="id55">
<h3>Other changes<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h3>
<p>As usual, many internal changes were done, documentation fixes,
etc. Among others:</p>
<ul class="simple">
<li>Fixed cluster initialization with disabled cluster storage (regression
introduced in 2.1.1)</li>
<li>File-based storage supports growing the disks</li>
<li>Fixed behaviour of node role changes</li>
<li>Fixed cluster verify for some corner cases, plus a general rewrite of
cluster verify to allow future extension with more checks</li>
<li>Fixed log spamming by watcher and node daemon (regression introduced
in 2.1.1)</li>
<li>Fixed possible validation issues when changing the list of enabled
hypervisors</li>
<li>Fixed cleanup of /etc/hosts during node removal</li>
<li>Fixed RAPI response for invalid methods</li>
<li>Fixed bug with hashed passwords in <tt class="docutils literal"><span class="pre">ganeti-rapi</span></tt> daemon</li>
<li>Multiple small improvements to the KVM hypervisor (VNC usage, booting
from ide disks, etc.)</li>
<li>Allow OS changes without re-installation (to record a changed OS
outside of Ganeti, or to allow OS renames)</li>
<li>Allow instance creation without OS installation (useful for example if
the OS will be installed manually, or restored from a backup not in
Ganeti format)</li>
<li>Implemented option to make cluster <tt class="docutils literal"><span class="pre">copyfile</span></tt> use the replication
network</li>
<li>Added list of enabled hypervisors to ssconf (possibly useful for
external scripts)</li>
<li>Added a new tool (<tt class="docutils literal"><span class="pre">tools/cfgupgrade12</span></tt>) that allows upgrading from
1.2 clusters</li>
<li>A partial form of node re-IP is possible via node readd, which now
allows changed node primary IP</li>
<li>Command line utilities now show an informational message if the job is
waiting for a lock</li>
<li>The logs of the master daemon now show the PID/UID/GID of the
connected client</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-1">
<h2>Version 2.1.1<a class="headerlink" href="#version-2-1-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 12 Mar 2010)</em></p>
<p>During the 2.1.0 long release candidate cycle, a lot of improvements and
changes have accumulated with were released later as 2.1.1.</p>
<div class="section" id="major-changes">
<h3>Major changes<a class="headerlink" href="#major-changes" title="Permalink to this headline">¶</a></h3>
<p>The node evacuate command (<tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">evacuate</span></tt>) was significantly
rewritten, and as such the IAllocator protocol was changed - a new
request type has been added. This unfortunate change during a stable
series is designed to improve performance of node evacuations; on
clusters with more than about five nodes and which are well-balanced,
evacuation should proceed in parallel for all instances of the node
being evacuated. As such, any existing IAllocator scripts need to be
updated, otherwise the above command will fail due to the unknown
request. The provided &#8220;dumb&#8221; allocator has not been updated; but the
ganeti-htools package supports the new protocol since version 0.2.4.</p>
<p>Another important change is increased validation of node and instance
names. This might create problems in special cases, if invalid host
names are being used.</p>
<p>Also, a new layer of hypervisor parameters has been added, that sits at
OS level between the cluster defaults and the instance ones. This allows
customisation of virtualization parameters depending on the installed
OS. For example instances with OS &#8216;X&#8217; may have a different KVM kernel
(or any other parameter) than the cluster defaults. This is intended to
help managing a multiple OSes on the same cluster, without manual
modification of each instance&#8217;s parameters.</p>
<p>A tool for merging clusters, <tt class="docutils literal"><span class="pre">cluster-merge</span></tt>, has been added in the
tools sub-directory.</p>
</div>
<div class="section" id="bug-fixes">
<h3>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Improved the int/float conversions that should make the code more
robust in face of errors from the node daemons</li>
<li>Fixed the remove node code in case of internal configuration errors</li>
<li>Fixed the node daemon behaviour in face of inconsistent queue
directory (e.g. read-only file-system where we can&#8217;t open the files
read-write, etc.)</li>
<li>Fixed the behaviour of gnt-node modify for master candidate demotion;
now it either aborts cleanly or, if given the new &#8220;auto_promote&#8221;
parameter, will automatically promote other nodes as needed</li>
<li>Fixed compatibility with (unreleased yet) Python 2.6.5 that would
completely prevent Ganeti from working</li>
<li>Fixed bug for instance export when not all disks were successfully
exported</li>
<li>Fixed behaviour of node add when the new node is slow in starting up
the node daemon</li>
<li>Fixed handling of signals in the LUXI client, which should improve
behaviour of command-line scripts</li>
<li>Added checks for invalid node/instance names in the configuration (now
flagged during cluster verify)</li>
<li>Fixed watcher behaviour for disk activation errors</li>
<li>Fixed two potentially endless loops in http library, which led to the
RAPI daemon hanging and consuming 100% CPU in some cases</li>
<li>Fixed bug in RAPI daemon related to hashed passwords</li>
<li>Fixed bug for unintended qemu-level bridging of multi-NIC KVM
instances</li>
<li>Enhanced compatibility with non-Debian OSes, but not using absolute
path in some commands and allowing customisation of the ssh
configuration directory</li>
<li>Fixed possible future issue with new Python versions by abiding to the
proper use of <tt class="docutils literal"><span class="pre">__slots__</span></tt> attribute on classes</li>
<li>Added checks that should prevent directory traversal attacks</li>
<li>Many documentation fixes based on feedback from users</li>
</ul>
</div>
<div class="section" id="id56">
<h3>New features<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Added an &#8220;early_release&#8221; more for instance replace disks and node
evacuate, where we release locks earlier and thus allow higher
parallelism within the cluster</li>
<li>Added watcher hooks, intended to allow the watcher to restart other
daemons (e.g. from the ganeti-nbma project), but they can be used of
course for any other purpose</li>
<li>Added a compile-time disable for DRBD barriers, to increase
performance if the administrator trusts the power supply or the
storage system to not lose writes</li>
<li>Added the option of using syslog for logging instead of, or in
addition to, Ganeti&#8217;s own log files</li>
<li>Removed boot restriction for paravirtual NICs for KVM, recent versions
can indeed boot from a paravirtual NIC</li>
<li>Added a generic debug level for many operations; while this is not
used widely yet, it allows one to pass the debug value all the way to
the OS scripts</li>
<li>Enhanced the hooks environment for instance moves (failovers,
migrations) where the primary/secondary nodes changed during the
operation, by adding {NEW,OLD}_{PRIMARY,SECONDARY} vars</li>
<li>Enhanced data validations for many user-supplied values; one important
item is the restrictions imposed on instance and node names, which
might reject some (invalid) host names</li>
<li>Add a configure-time option to disable file-based storage, if it&#8217;s not
needed; this allows greater security separation between the master
node and the other nodes from the point of view of the inter-node RPC
protocol</li>
<li>Added user notification in interactive tools if job is waiting in the
job queue or trying to acquire locks</li>
<li>Added log messages when a job is waiting for locks</li>
<li>Added filtering by node tags in instance operations which admit
multiple instances (start, stop, reboot, reinstall)</li>
<li>Added a new tool for cluster mergers, <tt class="docutils literal"><span class="pre">cluster-merge</span></tt></li>
<li>Parameters from command line which are of the form <tt class="docutils literal"><span class="pre">a=b,c=d</span></tt> can now
use backslash escapes to pass in values which contain commas,
e.g. <tt class="docutils literal"><span class="pre">a=b\\c,d=e</span></tt> where the &#8216;a&#8217; parameter would get the value
<tt class="docutils literal"><span class="pre">b,c</span></tt></li>
<li>For KVM, the instance name is the first parameter passed to KVM, so
that it&#8217;s more visible in the process list</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-0">
<h2>Version 2.1.0<a class="headerlink" href="#version-2-1-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 2 Mar 2010)</em></p>
<p>Ganeti 2.1 brings many improvements with it. Major changes:</p>
<ul class="simple">
<li>Added infrastructure to ease automated disk repairs</li>
<li>Added new daemon to export configuration data in a cheaper way than
using the remote API</li>
<li>Instance NICs can now be routed instead of being associated with a
networking bridge</li>
<li>Improved job locking logic to reduce impact of jobs acquiring multiple
locks waiting for other long-running jobs</li>
</ul>
<p>In-depth implementation details can be found in the Ganeti 2.1 design
document.</p>
<div class="section" id="details">
<h3>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Added chroot hypervisor</li>
<li>Added more options to xen-hvm hypervisor (<tt class="docutils literal"><span class="pre">kernel_path</span></tt> and
<tt class="docutils literal"><span class="pre">device_model</span></tt>)</li>
<li>Added more options to xen-pvm hypervisor (<tt class="docutils literal"><span class="pre">use_bootloader</span></tt>,
<tt class="docutils literal"><span class="pre">bootloader_path</span></tt> and <tt class="docutils literal"><span class="pre">bootloader_args</span></tt>)</li>
<li>Added the <tt class="docutils literal"><span class="pre">use_localtime</span></tt> option for the xen-hvm and kvm
hypervisors, and the default value for this has changed to false (in
2.0 xen-hvm always enabled it)</li>
<li>Added luxi call to submit multiple jobs in one go</li>
<li>Added cluster initialization option to not modify <tt class="docutils literal"><span class="pre">/etc/hosts</span></tt>
file on nodes</li>
<li>Added network interface parameters</li>
<li>Added dry run mode to some LUs</li>
<li>Added RAPI resources:<ul>
<li><tt class="docutils literal"><span class="pre">/2/instances/[instance_name]/info</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/instances/[instance_name]/replace-disks</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/evacuate</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/migrate</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/role</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/storage</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/storage/modify</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/2/nodes/[node_name]/storage/repair</span></tt></li>
</ul>
</li>
<li>Added OpCodes to evacuate or migrate all instances on a node</li>
<li>Added new command to list storage elements on nodes (<tt class="docutils literal"><span class="pre">gnt-node</span>
<span class="pre">list-storage</span></tt>) and modify them (<tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">modify-storage</span></tt>)</li>
<li>Added new ssconf files with master candidate IP address
(<tt class="docutils literal"><span class="pre">ssconf_master_candidates_ips</span></tt>), node primary IP address
(<tt class="docutils literal"><span class="pre">ssconf_node_primary_ips</span></tt>) and node secondary IP address
(<tt class="docutils literal"><span class="pre">ssconf_node_secondary_ips</span></tt>)</li>
<li>Added <tt class="docutils literal"><span class="pre">ganeti-confd</span></tt> and a client library to query the Ganeti
configuration via UDP</li>
<li>Added ability to run hooks after cluster initialization and before
cluster destruction</li>
<li>Added automatic mode for disk replace (<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">replace-disks</span>
<span class="pre">--auto</span></tt>)</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">recreate-disks</span></tt> to re-create (empty) disks
after catastrophic data-loss</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">repair-storage</span></tt> command to repair damaged LVM volume
groups</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">move</span></tt> command to move instances</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">watcher</span></tt> command to control watcher</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">powercycle</span></tt> command to powercycle nodes</li>
<li>Added new job status field <tt class="docutils literal"><span class="pre">lock_status</span></tt></li>
<li>Added parseable error codes to cluster verification (<tt class="docutils literal"><span class="pre">gnt-cluster</span>
<span class="pre">verify</span> <span class="pre">--error-codes</span></tt>) and made output less verbose (use
<tt class="docutils literal"><span class="pre">--verbose</span></tt> to restore previous behaviour)</li>
<li>Added UUIDs to the main config entities (cluster, nodes, instances)</li>
<li>Added support for OS variants</li>
<li>Added support for hashed passwords in the Ganeti remote API users file
(<tt class="docutils literal"><span class="pre">rapi_users</span></tt>)</li>
<li>Added option to specify maximum timeout on instance shutdown</li>
<li>Added <tt class="docutils literal"><span class="pre">--no-ssh-init</span></tt> option to <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">init</span></tt></li>
<li>Added new helper script to start and stop Ganeti daemons
(<tt class="docutils literal"><span class="pre">daemon-util</span></tt>), with the intent to reduce the work necessary to
adjust Ganeti for non-Debian distributions and to start/stop daemons
from one place</li>
<li>Added more unittests</li>
<li>Fixed critical bug in ganeti-masterd startup</li>
<li>Removed the configure-time <tt class="docutils literal"><span class="pre">kvm-migration-port</span></tt> parameter, this is
now customisable at the cluster level for both the KVM and Xen
hypervisors using the new <tt class="docutils literal"><span class="pre">migration_port</span></tt> parameter</li>
<li>Pass <tt class="docutils literal"><span class="pre">INSTANCE_REINSTALL</span></tt> variable to OS installation script when
reinstalling an instance</li>
<li>Allowed <tt class="docutils literal"><span class="pre">&#64;</span></tt> in tag names</li>
<li>Migrated to Sphinx (<a class="reference external" href="http://sphinx.pocoo.org/">http://sphinx.pocoo.org/</a>) for documentation</li>
<li>Many documentation updates</li>
<li>Distribute hypervisor files on <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">redist-conf</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">reinstall</span></tt> can now reinstall multiple instances</li>
<li>Updated many command line parameters</li>
<li>Introduced new OS API version 15</li>
<li>No longer support a default hypervisor</li>
<li>Treat virtual LVs as inexistent</li>
<li>Improved job locking logic to reduce lock contention</li>
<li>Match instance and node names case insensitively</li>
<li>Reimplemented bash completion script to be more complete</li>
<li>Improved burnin</li>
</ul>
</div>
</div>
<div class="section" id="version-2-0-6">
<h2>Version 2.0.6<a class="headerlink" href="#version-2-0-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 4 Feb 2010)</em></p>
<ul class="simple">
<li>Fix cleaner behaviour on nodes not in a cluster (Debian bug 568105)</li>
<li>Fix a string formatting bug</li>
<li>Improve safety of the code in some error paths</li>
<li>Improve data validation in the master of values returned from nodes</li>
</ul>
</div>
<div class="section" id="version-2-0-5">
<h2>Version 2.0.5<a class="headerlink" href="#version-2-0-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 17 Dec 2009)</em></p>
<ul class="simple">
<li>Fix security issue due to missing validation of iallocator names; this
allows local and remote execution of arbitrary executables</li>
<li>Fix failure of gnt-node list during instance removal</li>
<li>Ship the RAPI documentation in the archive</li>
</ul>
</div>
<div class="section" id="version-2-0-4">
<h2>Version 2.0.4<a class="headerlink" href="#version-2-0-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 30 Sep 2009)</em></p>
<ul class="simple">
<li>Fixed many wrong messages</li>
<li>Fixed a few bugs related to the locking library</li>
<li>Fixed MAC checking at instance creation time</li>
<li>Fixed a DRBD parsing bug related to gaps in /proc/drbd</li>
<li>Fixed a few issues related to signal handling in both daemons and
scripts</li>
<li>Fixed the example startup script provided</li>
<li>Fixed insserv dependencies in the example startup script (patch from
Debian)</li>
<li>Fixed handling of drained nodes in the iallocator framework</li>
<li>Fixed handling of KERNEL_PATH parameter for xen-hvm (Debian bug
#528618)</li>
<li>Fixed error related to invalid job IDs in job polling</li>
<li>Fixed job/opcode persistence on unclean master shutdown</li>
<li>Fixed handling of partial job processing after unclean master
shutdown</li>
<li>Fixed error reporting from LUs, previously all errors were converted
into execution errors</li>
<li>Fixed error reporting from burnin</li>
<li>Decreased significantly the memory usage of the job queue</li>
<li>Optimised slightly multi-job submission</li>
<li>Optimised slightly opcode loading</li>
<li>Backported the multi-job submit framework from the development
branch; multi-instance start and stop should be faster</li>
<li>Added script to clean archived jobs after 21 days; this will reduce
the size of the queue directory</li>
<li>Added some extra checks in disk size tracking</li>
<li>Added an example ethers hook script</li>
<li>Added a cluster parameter that prevents Ganeti from modifying of
/etc/hosts</li>
<li>Added more node information to RAPI responses</li>
<li>Added a <tt class="docutils literal"><span class="pre">gnt-job</span> <span class="pre">watch</span></tt> command that allows following the ouput of a
job</li>
<li>Added a bind-address option to ganeti-rapi</li>
<li>Added more checks to the configuration verify</li>
<li>Enhanced the burnin script such that some operations can be retried
automatically</li>
<li>Converted instance reinstall to multi-instance model</li>
</ul>
</div>
<div class="section" id="version-2-0-3">
<h2>Version 2.0.3<a class="headerlink" href="#version-2-0-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 7 Aug 2009)</em></p>
<ul class="simple">
<li>Added <tt class="docutils literal"><span class="pre">--ignore-size</span></tt> to the <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">activate-disks</span></tt> command
to allow using the pre-2.0.2 behaviour in activation, if any existing
instances have mismatched disk sizes in the configuration</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">repair-disk-sizes</span></tt> command to check and update
any configuration mismatches for disk sizes</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-master</span> <span class="pre">cluste-failover</span> <span class="pre">--no-voting</span></tt> to allow master
failover to work on two-node clusters</li>
<li>Fixed the <tt class="docutils literal"><span class="pre">--net</span></tt> option of <tt class="docutils literal"><span class="pre">gnt-backup</span> <span class="pre">import</span></tt>, which was
unusable</li>
<li>Fixed detection of OS script errors in <tt class="docutils literal"><span class="pre">gnt-backup</span> <span class="pre">export</span></tt></li>
<li>Fixed exit code of <tt class="docutils literal"><span class="pre">gnt-backup</span> <span class="pre">export</span></tt></li>
</ul>
</div>
<div class="section" id="version-2-0-2">
<h2>Version 2.0.2<a class="headerlink" href="#version-2-0-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 17 Jul 2009)</em></p>
<ul class="simple">
<li>Added experimental support for stripped logical volumes; this should
enhance performance but comes with a higher complexity in the block
device handling; stripping is only enabled when passing
<tt class="docutils literal"><span class="pre">--with-lvm-stripecount=N</span></tt> to <tt class="docutils literal"><span class="pre">configure</span></tt>, but codepaths are
affected even in the non-stripped mode</li>
<li>Improved resiliency against transient failures at the end of DRBD
resyncs, and in general of DRBD resync checks</li>
<li>Fixed a couple of issues with exports and snapshot errors</li>
<li>Fixed a couple of issues in instance listing</li>
<li>Added display of the disk size in <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">info</span></tt></li>
<li>Fixed checking for valid OSes in instance creation</li>
<li>Fixed handling of the &#8220;vcpus&#8221; parameter in instance listing and in
general of invalid parameters</li>
<li>Fixed http server library, and thus RAPI, to handle invalid
username/password combinations correctly; this means that now they
report unauthorized for queries too, not only for modifications,
allowing earlier detect of configuration problems</li>
<li>Added a new &#8220;role&#8221; node list field, equivalent to the master/master
candidate/drained/offline flags combinations</li>
<li>Fixed cluster modify and changes of candidate pool size</li>
<li>Fixed cluster verify error messages for wrong files on regular nodes</li>
<li>Fixed a couple of issues with node demotion from master candidate role</li>
<li>Fixed node readd issues</li>
<li>Added non-interactive mode for <tt class="docutils literal"><span class="pre">ganeti-masterd</span> <span class="pre">--no-voting</span></tt> startup</li>
<li>Added a new <tt class="docutils literal"><span class="pre">--no-voting</span></tt> option for masterfailover to fix failover
on two-nodes clusters when the former master node is unreachable</li>
<li>Added instance reinstall over RAPI</li>
</ul>
</div>
<div class="section" id="version-2-0-1">
<h2>Version 2.0.1<a class="headerlink" href="#version-2-0-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 16 Jun 2009)</em></p>
<ul class="simple">
<li>added <tt class="docutils literal"><span class="pre">-H</span></tt>/<tt class="docutils literal"><span class="pre">-B</span></tt> startup parameters to <tt class="docutils literal"><span class="pre">gnt-instance</span></tt>, which will
allow re-adding the start in single-user option (regression from 1.2)</li>
<li>the watcher writes the instance status to a file, to allow monitoring
to report the instance status (from the master) based on cached
results of the watcher&#8217;s queries; while this can get stale if the
watcher is being locked due to other work on the cluster, this is
still an improvement</li>
<li>the watcher now also restarts the node daemon and the rapi daemon if
they died</li>
<li>fixed the watcher to handle full and drained queue cases</li>
<li>hooks export more instance data in the environment, which helps if
hook scripts need to take action based on the instance&#8217;s properties
(no longer need to query back into ganeti)</li>
<li>instance failovers when the instance is stopped do not check for free
RAM, so that failing over a stopped instance is possible in low memory
situations</li>
<li>rapi uses queries for tags instead of jobs (for less job traffic), and
for cluster tags it won&#8217;t talk to masterd at all but read them from
ssconf</li>
<li>a couple of error handling fixes in RAPI</li>
<li>drbd handling: improved the error handling of inconsistent disks after
resync to reduce the frequency of &#8220;there are some degraded disks for
this instance&#8221; messages</li>
<li>fixed a bug in live migration when DRBD doesn&#8217;t want to reconnect (the
error handling path called a wrong function name)</li>
</ul>
</div>
<div class="section" id="version-2-0-0">
<h2>Version 2.0.0<a class="headerlink" href="#version-2-0-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 27 May 2009)</em></p>
<ul class="simple">
<li>no changes from rc5</li>
</ul>
</div>
<div class="section" id="version-2-0-rc5">
<h2>Version 2.0 rc5<a class="headerlink" href="#version-2-0-rc5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 20 May 2009)</em></p>
<ul class="simple">
<li>fix a couple of bugs (validation, argument checks)</li>
<li>fix <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">getmaster</span></tt> on non-master nodes (regression)</li>
<li>some small improvements to RAPI and IAllocator</li>
<li>make watcher automatically start the master daemon if down</li>
</ul>
</div>
<div class="section" id="version-2-0-rc4">
<h2>Version 2.0 rc4<a class="headerlink" href="#version-2-0-rc4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 27 Apr 2009)</em></p>
<ul class="simple">
<li>change the OS list to not require locks; this helps with big clusters</li>
<li>fix <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> and <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify-disks</span></tt> when the
volume group is broken</li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">info</span></tt>, without any arguments, doesn&#8217;t run for all
instances anymore; either pass <tt class="docutils literal"><span class="pre">--all</span></tt> or pass the desired
instances; this helps against mistakes on big clusters where listing
the information for all instances takes a long time</li>
<li>miscellaneous doc and man pages fixes</li>
</ul>
</div>
<div class="section" id="version-2-0-rc3">
<h2>Version 2.0 rc3<a class="headerlink" href="#version-2-0-rc3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 8 Apr 2009)</em></p>
<ul class="simple">
<li>Change the internal locking model of some <tt class="docutils literal"><span class="pre">gnt-node</span></tt> commands, in
order to reduce contention (and blocking of master daemon) when
batching many creation/reinstall jobs</li>
<li>Fixes to Xen soft reboot</li>
<li>No longer build documentation at build time, instead distribute it in
the archive, in order to reduce the need for the whole docbook/rst
toolchains</li>
</ul>
</div>
<div class="section" id="version-2-0-rc2">
<h2>Version 2.0 rc2<a class="headerlink" href="#version-2-0-rc2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 27 Mar 2009)</em></p>
<ul class="simple">
<li>Now the cfgupgrade scripts works and can upgrade 1.2.7 clusters to 2.0</li>
<li>Fix watcher startup sequence, improves the behaviour of busy clusters</li>
<li>Some other fixes in <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt>, <tt class="docutils literal"><span class="pre">gnt-instance</span>
<span class="pre">replace-disks</span></tt>, <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">add</span></tt>, <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">queue</span></tt>, KVM VNC
bind address and other places</li>
<li>Some documentation fixes and updates</li>
</ul>
</div>
<div class="section" id="version-2-0-rc1">
<h2>Version 2.0 rc1<a class="headerlink" href="#version-2-0-rc1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 2 Mar 2009)</em></p>
<ul class="simple">
<li>More documentation updates, now all docs should be more-or-less
up-to-date</li>
<li>A couple of small fixes (mixed hypervisor clusters, offline nodes,
etc.)</li>
<li>Added a customizable HV_KERNEL_ARGS hypervisor parameter (for Xen PVM
and KVM)</li>
<li>Fix an issue related to $libdir/run/ganeti and cluster creation</li>
</ul>
</div>
<div class="section" id="version-2-0-beta2">
<h2>Version 2.0 beta2<a class="headerlink" href="#version-2-0-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Thu, 19 Feb 2009)</em></p>
<ul class="simple">
<li>Xen PVM and KVM have switched the default value for the instance root
disk to the first partition on the first drive, instead of the whole
drive; this means that the OS installation scripts must be changed
accordingly</li>
<li>Man pages have been updated</li>
<li>RAPI has been switched by default to HTTPS, and the exported functions
should all work correctly</li>
<li>RAPI v1 has been removed</li>
<li>Many improvements to the KVM hypervisor</li>
<li>Block device errors are now better reported</li>
<li>Many other bugfixes and small improvements</li>
</ul>
</div>
<div class="section" id="version-2-0-beta1">
<h2>Version 2.0 beta1<a class="headerlink" href="#version-2-0-beta1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 26 Jan 2009)</em></p>
<ul class="simple">
<li>Version 2 is a general rewrite of the code and therefore the
differences are too many to list, see the design document for 2.0 in
the <tt class="docutils literal"><span class="pre">doc/</span></tt> subdirectory for more details</li>
<li>In this beta version there is not yet a migration path from 1.2 (there
will be one in the final 2.0 release)</li>
<li>A few significant changes are:<ul>
<li>all commands are executed by a daemon (<tt class="docutils literal"><span class="pre">ganeti-masterd</span></tt>) and the
various <tt class="docutils literal"><span class="pre">gnt-*</span></tt> commands are just front-ends to it</li>
<li>all the commands are entered into, and executed from a job queue,
see the <tt class="docutils literal"><span class="pre">gnt-job(8)</span></tt> manpage</li>
<li>the RAPI daemon supports read-write operations, secured by basic
HTTP authentication on top of HTTPS</li>
<li>DRBD version 0.7 support has been removed, DRBD 8 is the only
supported version (when migrating from Ganeti 1.2 to 2.0, you need
to migrate to DRBD 8 first while still running Ganeti 1.2)</li>
<li>DRBD devices are using statically allocated minor numbers, which
will be assigned to existing instances during the migration process</li>
<li>there is support for both Xen PVM and Xen HVM instances running on
the same cluster</li>
<li>KVM virtualization is supported too</li>
<li>file-based storage has been implemented, which means that it is
possible to run the cluster without LVM and DRBD storage, for
example using a shared filesystem exported from shared storage (and
still have live migration)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="version-1-2-7">
<h2>Version 1.2.7<a class="headerlink" href="#version-1-2-7" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 13 Jan 2009)</em></p>
<ul class="simple">
<li>Change the default reboot type in <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">reboot</span></tt> to &#8220;hard&#8221;</li>
<li>Reuse the old instance mac address by default on instance import, if
the instance name is the same.</li>
<li>Handle situations in which the node info rpc returns incomplete
results (issue 46)</li>
<li>Add checks for tcp/udp ports collisions in <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt></li>
<li>Improved version of batcher:<ul>
<li>state file support</li>
<li>instance mac address support</li>
<li>support for HVM clusters/instances</li>
</ul>
</li>
<li>Add an option to show the number of cpu sockets and nodes in
<tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">list</span></tt></li>
<li>Support OSes that handle more than one version of the OS api (but do
not change the current API in any other way)</li>
<li>Fix <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">migrate</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-debug</span></tt> man page</li>
<li>Fixes various more typos and small issues</li>
<li>Increase disk resync maximum speed to 60MB/s (from 30MB/s)</li>
</ul>
</div>
<div class="section" id="version-1-2-6">
<h2>Version 1.2.6<a class="headerlink" href="#version-1-2-6" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 24 Sep 2008)</em></p>
<ul class="simple">
<li>new <tt class="docutils literal"><span class="pre">--hvm-nic-type</span></tt> and <tt class="docutils literal"><span class="pre">--hvm-disk-type</span></tt> flags to control the
type of disk exported to fully virtualized instances.</li>
<li>provide access to the serial console of HVM instances</li>
<li>instance auto_balance flag, set by default. If turned off it will
avoid warnings on cluster verify if there is not enough memory to fail
over an instance. in the future it will prevent automatically failing
it over when we will support that.</li>
<li>batcher tool for instance creation, see <tt class="docutils literal"><span class="pre">tools/README.batcher</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">reinstall</span> <span class="pre">--select-os</span></tt> to interactively select a new
operating system when reinstalling an instance.</li>
<li>when changing the memory amount on instance modify a check has been
added that the instance will be able to start. also warnings are
emitted if the instance will not be able to fail over, if auto_balance
is true.</li>
<li>documentation fixes</li>
<li>sync fields between <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list/modify/add/import</span></tt></li>
<li>fix a race condition in drbd when the sync speed was set after giving
the device a remote peer.</li>
</ul>
</div>
<div class="section" id="version-1-2-5">
<h2>Version 1.2.5<a class="headerlink" href="#version-1-2-5" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 22 Jul 2008)</em></p>
<ul class="simple">
<li>note: the allowed size and number of tags per object were reduced</li>
<li>fix a bug in <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> with inconsistent volume groups</li>
<li>fixed twisted 8.x compatibility</li>
<li>fixed <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">replace-disks</span></tt> with iallocator</li>
<li>add TCP keepalives on twisted connections to detect restarted nodes</li>
<li>disk increase support, see <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">grow-disk</span></tt></li>
<li>implement bulk node/instance query for RAPI</li>
<li>add tags in node/instance listing (optional)</li>
<li>experimental migration (and live migration) support, read the man page
for <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">migrate</span></tt></li>
<li>the <tt class="docutils literal"><span class="pre">ganeti-watcher</span></tt> logs are now timestamped, and the watcher also
has some small improvements in handling its state file</li>
</ul>
</div>
<div class="section" id="version-1-2-4">
<h2>Version 1.2.4<a class="headerlink" href="#version-1-2-4" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Fri, 13 Jun 2008)</em></p>
<ul class="simple">
<li>Experimental readonly, REST-based remote API implementation;
automatically started on master node, TCP port 5080, if enabled by
<tt class="docutils literal"><span class="pre">--enable-rapi</span></tt> parameter to configure script.</li>
<li>Instance allocator support. Add and import instance accept a
<tt class="docutils literal"><span class="pre">--iallocator</span></tt> parameter, and call that instance allocator to decide
which node to use for the instance. The iallocator document describes
what&#8217;s expected from an allocator script.</li>
<li><tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> N+1 memory redundancy checks: Unless passed the
<tt class="docutils literal"><span class="pre">--no-nplus1-mem</span></tt> option <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> now checks that if a
node is lost there is still enough memory to fail over the instances
that reside on it.</li>
<li><tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> hooks: it is now possible to add post-hooks to
<tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt>, to check for site-specific compliance. All the
hooks will run, and their output, if any, will be displayed. Any
failing hook will make the verification return an error value.</li>
<li><tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify</span></tt> now checks that its peers are reachable on the
primary and secondary interfaces</li>
<li><tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">add</span></tt> now supports the <tt class="docutils literal"><span class="pre">--readd</span></tt> option, to readd a node
that is still declared as part of the cluster and has failed.</li>
<li><tt class="docutils literal"><span class="pre">gnt-*</span> <span class="pre">list</span></tt> commands now accept a new <tt class="docutils literal"><span class="pre">-o</span> <span class="pre">+field</span></tt> way of
specifying output fields, that just adds the chosen fields to the
default ones.</li>
<li><tt class="docutils literal"><span class="pre">gnt-backup</span></tt> now has a new <tt class="docutils literal"><span class="pre">remove</span></tt> command to delete an existing
export from the filesystem.</li>
<li>New per-instance parameters hvm_acpi, hvm_pae and hvm_cdrom_image_path
have been added. Using them you can enable/disable acpi and pae
support, and specify a path for a cd image to be exported to the
instance. These parameters as the name suggest only work on HVM
clusters.</li>
<li>When upgrading an HVM cluster to Ganeti 1.2.4, the values for ACPI and
PAE support will be set to the previously hardcoded values, but the
(previously hardcoded) path to the CDROM ISO image will be unset and
if required, needs to be set manually with <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt>
after the upgrade.</li>
<li>The address to which an instance&#8217;s VNC console is bound is now
selectable per-instance, rather than being cluster wide. Of course
this only applies to instances controlled via VNC, so currently just
applies to HVM clusters.</li>
</ul>
</div>
<div class="section" id="version-1-2-3">
<h2>Version 1.2.3<a class="headerlink" href="#version-1-2-3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Mon, 18 Feb 2008)</em></p>
<ul class="simple">
<li>more tweaks to the disk activation code (especially helpful for DRBD)</li>
<li>change the default <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list</span></tt> output format, now there is
one combined status field (see the manpage for the exact values this
field will have)</li>
<li>some more fixes for the mac export to hooks change</li>
<li>make Ganeti not break with DRBD 8.2.x (which changed the version
format in <tt class="docutils literal"><span class="pre">/proc/drbd</span></tt>) (issue 24)</li>
<li>add an upgrade tool from &#8220;remote_raid1&#8221; disk template to &#8220;drbd&#8221; disk
template, allowing migration from DRBD0.7+MD to DRBD8</li>
</ul>
</div>
<div class="section" id="version-1-2-2">
<h2>Version 1.2.2<a class="headerlink" href="#version-1-2-2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 30 Jan 2008)</em></p>
<ul class="simple">
<li>fix <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt> breakage introduced in 1.2.1 with the HVM
support (issue 23)</li>
<li>add command aliases infrastructure and a few aliases</li>
<li>allow listing of VCPUs in the <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list</span></tt> and improve the
man pages and the <tt class="docutils literal"><span class="pre">--help</span></tt> option of <tt class="docutils literal"><span class="pre">gnt-node</span>
<span class="pre">list</span></tt>/<tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">list</span></tt></li>
<li>fix <tt class="docutils literal"><span class="pre">gnt-backup</span> <span class="pre">list</span></tt> with down nodes (issue 21)</li>
<li>change the tools location (move from $pkgdatadir to $pkglibdir/tools)</li>
<li>fix the dist archive and add a check for including svn/git files in
the future</li>
<li>some developer-related changes: improve the burnin and the QA suite,
add an upload script for testing during development</li>
</ul>
</div>
<div class="section" id="version-1-2-1">
<h2>Version 1.2.1<a class="headerlink" href="#version-1-2-1" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 16 Jan 2008)</em></p>
<ul class="simple">
<li>experimental HVM support, read the install document, section
&#8220;Initializing the cluster&#8221;</li>
<li>allow for the PVM hypervisor per-instance kernel and initrd paths</li>
<li>add a new command <tt class="docutils literal"><span class="pre">gnt-cluster</span> <span class="pre">verify-disks</span></tt> which uses a new
algorithm to improve the reconnection of the DRBD pairs if the device
on the secondary node has gone away</li>
<li>make logical volume code auto-activate LVs at disk activation time</li>
<li>slightly improve the speed of activating disks</li>
<li>allow specification of the MAC address at instance creation time, and
changing it later via <tt class="docutils literal"><span class="pre">gnt-instance</span> <span class="pre">modify</span></tt></li>
<li>fix handling of external commands that generate lots of output on
stderr</li>
<li>update documentation with regard to minimum version of DRBD8 supported</li>
</ul>
</div>
<div class="section" id="version-1-2-0">
<h2>Version 1.2.0<a class="headerlink" href="#version-1-2-0" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 4 Dec 2007)</em></p>
<ul class="simple">
<li>Log the <tt class="docutils literal"><span class="pre">xm</span> <span class="pre">create</span></tt> output to the node daemon log on failure (to
help diagnosing the error)</li>
<li>In debug mode, log all external commands output if failed to the logs</li>
<li>Change parsing of lvm commands to ignore stderr</li>
</ul>
</div>
<div class="section" id="version-1-2-beta3">
<h2>Version 1.2 beta3<a class="headerlink" href="#version-1-2-beta3" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Wed, 28 Nov 2007)</em></p>
<ul class="simple">
<li>Another round of updates to the DRBD 8 code to deal with more failures
in the replace secondary node operation</li>
<li>Some more logging of failures in disk operations (lvm, drbd)</li>
<li>A few documentation updates</li>
<li>QA updates</li>
</ul>
</div>
<div class="section" id="version-1-2-beta2">
<h2>Version 1.2 beta2<a class="headerlink" href="#version-1-2-beta2" title="Permalink to this headline">¶</a></h2>
<p><em>(Released Tue, 13 Nov 2007)</em></p>
<ul class="simple">
<li>Change configuration file format from Python&#8217;s Pickle to JSON.
Upgrading is possible using the cfgupgrade utility.</li>
<li>Add support for DRBD 8.0 (new disk template <tt class="docutils literal"><span class="pre">drbd</span></tt>) which allows for
faster replace disks and is more stable (DRBD 8 has many improvements
compared to DRBD 0.7)</li>
<li>Added command line tags support (see man pages for <tt class="docutils literal"><span class="pre">gnt-instance</span></tt>,
<tt class="docutils literal"><span class="pre">gnt-node</span></tt>, <tt class="docutils literal"><span class="pre">gnt-cluster</span></tt>)</li>
<li>Added instance rename support</li>
<li>Added multi-instance startup/shutdown</li>
<li>Added cluster rename support</li>
<li>Added <tt class="docutils literal"><span class="pre">gnt-node</span> <span class="pre">evacuate</span></tt> to simplify some node operations</li>
<li>Added instance reboot operation that can speedup reboot as compared to
stop and start</li>
<li>Soften the requirement that hostnames are in FQDN format</li>
<li>The <tt class="docutils literal"><span class="pre">ganeti-watcher</span></tt> now activates drbd pairs after secondary node
reboots</li>
<li>Removed dependency on debian&#8217;s patched fping that uses the
non-standard <tt class="docutils literal"><span class="pre">-S</span></tt> option</li>
<li>Now the OS definitions are searched for in multiple, configurable
paths (easier for distros to package)</li>
<li>Some changes to the hooks infrastructure (especially the new
post-configuration update hook)</li>
<li>Other small bugfixes</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">News</a><ul>
<li><a class="reference internal" href="#version-2-15-2">Version 2.15.2</a><ul>
<li><a class="reference internal" href="#important-changes-and-security-notes">Important changes and security notes</a></li>
<li><a class="reference internal" href="#minor-changes">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-15-1">Version 2.15.1</a><ul>
<li><a class="reference internal" href="#new-features">New features</a></li>
<li><a class="reference internal" href="#bugfixes">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-15-0">Version 2.15.0</a><ul>
<li><a class="reference internal" href="#incompatible-important-changes">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id1">New features</a></li>
<li><a class="reference internal" href="#new-dependencies">New dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-15-0-rc1">Version 2.15.0 rc1</a><ul>
<li><a class="reference internal" href="#known-issues">Known issues:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-15-0-beta1">Version 2.15.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-14-2">Version 2.14.2</a><ul>
<li><a class="reference internal" href="#id2">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id3">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-1">Version 2.14.1</a><ul>
<li><a class="reference internal" href="#id4">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#other-changes">Other Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-0">Version 2.14.0</a><ul>
<li><a class="reference internal" href="#id5">New features</a></li>
<li><a class="reference internal" href="#id6">New dependencies</a></li>
<li><a class="reference internal" href="#id7">Known issues</a></li>
<li><a class="reference internal" href="#since-2-14-0-rc1">Since 2.14.0 rc1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-0-rc2">Version 2.14.0 rc2</a><ul>
<li><a class="reference internal" href="#id8">Since 2.14.0 rc1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-0-rc1">Version 2.14.0 rc1</a><ul>
<li><a class="reference internal" href="#since-2-14-0-beta2">Since 2.14.0 beta2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-0-beta2">Version 2.14.0 beta2</a><ul>
<li><a class="reference internal" href="#since-2-14-0-beta1">Since 2.14.0 beta1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-14-0-beta1">Version 2.14.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-13-3">Version 2.13.3</a><ul>
<li><a class="reference internal" href="#id9">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id10">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-13-2">Version 2.13.2</a><ul>
<li><a class="reference internal" href="#id11">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#other-fixes-and-known-issues">Other fixes and known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-13-1">Version 2.13.1</a><ul>
<li><a class="reference internal" href="#id12">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id13">Other fixes and known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-13-0">Version 2.13.0</a><ul>
<li><a class="reference internal" href="#id14">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id15">New features</a></li>
<li><a class="reference internal" href="#id16">New dependencies</a></li>
<li><a class="reference internal" href="#since-2-13-0-rc1">Since 2.13.0 rc1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-13-0-rc1">Version 2.13.0 rc1</a><ul>
<li><a class="reference internal" href="#since-2-13-0-beta1">Since 2.13.0 beta1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-13-0-beta1">Version 2.13.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-12-6">Version 2.12.6</a><ul>
<li><a class="reference internal" href="#id17">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id18">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-5">Version 2.12.5</a><ul>
<li><a class="reference internal" href="#id19">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#fixed-and-improvements">Fixed and improvements</a></li>
<li><a class="reference internal" href="#id20">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-4">Version 2.12.4</a><ul>
<li><a class="reference internal" href="#id21">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-3">Version 2.12.3</a><ul>
<li><a class="reference internal" href="#id22">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-2">Version 2.12.2</a><ul>
<li><a class="reference internal" href="#id23">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-1">Version 2.12.1</a></li>
<li><a class="reference internal" href="#version-2-12-0">Version 2.12.0</a><ul>
<li><a class="reference internal" href="#id24">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id25">New features</a></li>
<li><a class="reference internal" href="#id26">New dependencies</a></li>
<li><a class="reference internal" href="#incomplete-features">Incomplete features</a></li>
<li><a class="reference internal" href="#id27">Known issues</a></li>
<li><a class="reference internal" href="#since-2-12-0-rc2">Since 2.12.0 rc2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-0-rc2">Version 2.12.0 rc2</a><ul>
<li><a class="reference internal" href="#since-2-12-0-rc1">Since 2.12.0 rc1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-0-rc1">Version 2.12.0 rc1</a><ul>
<li><a class="reference internal" href="#since-2-12-0-beta1">Since 2.12.0 beta1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-12-0-beta1">Version 2.12.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-11-8">Version 2.11.8</a><ul>
<li><a class="reference internal" href="#id28">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id29">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-11-7">Version 2.11.7</a></li>
<li><a class="reference internal" href="#version-2-11-6">Version 2.11.6</a></li>
<li><a class="reference internal" href="#version-2-11-5">Version 2.11.5</a></li>
<li><a class="reference internal" href="#version-2-11-4">Version 2.11.4</a></li>
<li><a class="reference internal" href="#version-2-11-3">Version 2.11.3</a></li>
<li><a class="reference internal" href="#version-2-11-2">Version 2.11.2</a></li>
<li><a class="reference internal" href="#version-2-11-1">Version 2.11.1</a></li>
<li><a class="reference internal" href="#version-2-11-0">Version 2.11.0</a><ul>
<li><a class="reference internal" href="#id30">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id31">New features</a></li>
<li><a class="reference internal" href="#id32">New dependencies</a></li>
<li><a class="reference internal" href="#since-2-11-0-rc1">Since 2.11.0 rc1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-11-0-rc1">Version 2.11.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-11-0-beta1">Version 2.11.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-10-8">Version 2.10.8</a><ul>
<li><a class="reference internal" href="#id33">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id34">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-10-7">Version 2.10.7</a></li>
<li><a class="reference internal" href="#version-2-10-6">Version 2.10.6</a></li>
<li><a class="reference internal" href="#version-2-10-5">Version 2.10.5</a></li>
<li><a class="reference internal" href="#version-2-10-4">Version 2.10.4</a></li>
<li><a class="reference internal" href="#version-2-10-3">Version 2.10.3</a></li>
<li><a class="reference internal" href="#version-2-10-2">Version 2.10.2</a></li>
<li><a class="reference internal" href="#version-2-10-1">Version 2.10.1</a></li>
<li><a class="reference internal" href="#version-2-10-0">Version 2.10.0</a><ul>
<li><a class="reference internal" href="#id35">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id36">New features</a></li>
<li><a class="reference internal" href="#misc-changes">Misc changes</a></li>
<li><a class="reference internal" href="#id37">New dependencies</a></li>
<li><a class="reference internal" href="#since-2-10-0-rc3">Since 2.10.0 rc3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-10-0-rc3">Version 2.10.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-10-0-rc2">Version 2.10.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-10-0-rc1">Version 2.10.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-10-0-beta1">Version 2.10.0 beta1</a><ul>
<li><a class="reference internal" href="#id38">Known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-9-7">Version 2.9.7</a><ul>
<li><a class="reference internal" href="#id39">Important changes and security notes</a></li>
<li><a class="reference internal" href="#id40">Minor changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-9-6">Version 2.9.6</a></li>
<li><a class="reference internal" href="#version-2-9-5">Version 2.9.5</a></li>
<li><a class="reference internal" href="#version-2-9-4">Version 2.9.4</a></li>
<li><a class="reference internal" href="#version-2-9-3">Version 2.9.3</a></li>
<li><a class="reference internal" href="#version-2-9-2">Version 2.9.2</a></li>
<li><a class="reference internal" href="#version-2-9-1">Version 2.9.1</a></li>
<li><a class="reference internal" href="#version-2-9-0">Version 2.9.0</a><ul>
<li><a class="reference internal" href="#id41">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id42">New features</a></li>
<li><a class="reference internal" href="#id43">New dependencies</a></li>
<li><a class="reference internal" href="#since-2-9-0-rc3">Since 2.9.0 rc3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-9-0-rc3">Version 2.9.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-9-0-rc2">Version 2.9.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-9-0-rc1">Version 2.9.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-9-0-beta1">Version 2.9.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-8-4">Version 2.8.4</a></li>
<li><a class="reference internal" href="#version-2-8-3">Version 2.8.3</a></li>
<li><a class="reference internal" href="#version-2-8-2">Version 2.8.2</a></li>
<li><a class="reference internal" href="#version-2-8-1">Version 2.8.1</a></li>
<li><a class="reference internal" href="#version-2-8-0">Version 2.8.0</a><ul>
<li><a class="reference internal" href="#id44">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id45">New features</a></li>
<li><a class="reference internal" href="#id46">New dependencies</a></li>
<li><a class="reference internal" href="#since-2-8-0-rc3">Since 2.8.0 rc3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-8-0-rc3">Version 2.8.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-8-0-rc2">Version 2.8.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-8-0-rc1">Version 2.8.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-8-0-beta1">Version 2.8.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-7-2">Version 2.7.2</a></li>
<li><a class="reference internal" href="#version-2-7-1">Version 2.7.1</a></li>
<li><a class="reference internal" href="#version-2-7-0">Version 2.7.0</a><ul>
<li><a class="reference internal" href="#id47">Incompatible/important changes</a></li>
<li><a class="reference internal" href="#id48">New features</a></li>
<li><a class="reference internal" href="#id49">Misc changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-7-0-rc3">Version 2.7.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-7-0-rc2">Version 2.7.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-7-0-rc1">Version 2.7.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-7-0-beta3">Version 2.7.0 beta3</a></li>
<li><a class="reference internal" href="#version-2-7-0-beta2">Version 2.7.0 beta2</a></li>
<li><a class="reference internal" href="#version-2-7-0-beta1">Version 2.7.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-6-2">Version 2.6.2</a></li>
<li><a class="reference internal" href="#version-2-6-1">Version 2.6.1</a></li>
<li><a class="reference internal" href="#version-2-6-0">Version 2.6.0</a><ul>
<li><a class="reference internal" href="#id50">New features</a><ul>
<li><a class="reference internal" href="#instance-run-status">Instance run status</a></li>
<li><a class="reference internal" href="#instance-policies-and-specs">Instance policies and specs</a></li>
<li><a class="reference internal" href="#instance-migration-behaviour">Instance migration behaviour</a></li>
<li><a class="reference internal" href="#instance-memory-ballooning">Instance memory ballooning</a></li>
<li><a class="reference internal" href="#instance-cpu-pinning">Instance CPU pinning</a></li>
<li><a class="reference internal" href="#disk-parameters">Disk parameters</a></li>
<li><a class="reference internal" href="#rados-block-device-support">Rados block device support</a></li>
<li><a class="reference internal" href="#master-ip-setup">Master IP setup</a></li>
<li><a class="reference internal" href="#spice-support">SPICE support</a></li>
<li><a class="reference internal" href="#ovf-converter">OVF converter</a></li>
<li><a class="reference internal" href="#confd-daemon-changes">Confd daemon changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-interface-changes">User interface changes</a></li>
<li><a class="reference internal" href="#api-changes">API changes</a></li>
<li><a class="reference internal" href="#compatibility">Compatibility</a></li>
<li><a class="reference internal" href="#internal-changes">Internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-6-0-rc4">Version 2.6.0 rc4</a></li>
<li><a class="reference internal" href="#version-2-6-0-rc3">Version 2.6.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-6-0-rc2">Version 2.6.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-6-0-rc1">Version 2.6.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-6-0-beta2">Version 2.6.0 beta2</a></li>
<li><a class="reference internal" href="#version-2-6-0-beta1">Version 2.6.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-5-2">Version 2.5.2</a></li>
<li><a class="reference internal" href="#version-2-5-1">Version 2.5.1</a></li>
<li><a class="reference internal" href="#version-2-5-0">Version 2.5.0</a><ul>
<li><a class="reference internal" href="#incompatible-important-changes-and-bugfixes">Incompatible/important changes and bugfixes</a></li>
<li><a class="reference internal" href="#id51">New features</a></li>
<li><a class="reference internal" href="#node-group-improvements">Node group improvements</a></li>
<li><a class="reference internal" href="#misc">Misc</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-5-0-rc6">Version 2.5.0 rc6</a></li>
<li><a class="reference internal" href="#version-2-5-0-rc5">Version 2.5.0 rc5</a></li>
<li><a class="reference internal" href="#version-2-5-0-rc4">Version 2.5.0 rc4</a></li>
<li><a class="reference internal" href="#version-2-5-0-rc3">Version 2.5.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-5-0-rc2">Version 2.5.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-5-0-rc1">Version 2.5.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-5-0-beta3">Version 2.5.0 beta3</a></li>
<li><a class="reference internal" href="#version-2-5-0-beta2">Version 2.5.0 beta2</a></li>
<li><a class="reference internal" href="#version-2-5-0-beta1">Version 2.5.0 beta1</a></li>
<li><a class="reference internal" href="#version-2-4-5">Version 2.4.5</a></li>
<li><a class="reference internal" href="#version-2-4-4">Version 2.4.4</a></li>
<li><a class="reference internal" href="#version-2-4-3">Version 2.4.3</a></li>
<li><a class="reference internal" href="#version-2-4-2">Version 2.4.2</a></li>
<li><a class="reference internal" href="#version-2-4-1">Version 2.4.1</a></li>
<li><a class="reference internal" href="#version-2-4-0">Version 2.4.0</a></li>
<li><a class="reference internal" href="#version-2-4-0-rc3">Version 2.4.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-4-0-rc2">Version 2.4.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-4-0-rc1">Version 2.4.0 rc1</a><ul>
<li><a class="reference internal" href="#regressions-fixed-from-2-3">Regressions fixed from 2.3</a></li>
<li><a class="reference internal" href="#other-bugs-fixed">Other bugs fixed</a></li>
<li><a class="reference internal" href="#improvements">Improvements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-4-0-beta1">Version 2.4.0 beta1</a><ul>
<li><a class="reference internal" href="#user-visible">User-visible</a></li>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#remote-api">Remote API</a></li>
<li><a class="reference internal" href="#id52">Misc</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-3-1">Version 2.3.1</a></li>
<li><a class="reference internal" href="#version-2-3-1-rc1">Version 2.3.1 rc1</a></li>
<li><a class="reference internal" href="#version-2-3-0">Version 2.3.0</a></li>
<li><a class="reference internal" href="#version-2-3-0-rc1">Version 2.3.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-3-0-rc0">Version 2.3.0 rc0</a></li>
<li><a class="reference internal" href="#version-2-2-2">Version 2.2.2</a></li>
<li><a class="reference internal" href="#version-2-2-1">Version 2.2.1</a></li>
<li><a class="reference internal" href="#version-2-2-1-rc1">Version 2.2.1 rc1</a></li>
<li><a class="reference internal" href="#version-2-2-1-rc0">Version 2.2.1 rc0</a></li>
<li><a class="reference internal" href="#version-2-2-0-1">Version 2.2.0.1</a></li>
<li><a class="reference internal" href="#version-2-2-0">Version 2.2.0</a></li>
<li><a class="reference internal" href="#version-2-2-0-rc2">Version 2.2.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-2-0-rc1">Version 2.2.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-2-0-rc0">Version 2.2.0 rc0</a></li>
<li><a class="reference internal" href="#version-2-2-0-beta0">Version 2.2.0 beta0</a></li>
<li><a class="reference internal" href="#version-2-1-8">Version 2.1.8</a></li>
<li><a class="reference internal" href="#version-2-1-7">Version 2.1.7</a></li>
<li><a class="reference internal" href="#version-2-1-6">Version 2.1.6</a></li>
<li><a class="reference internal" href="#version-2-1-5">Version 2.1.5</a></li>
<li><a class="reference internal" href="#version-2-1-4">Version 2.1.4</a></li>
<li><a class="reference internal" href="#version-2-1-3">Version 2.1.3</a><ul>
<li><a class="reference internal" href="#significant-features">Significant features</a></li>
<li><a class="reference internal" href="#id53">Other changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-2-1">Version 2.1.2.1</a></li>
<li><a class="reference internal" href="#version-2-1-2">Version 2.1.2</a><ul>
<li><a class="reference internal" href="#id54">Significant features</a></li>
<li><a class="reference internal" href="#id55">Other changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-1">Version 2.1.1</a><ul>
<li><a class="reference internal" href="#major-changes">Major changes</a></li>
<li><a class="reference internal" href="#bug-fixes">Bug fixes</a></li>
<li><a class="reference internal" href="#id56">New features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-0">Version 2.1.0</a><ul>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-0-6">Version 2.0.6</a></li>
<li><a class="reference internal" href="#version-2-0-5">Version 2.0.5</a></li>
<li><a class="reference internal" href="#version-2-0-4">Version 2.0.4</a></li>
<li><a class="reference internal" href="#version-2-0-3">Version 2.0.3</a></li>
<li><a class="reference internal" href="#version-2-0-2">Version 2.0.2</a></li>
<li><a class="reference internal" href="#version-2-0-1">Version 2.0.1</a></li>
<li><a class="reference internal" href="#version-2-0-0">Version 2.0.0</a></li>
<li><a class="reference internal" href="#version-2-0-rc5">Version 2.0 rc5</a></li>
<li><a class="reference internal" href="#version-2-0-rc4">Version 2.0 rc4</a></li>
<li><a class="reference internal" href="#version-2-0-rc3">Version 2.0 rc3</a></li>
<li><a class="reference internal" href="#version-2-0-rc2">Version 2.0 rc2</a></li>
<li><a class="reference internal" href="#version-2-0-rc1">Version 2.0 rc1</a></li>
<li><a class="reference internal" href="#version-2-0-beta2">Version 2.0 beta2</a></li>
<li><a class="reference internal" href="#version-2-0-beta1">Version 2.0 beta1</a></li>
<li><a class="reference internal" href="#version-1-2-7">Version 1.2.7</a></li>
<li><a class="reference internal" href="#version-1-2-6">Version 1.2.6</a></li>
<li><a class="reference internal" href="#version-1-2-5">Version 1.2.5</a></li>
<li><a class="reference internal" href="#version-1-2-4">Version 1.2.4</a></li>
<li><a class="reference internal" href="#version-1-2-3">Version 1.2.3</a></li>
<li><a class="reference internal" href="#version-1-2-2">Version 1.2.2</a></li>
<li><a class="reference internal" href="#version-1-2-1">Version 1.2.1</a></li>
<li><a class="reference internal" href="#version-1-2-0">Version 1.2.0</a></li>
<li><a class="reference internal" href="#version-1-2-beta3">Version 1.2 beta3</a></li>
<li><a class="reference internal" href="#version-1-2-beta2">Version 1.2 beta2</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="move-instance.html"
                        title="previous chapter">Moving instances between clusters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ovfconverter.html"
                        title="next chapter">OVF converter</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/news.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="ovfconverter.html" title="OVF converter"
             >next</a></li>
        <li class="right" >
          <a href="move-instance.html" title="Moving instances between clusters"
             >previous</a> |</li>
        <li><a href="index.html">Ganeti 2.15.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013 Google Inc..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>