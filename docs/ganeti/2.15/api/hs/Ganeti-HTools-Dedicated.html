<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.HTools.Dedicated</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-HTools-Dedicated.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/HTools/Dedicated.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Ganeti.HTools.Dedicated</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of special handling of dedicated clusters.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:isDedicated">isDedicated</a> :: <a href="Ganeti-HTools-Loader.html#t:ClusterData">ClusterData</a> -&gt; Maybe String -&gt; Bool</li><li class="src short"><a href="#v:minimallyCompliantInstance">minimallyCompliantInstance</a> :: <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:testInstances">testInstances</a> :: <a href="Ganeti-HTools-Types.html#t:IPolicy">IPolicy</a> -&gt; [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>]</li><li class="src short"><a href="#v:allocationVector">allocationVector</a> :: [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>] -&gt; <a href="Ganeti-HTools-Node.html#t:Node">Node</a> -&gt; [Int]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Metric">Metric</a> = ([Int], Int)</li><li class="src short"><a href="#v:lostAllocationsMetric">lostAllocationsMetric</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>] -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Node.html#t:Node">Node</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>, <a href="Ganeti-HTools-Node.html#t:Node">Node</a>)</li><li class="src short"><a href="#v:allocateOnSingle">allocateOnSingle</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Node.html#t:GenericAllocElement">GenericAllocElement</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)</li><li class="src short"><a href="#v:allocateOnPair">allocateOnPair</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Node.html#t:GenericAllocElement">GenericAllocElement</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)</li><li class="src short"><a href="#v:findAllocation">findAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Group.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Gdx">Gdx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Int -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> (<a href="Ganeti-HTools-Cluster.html#t:GenericAllocSolution">GenericAllocSolution</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>, [String])</li><li class="src short"><a href="#v:findMGAllocation">findMGAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Group.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Int -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> (<a href="Ganeti-HTools-Cluster.html#t:GenericAllocSolution">GenericAllocSolution</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)</li><li class="src short"><a href="#v:runDedicatedAllocation">runDedicatedAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Loader.html#t:Request">Request</a> -&gt; (Maybe (<a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>), String)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:isDedicated" class="def">isDedicated</a> :: <a href="Ganeti-HTools-Loader.html#t:ClusterData">ClusterData</a> -&gt; Maybe String -&gt; Bool<a href="Ganeti/HTools/Dedicated.html#isDedicated" class="link">Source</a></p><div class="doc"><p>Given a cluster description and maybe a group name, decide
 if that group, or all allocatable groups if no group is given,
 is dedicated.
</p></div></div><div class="top"><p class="src"><a name="v:minimallyCompliantInstance" class="def">minimallyCompliantInstance</a> :: <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a><a href="Ganeti/HTools/Dedicated.html#minimallyCompliantInstance" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:testInstances" class="def">testInstances</a> :: <a href="Ganeti-HTools-Types.html#t:IPolicy">IPolicy</a> -&gt; [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>]<a href="Ganeti/HTools/Dedicated.html#testInstances" class="link">Source</a></p><div class="doc"><p>From an instance policy get the list of test instances, in correct order,
 for which the allocation count has to be determined for the lost allocations
 metrics.
</p></div></div><div class="top"><p class="src"><a name="v:allocationVector" class="def">allocationVector</a> :: [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>] -&gt; <a href="Ganeti-HTools-Node.html#t:Node">Node</a> -&gt; [Int]<a href="Ganeti/HTools/Dedicated.html#allocationVector" class="link">Source</a></p><div class="doc"><p>Given the test instances, compute the allocations vector of a node
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Metric" class="def">Metric</a> = ([Int], Int)<a href="Ganeti/HTools/Dedicated.html#Metric" class="link">Source</a></p><div class="doc"><p>The metric do be used in dedicated allocation.
</p></div></div><div class="top"><p class="src"><a name="v:lostAllocationsMetric" class="def">lostAllocationsMetric</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; [<a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>] -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Node.html#t:Node">Node</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>, <a href="Ganeti-HTools-Node.html#t:Node">Node</a>)<a href="Ganeti/HTools/Dedicated.html#lostAllocationsMetric" class="link">Source</a></p><div class="doc"><p>Given the test instances and an instance to be placed, compute
 the lost allocations metrics for that node, together with the
 modified node. Return Bad if it is not possible to place the
 instance on that node.
</p></div></div><div class="top"><p class="src"><a name="v:allocateOnSingle" class="def">allocateOnSingle</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Node.html#t:GenericAllocElement">GenericAllocElement</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)<a href="Ganeti/HTools/Dedicated.html#allocateOnSingle" class="link">Source</a></p><div class="doc"><p>Allocate an instance on a given node.
</p></div></div><div class="top"><p class="src"><a name="v:allocateOnPair" class="def">allocateOnPair</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> (<a href="Ganeti-HTools-Node.html#t:GenericAllocElement">GenericAllocElement</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)<a href="Ganeti/HTools/Dedicated.html#allocateOnPair" class="link">Source</a></p><div class="doc"><p>Allocate an instance on a given pair of nodes.
</p></div></div><div class="top"><p class="src"><a name="v:findAllocation" class="def">findAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Group.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Gdx">Gdx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Int -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> (<a href="Ganeti-HTools-Cluster.html#t:GenericAllocSolution">GenericAllocSolution</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>, [String])<a href="Ganeti/HTools/Dedicated.html#findAllocation" class="link">Source</a></p><div class="doc"><p>Find an allocation for an instance on a group.
</p></div></div><div class="top"><p class="src"><a name="v:findMGAllocation" class="def">findMGAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Group.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Node.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:List">List</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Int -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> (<a href="Ganeti-HTools-Cluster.html#t:GenericAllocSolution">GenericAllocSolution</a> <a href="Ganeti-HTools-Dedicated.html#t:Metric">Metric</a>)<a href="Ganeti/HTools/Dedicated.html#findMGAllocation" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:runDedicatedAllocation" class="def">runDedicatedAllocation</a> :: <a href="Ganeti-HTools-AlgorithmParams.html#t:AlgorithmOptions">AlgorithmOptions</a> -&gt; <a href="Ganeti-HTools-Loader.html#t:Request">Request</a> -&gt; (Maybe (<a href="Ganeti-HTools-Node.html#t:List">List</a>, <a href="Ganeti-HTools-Instance.html#t:List">List</a>), String)<a href="Ganeti/HTools/Dedicated.html#runDedicatedAllocation" class="link">Source</a></p><div class="doc"><p>Handle allocation requests in the dedicated scenario.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>