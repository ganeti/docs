<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.HTools.Instance</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-HTools-Instance.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/HTools/Instance.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Ganeti.HTools.Instance</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Type declarations
</a></li><li><a href="#g:2">Initialization
</a></li><li><a href="#g:3">Update functions
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Module describing an instance.
</p><p>The instance data type holds very few fields, the algorithm
intelligence is in the <a href="Node.html">Node</a> and <a href="Cluster.html">Cluster</a> modules.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:Disk">Disk</a>  = <a href="#v:Disk">Disk</a> {<ul class="subs"><li><a href="#v:dskSize">dskSize</a> :: Int</li><li><a href="#v:dskSpindles">dskSpindles</a> :: Maybe Int</li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Instance">Instance</a>  = <a href="#v:Instance">Instance</a> {<ul class="subs"><li><a href="#v:name">name</a> :: String</li><li><a href="#v:alias">alias</a> :: String</li><li><a href="#v:mem">mem</a> :: Int</li><li><a href="#v:dsk">dsk</a> :: Int</li><li><a href="#v:disks">disks</a> :: [<a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a>]</li><li><a href="#v:vcpus">vcpus</a> :: Int</li><li><a href="#v:runSt">runSt</a> :: <a href="Ganeti-Types.html#t:InstanceStatus">InstanceStatus</a></li><li><a href="#v:pNode">pNode</a> :: <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></li><li><a href="#v:sNode">sNode</a> :: <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></li><li><a href="#v:idx">idx</a> :: <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a></li><li><a href="#v:util">util</a> :: <a href="Ganeti-HTools-Types.html#t:DynUtil">DynUtil</a></li><li><a href="#v:movable">movable</a> :: Bool</li><li><a href="#v:autoBalance">autoBalance</a> :: Bool</li><li><a href="#v:diskTemplate">diskTemplate</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a></li><li><a href="#v:spindleUse">spindleUse</a> :: Int</li><li><a href="#v:allTags">allTags</a> :: [String]</li><li><a href="#v:exclTags">exclTags</a> :: [String]</li><li><a href="#v:locationScore">locationScore</a> :: Int</li><li><a href="#v:arPolicy">arPolicy</a> :: <a href="Ganeti-HTools-Types.html#t:AutoRepairPolicy">AutoRepairPolicy</a></li><li><a href="#v:nics">nics</a> :: [<a href="Ganeti-HTools-Nic.html#t:Nic">Nic</a>]</li><li><a href="#v:forthcoming">forthcoming</a> :: Bool</li></ul>}</li><li class="src short"><a href="#v:isRunning">isRunning</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:isOffline">isOffline</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:notOffline">notOffline</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:instanceDown">instanceDown</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:applyIfOnline">applyIfOnline</a> ::  <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; (a -&gt; a) -&gt; a -&gt; a</li><li class="src short"><a href="#v:usesSecMem">usesSecMem</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:localStorageTemplates">localStorageTemplates</a> :: [<a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a>]</li><li class="src short"><a href="#v:movableDiskTemplates">movableDiskTemplates</a> :: [<a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:AssocList">AssocList</a> = [(<a href="Ganeti-HTools-Types.html#t:Idx">Idx</a>, <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>)]</li><li class="src short"><span class="keyword">type</span> <a href="#t:List">List</a> = <a href="Ganeti-HTools-Container.html#t:Container">Container</a> <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:create">create</a> :: String -&gt; Int -&gt; Int -&gt; [<a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a>] -&gt; Int -&gt; <a href="Ganeti-Types.html#t:InstanceStatus">InstanceStatus</a> -&gt; [String] -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Int -&gt; [<a href="Ganeti-HTools-Nic.html#t:Nic">Nic</a>] -&gt; Bool -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setIdx">setIdx</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setName">setName</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; String -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setAlias">setAlias</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; String -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setPri">setPri</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setSec">setSec</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setBoth">setBoth</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:setMovable">setMovable</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:shrinkByType">shrinkByType</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:FailMode">FailMode</a> -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></li><li class="src short"><a href="#v:getTotalSpindles">getTotalSpindles</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Maybe Int</li><li class="src short"><a href="#v:specOf">specOf</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:RSpec">RSpec</a></li><li class="src short"><a href="#v:instCompareISpec">instCompareISpec</a> :: Ordering -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:instBelowISpec">instBelowISpec</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:instAboveISpec">instAboveISpec</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:instMatchesMinMaxSpecs">instMatchesMinMaxSpecs</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:MinMaxISpecs">MinMaxISpecs</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:instMatchesSpecs">instMatchesSpecs</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; [<a href="Ganeti-HTools-Types.html#t:MinMaxISpecs">MinMaxISpecs</a>] -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:instMatchesPolicy">instMatchesPolicy</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:IPolicy">IPolicy</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()</li><li class="src short"><a href="#v:hasSecondary">hasSecondary</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:requiredNodes">requiredNodes</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Int</li><li class="src short"><a href="#v:allNodes">allNodes</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; [<a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a>]</li><li class="src short"><a href="#v:usesLocalStorage">usesLocalStorage</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li><li class="src short"><a href="#v:supportsMoves">supportsMoves</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Bool</li><li class="src short"><a href="#v:mirrorType">mirrorType</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:MirrorType">MirrorType</a></li><li class="src short"><a href="#v:usesMemory">usesMemory</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool</li></ul></div><div id="interface"><h1 id="g:1">Type declarations
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Disk" class="def">Disk</a>  <a href="Ganeti/HTools/Instance.html#Disk" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Disk" class="def">Disk</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:dskSize" class="def">dskSize</a> :: Int</dt><dd class="doc"><p>Size in bytes
</p></dd><dt class="src"><a name="v:dskSpindles" class="def">dskSpindles</a> :: Maybe Int</dt><dd class="doc"><p>Number of spindles
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Disk" class="caption collapser" onclick="toggleSection('i:Disk')">Instances</p><div id="section.i:Disk" class="show"><table><tr><td class="src">Eq <a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Instance" class="def">Instance</a>  <a href="Ganeti/HTools/Instance.html#Instance" class="link">Source</a></p><div class="doc"><p>The instance type.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Instance" class="def">Instance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:name" class="def">name</a> :: String</dt><dd class="doc"><p>The instance name
</p></dd><dt class="src"><a name="v:alias" class="def">alias</a> :: String</dt><dd class="doc"><p>The shortened name
</p></dd><dt class="src"><a name="v:mem" class="def">mem</a> :: Int</dt><dd class="doc"><p>Memory of the instance
</p></dd><dt class="src"><a name="v:dsk" class="def">dsk</a> :: Int</dt><dd class="doc"><p>Total disk usage of the instance
</p></dd><dt class="src"><a name="v:disks" class="def">disks</a> :: [<a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a>]</dt><dd class="doc"><p>Sizes of the individual disks
</p></dd><dt class="src"><a name="v:vcpus" class="def">vcpus</a> :: Int</dt><dd class="doc"><p>Number of VCPUs
</p></dd><dt class="src"><a name="v:runSt" class="def">runSt</a> :: <a href="Ganeti-Types.html#t:InstanceStatus">InstanceStatus</a></dt><dd class="doc"><p>Original run status
</p></dd><dt class="src"><a name="v:pNode" class="def">pNode</a> :: <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></dt><dd class="doc"><p>Original primary node
</p></dd><dt class="src"><a name="v:sNode" class="def">sNode</a> :: <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></dt><dd class="doc"><p>Original secondary node
</p></dd><dt class="src"><a name="v:idx" class="def">idx</a> :: <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a></dt><dd class="doc"><p>Internal index
</p></dd><dt class="src"><a name="v:util" class="def">util</a> :: <a href="Ganeti-HTools-Types.html#t:DynUtil">DynUtil</a></dt><dd class="doc"><p>Dynamic resource usage
</p></dd><dt class="src"><a name="v:movable" class="def">movable</a> :: Bool</dt><dd class="doc"><p>Can and should the instance be moved?
</p></dd><dt class="src"><a name="v:autoBalance" class="def">autoBalance</a> :: Bool</dt><dd class="doc"><p>Is the instance auto-balanced?
</p></dd><dt class="src"><a name="v:diskTemplate" class="def">diskTemplate</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a></dt><dd class="doc"><p>The disk template of the instance
</p></dd><dt class="src"><a name="v:spindleUse" class="def">spindleUse</a> :: Int</dt><dd class="doc"><p>The numbers of used spindles
</p></dd><dt class="src"><a name="v:allTags" class="def">allTags</a> :: [String]</dt><dd class="doc"><p>List of all instance tags
</p></dd><dt class="src"><a name="v:exclTags" class="def">exclTags</a> :: [String]</dt><dd class="doc"><p>List of instance exclusion tags
</p></dd><dt class="src"><a name="v:locationScore" class="def">locationScore</a> :: Int</dt><dd class="doc"><p>The number of common-failures between
 primary and secondary node of the instance
</p></dd><dt class="src"><a name="v:arPolicy" class="def">arPolicy</a> :: <a href="Ganeti-HTools-Types.html#t:AutoRepairPolicy">AutoRepairPolicy</a></dt><dd class="doc"><p>Instance's auto-repair policy
</p></dd><dt class="src"><a name="v:nics" class="def">nics</a> :: [<a href="Ganeti-HTools-Nic.html#t:Nic">Nic</a>]</dt><dd class="doc"><p>NICs of the instance
</p></dd><dt class="src"><a name="v:forthcoming" class="def">forthcoming</a> :: Bool</dt><dd class="doc"><p>Is the instance is forthcoming?
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Instance" class="caption collapser" onclick="toggleSection('i:Instance')">Instances</p><div id="section.i:Instance" class="show"><table><tr><td class="src">Eq <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Ganeti-HTools-Types.html#t:Element">Element</a> <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:isRunning" class="def">isRunning</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#isRunning" class="link">Source</a></p><div class="doc"><p>Check if instance is running.
</p></div></div><div class="top"><p class="src"><a name="v:isOffline" class="def">isOffline</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#isOffline" class="link">Source</a></p><div class="doc"><p>Check if instance is offline.
</p></div></div><div class="top"><p class="src"><a name="v:notOffline" class="def">notOffline</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#notOffline" class="link">Source</a></p><div class="doc"><p>Helper to check if the instance is not offline.
</p></div></div><div class="top"><p class="src"><a name="v:instanceDown" class="def">instanceDown</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#instanceDown" class="link">Source</a></p><div class="doc"><p>Check if instance is down.
</p></div></div><div class="top"><p class="src"><a name="v:applyIfOnline" class="def">applyIfOnline</a> ::  <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; (a -&gt; a) -&gt; a -&gt; a<a href="Ganeti/HTools/Instance.html#applyIfOnline" class="link">Source</a></p><div class="doc"><p>Apply the function if the instance is online. Otherwise use
 the initial value
</p></div></div><div class="top"><p class="src"><a name="v:usesSecMem" class="def">usesSecMem</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#usesSecMem" class="link">Source</a></p><div class="doc"><p>Helper for determining whether an instance's memory needs to be
 taken into account for secondary memory reservation.
</p></div></div><div class="top"><p class="src"><a name="v:localStorageTemplates" class="def">localStorageTemplates</a> :: [<a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a>]<a href="Ganeti/HTools/Instance.html#localStorageTemplates" class="link">Source</a></p><div class="doc"><p>Constant holding the local storage templates.
</p><p><em>Note:</em> Currently Ganeti only exports node total/free disk space
 for LVM-based storage; file-based storage is ignored in this model,
 so even though file-based storage uses in reality disk space on the
 node, in our model it won't affect it and we can't compute whether
 there is enough disk space for a file-based instance. Therefore we
 will treat this template as 'foreign' storage.
</p></div></div><div class="top"><p class="src"><a name="v:movableDiskTemplates" class="def">movableDiskTemplates</a> :: [<a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a>]<a href="Ganeti/HTools/Instance.html#movableDiskTemplates" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:AssocList" class="def">AssocList</a> = [(<a href="Ganeti-HTools-Types.html#t:Idx">Idx</a>, <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a>)]<a href="Ganeti/HTools/Instance.html#AssocList" class="link">Source</a></p><div class="doc"><p>A simple name for the int, instance association list.
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:List" class="def">List</a> = <a href="Ganeti-HTools-Container.html#t:Container">Container</a> <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a><a href="Ganeti/HTools/Instance.html#List" class="link">Source</a></p><div class="doc"><p>A simple name for an instance map.
</p></div></div><h1 id="g:2">Initialization
</h1><div class="top"><p class="src"><a name="v:create" class="def">create</a> :: String -&gt; Int -&gt; Int -&gt; [<a href="Ganeti-HTools-Instance.html#t:Disk">Disk</a>] -&gt; Int -&gt; <a href="Ganeti-Types.html#t:InstanceStatus">InstanceStatus</a> -&gt; [String] -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a> -&gt; <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Int -&gt; [<a href="Ganeti-HTools-Nic.html#t:Nic">Nic</a>] -&gt; Bool -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a><a href="Ganeti/HTools/Instance.html#create" class="link">Source</a></p><div class="doc"><p>Create an instance.
</p><p>Some parameters are not initialized by function, and must be set
 later (via <code><a href="Ganeti-HTools-Instance.html#v:setIdx">setIdx</a></code> for example).
</p></div></div><div class="top"><p class="src"><a name="v:setIdx" class="def">setIdx</a><a href="Ganeti/HTools/Instance.html#setIdx" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The original instance
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Types.html#t:Idx">Idx</a></td><td class="doc"><p>New index
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The modified instance
</p></td></tr></table></div><div class="doc"><p>Changes the index.
</p><p>This is used only during the building of the data structures.
</p></div></div><div class="top"><p class="src"><a name="v:setName" class="def">setName</a><a href="Ganeti/HTools/Instance.html#setName" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The original instance
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>New name
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The modified instance
</p></td></tr></table></div><div class="doc"><p>Changes the name.
</p><p>This is used only during the building of the data structures.
</p></div></div><div class="top"><p class="src"><a name="v:setAlias" class="def">setAlias</a><a href="Ganeti/HTools/Instance.html#setAlias" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The original instance
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>New alias
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The modified instance
</p></td></tr></table></div><div class="doc"><p>Changes the alias.
</p><p>This is used only during the building of the data structures.
</p></div></div><h1 id="g:3">Update functions
</h1><div class="top"><p class="src"><a name="v:setPri" class="def">setPri</a><a href="Ganeti/HTools/Instance.html#setPri" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the original instance
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></td><td class="doc"><p>the new primary node
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the modified instance
</p></td></tr></table></div><div class="doc"><p>Changes the primary node of the instance.
</p></div></div><div class="top"><p class="src"><a name="v:setSec" class="def">setSec</a><a href="Ganeti/HTools/Instance.html#setSec" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the original instance
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></td><td class="doc"><p>the new secondary node
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the modified instance
</p></td></tr></table></div><div class="doc"><p>Changes the secondary node of the instance.
</p></div></div><div class="top"><p class="src"><a name="v:setBoth" class="def">setBoth</a><a href="Ganeti/HTools/Instance.html#setBoth" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the original instance
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></td><td class="doc"><p>new primary node index
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a></td><td class="doc"><p>new secondary node index
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>the modified instance
</p></td></tr></table></div><div class="doc"><p>Changes both nodes of the instance.
</p></div></div><div class="top"><p class="src"><a name="v:setMovable" class="def">setMovable</a><a href="Ganeti/HTools/Instance.html#setMovable" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The original instance
</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>New movable flag
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a></td><td class="doc"><p>The modified instance
</p></td></tr></table></div><div class="doc"><p>Sets the movable flag on an instance.
</p></div></div><div class="top"><p class="src"><a name="v:shrinkByType" class="def">shrinkByType</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:FailMode">FailMode</a> -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a><a href="Ganeti/HTools/Instance.html#shrinkByType" class="link">Source</a></p><div class="doc"><p>Try to shrink the instance based on the reason why we can't
 allocate it.
</p></div></div><div class="top"><p class="src"><a name="v:getTotalSpindles" class="def">getTotalSpindles</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Maybe Int<a href="Ganeti/HTools/Instance.html#getTotalSpindles" class="link">Source</a></p><div class="doc"><p>Get the number of disk spindles
</p></div></div><div class="top"><p class="src"><a name="v:specOf" class="def">specOf</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:RSpec">RSpec</a><a href="Ganeti/HTools/Instance.html#specOf" class="link">Source</a></p><div class="doc"><p>Return the spec of an instance.
</p></div></div><div class="top"><p class="src"><a name="v:instCompareISpec" class="def">instCompareISpec</a> :: Ordering -&gt; <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instCompareISpec" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:instBelowISpec" class="def">instBelowISpec</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instBelowISpec" class="link">Source</a></p><div class="doc"><p>Checks if an instance is smaller than a given spec.
</p></div></div><div class="top"><p class="src"><a name="v:instAboveISpec" class="def">instAboveISpec</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:ISpec">ISpec</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instAboveISpec" class="link">Source</a></p><div class="doc"><p>Checks if an instance is bigger than a given spec.
</p></div></div><div class="top"><p class="src"><a name="v:instMatchesMinMaxSpecs" class="def">instMatchesMinMaxSpecs</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:MinMaxISpecs">MinMaxISpecs</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instMatchesMinMaxSpecs" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:instMatchesSpecs" class="def">instMatchesSpecs</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; [<a href="Ganeti-HTools-Types.html#t:MinMaxISpecs">MinMaxISpecs</a>] -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instMatchesSpecs" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:instMatchesPolicy" class="def">instMatchesPolicy</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:IPolicy">IPolicy</a> -&gt; Bool -&gt; <a href="Ganeti-HTools-Types.html#t:OpResult">OpResult</a> ()<a href="Ganeti/HTools/Instance.html#instMatchesPolicy" class="link">Source</a></p><div class="doc"><p>Checks if an instance matches a policy.
</p></div></div><div class="top"><p class="src"><a name="v:hasSecondary" class="def">hasSecondary</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#hasSecondary" class="link">Source</a></p><div class="doc"><p>Checks whether the instance uses a secondary node.
</p><p><em>Note:</em> This should be reconciled with <code><code><a href="Ganeti-HTools-Instance.html#v:sNode">sNode</a></code> ==
 <code><a href="Node.html#v:noSecondary">noSecondary</a></code></code>.
</p></div></div><div class="top"><p class="src"><a name="v:requiredNodes" class="def">requiredNodes</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Int<a href="Ganeti/HTools/Instance.html#requiredNodes" class="link">Source</a></p><div class="doc"><p>Computed the number of nodes for a given disk template.
</p></div></div><div class="top"><p class="src"><a name="v:allNodes" class="def">allNodes</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; [<a href="Ganeti-HTools-Types.html#t:Ndx">Ndx</a>]<a href="Ganeti/HTools/Instance.html#allNodes" class="link">Source</a></p><div class="doc"><p>Computes all nodes of an instance.
</p></div></div><div class="top"><p class="src"><a name="v:usesLocalStorage" class="def">usesLocalStorage</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#usesLocalStorage" class="link">Source</a></p><div class="doc"><p>Checks whether a given disk template uses local storage.
</p></div></div><div class="top"><p class="src"><a name="v:supportsMoves" class="def">supportsMoves</a> :: <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#supportsMoves" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:mirrorType" class="def">mirrorType</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; <a href="Ganeti-HTools-Types.html#t:MirrorType">MirrorType</a><a href="Ganeti/HTools/Instance.html#mirrorType" class="link">Source</a></p><div class="doc"><p>A simple wrapper over <code><a href="Ganeti-HTools-Types.html#v:templateMirrorType">templateMirrorType</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:usesMemory" class="def">usesMemory</a> :: <a href="Ganeti-HTools-Instance.html#t:Instance">Instance</a> -&gt; Bool<a href="Ganeti/HTools/Instance.html#usesMemory" class="link">Source</a></p><div class="doc"><p>Whether the instance uses memory on its host node.
 Depends on the <code>InstanceStatus</code> and on whether the instance is forthcoming;
 instances that aren't running or existent don't use memory.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>