<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ganeti.cmdlib.instance_storage</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ganeti-module.html">Package&nbsp;ganeti</a> ::
        <a href="ganeti.cmdlib-module.html">Package&nbsp;cmdlib</a> ::
        Module&nbsp;instance_storage
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ganeti.cmdlib.instance_storage-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module instance_storage</h1><p class="nomargin-top"><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html">source&nbsp;code</a></span></p>
<p>Logical units dealing with storage of instances.</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.LUInstanceRecreateDisks-class.html" class="summary-name">LUInstanceRecreateDisks</a><br />
      Recreate an instance's missing disks.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.LUInstanceGrowDisk-class.html" class="summary-name">LUInstanceGrowDisk</a><br />
      Grow a disk of an instance.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.LUInstanceReplaceDisks-class.html" class="summary-name">LUInstanceReplaceDisks</a><br />
      Replace the disks of an instance.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.LUInstanceActivateDisks-class.html" class="summary-name">LUInstanceActivateDisks</a><br />
      Bring up an instance's disks.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.LUInstanceDeactivateDisks-class.html" class="summary-name">LUInstanceDeactivateDisks</a><br />
      Shutdown an instance's disks.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.TLReplaceDisks-class.html" class="summary-name">TLReplaceDisks</a><br />
      Replaces disks for an instance.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage.TemporaryDisk-class.html" class="summary-name">TemporaryDisk</a><br />
      Creates a new temporary bootable disk, and makes sure it is 
        destroyed.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CreateSingleBlockDev" class="summary-sig-name">CreateSingleBlockDev</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">device</span>,
        <span class="summary-sig-arg">info</span>,
        <span class="summary-sig-arg">force_open</span>,
        <span class="summary-sig-arg">excl_stor</span>)</span><br />
      Create a single block device on a given node.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CreateSingleBlockDev">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CreateBlockDevInner" class="summary-sig-name" onclick="show_private();">_CreateBlockDevInner</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">device</span>,
        <span class="summary-sig-arg">force_create</span>,
        <span class="summary-sig-arg">info</span>,
        <span class="summary-sig-arg">force_open</span>,
        <span class="summary-sig-arg">excl_stor</span>)</span><br />
      Create a tree of block devices on a given node.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CreateBlockDevInner">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">bool</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#IsExclusiveStorageEnabledNodeUuid" class="summary-sig-name">IsExclusiveStorageEnabledNodeUuid</a>(<span class="summary-sig-arg">cfg</span>,
        <span class="summary-sig-arg">node_uuid</span>)</span><br />
      Whether exclusive_storage is in effect for the given node.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#IsExclusiveStorageEnabledNodeUuid">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CreateBlockDev" class="summary-sig-name" onclick="show_private();">_CreateBlockDev</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">device</span>,
        <span class="summary-sig-arg">force_create</span>,
        <span class="summary-sig-arg">info</span>,
        <span class="summary-sig-arg">force_open</span>)</span><br />
      Wrapper around <a 
      href="ganeti.cmdlib.instance_storage-module.html#_CreateBlockDevInner"
      class="link" onclick="show_private();">_CreateBlockDevInner</a>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CreateBlockDev">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_UndoCreateDisks" class="summary-sig-name" onclick="show_private();">_UndoCreateDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">disks_created</span>,
        <span class="summary-sig-arg">instance</span>)</span><br />
      Undo the work performed by <a 
      href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" 
      class="link">CreateDisks</a>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_UndoCreateDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" class="summary-sig-name">CreateDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disk_template</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">to_skip</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">target_node_uuid</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>)</span><br />
      Create all disks for an instance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CreateDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="ComputeDiskSizePerVG"></a><span class="summary-sig-name">ComputeDiskSizePerVG</span>(<span class="summary-sig-arg">disk_template</span>,
        <span class="summary-sig-arg">disks</span>)</span><br />
      Compute disk size requirements in the volume group</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ComputeDiskSizePerVG">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#ComputeDisks" class="summary-sig-name">ComputeDisks</a>(<span class="summary-sig-arg">disks</span>,
        <span class="summary-sig-arg">disk_template</span>,
        <span class="summary-sig-arg">default_vg</span>)</span><br />
      Computes the instance disks.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ComputeDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of dictionaries</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#ComputeDisksInfo" class="summary-sig-name">ComputeDisksInfo</a>(<span class="summary-sig-arg">disks</span>,
        <span class="summary-sig-arg">disk_template</span>,
        <span class="summary-sig-arg">default_vg</span>,
        <span class="summary-sig-arg">ext_params</span>)</span><br />
      Computes the new instance's disks for the template conversion.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ComputeDisksInfo">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">string</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CalculateFileStorageDir" class="summary-sig-name">CalculateFileStorageDir</a>(<span class="summary-sig-arg">disk_type</span>,
        <span class="summary-sig-arg">cfg</span>,
        <span class="summary-sig-arg">instance_name</span>,
        <span class="summary-sig-arg">file_storage_dir</span>=<span class="summary-sig-default">None</span>)</span><br />
      Calculate final instance file storage dir.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CalculateFileStorageDir">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="CheckRADOSFreeSpace"></a><span class="summary-sig-name">CheckRADOSFreeSpace</span>()</span><br />
      Compute disk size requirements inside the RADOS cluster.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckRADOSFreeSpace">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_GenerateDRBD8Branch"></a><span class="summary-sig-name">_GenerateDRBD8Branch</span>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">primary_uuid</span>,
        <span class="summary-sig-arg">secondary_uuid</span>,
        <span class="summary-sig-arg">size</span>,
        <span class="summary-sig-arg">vgnames</span>,
        <span class="summary-sig-arg">names</span>,
        <span class="summary-sig-arg">iv_name</span>,
        <span class="summary-sig-arg">forthcoming</span>=<span class="summary-sig-default">False</span>)</span><br />
      Generate a drbd8 device complete with its children.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_GenerateDRBD8Branch">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="GenerateDiskTemplate"></a><span class="summary-sig-name">GenerateDiskTemplate</span>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">template_name</span>,
        <span class="summary-sig-arg">instance_uuid</span>,
        <span class="summary-sig-arg">primary_node_uuid</span>,
        <span class="summary-sig-arg">secondary_node_uuids</span>,
        <span class="summary-sig-arg">disk_info</span>,
        <span class="summary-sig-arg">file_storage_dir</span>,
        <span class="summary-sig-arg">file_driver</span>,
        <span class="summary-sig-arg">base_index</span>,
        <span class="summary-sig-arg">feedback_fn</span>,
        <span class="summary-sig-arg">full_disk_params</span>,
        <span class="summary-sig-arg">forthcoming</span>=<span class="summary-sig-default">False</span>)</span><br />
      Generate the entire disk layout for a given template type.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#GenerateDiskTemplate">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="CommitDisks"></a><span class="summary-sig-name">CommitDisks</span>(<span class="summary-sig-arg">disks</span>)</span><br />
      Recursively remove the forthcoming flag</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CommitDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CheckSpindlesExclusiveStorage" class="summary-sig-name">CheckSpindlesExclusiveStorage</a>(<span class="summary-sig-arg">diskdict</span>,
        <span class="summary-sig-arg">es_flag</span>,
        <span class="summary-sig-arg">required</span>)</span><br />
      Check the presence of the spindle options with exclusive_storage.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckSpindlesExclusiveStorage">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CheckDiskExtProvider" class="summary-sig-name">CheckDiskExtProvider</a>(<span class="summary-sig-arg">diskdict</span>,
        <span class="summary-sig-arg">disk_template</span>)</span><br />
      Check that the given disk should or should not have the provider 
      param.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckDiskExtProvider">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_PerformNodeInfoCall" class="summary-sig-name" onclick="show_private();">_PerformNodeInfoCall</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuids</span>,
        <span class="summary-sig-arg">vg</span>)</span><br />
      Prepares the input and performs a node info call.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_PerformNodeInfoCall">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CheckVgCapacityForNode" class="summary-sig-name" onclick="show_private();">_CheckVgCapacityForNode</a>(<span class="summary-sig-arg">node_name</span>,
        <span class="summary-sig-arg">node_info</span>,
        <span class="summary-sig-arg">vg</span>,
        <span class="summary-sig-arg">requested</span>)</span><br />
      Checks the vg capacity for a given node.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckVgCapacityForNode">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CheckNodesFreeDiskOnVG" class="summary-sig-name" onclick="show_private();">_CheckNodesFreeDiskOnVG</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuids</span>,
        <span class="summary-sig-arg">vg</span>,
        <span class="summary-sig-arg">requested</span>)</span><br />
      Checks if nodes have enough free disk space in the specified VG.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckNodesFreeDiskOnVG">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#CheckNodesFreeDiskPerVG" class="summary-sig-name">CheckNodesFreeDiskPerVG</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuids</span>,
        <span class="summary-sig-arg">req_sizes</span>)</span><br />
      Checks if nodes have enough free disk space in all the VGs.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckNodesFreeDiskPerVG">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_DiskSizeInBytesToMebibytes" class="summary-sig-name" onclick="show_private();">_DiskSizeInBytesToMebibytes</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">size</span>)</span><br />
      Converts a disk size in bytes to mebibytes.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_DiskSizeInBytesToMebibytes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CalcEta" class="summary-sig-name" onclick="show_private();">_CalcEta</a>(<span class="summary-sig-arg">time_taken</span>,
        <span class="summary-sig-arg">written</span>,
        <span class="summary-sig-arg">total_size</span>)</span><br />
      Calculates the ETA based on size written and total size.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CalcEta">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#WipeDisks" class="summary-sig-name">WipeDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>)</span><br />
      Wipes instance disks.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#WipeDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#ImageDisks" class="summary-sig-name">ImageDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">image</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>)</span><br />
      Dumps an image onto an instance disk.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ImageDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#WipeOrCleanupDisks" class="summary-sig-name">WipeOrCleanupDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">cleanup</span>=<span class="summary-sig-default">None</span>)</span><br />
      Wrapper for <a 
      href="ganeti.cmdlib.instance_storage-module.html#WipeDisks" 
      class="link">WipeDisks</a> that handles errors.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#WipeOrCleanupDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">list of <a href="ganeti.objects.Disk-class.html" 
      class="link">objects.Disk</a></span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#ExpandCheckDisks" class="summary-sig-name">ExpandCheckDisks</a>(<span class="summary-sig-arg">instance_disks</span>,
        <span class="summary-sig-arg">disks</span>)</span><br />
      Return the instance disks selected by the disks list</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ExpandCheckDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="WaitForSync"></a><span class="summary-sig-name">WaitForSync</span>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">oneshot</span>=<span class="summary-sig-default">False</span>)</span><br />
      Sleep and poll for an instance's disk to sync.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#WaitForSync">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#ShutdownInstanceDisks" class="summary-sig-name">ShutdownInstanceDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ignore_primary</span>=<span class="summary-sig-default">False</span>)</span><br />
      Shutdown block devices of an instance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ShutdownInstanceDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_SafeShutdownInstanceDisks" class="summary-sig-name" onclick="show_private();">_SafeShutdownInstanceDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">req_states</span>=<span class="summary-sig-default">None</span>)</span><br />
      Shutdown block devices of an instance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_SafeShutdownInstanceDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#AssembleInstanceDisks" class="summary-sig-name">AssembleInstanceDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">disks</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">ignore_secondaries</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">ignore_size</span>=<span class="summary-sig-default">False</span>)</span><br />
      Prepare the block devices for an instance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#AssembleInstanceDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#StartInstanceDisks" class="summary-sig-name">StartInstanceDisks</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">force</span>)</span><br />
      Start the disks of an instance.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#StartInstanceDisks">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_CheckDiskConsistencyInner" class="summary-sig-name" onclick="show_private();">_CheckDiskConsistencyInner</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">dev</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">on_primary</span>,
        <span class="summary-sig-arg">ldisk</span>=<span class="summary-sig-default">False</span>)</span><br />
      Check that mirrors are not degraded.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckDiskConsistencyInner">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="CheckDiskConsistency"></a><span class="summary-sig-name">CheckDiskConsistency</span>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">instance</span>,
        <span class="summary-sig-arg">dev</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">on_primary</span>,
        <span class="summary-sig-arg">ldisk</span>=<span class="summary-sig-default">False</span>)</span><br />
      Wrapper around <a 
      href="ganeti.cmdlib.instance_storage-module.html#_CheckDiskConsistencyInner"
      class="link" 
      onclick="show_private();">_CheckDiskConsistencyInner</a>.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckDiskConsistency">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_BlockdevFind" class="summary-sig-name" onclick="show_private();">_BlockdevFind</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">node_uuid</span>,
        <span class="summary-sig-arg">dev</span>,
        <span class="summary-sig-arg">instance</span>)</span><br />
      Wrapper around call_blockdev_find to annotate diskparams.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_BlockdevFind">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="ganeti.cmdlib.instance_storage-module.html#_GenerateUniqueNames" class="summary-sig-name" onclick="show_private();">_GenerateUniqueNames</a>(<span class="summary-sig-arg">lu</span>,
        <span class="summary-sig-arg">exts</span>)</span><br />
      Generate a suitable LV name.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_GenerateUniqueNames">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ganeti.cmdlib.instance_storage-module.html#_DISK_TEMPLATE_NAME_PREFIX" class="summary-name" onclick="show_private();">_DISK_TEMPLATE_NAME_PREFIX</a> = <code title="{constants.DT_PLAIN: &quot;&quot;, constants.DT_RBD: &quot;.rbd&quot;, constants.DT_EXT: &quot;\
.ext&quot;, constants.DT_FILE: &quot;.file&quot;, constants.DT_SHARED_FILE: &quot;.sharedf\
ile&quot;,}">{constants.DT_PLAIN: &quot;&quot;, constant<code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
</table>
<p class="indent-wrapped-lines"><b>Imports:</b>
  <span title="itertools">itertools</span>,
  <span title="logging">logging</span>,
  <span title="os">os</span>,
  <span title="time">time</span>,
  <a href="ganeti.compat-module.html" title="ganeti.compat">compat</a>,
  <a href="ganeti.constants-module.html" title="ganeti.constants">constants</a>,
  <a href="ganeti.errors-module.html" title="ganeti.errors">errors</a>,
  <a href="ganeti.ht-module.html" title="ganeti.ht">ht</a>,
  <a href="ganeti.locking-module.html" title="ganeti.locking">locking</a>,
  <a href="ganeti.masterd.iallocator-module.html" title="ganeti.masterd.iallocator">iallocator</a>,
  <a href="ganeti.objects-module.html" title="ganeti.objects">objects</a>,
  <a href="ganeti.utils-module.html" title="ganeti.utils">utils</a>,
  <a href="ganeti.rpc.node-module.html" title="ganeti.rpc.node">rpc</a>,
  <a href="ganeti.cmdlib.base.LogicalUnit-class.html" title="ganeti.cmdlib.base.LogicalUnit">LogicalUnit</a>,
  <a href="ganeti.cmdlib.base.NoHooksLU-class.html" title="ganeti.cmdlib.base.NoHooksLU">NoHooksLU</a>,
  <a href="ganeti.cmdlib.base.Tasklet-class.html" title="ganeti.cmdlib.base.Tasklet">Tasklet</a>,
  <span title="ganeti.cmdlib.common.INSTANCE_DOWN">INSTANCE_DOWN</span>,
  <span title="ganeti.cmdlib.common.INSTANCE_NOT_RUNNING">INSTANCE_NOT_RUNNING</span>,
  <a href="ganeti.cmdlib.common-module.html#AnnotateDiskParams" title="ganeti.cmdlib.common.AnnotateDiskParams">AnnotateDiskParams</a>,
  <a href="ganeti.cmdlib.common-module.html#CheckIAllocatorOrNode" title="ganeti.cmdlib.common.CheckIAllocatorOrNode">CheckIAllocatorOrNode</a>,
  <a href="ganeti.cmdlib.common-module.html#ExpandNodeUuidAndName" title="ganeti.cmdlib.common.ExpandNodeUuidAndName">ExpandNodeUuidAndName</a>,
  <a href="ganeti.cmdlib.common-module.html#ComputeIPolicyDiskSizesViolation" title="ganeti.cmdlib.common.ComputeIPolicyDiskSizesViolation">ComputeIPolicyDiskSizesViolation</a>,
  <a href="ganeti.cmdlib.common-module.html#CheckNodeOnline" title="ganeti.cmdlib.common.CheckNodeOnline">CheckNodeOnline</a>,
  <a href="ganeti.cmdlib.common-module.html#CheckInstanceNodeGroups" title="ganeti.cmdlib.common.CheckInstanceNodeGroups">CheckInstanceNodeGroups</a>,
  <a href="ganeti.cmdlib.common-module.html#CheckInstanceState" title="ganeti.cmdlib.common.CheckInstanceState">CheckInstanceState</a>,
  <a href="ganeti.cmdlib.common-module.html#IsExclusiveStorageEnabledNode" title="ganeti.cmdlib.common.IsExclusiveStorageEnabledNode">IsExclusiveStorageEnabledNode</a>,
  <a href="ganeti.cmdlib.common-module.html#FindFaultyInstanceDisks" title="ganeti.cmdlib.common.FindFaultyInstanceDisks">FindFaultyInstanceDisks</a>,
  <a href="ganeti.cmdlib.common-module.html#GetWantedNodes" title="ganeti.cmdlib.common.GetWantedNodes">GetWantedNodes</a>,
  <a href="ganeti.cmdlib.common-module.html#CheckDiskTemplateEnabled" title="ganeti.cmdlib.common.CheckDiskTemplateEnabled">CheckDiskTemplateEnabled</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#GetInstanceInfoText" title="ganeti.cmdlib.instance_utils.GetInstanceInfoText">GetInstanceInfoText</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#CopyLockList" title="ganeti.cmdlib.instance_utils.CopyLockList">CopyLockList</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#ReleaseLocks" title="ganeti.cmdlib.instance_utils.ReleaseLocks">ReleaseLocks</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#CheckNodeVmCapable" title="ganeti.cmdlib.instance_utils.CheckNodeVmCapable">CheckNodeVmCapable</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#BuildInstanceHookEnvByObject" title="ganeti.cmdlib.instance_utils.BuildInstanceHookEnvByObject">BuildInstanceHookEnvByObject</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#CheckNodeNotDrained" title="ganeti.cmdlib.instance_utils.CheckNodeNotDrained">CheckNodeNotDrained</a>,
  <a href="ganeti.cmdlib.instance_utils-module.html#CheckTargetNodeIPolicy" title="ganeti.cmdlib.instance_utils.CheckTargetNodeIPolicy">CheckTargetNodeIPolicy</a>,
  <a href="ganeti-module.html" title="ganeti">ganeti</a>
</p><br />
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="CreateSingleBlockDev"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CreateSingleBlockDev</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuid</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">device</span>,
        <span class="sig-arg">info</span>,
        <span class="sig-arg">force_open</span>,
        <span class="sig-arg">excl_stor</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CreateSingleBlockDev">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Create a single block device on a given node.</p>
  <p>This will not recurse over children of the device, so they must be 
  created in advance.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> - the lu on whose behalf we execute</li>
        <li><strong class="pname"><code>node_uuid</code></strong> - the node on which to create the device</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance which owns the device</li>
        <li><strong class="pname"><code>device</code></strong> (<a href="ganeti.objects.Disk-class.html" 
          class="link">objects.Disk</a>) - the device to create</li>
        <li><strong class="pname"><code>info</code></strong> - the extra 'metadata' we should attach to the device (this will be
          represented as a LVM tag)</li>
        <li><strong class="pname"><code>force_open</code></strong> (boolean) - this parameter will be passes to the <a 
          href="ganeti.backend-module.html#BlockdevCreate" 
          class="link">backend.BlockdevCreate</a> function where it 
          specifies whether we run on primary or not, and it affects both 
          the child assembly and the device own Open() execution</li>
        <li><strong class="pname"><code>excl_stor</code></strong> (boolean) - Whether exclusive_storage is active for the node</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_CreateBlockDevInner"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CreateBlockDevInner</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuid</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">device</span>,
        <span class="sig-arg">force_create</span>,
        <span class="sig-arg">info</span>,
        <span class="sig-arg">force_open</span>,
        <span class="sig-arg">excl_stor</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CreateBlockDevInner">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Create a tree of block devices on a given node.</p>
  <p>If this device type has to be created on secondaries, create it and 
  all its children.</p>
  <p>If not, just recurse to children keeping the same 'force' value.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> - the lu on whose behalf we execute</li>
        <li><strong class="pname"><code>node_uuid</code></strong> - the node on which to create the device</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance which owns the device</li>
        <li><strong class="pname"><code>device</code></strong> (<a href="ganeti.objects.Disk-class.html" 
          class="link">objects.Disk</a>) - the device to create</li>
        <li><strong class="pname"><code>force_create</code></strong> (boolean) - whether to force creation of this device; this will be change to 
          True whenever we find a device which has CreateOnSecondary() 
          attribute</li>
        <li><strong class="pname"><code>info</code></strong> - the extra 'metadata' we should attach to the device (this will be
          represented as a LVM tag)</li>
        <li><strong class="pname"><code>force_open</code></strong> (boolean) - this parameter will be passes to the <a 
          href="ganeti.backend-module.html#BlockdevCreate" 
          class="link">backend.BlockdevCreate</a> function where it 
          specifies whether we run on primary or not, and it affects both 
          the child assembly and the device own Open() execution</li>
        <li><strong class="pname"><code>excl_stor</code></strong> (boolean) - Whether exclusive_storage is active for the node</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>list of created devices</dd>
  </dl>
<div class="fields">      <p><strong>Attention:</strong>
        The device has to be annotated already.
      </p>
</div></td></tr></table>
</div>
<a name="IsExclusiveStorageEnabledNodeUuid"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">IsExclusiveStorageEnabledNodeUuid</span>(<span class="sig-arg">cfg</span>,
        <span class="sig-arg">node_uuid</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#IsExclusiveStorageEnabledNodeUuid">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Whether exclusive_storage is in effect for the given node.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>cfg</code></strong> (<a href="ganeti.config.ConfigWriter-class.html" 
          class="link">config.ConfigWriter</a>) - The cluster configuration</li>
        <li><strong class="pname"><code>node_uuid</code></strong> (string) - The node UUID</li>
    </ul></dd>
    <dt>Returns: bool</dt>
        <dd>The effective value of exclusive_storage</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - if no node exists with the given name</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_CreateBlockDev"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CreateBlockDev</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuid</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">device</span>,
        <span class="sig-arg">force_create</span>,
        <span class="sig-arg">info</span>,
        <span class="sig-arg">force_open</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CreateBlockDev">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Wrapper around <a 
  href="ganeti.cmdlib.instance_storage-module.html#_CreateBlockDevInner" 
  class="link" onclick="show_private();">_CreateBlockDevInner</a>.</p>
  <p>This method annotates the root device first.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_UndoCreateDisks"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_UndoCreateDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">disks_created</span>,
        <span class="sig-arg">instance</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_UndoCreateDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Undo the work performed by <a 
  href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" 
  class="link">CreateDisks</a>.</p>
  <p>This function is called in case of an error to undo the work of <a 
  href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" 
  class="link">CreateDisks</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>disks_created</code></strong> - the result returned by <a 
          href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" 
          class="link">CreateDisks</a></li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance for which disks were created</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="CreateDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CreateDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disk_template</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">to_skip</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">target_node_uuid</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CreateDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Create all disks for an instance.</p>
  <p>This abstracts away some work from AddInstance.</p>
  <p>Since the instance may not have been saved to the config file yet, 
  this function can not query the config file for the instance's disks; in 
  that case they need to be passed as an argument.</p>
  <p>This function is also used by the disk template conversion mechanism 
  to create the new disks of the instance. Since the instance will have the
  old template at the time we create the new disks, the new template must 
  be passed as an extra argument.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance whose disks we should create</li>
        <li><strong class="pname"><code>disk_template</code></strong> (string) - if provided, overrides the instance's disk_template</li>
        <li><strong class="pname"><code>to_skip</code></strong> (list) - list of indices to skip</li>
        <li><strong class="pname"><code>target_node_uuid</code></strong> (string) - if passed, overrides the target node for creation</li>
        <li><strong class="pname"><code>disks</code></strong> (list of {objects.Disk}) - the disks to create; if not specified, all the disks of the 
          instance are created</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>information about the created disks, to be used to call <a 
          href="ganeti.cmdlib.instance_storage-module.html#_UndoCreateDisks"
          class="link" onclick="show_private();">_UndoCreateDisks</a></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - in case of error</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ComputeDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ComputeDisks</span>(<span class="sig-arg">disks</span>,
        <span class="sig-arg">disk_template</span>,
        <span class="sig-arg">default_vg</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ComputeDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Computes the instance disks.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>disks</code></strong> (list of dictionaries) - The disks' input dictionary</li>
        <li><strong class="pname"><code>disk_template</code></strong> (string) - The disk template of the instance</li>
        <li><strong class="pname"><code>default_vg</code></strong> (string) - The default_vg to assume</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>The computed disks</dd>
  </dl>
</td></tr></table>
</div>
<a name="ComputeDisksInfo"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ComputeDisksInfo</span>(<span class="sig-arg">disks</span>,
        <span class="sig-arg">disk_template</span>,
        <span class="sig-arg">default_vg</span>,
        <span class="sig-arg">ext_params</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ComputeDisksInfo">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Computes the new instance's disks for the template conversion.</p>
  <p>This method is used by the disks template conversion mechanism. Using 
  the 'ComputeDisks' method as an auxiliary method computes the disks that 
  will be used for generating the new disk template of the instance. It 
  computes the size, mode, and name parameters from the instance's current 
  disks, such as the volume group and the access parameters for the 
  templates that support them. For conversions targeting an extstorage 
  template, the mandatory provider's name or any user-provided extstorage 
  parameters will also be included in the result.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>disks</code></strong> (list of {objects.Disk}) - The current disks of the instance</li>
        <li><strong class="pname"><code>disk_template</code></strong> (string) - The disk template of the instance</li>
        <li><strong class="pname"><code>default_vg</code></strong> (string) - The default volume group to assume</li>
        <li><strong class="pname"><code>ext_params</code></strong> (dict) - The extstorage parameters</li>
    </ul></dd>
    <dt>Returns: list of dictionaries</dt>
        <dd>The computed disks' information for the new template</dd>
  </dl>
</td></tr></table>
</div>
<a name="CalculateFileStorageDir"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CalculateFileStorageDir</span>(<span class="sig-arg">disk_type</span>,
        <span class="sig-arg">cfg</span>,
        <span class="sig-arg">instance_name</span>,
        <span class="sig-arg">file_storage_dir</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CalculateFileStorageDir">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate final instance file storage dir.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>disk_type</code></strong> (disk template) - constants.DT_FILE, constants.DT_SHARED_FILE, or 
          constants.DT_GLUSTER</li>
        <li><strong class="pname"><code>cfg</code></strong> (ConfigWriter) - the configuration that is to be used.</li>
        <li><strong class="pname"><code>file_storage_dir</code></strong> (path) - the path below the configured base.</li>
        <li><strong class="pname"><code>instance_name</code></strong> (string) - name of the instance this disk is for.</li>
    </ul></dd>
    <dt>Returns: string</dt>
        <dd>The file storage directory for the instance</dd>
  </dl>
</td></tr></table>
</div>
<a name="CheckSpindlesExclusiveStorage"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CheckSpindlesExclusiveStorage</span>(<span class="sig-arg">diskdict</span>,
        <span class="sig-arg">es_flag</span>,
        <span class="sig-arg">required</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckSpindlesExclusiveStorage">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check the presence of the spindle options with exclusive_storage.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>diskdict</code></strong> (dict) - disk parameters</li>
        <li><strong class="pname"><code>es_flag</code></strong> (bool) - the effective value of the exlusive_storage flag</li>
        <li><strong class="pname"><code>required</code></strong> (bool) - whether spindles are required or just optional @raise 
          errors.OpPrereqError when spindles are given and they should not</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="CheckDiskExtProvider"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CheckDiskExtProvider</span>(<span class="sig-arg">diskdict</span>,
        <span class="sig-arg">disk_template</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckDiskExtProvider">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check that the given disk should or should not have the provider 
  param.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>diskdict</code></strong> (dict) - disk parameters</li>
        <li><strong class="pname"><code>disk_template</code></strong> (string) - the desired template of this disk</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - when the parameter is used in the wrong way</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_PerformNodeInfoCall"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_PerformNodeInfoCall</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuids</span>,
        <span class="sig-arg">vg</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_PerformNodeInfoCall">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Prepares the input and performs a node info call.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<code>LogicalUnit</code>) - a logical unit from which we get configuration data</li>
        <li><strong class="pname"><code>node_uuids</code></strong> (list of string) - list of node UUIDs to perform the call for</li>
        <li><strong class="pname"><code>vg</code></strong> (string) - the volume group's name</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_CheckVgCapacityForNode"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CheckVgCapacityForNode</span>(<span class="sig-arg">node_name</span>,
        <span class="sig-arg">node_info</span>,
        <span class="sig-arg">vg</span>,
        <span class="sig-arg">requested</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckVgCapacityForNode">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Checks the vg capacity for a given node.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>node_info</code></strong> (tuple (_, list of dicts, _)) - the result of the node info call for one node</li>
        <li><strong class="pname"><code>node_name</code></strong> (string) - the name of the node</li>
        <li><strong class="pname"><code>vg</code></strong> (string) - volume group name</li>
        <li><strong class="pname"><code>requested</code></strong> (int) - the amount of disk in MiB to check for</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - if the node doesn't have enough disk, or we cannot check the node</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_CheckNodesFreeDiskOnVG"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CheckNodesFreeDiskOnVG</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuids</span>,
        <span class="sig-arg">vg</span>,
        <span class="sig-arg">requested</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckNodesFreeDiskOnVG">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Checks if nodes have enough free disk space in the specified VG.</p>
  <p>This function checks if all given nodes have the needed amount of free
  disk. In case any node has less disk or we cannot get the information 
  from the node, this function raises an OpPrereqError exception.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<code>LogicalUnit</code>) - a logical unit from which we get configuration data</li>
        <li><strong class="pname"><code>node_uuids</code></strong> (<code>list</code>) - the list of node UUIDs to check</li>
        <li><strong class="pname"><code>vg</code></strong> (<code>str</code>) - the volume group to check</li>
        <li><strong class="pname"><code>requested</code></strong> (<code>int</code>) - the amount of disk in MiB to check for</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - if the node doesn't have enough disk, or we cannot check the node</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="CheckNodesFreeDiskPerVG"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">CheckNodesFreeDiskPerVG</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuids</span>,
        <span class="sig-arg">req_sizes</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#CheckNodesFreeDiskPerVG">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Checks if nodes have enough free disk space in all the VGs.</p>
  <p>This function checks if all given nodes have the needed amount of free
  disk. In case any node has less disk or we cannot get the information 
  from the node, this function raises an OpPrereqError exception.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<code>LogicalUnit</code>) - a logical unit from which we get configuration data</li>
        <li><strong class="pname"><code>node_uuids</code></strong> (<code>list</code>) - the list of node UUIDs to check</li>
        <li><strong class="pname"><code>req_sizes</code></strong> (<code>dict</code>) - the hash of vg and corresponding amount of disk in MiB to check 
          for</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - if the node doesn't have enough disk, or we cannot check the node</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_DiskSizeInBytesToMebibytes"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_DiskSizeInBytesToMebibytes</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">size</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_DiskSizeInBytesToMebibytes">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Converts a disk size in bytes to mebibytes.</p>
  <p>Warns and rounds up if the size isn't an even multiple of 1 MiB.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_CalcEta"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CalcEta</span>(<span class="sig-arg">time_taken</span>,
        <span class="sig-arg">written</span>,
        <span class="sig-arg">total_size</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CalcEta">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculates the ETA based on size written and total size.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>time_taken</code></strong> - The time taken so far</li>
        <li><strong class="pname"><code>written</code></strong> - amount written so far</li>
        <li><strong class="pname"><code>total_size</code></strong> - The total size of data to be written</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>The remaining time in seconds</dd>
  </dl>
</td></tr></table>
</div>
<a name="WipeDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">WipeDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#WipeDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Wipes instance disks.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance whose disks we should create</li>
        <li><strong class="pname"><code>disks</code></strong> (None or list of tuple of (number, <a 
          href="ganeti.objects.Disk-class.html" 
          class="link">objects.Disk</a>, number)) - Disk details; tuple contains disk index, disk object and the 
          start offset</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ImageDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ImageDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">image</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ImageDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Dumps an image onto an instance disk.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance whose disks we should create</li>
        <li><strong class="pname"><code>image</code></strong> (string) - the image whose disks we should create</li>
        <li><strong class="pname"><code>disks</code></strong> (None or list of ints) - disk indices</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="WipeOrCleanupDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">WipeOrCleanupDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">cleanup</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#WipeOrCleanupDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Wrapper for <a 
  href="ganeti.cmdlib.instance_storage-module.html#WipeDisks" 
  class="link">WipeDisks</a> that handles errors.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance whose disks we should wipe</li>
        <li><strong class="pname"><code>disks</code></strong> - see <a 
          href="ganeti.cmdlib.instance_storage-module.html#WipeDisks" 
          class="link">WipeDisks</a></li>
        <li><strong class="pname"><code>cleanup</code></strong> - the result returned by <a 
          href="ganeti.cmdlib.instance_storage-module.html#CreateDisks" 
          class="link">CreateDisks</a>, used for cleanup in case of error</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'><a href="ganeti.errors.OpPrereqError-class.html">errors.OpPrereqError</a></strong></code> - in case of failure</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="ExpandCheckDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ExpandCheckDisks</span>(<span class="sig-arg">instance_disks</span>,
        <span class="sig-arg">disks</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ExpandCheckDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return the instance disks selected by the disks list</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>disks</code></strong> (list of <a href="ganeti.objects.Disk-class.html" 
          class="link">objects.Disk</a> or None) - selected disks</li>
    </ul></dd>
    <dt>Returns: list of <a href="ganeti.objects.Disk-class.html" 
      class="link">objects.Disk</a></dt>
        <dd>selected instance disks to act on</dd>
  </dl>
</td></tr></table>
</div>
<a name="ShutdownInstanceDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">ShutdownInstanceDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ignore_primary</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#ShutdownInstanceDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Shutdown block devices of an instance.</p>
  <p>This does the shutdown on all nodes of the instance.</p>
  <p>If the ignore_primary is false, errors on the primary node are 
  ignored.</p>
  <p>Modifies the configuration of the instance, so the caller should 
  re-read the instance configuration, if needed.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_SafeShutdownInstanceDisks"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_SafeShutdownInstanceDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">req_states</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_SafeShutdownInstanceDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Shutdown block devices of an instance.</p>
  <p>This function checks if an instance is running, before calling 
  _ShutdownInstanceDisks.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="AssembleInstanceDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">AssembleInstanceDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">disks</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">ignore_secondaries</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">ignore_size</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#AssembleInstanceDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Prepare the block devices for an instance.</p>
  <p>This sets up the block devices on all nodes.</p>
  <p>Modifies the configuration of the instance, so the caller should 
  re-read the instance configuration, if needed.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> (<a href="ganeti.cmdlib.base.LogicalUnit-class.html" 
          class="link">LogicalUnit</a>) - the logical unit on whose behalf we execute</li>
        <li><strong class="pname"><code>instance</code></strong> (<a href="ganeti.objects.Instance-class.html" 
          class="link">objects.Instance</a>) - the instance for whose disks we assemble</li>
        <li><strong class="pname"><code>disks</code></strong> (list of <a href="ganeti.objects.Disk-class.html" 
          class="link">objects.Disk</a> or None) - which disks to assemble (or all, if None)</li>
        <li><strong class="pname"><code>ignore_secondaries</code></strong> (boolean) - if true, errors on secondary nodes won't result in an error 
          return from the function</li>
        <li><strong class="pname"><code>ignore_size</code></strong> (boolean) - if true, the current known size of the disk will not be used 
          during the disk activation, useful for cases when the size is 
          wrong</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>False if the operation failed, otherwise a list of (host, 
          instance_visible_name, node_visible_name) with the mapping from 
          node devices to instance devices, as well as the payloads of the 
          RPC calls</dd>
  </dl>
</td></tr></table>
</div>
<a name="StartInstanceDisks"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">StartInstanceDisks</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">force</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#StartInstanceDisks">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Start the disks of an instance.</p>
  <p>Modifies the configuration of the instance, so the caller should 
  re-read the instance configuration, if needed.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_CheckDiskConsistencyInner"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_CheckDiskConsistencyInner</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">instance</span>,
        <span class="sig-arg">dev</span>,
        <span class="sig-arg">node_uuid</span>,
        <span class="sig-arg">on_primary</span>,
        <span class="sig-arg">ldisk</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_CheckDiskConsistencyInner">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Check that mirrors are not degraded.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Attention:</strong>
        The device has to be annotated already.
        <p>The ldisk parameter, if True, will change the test from the 
        is_degraded attribute (which represents overall non-ok status for 
        the device(s)) to the ldisk (representing the local storage 
        status).</p>
      </p>
</div></td></tr></table>
</div>
<a name="_BlockdevFind"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_BlockdevFind</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">node_uuid</span>,
        <span class="sig-arg">dev</span>,
        <span class="sig-arg">instance</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_BlockdevFind">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Wrapper around call_blockdev_find to annotate diskparams.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>lu</code></strong> - A reference to the lu object</li>
        <li><strong class="pname"><code>node_uuid</code></strong> - The node to call out</li>
        <li><strong class="pname"><code>dev</code></strong> - The device to find</li>
        <li><strong class="pname"><code>instance</code></strong> - The instance object the device belongs to @returns The result of 
          the rpc call</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="_GenerateUniqueNames"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_GenerateUniqueNames</span>(<span class="sig-arg">lu</span>,
        <span class="sig-arg">exts</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="ganeti.cmdlib.instance_storage-pysrc.html#_GenerateUniqueNames">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Generate a suitable LV name.</p>
  <p>This will generate a logical volume name for the given instance.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="_DISK_TEMPLATE_NAME_PREFIX"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">_DISK_TEMPLATE_NAME_PREFIX</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
{constants.DT_PLAIN: &quot;&quot;, constants.DT_RBD: &quot;.rbd&quot;, constants.DT_EXT: &quot;<span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
.ext&quot;, constants.DT_FILE: &quot;.file&quot;, constants.DT_SHARED_FILE: &quot;.sharedf<span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
ile&quot;,}
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Apr 12 13:38:34 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
