<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.Luxi</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-Luxi.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/Luxi.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.Luxi</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Utility functions
</a></li><li><a href="#g:2">Generic protocol functionality
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of the Ganeti LUXI interface.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:withTimeout">withTimeout</a> ::  Int -&gt; String -&gt; IO a -&gt; IO a</li><li class="src short"><span class="keyword">data</span>  <a href="#t:RecvResult">RecvResult</a> <ul class="subs"><li>= <a href="#v:RecvConnClosed">RecvConnClosed</a>  </li><li>| <a href="#v:RecvError">RecvError</a> String  </li><li>| <a href="#v:RecvOk">RecvOk</a> String  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:LuxiOp">LuxiOp</a> <ul class="subs"><li>= <a href="#v:Query">Query</a> <a href="Ganeti-Query-Language.html#t:ItemType">ItemType</a> [String] (<a href="Ganeti-Query-Language.html#t:Filter">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField">FilterField</a>)  </li><li>| <a href="#v:QueryFields">QueryFields</a> <a href="Ganeti-Query-Language.html#t:ItemType">ItemType</a> [String]  </li><li>| <a href="#v:QueryNodes">QueryNodes</a> [String] [String] Bool  </li><li>| <a href="#v:QueryGroups">QueryGroups</a> [String] [String] Bool  </li><li>| <a href="#v:QueryNetworks">QueryNetworks</a> [String] [String] Bool  </li><li>| <a href="#v:QueryInstances">QueryInstances</a> [String] [String] Bool  </li><li>| <a href="#v:QueryJobs">QueryJobs</a> [<a href="Ganeti-Types.html#t:JobId">JobId</a>] [String]  </li><li>| <a href="#v:QueryExports">QueryExports</a> [String] Bool  </li><li>| <a href="#v:QueryConfigValues">QueryConfigValues</a> [String]  </li><li>| <a href="#v:QueryClusterInfo">QueryClusterInfo</a>  </li><li>| <a href="#v:QueryTags">QueryTags</a> <a href="Ganeti-Types.html#t:TagKind">TagKind</a> String  </li><li>| <a href="#v:SubmitJob">SubmitJob</a> [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]  </li><li>| <a href="#v:SubmitJobToDrainedQueue">SubmitJobToDrainedQueue</a> [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]  </li><li>| <a href="#v:SubmitManyJobs">SubmitManyJobs</a> [[<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]]  </li><li>| <a href="#v:WaitForJobChange">WaitForJobChange</a> <a href="Ganeti-Types.html#t:JobId">JobId</a> [String] JSValue JSValue Int  </li><li>| <a href="#v:ArchiveJob">ArchiveJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a>  </li><li>| <a href="#v:AutoArchiveJobs">AutoArchiveJobs</a> Int Int  </li><li>| <a href="#v:CancelJob">CancelJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a>  </li><li>| <a href="#v:ChangeJobPriority">ChangeJobPriority</a> <a href="Ganeti-Types.html#t:JobId">JobId</a> Int  </li><li>| <a href="#v:SetDrainFlag">SetDrainFlag</a> Bool  </li><li>| <a href="#v:SetWatcherPause">SetWatcherPause</a> Double  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:LuxiReq">LuxiReq</a> <ul class="subs"><li>= <a href="#v:ReqQuery">ReqQuery</a>  </li><li>| <a href="#v:ReqQueryFields">ReqQueryFields</a>  </li><li>| <a href="#v:ReqQueryNodes">ReqQueryNodes</a>  </li><li>| <a href="#v:ReqQueryGroups">ReqQueryGroups</a>  </li><li>| <a href="#v:ReqQueryNetworks">ReqQueryNetworks</a>  </li><li>| <a href="#v:ReqQueryInstances">ReqQueryInstances</a>  </li><li>| <a href="#v:ReqQueryJobs">ReqQueryJobs</a>  </li><li>| <a href="#v:ReqQueryExports">ReqQueryExports</a>  </li><li>| <a href="#v:ReqQueryConfigValues">ReqQueryConfigValues</a>  </li><li>| <a href="#v:ReqQueryClusterInfo">ReqQueryClusterInfo</a>  </li><li>| <a href="#v:ReqQueryTags">ReqQueryTags</a>  </li><li>| <a href="#v:ReqSubmitJob">ReqSubmitJob</a>  </li><li>| <a href="#v:ReqSubmitJobToDrainedQueue">ReqSubmitJobToDrainedQueue</a>  </li><li>| <a href="#v:ReqSubmitManyJobs">ReqSubmitManyJobs</a>  </li><li>| <a href="#v:ReqWaitForJobChange">ReqWaitForJobChange</a>  </li><li>| <a href="#v:ReqArchiveJob">ReqArchiveJob</a>  </li><li>| <a href="#v:ReqAutoArchiveJobs">ReqAutoArchiveJobs</a>  </li><li>| <a href="#v:ReqCancelJob">ReqCancelJob</a>  </li><li>| <a href="#v:ReqChangeJobPriority">ReqChangeJobPriority</a>  </li><li>| <a href="#v:ReqSetDrainFlag">ReqSetDrainFlag</a>  </li><li>| <a href="#v:ReqSetWatcherPause">ReqSetWatcherPause</a>  </li></ul></li><li class="src short"><a href="#v:luxiReqFromRaw">luxiReqFromRaw</a> :: <span class="keyword">forall</span> m. Monad m =&gt; String -&gt; m <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></li><li class="src short"><a href="#v:luxiReqToRaw">luxiReqToRaw</a> :: <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a> -&gt; String</li><li class="src short"><a href="#v:opToArgs">opToArgs</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; JSValue</li><li class="src short"><a href="#v:opToDict">opToDict</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; [(String, JSValue)]</li><li class="src short"><a href="#v:allLuxiCalls">allLuxiCalls</a> :: [String]</li><li class="src short"><a href="#v:strOfOp">strOfOp</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; String</li><li class="src short"><span class="keyword">data</span>  <a href="#t:LuxiCall">LuxiCall</a>  = <a href="#v:LuxiCall">LuxiCall</a> <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a> JSValue</li><li class="src short"><a href="#v:eOM">eOM</a> :: Word8</li><li class="src short"><a href="#v:bEOM">bEOM</a> :: ByteString</li><li class="src short"><span class="keyword">data</span>  <a href="#t:MsgKeys">MsgKeys</a> <ul class="subs"><li>= <a href="#v:Method">Method</a>  </li><li>| <a href="#v:Args">Args</a>  </li><li>| <a href="#v:Success">Success</a>  </li><li>| <a href="#v:Result">Result</a>  </li></ul></li><li class="src short"><a href="#v:strOfKey">strOfKey</a> :: <a href="Ganeti-Luxi.html#t:MsgKeys">MsgKeys</a> -&gt; String</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Client">Client</a>  = <a href="#v:Client">Client</a> {<ul class="subs"><li><a href="#v:socket">socket</a> :: Handle</li><li><a href="#v:rbuf">rbuf</a> :: IORef ByteString</li></ul>}</li><li class="src short"><a href="#v:getClient">getClient</a> :: String -&gt; IO <a href="Ganeti-Luxi.html#t:Client">Client</a></li><li class="src short"><a href="#v:getServer">getServer</a> :: Bool -&gt; FilePath -&gt; IO Socket</li><li class="src short"><a href="#v:closeServer">closeServer</a> :: FilePath -&gt; Socket -&gt; IO ()</li><li class="src short"><a href="#v:acceptClient">acceptClient</a> :: Socket -&gt; IO <a href="Ganeti-Luxi.html#t:Client">Client</a></li><li class="src short"><a href="#v:closeClient">closeClient</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO ()</li><li class="src short"><a href="#v:sendMsg">sendMsg</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; String -&gt; IO ()</li><li class="src short"><a href="#v:recvUpdate">recvUpdate</a> :: Handle -&gt; ByteString -&gt; IO (ByteString, ByteString)</li><li class="src short"><a href="#v:recvMsg">recvMsg</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO String</li><li class="src short"><a href="#v:recvMsgExt">recvMsgExt</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO <a href="Ganeti-Luxi.html#t:RecvResult">RecvResult</a></li><li class="src short"><a href="#v:buildCall">buildCall</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; String</li><li class="src short"><a href="#v:buildResponse">buildResponse</a> :: Bool -&gt; JSValue -&gt; String</li><li class="src short"><a href="#v:validateCall">validateCall</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-Luxi.html#t:LuxiCall">LuxiCall</a></li><li class="src short"><a href="#v:decodeCall">decodeCall</a> :: <a href="Ganeti-Luxi.html#t:LuxiCall">LuxiCall</a> -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></li><li class="src short"><a href="#v:validateResult">validateResult</a> :: String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue</li><li class="src short"><a href="#v:decodeError">decodeError</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue</li><li class="src short"><a href="#v:callMethod">callMethod</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue)</li><li class="src short"><a href="#v:parseSubmitJobResult">parseSubmitJobResult</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> <a href="Ganeti-Types.html#t:JobId">JobId</a></li><li class="src short"><a href="#v:submitManyJobs">submitManyJobs</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; [[<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]] -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> [<a href="Ganeti-Types.html#t:JobId">JobId</a>])</li><li class="src short"><a href="#v:queryJobsStatus">queryJobsStatus</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; [<a href="Ganeti-Types.html#t:JobId">JobId</a>] -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> [<a href="Ganeti-Types.html#t:JobStatus">JobStatus</a>])</li></ul></div><div id="interface"><h1 id="g:1">Utility functions
</h1><div class="top"><p class="src"><a name="v:withTimeout" class="def">withTimeout</a> ::  Int -&gt; String -&gt; IO a -&gt; IO a<a href="Ganeti/Luxi.html#withTimeout" class="link">Source</a></p></div><h1 id="g:2">Generic protocol functionality
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:RecvResult" class="def">RecvResult</a>  <a href="Ganeti/Luxi.html#RecvResult" class="link">Source</a></p><div class="doc"><p>Result of receiving a message from the socket.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:RecvConnClosed" class="def">RecvConnClosed</a></td><td class="doc"><p>Connection closed
</p></td></tr><tr><td class="src"><a name="v:RecvError" class="def">RecvError</a> String</td><td class="doc"><p>Any other error
</p></td></tr><tr><td class="src"><a name="v:RecvOk" class="def">RecvOk</a> String</td><td class="doc"><p>Successfull receive
</p></td></tr></table></div><div class="subs instances"><p id="control.i:RecvResult" class="caption collapser" onclick="toggleSection('i:RecvResult')">Instances</p><div id="section.i:RecvResult" class="show"><table><tr><td class="src">Eq <a href="Ganeti-Luxi.html#t:RecvResult">RecvResult</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Luxi.html#t:RecvResult">RecvResult</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:LuxiOp" class="def">LuxiOp</a>  <a href="Ganeti/Luxi.html#LuxiOp" class="link">Source</a></p><div class="doc"><p>Currently supported Luxi operations and JSON serialization.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Query" class="def">Query</a> <a href="Ganeti-Query-Language.html#t:ItemType">ItemType</a> [String] (<a href="Ganeti-Query-Language.html#t:Filter">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField">FilterField</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryFields" class="def">QueryFields</a> <a href="Ganeti-Query-Language.html#t:ItemType">ItemType</a> [String]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryNodes" class="def">QueryNodes</a> [String] [String] Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryGroups" class="def">QueryGroups</a> [String] [String] Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryNetworks" class="def">QueryNetworks</a> [String] [String] Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryInstances" class="def">QueryInstances</a> [String] [String] Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryJobs" class="def">QueryJobs</a> [<a href="Ganeti-Types.html#t:JobId">JobId</a>] [String]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryExports" class="def">QueryExports</a> [String] Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryConfigValues" class="def">QueryConfigValues</a> [String]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryClusterInfo" class="def">QueryClusterInfo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:QueryTags" class="def">QueryTags</a> <a href="Ganeti-Types.html#t:TagKind">TagKind</a> String</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SubmitJob" class="def">SubmitJob</a> [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SubmitJobToDrainedQueue" class="def">SubmitJobToDrainedQueue</a> [<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SubmitManyJobs" class="def">SubmitManyJobs</a> [[<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:WaitForJobChange" class="def">WaitForJobChange</a> <a href="Ganeti-Types.html#t:JobId">JobId</a> [String] JSValue JSValue Int</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ArchiveJob" class="def">ArchiveJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:AutoArchiveJobs" class="def">AutoArchiveJobs</a> Int Int</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:CancelJob" class="def">CancelJob</a> <a href="Ganeti-Types.html#t:JobId">JobId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ChangeJobPriority" class="def">ChangeJobPriority</a> <a href="Ganeti-Types.html#t:JobId">JobId</a> Int</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SetDrainFlag" class="def">SetDrainFlag</a> Bool</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SetWatcherPause" class="def">SetWatcherPause</a> Double</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:LuxiOp" class="caption collapser" onclick="toggleSection('i:LuxiOp')">Instances</p><div id="section.i:LuxiOp" class="show"><table><tr><td class="src">Eq <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:LuxiReq" class="def">LuxiReq</a>  <a href="Ganeti/Luxi.html#LuxiReq" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ReqQuery" class="def">ReqQuery</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryFields" class="def">ReqQueryFields</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryNodes" class="def">ReqQueryNodes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryGroups" class="def">ReqQueryGroups</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryNetworks" class="def">ReqQueryNetworks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryInstances" class="def">ReqQueryInstances</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryJobs" class="def">ReqQueryJobs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryExports" class="def">ReqQueryExports</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryConfigValues" class="def">ReqQueryConfigValues</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryClusterInfo" class="def">ReqQueryClusterInfo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqQueryTags" class="def">ReqQueryTags</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqSubmitJob" class="def">ReqSubmitJob</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqSubmitJobToDrainedQueue" class="def">ReqSubmitJobToDrainedQueue</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqSubmitManyJobs" class="def">ReqSubmitManyJobs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqWaitForJobChange" class="def">ReqWaitForJobChange</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqArchiveJob" class="def">ReqArchiveJob</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqAutoArchiveJobs" class="def">ReqAutoArchiveJobs</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqCancelJob" class="def">ReqCancelJob</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqChangeJobPriority" class="def">ReqChangeJobPriority</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqSetDrainFlag" class="def">ReqSetDrainFlag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ReqSetWatcherPause" class="def">ReqSetWatcherPause</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:LuxiReq" class="caption collapser" onclick="toggleSection('i:LuxiReq')">Instances</p><div id="section.i:LuxiReq" class="show"><table><tr><td class="src">Bounded <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Enum <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Eq <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Ord <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">JSON <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:luxiReqFromRaw" class="def">luxiReqFromRaw</a> :: <span class="keyword">forall</span> m. Monad m =&gt; String -&gt; m <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a><a href="Ganeti/Luxi.html#luxiReqFromRaw" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:luxiReqToRaw" class="def">luxiReqToRaw</a> :: <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a> -&gt; String<a href="Ganeti/Luxi.html#luxiReqToRaw" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:opToArgs" class="def">opToArgs</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; JSValue<a href="Ganeti/Luxi.html#opToArgs" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:opToDict" class="def">opToDict</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; [(String, JSValue)]<a href="Ganeti/Luxi.html#opToDict" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:allLuxiCalls" class="def">allLuxiCalls</a> :: [String]<a href="Ganeti/Luxi.html#allLuxiCalls" class="link">Source</a></p><div class="doc"><p>List of all defined Luxi calls.
</p></div></div><div class="top"><p class="src"><a name="v:strOfOp" class="def">strOfOp</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; String<a href="Ganeti/Luxi.html#strOfOp" class="link">Source</a></p><div class="doc"><p>The serialisation of LuxiOps into strings in messages.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:LuxiCall" class="def">LuxiCall</a>  <a href="Ganeti/Luxi.html#LuxiCall" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:LuxiCall" class="def">LuxiCall</a> <a href="Ganeti-Luxi.html#t:LuxiReq">LuxiReq</a> JSValue</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a name="v:eOM" class="def">eOM</a> :: Word8<a href="Ganeti/Luxi.html#eOM" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:bEOM" class="def">bEOM</a> :: ByteString<a href="Ganeti/Luxi.html#bEOM" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:MsgKeys" class="def">MsgKeys</a>  <a href="Ganeti/Luxi.html#MsgKeys" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Method" class="def">Method</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Args" class="def">Args</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Success" class="def">Success</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Result" class="def">Result</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a name="v:strOfKey" class="def">strOfKey</a> :: <a href="Ganeti-Luxi.html#t:MsgKeys">MsgKeys</a> -&gt; String<a href="Ganeti/Luxi.html#strOfKey" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Client" class="def">Client</a>  <a href="Ganeti/Luxi.html#Client" class="link">Source</a></p><div class="doc"><p>Luxi client encapsulation.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Client" class="def">Client</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:socket" class="def">socket</a> :: Handle</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:rbuf" class="def">rbuf</a> :: IORef ByteString</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><a name="v:getClient" class="def">getClient</a> :: String -&gt; IO <a href="Ganeti-Luxi.html#t:Client">Client</a><a href="Ganeti/Luxi.html#getClient" class="link">Source</a></p><div class="doc"><p>Connects to the master daemon and returns a luxi Client.
</p></div></div><div class="top"><p class="src"><a name="v:getServer" class="def">getServer</a> :: Bool -&gt; FilePath -&gt; IO Socket<a href="Ganeti/Luxi.html#getServer" class="link">Source</a></p><div class="doc"><p>Creates and returns a server endpoint.
</p></div></div><div class="top"><p class="src"><a name="v:closeServer" class="def">closeServer</a> :: FilePath -&gt; Socket -&gt; IO ()<a href="Ganeti/Luxi.html#closeServer" class="link">Source</a></p><div class="doc"><p>Closes a server endpoint.
 FIXME: this should be encapsulated into a nicer type.
</p></div></div><div class="top"><p class="src"><a name="v:acceptClient" class="def">acceptClient</a> :: Socket -&gt; IO <a href="Ganeti-Luxi.html#t:Client">Client</a><a href="Ganeti/Luxi.html#acceptClient" class="link">Source</a></p><div class="doc"><p>Accepts a client
</p></div></div><div class="top"><p class="src"><a name="v:closeClient" class="def">closeClient</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO ()<a href="Ganeti/Luxi.html#closeClient" class="link">Source</a></p><div class="doc"><p>Closes the client socket.
</p></div></div><div class="top"><p class="src"><a name="v:sendMsg" class="def">sendMsg</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; String -&gt; IO ()<a href="Ganeti/Luxi.html#sendMsg" class="link">Source</a></p><div class="doc"><p>Sends a message over a luxi transport.
</p></div></div><div class="top"><p class="src"><a name="v:recvUpdate" class="def">recvUpdate</a> :: Handle -&gt; ByteString -&gt; IO (ByteString, ByteString)<a href="Ganeti/Luxi.html#recvUpdate" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:recvMsg" class="def">recvMsg</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO String<a href="Ganeti/Luxi.html#recvMsg" class="link">Source</a></p><div class="doc"><p>Waits for a message over a luxi transport.
</p></div></div><div class="top"><p class="src"><a name="v:recvMsgExt" class="def">recvMsgExt</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO <a href="Ganeti-Luxi.html#t:RecvResult">RecvResult</a><a href="Ganeti/Luxi.html#recvMsgExt" class="link">Source</a></p><div class="doc"><p>Extended wrapper over recvMsg.
</p></div></div><div class="top"><p class="src"><a name="v:buildCall" class="def">buildCall</a><a href="Ganeti/Luxi.html#buildCall" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></td><td class="doc"><p>The method
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>The serialized form
</p></td></tr></table></div><div class="doc"><p>Serialize a request to String.
</p></div></div><div class="top"><p class="src"><a name="v:buildResponse" class="def">buildResponse</a><a href="Ganeti/Luxi.html#buildResponse" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Bool</td><td class="doc"><p>Success
</p></td></tr><tr><td class="src">-&gt; JSValue</td><td class="doc"><p>The arguments
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>The serialized form
</p></td></tr></table></div><div class="doc"><p>Serialize the response to String.
</p></div></div><div class="top"><p class="src"><a name="v:validateCall" class="def">validateCall</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-Luxi.html#t:LuxiCall">LuxiCall</a><a href="Ganeti/Luxi.html#validateCall" class="link">Source</a></p><div class="doc"><p>Check that luxi request contains the required keys and parse it.
</p></div></div><div class="top"><p class="src"><a name="v:decodeCall" class="def">decodeCall</a> :: <a href="Ganeti-Luxi.html#t:LuxiCall">LuxiCall</a> -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a><a href="Ganeti/Luxi.html#decodeCall" class="link">Source</a></p><div class="doc"><p>Converts Luxi call arguments into a <code><a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a></code> data structure.
</p><p>This is currently hand-coded until we make it more uniform so that
 it can be generated using TH.
</p></div></div><div class="top"><p class="src"><a name="v:validateResult" class="def">validateResult</a> :: String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue<a href="Ganeti/Luxi.html#validateResult" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:decodeError" class="def">decodeError</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue<a href="Ganeti/Luxi.html#decodeError" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:callMethod" class="def">callMethod</a> :: <a href="Ganeti-Luxi.html#t:LuxiOp">LuxiOp</a> -&gt; <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> JSValue)<a href="Ganeti/Luxi.html#callMethod" class="link">Source</a></p><div class="doc"><p>Generic luxi method call.
</p></div></div><div class="top"><p class="src"><a name="v:parseSubmitJobResult" class="def">parseSubmitJobResult</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> <a href="Ganeti-Types.html#t:JobId">JobId</a><a href="Ganeti/Luxi.html#parseSubmitJobResult" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:submitManyJobs" class="def">submitManyJobs</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; [[<a href="Ganeti-OpCodes.html#t:MetaOpCode">MetaOpCode</a>]] -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> [<a href="Ganeti-Types.html#t:JobId">JobId</a>])<a href="Ganeti/Luxi.html#submitManyJobs" class="link">Source</a></p><div class="doc"><p>Specialized submitManyJobs call.
</p></div></div><div class="top"><p class="src"><a name="v:queryJobsStatus" class="def">queryJobsStatus</a> :: <a href="Ganeti-Luxi.html#t:Client">Client</a> -&gt; [<a href="Ganeti-Types.html#t:JobId">JobId</a>] -&gt; IO (<a href="Ganeti-Errors.html#t:ErrorResult">ErrorResult</a> [<a href="Ganeti-Types.html#t:JobStatus">JobStatus</a>])<a href="Ganeti/Luxi.html#queryJobsStatus" class="link">Source</a></p><div class="doc"><p>Custom queryJobs call.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>