<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>ganeti.hooksmaster</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="ganeti-module.html">Package&nbsp;ganeti</a> ::
        Module&nbsp;hooksmaster
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="ganeti.hooksmaster-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="ganeti.hooksmaster-module.html">Module ganeti.hooksmaster</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2006, 2007, 2011, 2012 Google Inc.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-comment"># This program is free software; you can redistribute it and/or modify</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-comment"># it under the terms of the GNU General Public License as published by</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-comment"># the Free Software Foundation; either version 2 of the License, or</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-comment"># (at your option) any later version.</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-comment"># This program is distributed in the hope that it will be useful, but</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-comment"># WITHOUT ANY WARRANTY; without even the implied warranty of</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-comment"># General Public License for more details.</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-comment">#</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-comment"># You should have received a copy of the GNU General Public License</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-comment"># along with this program; if not, write to the Free Software</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-comment"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-comment"># 02110-1301, USA.</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-docstring">"""Module implementing the logic for running hooks.</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-docstring">"""</tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package ganeti=ganeti-module.html"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-0', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-1" class="py-name" targets="Module ganeti.constants=ganeti.constants-module.html"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-1', 'constants', 'link-1');">constants</a></tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-2" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-2', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-3" class="py-name" targets="Module ganeti.errors=ganeti.errors-module.html"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-3', 'errors', 'link-3');">errors</a></tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-4', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-5" class="py-name" targets="Package ganeti.utils=ganeti.utils-module.html"><a title="ganeti.utils" class="py-name" href="#" onclick="return doclink('link-5', 'utils', 'link-5');">utils</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-6" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-6', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-7" class="py-name" targets="Module ganeti.compat=ganeti.compat-module.html"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-7', 'compat', 'link-7');">compat</a></tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name"><a title="ganeti" class="py-name" href="#" onclick="return doclink('link-8', 'ganeti', 'link-0');">ganeti</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Module ganeti.pathutils=ganeti.pathutils-module.html"><a title="ganeti.pathutils" class="py-name" href="#" onclick="return doclink('link-9', 'pathutils', 'link-9');">pathutils</a></tt> </tt>
<a name="_RpcResultsToHooksResults"></a><div id="_RpcResultsToHooksResults-def"><a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt> <a class="py-toggle" href="#" id="_RpcResultsToHooksResults-toggle" onclick="return toggle('_RpcResultsToHooksResults');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster-module.html#_RpcResultsToHooksResults">_RpcResultsToHooksResults</a><tt class="py-op">(</tt><tt class="py-param">rpc_results</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="_RpcResultsToHooksResults-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="_RpcResultsToHooksResults-expanded"><a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line">  <tt class="py-docstring">"""Function to convert RPC results to the format expected by HooksMaster.</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line"><tt class="py-docstring">  @type rpc_results: dict(node: L{rpc.RpcResult})</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-docstring">  @param rpc_results: RPC results</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">  @rtype: dict(node: (fail_msg, offline, hooks_results))</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">  @return: RPC results unpacked according to the format expected by</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">    L({hooksmaster.HooksMaster}</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-docstring">  """</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">  <tt class="py-keyword">return</tt> <tt class="py-name">dict</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">,</tt> <tt class="py-op">(</tt><tt class="py-name">rpc_res</tt><tt class="py-op">.</tt><tt class="py-name">fail_msg</tt><tt class="py-op">,</tt> <tt class="py-name">rpc_res</tt><tt class="py-op">.</tt><tt class="py-name">offline</tt><tt class="py-op">,</tt> <tt class="py-name">rpc_res</tt><tt class="py-op">.</tt><tt class="py-name">payload</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line">              <tt class="py-keyword">for</tt> <tt class="py-op">(</tt><tt class="py-name">node</tt><tt class="py-op">,</tt> <tt class="py-name">rpc_res</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">rpc_results</tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster"></a><div id="HooksMaster-def"><a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line"> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt> <a class="py-toggle" href="#" id="HooksMaster-toggle" onclick="return toggle('HooksMaster');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html">HooksMaster</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="HooksMaster-expanded"><a name="HooksMaster.__init__"></a><div id="HooksMaster.__init__-def"><a name="L48"></a><tt class="py-lineno"> 48</tt> <a class="py-toggle" href="#" id="HooksMaster.__init__-toggle" onclick="return toggle('HooksMaster.__init__');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">opcode</tt><tt class="py-op">,</tt> <tt class="py-param">hooks_path</tt><tt class="py-op">,</tt> <tt class="py-param">nodes</tt><tt class="py-op">,</tt> <tt class="py-param">hooks_execution_fn</tt><tt class="py-op">,</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">               <tt class="py-param">hooks_results_adapt_fn</tt><tt class="py-op">,</tt> <tt class="py-param">build_env_fn</tt><tt class="py-op">,</tt> <tt class="py-param">log_fn</tt><tt class="py-op">,</tt> <tt class="py-param">htype</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">               <tt class="py-param">cluster_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-param">master_name</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.__init__-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.__init__-expanded"><a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">    <tt class="py-docstring">"""Base class for hooks masters.</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line"><tt class="py-docstring">    This class invokes the execution of hooks according to the behaviour</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"><tt class="py-docstring">    specified by its parameters.</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"><tt class="py-docstring">    @type opcode: string</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"><tt class="py-docstring">    @param opcode: opcode of the operation to which the hooks are tied</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"><tt class="py-docstring">    @type hooks_path: string</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line"><tt class="py-docstring">    @param hooks_path: prefix of the hooks directories</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line"><tt class="py-docstring">    @type nodes: 2-tuple of lists</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"><tt class="py-docstring">    @param nodes: 2-tuple of lists containing nodes on which pre-hooks must be</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"><tt class="py-docstring">      run and nodes on which post-hooks must be run</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line"><tt class="py-docstring">    @type hooks_execution_fn: function that accepts the following parameters:</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line"><tt class="py-docstring">      (node_list, hooks_path, phase, environment)</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line"><tt class="py-docstring">    @param hooks_execution_fn: function that will execute the hooks; can be</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line"><tt class="py-docstring">      None, indicating that no conversion is necessary.</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"><tt class="py-docstring">    @type hooks_results_adapt_fn: function</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"><tt class="py-docstring">    @param hooks_results_adapt_fn: function that will adapt the return value of</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line"><tt class="py-docstring">      hooks_execution_fn to the format expected by RunPhase</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line"><tt class="py-docstring">    @type build_env_fn: function that returns a dictionary having strings as</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line"><tt class="py-docstring">      keys</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line"><tt class="py-docstring">    @param build_env_fn: function that builds the environment for the hooks</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line"><tt class="py-docstring">    @type log_fn: function that accepts a string</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line"><tt class="py-docstring">    @param log_fn: logging function</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line"><tt class="py-docstring">    @type htype: string or None</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line"><tt class="py-docstring">    @param htype: None or one of L{constants.HTYPE_CLUSTER},</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line"><tt class="py-docstring">     L{constants.HTYPE_NODE}, L{constants.HTYPE_INSTANCE}</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"><tt class="py-docstring">    @type cluster_name: string</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"><tt class="py-docstring">    @param cluster_name: name of the cluster</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"><tt class="py-docstring">    @type master_name: string</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line"><tt class="py-docstring">    @param master_name: name of the master</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">opcode</tt> <tt class="py-op">=</tt> <tt class="py-name">opcode</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_path</tt> <tt class="py-op">=</tt> <tt class="py-name">hooks_path</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_execution_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">hooks_execution_fn</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_results_adapt_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">hooks_results_adapt_fn</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">build_env_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">build_env_fn</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">log_fn</tt> <tt class="py-op">=</tt> <tt class="py-name">log_fn</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">htype</tt> <tt class="py-op">=</tt> <tt class="py-name">htype</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">cluster_name</tt> <tt class="py-op">=</tt> <tt class="py-name">cluster_name</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">master_name</tt> <tt class="py-op">=</tt> <tt class="py-name">master_name</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line"> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Method ganeti.hooksmaster.HooksMaster._BuildEnv()=ganeti.hooksmaster.HooksMaster-class.html#_BuildEnv"><a title="ganeti.hooksmaster.HooksMaster._BuildEnv" class="py-name" href="#" onclick="return doclink('link-10', '_BuildEnv', 'link-10');">_BuildEnv</a></tt><tt class="py-op">(</tt><tt id="link-11" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-11', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Variable ganeti.constants.HOOKS_PHASE_PRE=ganeti.constants-module.html#HOOKS_PHASE_PRE"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-12', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">)</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">    <tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_nodes</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">post_nodes</tt><tt class="py-op">)</tt> <tt class="py-op">=</tt> <tt class="py-name">nodes</tt> </tt>
</div><a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster._BuildEnv"></a><div id="HooksMaster._BuildEnv-def"><a name="L97"></a><tt class="py-lineno"> 97</tt> <a class="py-toggle" href="#" id="HooksMaster._BuildEnv-toggle" onclick="return toggle('HooksMaster._BuildEnv');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#_BuildEnv">_BuildEnv</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster._BuildEnv-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster._BuildEnv-expanded"><a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">    <tt class="py-docstring">"""Compute the environment and the target nodes.</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"><tt class="py-docstring">    Based on the opcode and the current node list, this builds the</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line"><tt class="py-docstring">    environment for the hooks and the target node list for the run.</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-13" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-13', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-14" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-14', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">      <tt class="py-name">prefix</tt> <tt class="py-op">=</tt> <tt class="py-string">"GANETI_"</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-15" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-15', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Variable ganeti.constants.HOOKS_PHASE_POST=ganeti.constants-module.html#HOOKS_PHASE_POST"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-16', 'HOOKS_PHASE_POST', 'link-16');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">      <tt class="py-name">prefix</tt> <tt class="py-op">=</tt> <tt class="py-string">"GANETI_POST_"</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line"> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line"> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_path</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">      <tt class="py-name">phase_env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">build_env_fn</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">phase_env</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">        <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt id="link-17" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-17', 'compat', 'link-7');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">upper</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-name">prefix</tt><tt class="py-op">)</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">                              <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">phase_env</tt><tt class="py-op">)</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">        <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-string">"%s%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">prefix</tt><tt class="py-op">,</tt> <tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">)</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">                   <tt class="py-keyword">for</tt> <tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">phase_env</tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line"> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-18" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-18', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-19', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt id="link-20" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-20', 'compat', 'link-7');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_"</tt><tt class="py-op">)</tt> <tt class="py-keyword">and</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">                         <tt class="py-keyword">not</tt> <tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                        <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line"> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-21" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-21', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-22', 'HOOKS_PHASE_POST', 'link-16');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt id="link-23" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-23', 'compat', 'link-7');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">,</tt> <tt class="py-name">dict</tt><tt class="py-op">)</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line"> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">      <tt class="py-comment"># Merge with pre-phase environment</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">      <tt class="py-keyword">assert</tt> <tt class="py-keyword">not</tt> <tt id="link-24" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-24', 'compat', 'link-7');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">any</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_POST_"</tt><tt class="py-op">)</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">                            <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line"> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">env</tt> </tt>
</div><a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster._RunWrapper"></a><div id="HooksMaster._RunWrapper-def"><a name="L139"></a><tt class="py-lineno">139</tt> <a class="py-toggle" href="#" id="HooksMaster._RunWrapper-toggle" onclick="return toggle('HooksMaster._RunWrapper');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#_RunWrapper">_RunWrapper</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">node_list</tt><tt class="py-op">,</tt> <tt class="py-param">hpath</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">,</tt> <tt class="py-param">phase_env</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster._RunWrapper-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster._RunWrapper-expanded"><a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">    <tt class="py-docstring">"""Simple wrapper over self.callfn.</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line"><tt class="py-docstring">    This method fixes the environment before executing the hooks.</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">      <tt class="py-string">"PATH"</tt><tt class="py-op">:</tt> <tt id="link-25" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-25', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-26" class="py-name" targets="Variable ganeti.constants.HOOKS_PATH=ganeti.constants-module.html#HOOKS_PATH"><a title="ganeti.constants.HOOKS_PATH" class="py-name" href="#" onclick="return doclink('link-26', 'HOOKS_PATH', 'link-26');">HOOKS_PATH</a></tt><tt class="py-op">,</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_VERSION"</tt><tt class="py-op">:</tt> <tt id="link-27" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-27', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name" targets="Variable ganeti.constants.HOOKS_VERSION=ganeti.constants-module.html#HOOKS_VERSION"><a title="ganeti.constants.HOOKS_VERSION" class="py-name" href="#" onclick="return doclink('link-28', 'HOOKS_VERSION', 'link-28');">HOOKS_VERSION</a></tt><tt class="py-op">,</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_OP_CODE"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">opcode</tt><tt class="py-op">,</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_DATA_DIR"</tt><tt class="py-op">:</tt> <tt id="link-29" class="py-name"><a title="ganeti.pathutils" class="py-name" href="#" onclick="return doclink('link-29', 'pathutils', 'link-9');">pathutils</a></tt><tt class="py-op">.</tt><tt id="link-30" class="py-name" targets="Variable ganeti.pathutils.DATA_DIR=ganeti.pathutils-module.html#DATA_DIR"><a title="ganeti.pathutils.DATA_DIR" class="py-name" href="#" onclick="return doclink('link-30', 'DATA_DIR', 'link-30');">DATA_DIR</a></tt><tt class="py-op">,</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_PHASE"</tt><tt class="py-op">:</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">      <tt class="py-string">"GANETI_HOOKS_PATH"</tt><tt class="py-op">:</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">      <tt class="py-op">}</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line"> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">htype</tt><tt class="py-op">:</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_OBJECT_TYPE"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">htype</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line"> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">cluster_name</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_CLUSTER"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">cluster_name</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line"> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">master_name</tt> <tt class="py-keyword">is</tt> <tt class="py-keyword">not</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">      <tt class="py-name">env</tt><tt class="py-op">[</tt><tt class="py-string">"GANETI_MASTER"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">master_name</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase_env</tt><tt class="py-op">:</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">      <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt id="link-31" class="py-name"><a title="ganeti.utils" class="py-name" href="#" onclick="return doclink('link-31', 'utils', 'link-5');">utils</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Module ganeti.utils.algo=ganeti.utils.algo-module.html"><a title="ganeti.utils.algo" class="py-name" href="#" onclick="return doclink('link-32', 'algo', 'link-32');">algo</a></tt><tt class="py-op">.</tt><tt class="py-name">JoinDisjointDicts</tt><tt class="py-op">(</tt><tt class="py-name">env</tt><tt class="py-op">,</tt> <tt class="py-name">phase_env</tt><tt class="py-op">)</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line"> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">    <tt class="py-comment"># Convert everything to strings</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">    <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">dict</tt><tt class="py-op">(</tt><tt class="py-op">[</tt><tt class="py-op">(</tt><tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">key</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">val</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-keyword">for</tt> <tt class="py-name">key</tt><tt class="py-op">,</tt> <tt class="py-name">val</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">.</tt><tt class="py-name">iteritems</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line"> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">    <tt class="py-keyword">assert</tt> <tt id="link-33" class="py-name"><a title="ganeti.compat" class="py-name" href="#" onclick="return doclink('link-33', 'compat', 'link-7');">compat</a></tt><tt class="py-op">.</tt><tt class="py-name">all</tt><tt class="py-op">(</tt><tt class="py-name">key</tt> <tt class="py-op">==</tt> <tt class="py-string">"PATH"</tt> <tt class="py-keyword">or</tt> <tt class="py-name">key</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"GANETI_"</tt><tt class="py-op">)</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                      <tt class="py-keyword">for</tt> <tt class="py-name">key</tt> <tt class="py-keyword">in</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line"> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_execution_fn</tt><tt class="py-op">(</tt><tt class="py-name">node_list</tt><tt class="py-op">,</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
</div><a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster.RunPhase"></a><div id="HooksMaster.RunPhase-def"><a name="L174"></a><tt class="py-lineno">174</tt> <a class="py-toggle" href="#" id="HooksMaster.RunPhase-toggle" onclick="return toggle('HooksMaster.RunPhase');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#RunPhase">RunPhase</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">phase</tt><tt class="py-op">,</tt> <tt class="py-param">nodes</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.RunPhase-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.RunPhase-expanded"><a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">    <tt class="py-docstring">"""Run all the scripts for a phase.</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line"><tt class="py-docstring">    This is the main function of the HookMaster.</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"><tt class="py-docstring">    It executes self.hooks_execution_fn, and after running</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line"><tt class="py-docstring">    self.hooks_results_adapt_fn on its results it expects them to be in the form</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line"><tt class="py-docstring">    {node_name: (fail_msg, [(script, result, output), ...]}).</tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line"><tt class="py-docstring">    @param phase: one of L{constants.HOOKS_PHASE_POST} or</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line"><tt class="py-docstring">        L{constants.HOOKS_PHASE_PRE}; it denotes the hooks phase</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line"><tt class="py-docstring">    @param nodes: overrides the predefined list of nodes for the given phase</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line"><tt class="py-docstring">    @return: the processed results of the hooks multi-node rpc call</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line"><tt class="py-docstring">    @raise errors.HooksFailure: on communication failure to the nodes</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line"><tt class="py-docstring">    @raise errors.HooksAbort: on failure of one of the hooks</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-34" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-34', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-35" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-35', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">nodes</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">        <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_nodes</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">      <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">    <tt class="py-keyword">elif</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-36" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-36', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-37', 'HOOKS_PHASE_POST', 'link-16');">HOOKS_PHASE_POST</a></tt><tt class="py-op">:</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">nodes</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">        <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">post_nodes</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">      <tt class="py-name">env</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-38" class="py-name"><a title="ganeti.hooksmaster.HooksMaster._BuildEnv" class="py-name" href="#" onclick="return doclink('link-38', '_BuildEnv', 'link-10');">_BuildEnv</a></tt><tt class="py-op">(</tt><tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt class="py-name">AssertionError</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown phase '%s'"</tt> <tt class="py-op">%</tt> <tt class="py-name">phase</tt><tt class="py-op">)</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line"> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">nodes</tt><tt class="py-op">:</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">      <tt class="py-comment"># empty node list, we should not attempt to run this as either</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">      <tt class="py-comment"># we're in the cluster init phase and the rpc client part can't</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">      <tt class="py-comment"># even attempt to run, or this LU doesn't do hooks at all</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">      <tt class="py-keyword">return</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">    <tt class="py-name">results</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-39" class="py-name" targets="Method ganeti.hooksmaster.HooksMaster._RunWrapper()=ganeti.hooksmaster.HooksMaster-class.html#_RunWrapper"><a title="ganeti.hooksmaster.HooksMaster._RunWrapper" class="py-name" href="#" onclick="return doclink('link-39', '_RunWrapper', 'link-39');">_RunWrapper</a></tt><tt class="py-op">(</tt><tt class="py-name">nodes</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_path</tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">env</tt><tt class="py-op">)</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">results</tt><tt class="py-op">:</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">      <tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt class="py-string">"Communication Failure"</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-40" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-40', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-41" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-41', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-42" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-42', 'errors', 'link-3');">errors</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name" targets="Class ganeti.errors.HooksFailure=ganeti.errors.HooksFailure-class.html"><a title="ganeti.errors.HooksFailure" class="py-name" href="#" onclick="return doclink('link-43', 'HooksFailure', 'link-43');">HooksFailure</a></tt><tt class="py-op">(</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">      <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">log_fn</tt><tt class="py-op">(</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">results</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">    <tt class="py-name">converted_res</tt> <tt class="py-op">=</tt> <tt class="py-name">results</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_results_adapt_fn</tt><tt class="py-op">:</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">      <tt class="py-name">converted_res</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">hooks_results_adapt_fn</tt><tt class="py-op">(</tt><tt class="py-name">results</tt><tt class="py-op">)</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line"> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">    <tt class="py-name">errs</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-op">(</tt><tt class="py-name">fail_msg</tt><tt class="py-op">,</tt> <tt class="py-name">offline</tt><tt class="py-op">,</tt> <tt class="py-name">hooks_results</tt><tt class="py-op">)</tt> <tt class="py-keyword">in</tt> <tt class="py-name">converted_res</tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">offline</tt><tt class="py-op">:</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">        <tt class="py-keyword">continue</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">      <tt class="py-keyword">if</tt> <tt class="py-name">fail_msg</tt><tt class="py-op">:</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">log_fn</tt><tt class="py-op">(</tt><tt class="py-string">"Communication failure to node %s: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">fail_msg</tt><tt class="py-op">)</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">        <tt class="py-keyword">continue</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line"> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line">      <tt class="py-keyword">for</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt class="py-name">hkr</tt><tt class="py-op">,</tt> <tt id="link-44" class="py-name" targets="Variable ganeti.utils.process.RunResult.output=ganeti.utils.process.RunResult-class.html#output"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-44', 'output', 'link-44');">output</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">hooks_results</tt><tt class="py-op">:</tt> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hkr</tt> <tt class="py-op">==</tt> <tt id="link-45" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-45', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-46" class="py-name" targets="Variable ganeti.constants.HKR_FAIL=ganeti.constants-module.html#HKR_FAIL"><a title="ganeti.constants.HKR_FAIL" class="py-name" href="#" onclick="return doclink('link-46', 'HKR_FAIL', 'link-46');">HKR_FAIL</a></tt><tt class="py-op">:</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">          <tt class="py-keyword">if</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-47" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-47', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-48', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">            <tt class="py-name">errs</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt id="link-49" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-49', 'output', 'link-44');">output</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line">          <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-50" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-50', 'output', 'link-44');">output</a></tt><tt class="py-op">:</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">              <tt id="link-51" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-51', 'output', 'link-44');">output</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"(no output)"</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">log_fn</tt><tt class="py-op">(</tt><tt class="py-string">"On %s script %s failed, output: %s"</tt> <tt class="py-op">%</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">                        <tt class="py-op">(</tt><tt class="py-name">node_name</tt><tt class="py-op">,</tt> <tt class="py-name">script</tt><tt class="py-op">,</tt> <tt id="link-52" class="py-name"><a title="ganeti.utils.process.RunResult.output" class="py-name" href="#" onclick="return doclink('link-52', 'output', 'link-44');">output</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line"> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">errs</tt> <tt class="py-keyword">and</tt> <tt class="py-name">phase</tt> <tt class="py-op">==</tt> <tt id="link-53" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-53', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_PRE" class="py-name" href="#" onclick="return doclink('link-54', 'HOOKS_PHASE_PRE', 'link-12');">HOOKS_PHASE_PRE</a></tt><tt class="py-op">:</tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">      <tt class="py-keyword">raise</tt> <tt id="link-55" class="py-name"><a title="ganeti.errors" class="py-name" href="#" onclick="return doclink('link-55', 'errors', 'link-3');">errors</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name" targets="Class ganeti.errors.HooksAbort=ganeti.errors.HooksAbort-class.html"><a title="ganeti.errors.HooksAbort" class="py-name" href="#" onclick="return doclink('link-56', 'HooksAbort', 'link-56');">HooksAbort</a></tt><tt class="py-op">(</tt><tt class="py-name">errs</tt><tt class="py-op">)</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line"> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">results</tt> </tt>
</div><a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line"> </tt>
<a name="HooksMaster.RunConfigUpdate"></a><div id="HooksMaster.RunConfigUpdate-def"><a name="L244"></a><tt class="py-lineno">244</tt> <a class="py-toggle" href="#" id="HooksMaster.RunConfigUpdate-toggle" onclick="return toggle('HooksMaster.RunConfigUpdate');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#RunConfigUpdate">RunConfigUpdate</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.RunConfigUpdate-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.RunConfigUpdate-expanded"><a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">    <tt class="py-docstring">"""Run the special configuration update hook</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line"><tt class="py-docstring">    This is a special hook that runs only on the master after each</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line"><tt class="py-docstring">    top-level LI if the configuration has been updated.</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">    <tt class="py-name">phase</tt> <tt class="py-op">=</tt> <tt id="link-57" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-57', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="ganeti.constants.HOOKS_PHASE_POST" class="py-name" href="#" onclick="return doclink('link-58', 'HOOKS_PHASE_POST', 'link-16');">HOOKS_PHASE_POST</a></tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">    <tt class="py-name">hpath</tt> <tt class="py-op">=</tt> <tt id="link-59" class="py-name"><a title="ganeti.constants" class="py-name" href="#" onclick="return doclink('link-59', 'constants', 'link-1');">constants</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name" targets="Variable ganeti.constants.HOOKS_NAME_CFGUPDATE=ganeti.constants-module.html#HOOKS_NAME_CFGUPDATE"><a title="ganeti.constants.HOOKS_NAME_CFGUPDATE" class="py-name" href="#" onclick="return doclink('link-60', 'HOOKS_NAME_CFGUPDATE', 'link-60');">HOOKS_NAME_CFGUPDATE</a></tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">    <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">master_name</tt><tt class="py-op">]</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-61" class="py-name"><a title="ganeti.hooksmaster.HooksMaster._RunWrapper" class="py-name" href="#" onclick="return doclink('link-61', '_RunWrapper', 'link-39');">_RunWrapper</a></tt><tt class="py-op">(</tt><tt class="py-name">nodes</tt><tt class="py-op">,</tt> <tt class="py-name">hpath</tt><tt class="py-op">,</tt> <tt class="py-name">phase</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">pre_env</tt><tt class="py-op">)</tt> </tt>
</div><a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line"> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">  <tt class="py-decorator">@</tt><tt class="py-decorator">staticmethod</tt> </tt>
<a name="HooksMaster.BuildFromLu"></a><div id="HooksMaster.BuildFromLu-def"><a name="L257"></a><tt class="py-lineno">257</tt> <a class="py-toggle" href="#" id="HooksMaster.BuildFromLu-toggle" onclick="return toggle('HooksMaster.BuildFromLu');">-</a><tt class="py-line">  <tt class="py-keyword">def</tt> <a class="py-def-name" href="ganeti.hooksmaster.HooksMaster-class.html#BuildFromLu">BuildFromLu</a><tt class="py-op">(</tt><tt class="py-param">hooks_execution_fn</tt><tt class="py-op">,</tt> <tt class="py-param">lu</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="HooksMaster.BuildFromLu-collapsed" style="display:none;" pad="+++" indent="++++++"></div><div id="HooksMaster.BuildFromLu-expanded"><a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-62" class="py-name" targets="Variable ganeti.cmdlib.LUBackupExport.HPATH=ganeti.cmdlib.LUBackupExport-class.html#HPATH,Variable ganeti.cmdlib.LUClusterDestroy.HPATH=ganeti.cmdlib.LUClusterDestroy-class.html#HPATH,Variable ganeti.cmdlib.LUClusterPostInit.HPATH=ganeti.cmdlib.LUClusterPostInit-class.html#HPATH,Variable ganeti.cmdlib.LUClusterRename.HPATH=ganeti.cmdlib.LUClusterRename-class.html#HPATH,Variable ganeti.cmdlib.LUClusterSetParams.HPATH=ganeti.cmdlib.LUClusterSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUClusterVerifyGroup.HPATH=ganeti.cmdlib.LUClusterVerifyGroup-class.html#HPATH,Variable ganeti.cmdlib.LUGroupAdd.HPATH=ganeti.cmdlib.LUGroupAdd-class.html#HPATH,Variable ganeti.cmdlib.LUGroupEvacuate.HPATH=ganeti.cmdlib.LUGroupEvacuate-class.html#HPATH,Variable ganeti.cmdlib.LUGroupRemove.HPATH=ganeti.cmdlib.LUGroupRemove-class.html#HPATH,Variable ganeti.cmdlib.LUGroupRename.HPATH=ganeti.cmdlib.LUGroupRename-class.html#HPATH,Variable ganeti.cmdlib.LUGroupSetParams.HPATH=ganeti.cmdlib.LUGroupSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceChangeGroup.HPATH=ganeti.cmdlib.LUInstanceChangeGroup-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceCreate.HPATH=ganeti.cmdlib.LUInstanceCreate-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceFailover.HPATH=ganeti.cmdlib.LUInstanceFailover-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceGrowDisk.HPATH=ganeti.cmdlib.LUInstanceGrowDisk-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceMigrate.HPATH=ganeti.cmdlib.LUInstanceMigrate-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceMove.HPATH=ganeti.cmdlib.LUInstanceMove-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReboot.HPATH=ganeti.cmdlib.LUInstanceReboot-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRecreateDisks.HPATH=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReinstall.HPATH=ganeti.cmdlib.LUInstanceReinstall-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRemove.HPATH=ganeti.cmdlib.LUInstanceRemove-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceRename.HPATH=ganeti.cmdlib.LUInstanceRename-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceReplaceDisks.HPATH=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceSetParams.HPATH=ganeti.cmdlib.LUInstanceSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceShutdown.HPATH=ganeti.cmdlib.LUInstanceShutdown-class.html#HPATH,Variable ganeti.cmdlib.LUInstanceStartup.HPATH=ganeti.cmdlib.LUInstanceStartup-class.html#HPATH,Variable ganeti.cmdlib.LUNetworkAdd.HPATH=ganeti.cmdlib.LUNetworkAdd-class.html#HPATH,Variable ganeti.cmdlib.LUNetworkConnect.HPATH=ganeti.cmdlib.LUNetworkConnect-class.html#HPATH,Variable ganeti.cmdlib.LUNetworkDisconnect.HPATH=ganeti.cmdlib.LUNetworkDisconnect-class.html#HPATH,Variable ganeti.cmdlib.LUNetworkRemove.HPATH=ganeti.cmdlib.LUNetworkRemove-class.html#HPATH,Variable ganeti.cmdlib.LUNetworkSetParams.HPATH=ganeti.cmdlib.LUNetworkSetParams-class.html#HPATH,Variable ganeti.cmdlib.LUNodeAdd.HPATH=ganeti.cmdlib.LUNodeAdd-class.html#HPATH,Variable ganeti.cmdlib.LUNodeMigrate.HPATH=ganeti.cmdlib.LUNodeMigrate-class.html#HPATH,Variable ganeti.cmdlib.LUNodeRemove.HPATH=ganeti.cmdlib.LUNodeRemove-class.html#HPATH,Variable ganeti.cmdlib.LUNodeSetParams.HPATH=ganeti.cmdlib.LUNodeSetParams-class.html#HPATH,Variable ganeti.cmdlib.LogicalUnit.HPATH=ganeti.cmdlib.LogicalUnit-class.html#HPATH,Variable ganeti.cmdlib.NoHooksLU.HPATH=ganeti.cmdlib.NoHooksLU-class.html#HPATH"><a title="ganeti.cmdlib.LUBackupExport.HPATH
ganeti.cmdlib.LUClusterDestroy.HPATH
ganeti.cmdlib.LUClusterPostInit.HPATH
ganeti.cmdlib.LUClusterRename.HPATH
ganeti.cmdlib.LUClusterSetParams.HPATH
ganeti.cmdlib.LUClusterVerifyGroup.HPATH
ganeti.cmdlib.LUGroupAdd.HPATH
ganeti.cmdlib.LUGroupEvacuate.HPATH
ganeti.cmdlib.LUGroupRemove.HPATH
ganeti.cmdlib.LUGroupRename.HPATH
ganeti.cmdlib.LUGroupSetParams.HPATH
ganeti.cmdlib.LUInstanceChangeGroup.HPATH
ganeti.cmdlib.LUInstanceCreate.HPATH
ganeti.cmdlib.LUInstanceFailover.HPATH
ganeti.cmdlib.LUInstanceGrowDisk.HPATH
ganeti.cmdlib.LUInstanceMigrate.HPATH
ganeti.cmdlib.LUInstanceMove.HPATH
ganeti.cmdlib.LUInstanceReboot.HPATH
ganeti.cmdlib.LUInstanceRecreateDisks.HPATH
ganeti.cmdlib.LUInstanceReinstall.HPATH
ganeti.cmdlib.LUInstanceRemove.HPATH
ganeti.cmdlib.LUInstanceRename.HPATH
ganeti.cmdlib.LUInstanceReplaceDisks.HPATH
ganeti.cmdlib.LUInstanceSetParams.HPATH
ganeti.cmdlib.LUInstanceShutdown.HPATH
ganeti.cmdlib.LUInstanceStartup.HPATH
ganeti.cmdlib.LUNetworkAdd.HPATH
ganeti.cmdlib.LUNetworkConnect.HPATH
ganeti.cmdlib.LUNetworkDisconnect.HPATH
ganeti.cmdlib.LUNetworkRemove.HPATH
ganeti.cmdlib.LUNetworkSetParams.HPATH
ganeti.cmdlib.LUNodeAdd.HPATH
ganeti.cmdlib.LUNodeMigrate.HPATH
ganeti.cmdlib.LUNodeRemove.HPATH
ganeti.cmdlib.LUNodeSetParams.HPATH
ganeti.cmdlib.LogicalUnit.HPATH
ganeti.cmdlib.NoHooksLU.HPATH" class="py-name" href="#" onclick="return doclink('link-62', 'HPATH', 'link-62');">HPATH</a></tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">      <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">      <tt class="py-name">nodes</tt> <tt class="py-op">=</tt> <tt class="py-name">map</tt><tt class="py-op">(</tt><tt class="py-name">frozenset</tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-63" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.BuildHooksNodes()=ganeti.cmdlib.LUBackupExport-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterDestroy.BuildHooksNodes()=ganeti.cmdlib.LUClusterDestroy-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterPostInit.BuildHooksNodes()=ganeti.cmdlib.LUClusterPostInit-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterRename.BuildHooksNodes()=ganeti.cmdlib.LUClusterRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterSetParams.BuildHooksNodes()=ganeti.cmdlib.LUClusterSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksNodes()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupAdd.BuildHooksNodes()=ganeti.cmdlib.LUGroupAdd-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupEvacuate.BuildHooksNodes()=ganeti.cmdlib.LUGroupEvacuate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupRemove.BuildHooksNodes()=ganeti.cmdlib.LUGroupRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupRename.BuildHooksNodes()=ganeti.cmdlib.LUGroupRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUGroupSetParams.BuildHooksNodes()=ganeti.cmdlib.LUGroupSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksNodes()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceCreate.BuildHooksNodes()=ganeti.cmdlib.LUInstanceCreate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceFailover.BuildHooksNodes()=ganeti.cmdlib.LUInstanceFailover-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksNodes()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceMigrate.BuildHooksNodes()=ganeti.cmdlib.LUInstanceMigrate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceMove.BuildHooksNodes()=ganeti.cmdlib.LUInstanceMove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReboot.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReboot-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReinstall.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReinstall-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRemove.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceRename.BuildHooksNodes()=ganeti.cmdlib.LUInstanceRename-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksNodes()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceSetParams.BuildHooksNodes()=ganeti.cmdlib.LUInstanceSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceShutdown.BuildHooksNodes()=ganeti.cmdlib.LUInstanceShutdown-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUInstanceStartup.BuildHooksNodes()=ganeti.cmdlib.LUInstanceStartup-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNetworkAdd.BuildHooksNodes()=ganeti.cmdlib.LUNetworkAdd-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNetworkConnect.BuildHooksNodes()=ganeti.cmdlib.LUNetworkConnect-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNetworkDisconnect.BuildHooksNodes()=ganeti.cmdlib.LUNetworkDisconnect-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNetworkRemove.BuildHooksNodes()=ganeti.cmdlib.LUNetworkRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNetworkSetParams.BuildHooksNodes()=ganeti.cmdlib.LUNetworkSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeAdd.BuildHooksNodes()=ganeti.cmdlib.LUNodeAdd-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeMigrate.BuildHooksNodes()=ganeti.cmdlib.LUNodeMigrate-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeRemove.BuildHooksNodes()=ganeti.cmdlib.LUNodeRemove-class.html#BuildHooksNodes,Method ganeti.cmdlib.LUNodeSetParams.BuildHooksNodes()=ganeti.cmdlib.LUNodeSetParams-class.html#BuildHooksNodes,Method ganeti.cmdlib.LogicalUnit.BuildHooksNodes()=ganeti.cmdlib.LogicalUnit-class.html#BuildHooksNodes,Method ganeti.cmdlib.NoHooksLU.BuildHooksNodes()=ganeti.cmdlib.NoHooksLU-class.html#BuildHooksNodes"><a title="ganeti.cmdlib.LUBackupExport.BuildHooksNodes
ganeti.cmdlib.LUClusterDestroy.BuildHooksNodes
ganeti.cmdlib.LUClusterPostInit.BuildHooksNodes
ganeti.cmdlib.LUClusterRename.BuildHooksNodes
ganeti.cmdlib.LUClusterSetParams.BuildHooksNodes
ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksNodes
ganeti.cmdlib.LUGroupAdd.BuildHooksNodes
ganeti.cmdlib.LUGroupEvacuate.BuildHooksNodes
ganeti.cmdlib.LUGroupRemove.BuildHooksNodes
ganeti.cmdlib.LUGroupRename.BuildHooksNodes
ganeti.cmdlib.LUGroupSetParams.BuildHooksNodes
ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksNodes
ganeti.cmdlib.LUInstanceCreate.BuildHooksNodes
ganeti.cmdlib.LUInstanceFailover.BuildHooksNodes
ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksNodes
ganeti.cmdlib.LUInstanceMigrate.BuildHooksNodes
ganeti.cmdlib.LUInstanceMove.BuildHooksNodes
ganeti.cmdlib.LUInstanceReboot.BuildHooksNodes
ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksNodes
ganeti.cmdlib.LUInstanceReinstall.BuildHooksNodes
ganeti.cmdlib.LUInstanceRemove.BuildHooksNodes
ganeti.cmdlib.LUInstanceRename.BuildHooksNodes
ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksNodes
ganeti.cmdlib.LUInstanceSetParams.BuildHooksNodes
ganeti.cmdlib.LUInstanceShutdown.BuildHooksNodes
ganeti.cmdlib.LUInstanceStartup.BuildHooksNodes
ganeti.cmdlib.LUNetworkAdd.BuildHooksNodes
ganeti.cmdlib.LUNetworkConnect.BuildHooksNodes
ganeti.cmdlib.LUNetworkDisconnect.BuildHooksNodes
ganeti.cmdlib.LUNetworkRemove.BuildHooksNodes
ganeti.cmdlib.LUNetworkSetParams.BuildHooksNodes
ganeti.cmdlib.LUNodeAdd.BuildHooksNodes
ganeti.cmdlib.LUNodeMigrate.BuildHooksNodes
ganeti.cmdlib.LUNodeRemove.BuildHooksNodes
ganeti.cmdlib.LUNodeSetParams.BuildHooksNodes
ganeti.cmdlib.LogicalUnit.BuildHooksNodes
ganeti.cmdlib.NoHooksLU.BuildHooksNodes" class="py-name" href="#" onclick="return doclink('link-63', 'BuildHooksNodes', 'link-63');">BuildHooksNodes</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line"> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">    <tt class="py-name">master_name</tt> <tt class="py-op">=</tt> <tt class="py-name">cluster_name</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">:</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line">      <tt class="py-name">master_name</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-64" class="py-name" targets="Method ganeti.config.ConfigWriter.GetMasterNode()=ganeti.config.ConfigWriter-class.html#GetMasterNode,Method ganeti.ssconf.SimpleStore.GetMasterNode()=ganeti.ssconf.SimpleStore-class.html#GetMasterNode"><a title="ganeti.config.ConfigWriter.GetMasterNode
ganeti.ssconf.SimpleStore.GetMasterNode" class="py-name" href="#" onclick="return doclink('link-64', 'GetMasterNode', 'link-64');">GetMasterNode</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">      <tt class="py-name">cluster_name</tt> <tt class="py-op">=</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">cfg</tt><tt class="py-op">.</tt><tt id="link-65" class="py-name" targets="Method ganeti.config.ConfigWriter.GetClusterName()=ganeti.config.ConfigWriter-class.html#GetClusterName,Method ganeti.ssconf.SimpleStore.GetClusterName()=ganeti.ssconf.SimpleStore-class.html#GetClusterName"><a title="ganeti.config.ConfigWriter.GetClusterName
ganeti.ssconf.SimpleStore.GetClusterName" class="py-name" href="#" onclick="return doclink('link-65', 'GetClusterName', 'link-65');">GetClusterName</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line"> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt id="link-66" class="py-name" targets="Class ganeti.hooksmaster.HooksMaster=ganeti.hooksmaster.HooksMaster-class.html"><a title="ganeti.hooksmaster.HooksMaster" class="py-name" href="#" onclick="return doclink('link-66', 'HooksMaster', 'link-66');">HooksMaster</a></tt><tt class="py-op">(</tt><tt class="py-name">lu</tt><tt class="py-op">.</tt><tt class="py-name">op</tt><tt class="py-op">.</tt><tt class="py-name">OP_ID</tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-67" class="py-name"><a title="ganeti.cmdlib.LUBackupExport.HPATH
ganeti.cmdlib.LUClusterDestroy.HPATH
ganeti.cmdlib.LUClusterPostInit.HPATH
ganeti.cmdlib.LUClusterRename.HPATH
ganeti.cmdlib.LUClusterSetParams.HPATH
ganeti.cmdlib.LUClusterVerifyGroup.HPATH
ganeti.cmdlib.LUGroupAdd.HPATH
ganeti.cmdlib.LUGroupEvacuate.HPATH
ganeti.cmdlib.LUGroupRemove.HPATH
ganeti.cmdlib.LUGroupRename.HPATH
ganeti.cmdlib.LUGroupSetParams.HPATH
ganeti.cmdlib.LUInstanceChangeGroup.HPATH
ganeti.cmdlib.LUInstanceCreate.HPATH
ganeti.cmdlib.LUInstanceFailover.HPATH
ganeti.cmdlib.LUInstanceGrowDisk.HPATH
ganeti.cmdlib.LUInstanceMigrate.HPATH
ganeti.cmdlib.LUInstanceMove.HPATH
ganeti.cmdlib.LUInstanceReboot.HPATH
ganeti.cmdlib.LUInstanceRecreateDisks.HPATH
ganeti.cmdlib.LUInstanceReinstall.HPATH
ganeti.cmdlib.LUInstanceRemove.HPATH
ganeti.cmdlib.LUInstanceRename.HPATH
ganeti.cmdlib.LUInstanceReplaceDisks.HPATH
ganeti.cmdlib.LUInstanceSetParams.HPATH
ganeti.cmdlib.LUInstanceShutdown.HPATH
ganeti.cmdlib.LUInstanceStartup.HPATH
ganeti.cmdlib.LUNetworkAdd.HPATH
ganeti.cmdlib.LUNetworkConnect.HPATH
ganeti.cmdlib.LUNetworkDisconnect.HPATH
ganeti.cmdlib.LUNetworkRemove.HPATH
ganeti.cmdlib.LUNetworkSetParams.HPATH
ganeti.cmdlib.LUNodeAdd.HPATH
ganeti.cmdlib.LUNodeMigrate.HPATH
ganeti.cmdlib.LUNodeRemove.HPATH
ganeti.cmdlib.LUNodeSetParams.HPATH
ganeti.cmdlib.LogicalUnit.HPATH
ganeti.cmdlib.NoHooksLU.HPATH" class="py-name" href="#" onclick="return doclink('link-67', 'HPATH', 'link-62');">HPATH</a></tt><tt class="py-op">,</tt> <tt class="py-name">nodes</tt><tt class="py-op">,</tt> <tt class="py-name">hooks_execution_fn</tt><tt class="py-op">,</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">                       <tt id="link-68" class="py-name" targets="Function ganeti.hooksmaster._RpcResultsToHooksResults()=ganeti.hooksmaster-module.html#_RpcResultsToHooksResults"><a title="ganeti.hooksmaster._RpcResultsToHooksResults" class="py-name" href="#" onclick="return doclink('link-68', '_RpcResultsToHooksResults', 'link-68');">_RpcResultsToHooksResults</a></tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-69" class="py-name" targets="Method ganeti.cmdlib.LUBackupExport.BuildHooksEnv()=ganeti.cmdlib.LUBackupExport-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterDestroy.BuildHooksEnv()=ganeti.cmdlib.LUClusterDestroy-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterPostInit.BuildHooksEnv()=ganeti.cmdlib.LUClusterPostInit-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterRename.BuildHooksEnv()=ganeti.cmdlib.LUClusterRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterSetParams.BuildHooksEnv()=ganeti.cmdlib.LUClusterSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksEnv()=ganeti.cmdlib.LUClusterVerifyGroup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupAdd.BuildHooksEnv()=ganeti.cmdlib.LUGroupAdd-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupEvacuate.BuildHooksEnv()=ganeti.cmdlib.LUGroupEvacuate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupRemove.BuildHooksEnv()=ganeti.cmdlib.LUGroupRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupRename.BuildHooksEnv()=ganeti.cmdlib.LUGroupRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUGroupSetParams.BuildHooksEnv()=ganeti.cmdlib.LUGroupSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksEnv()=ganeti.cmdlib.LUInstanceChangeGroup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceCreate.BuildHooksEnv()=ganeti.cmdlib.LUInstanceCreate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceFailover.BuildHooksEnv()=ganeti.cmdlib.LUInstanceFailover-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksEnv()=ganeti.cmdlib.LUInstanceGrowDisk-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceMigrate.BuildHooksEnv()=ganeti.cmdlib.LUInstanceMigrate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceMove.BuildHooksEnv()=ganeti.cmdlib.LUInstanceMove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReboot.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReboot-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReinstall.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReinstall-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRemove.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceRename.BuildHooksEnv()=ganeti.cmdlib.LUInstanceRename-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksEnv()=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceSetParams.BuildHooksEnv()=ganeti.cmdlib.LUInstanceSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceShutdown.BuildHooksEnv()=ganeti.cmdlib.LUInstanceShutdown-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUInstanceStartup.BuildHooksEnv()=ganeti.cmdlib.LUInstanceStartup-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNetworkAdd.BuildHooksEnv()=ganeti.cmdlib.LUNetworkAdd-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNetworkConnect.BuildHooksEnv()=ganeti.cmdlib.LUNetworkConnect-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNetworkDisconnect.BuildHooksEnv()=ganeti.cmdlib.LUNetworkDisconnect-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNetworkRemove.BuildHooksEnv()=ganeti.cmdlib.LUNetworkRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNetworkSetParams.BuildHooksEnv()=ganeti.cmdlib.LUNetworkSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeAdd.BuildHooksEnv()=ganeti.cmdlib.LUNodeAdd-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeMigrate.BuildHooksEnv()=ganeti.cmdlib.LUNodeMigrate-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeRemove.BuildHooksEnv()=ganeti.cmdlib.LUNodeRemove-class.html#BuildHooksEnv,Method ganeti.cmdlib.LUNodeSetParams.BuildHooksEnv()=ganeti.cmdlib.LUNodeSetParams-class.html#BuildHooksEnv,Method ganeti.cmdlib.LogicalUnit.BuildHooksEnv()=ganeti.cmdlib.LogicalUnit-class.html#BuildHooksEnv,Method ganeti.cmdlib.NoHooksLU.BuildHooksEnv()=ganeti.cmdlib.NoHooksLU-class.html#BuildHooksEnv"><a title="ganeti.cmdlib.LUBackupExport.BuildHooksEnv
ganeti.cmdlib.LUClusterDestroy.BuildHooksEnv
ganeti.cmdlib.LUClusterPostInit.BuildHooksEnv
ganeti.cmdlib.LUClusterRename.BuildHooksEnv
ganeti.cmdlib.LUClusterSetParams.BuildHooksEnv
ganeti.cmdlib.LUClusterVerifyGroup.BuildHooksEnv
ganeti.cmdlib.LUGroupAdd.BuildHooksEnv
ganeti.cmdlib.LUGroupEvacuate.BuildHooksEnv
ganeti.cmdlib.LUGroupRemove.BuildHooksEnv
ganeti.cmdlib.LUGroupRename.BuildHooksEnv
ganeti.cmdlib.LUGroupSetParams.BuildHooksEnv
ganeti.cmdlib.LUInstanceChangeGroup.BuildHooksEnv
ganeti.cmdlib.LUInstanceCreate.BuildHooksEnv
ganeti.cmdlib.LUInstanceFailover.BuildHooksEnv
ganeti.cmdlib.LUInstanceGrowDisk.BuildHooksEnv
ganeti.cmdlib.LUInstanceMigrate.BuildHooksEnv
ganeti.cmdlib.LUInstanceMove.BuildHooksEnv
ganeti.cmdlib.LUInstanceReboot.BuildHooksEnv
ganeti.cmdlib.LUInstanceRecreateDisks.BuildHooksEnv
ganeti.cmdlib.LUInstanceReinstall.BuildHooksEnv
ganeti.cmdlib.LUInstanceRemove.BuildHooksEnv
ganeti.cmdlib.LUInstanceRename.BuildHooksEnv
ganeti.cmdlib.LUInstanceReplaceDisks.BuildHooksEnv
ganeti.cmdlib.LUInstanceSetParams.BuildHooksEnv
ganeti.cmdlib.LUInstanceShutdown.BuildHooksEnv
ganeti.cmdlib.LUInstanceStartup.BuildHooksEnv
ganeti.cmdlib.LUNetworkAdd.BuildHooksEnv
ganeti.cmdlib.LUNetworkConnect.BuildHooksEnv
ganeti.cmdlib.LUNetworkDisconnect.BuildHooksEnv
ganeti.cmdlib.LUNetworkRemove.BuildHooksEnv
ganeti.cmdlib.LUNetworkSetParams.BuildHooksEnv
ganeti.cmdlib.LUNodeAdd.BuildHooksEnv
ganeti.cmdlib.LUNodeMigrate.BuildHooksEnv
ganeti.cmdlib.LUNodeRemove.BuildHooksEnv
ganeti.cmdlib.LUNodeSetParams.BuildHooksEnv
ganeti.cmdlib.LogicalUnit.BuildHooksEnv
ganeti.cmdlib.NoHooksLU.BuildHooksEnv" class="py-name" href="#" onclick="return doclink('link-69', 'BuildHooksEnv', 'link-69');">BuildHooksEnv</a></tt><tt class="py-op">,</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">                       <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Method ganeti.mcpu.Processor.LogWarning()=ganeti.mcpu.Processor-class.html#LogWarning"><a title="ganeti.mcpu.Processor.LogWarning" class="py-name" href="#" onclick="return doclink('link-70', 'LogWarning', 'link-70');">LogWarning</a></tt><tt class="py-op">,</tt> <tt class="py-name">lu</tt><tt class="py-op">.</tt><tt id="link-71" class="py-name" targets="Variable ganeti.cmdlib.LUBackupExport.HTYPE=ganeti.cmdlib.LUBackupExport-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterDestroy.HTYPE=ganeti.cmdlib.LUClusterDestroy-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterPostInit.HTYPE=ganeti.cmdlib.LUClusterPostInit-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterRename.HTYPE=ganeti.cmdlib.LUClusterRename-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterSetParams.HTYPE=ganeti.cmdlib.LUClusterSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUClusterVerifyGroup.HTYPE=ganeti.cmdlib.LUClusterVerifyGroup-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupAdd.HTYPE=ganeti.cmdlib.LUGroupAdd-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupEvacuate.HTYPE=ganeti.cmdlib.LUGroupEvacuate-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupRemove.HTYPE=ganeti.cmdlib.LUGroupRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupRename.HTYPE=ganeti.cmdlib.LUGroupRename-class.html#HTYPE,Variable ganeti.cmdlib.LUGroupSetParams.HTYPE=ganeti.cmdlib.LUGroupSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceChangeGroup.HTYPE=ganeti.cmdlib.LUInstanceChangeGroup-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceCreate.HTYPE=ganeti.cmdlib.LUInstanceCreate-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceFailover.HTYPE=ganeti.cmdlib.LUInstanceFailover-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceGrowDisk.HTYPE=ganeti.cmdlib.LUInstanceGrowDisk-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceMigrate.HTYPE=ganeti.cmdlib.LUInstanceMigrate-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceMove.HTYPE=ganeti.cmdlib.LUInstanceMove-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReboot.HTYPE=ganeti.cmdlib.LUInstanceReboot-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRecreateDisks.HTYPE=ganeti.cmdlib.LUInstanceRecreateDisks-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReinstall.HTYPE=ganeti.cmdlib.LUInstanceReinstall-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRemove.HTYPE=ganeti.cmdlib.LUInstanceRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceRename.HTYPE=ganeti.cmdlib.LUInstanceRename-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceReplaceDisks.HTYPE=ganeti.cmdlib.LUInstanceReplaceDisks-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceSetParams.HTYPE=ganeti.cmdlib.LUInstanceSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceShutdown.HTYPE=ganeti.cmdlib.LUInstanceShutdown-class.html#HTYPE,Variable ganeti.cmdlib.LUInstanceStartup.HTYPE=ganeti.cmdlib.LUInstanceStartup-class.html#HTYPE,Variable ganeti.cmdlib.LUNetworkAdd.HTYPE=ganeti.cmdlib.LUNetworkAdd-class.html#HTYPE,Variable ganeti.cmdlib.LUNetworkConnect.HTYPE=ganeti.cmdlib.LUNetworkConnect-class.html#HTYPE,Variable ganeti.cmdlib.LUNetworkDisconnect.HTYPE=ganeti.cmdlib.LUNetworkDisconnect-class.html#HTYPE,Variable ganeti.cmdlib.LUNetworkRemove.HTYPE=ganeti.cmdlib.LUNetworkRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUNetworkSetParams.HTYPE=ganeti.cmdlib.LUNetworkSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeAdd.HTYPE=ganeti.cmdlib.LUNodeAdd-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeMigrate.HTYPE=ganeti.cmdlib.LUNodeMigrate-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeRemove.HTYPE=ganeti.cmdlib.LUNodeRemove-class.html#HTYPE,Variable ganeti.cmdlib.LUNodeSetParams.HTYPE=ganeti.cmdlib.LUNodeSetParams-class.html#HTYPE,Variable ganeti.cmdlib.LogicalUnit.HTYPE=ganeti.cmdlib.LogicalUnit-class.html#HTYPE,Variable ganeti.cmdlib.NoHooksLU.HTYPE=ganeti.cmdlib.NoHooksLU-class.html#HTYPE"><a title="ganeti.cmdlib.LUBackupExport.HTYPE
ganeti.cmdlib.LUClusterDestroy.HTYPE
ganeti.cmdlib.LUClusterPostInit.HTYPE
ganeti.cmdlib.LUClusterRename.HTYPE
ganeti.cmdlib.LUClusterSetParams.HTYPE
ganeti.cmdlib.LUClusterVerifyGroup.HTYPE
ganeti.cmdlib.LUGroupAdd.HTYPE
ganeti.cmdlib.LUGroupEvacuate.HTYPE
ganeti.cmdlib.LUGroupRemove.HTYPE
ganeti.cmdlib.LUGroupRename.HTYPE
ganeti.cmdlib.LUGroupSetParams.HTYPE
ganeti.cmdlib.LUInstanceChangeGroup.HTYPE
ganeti.cmdlib.LUInstanceCreate.HTYPE
ganeti.cmdlib.LUInstanceFailover.HTYPE
ganeti.cmdlib.LUInstanceGrowDisk.HTYPE
ganeti.cmdlib.LUInstanceMigrate.HTYPE
ganeti.cmdlib.LUInstanceMove.HTYPE
ganeti.cmdlib.LUInstanceReboot.HTYPE
ganeti.cmdlib.LUInstanceRecreateDisks.HTYPE
ganeti.cmdlib.LUInstanceReinstall.HTYPE
ganeti.cmdlib.LUInstanceRemove.HTYPE
ganeti.cmdlib.LUInstanceRename.HTYPE
ganeti.cmdlib.LUInstanceReplaceDisks.HTYPE
ganeti.cmdlib.LUInstanceSetParams.HTYPE
ganeti.cmdlib.LUInstanceShutdown.HTYPE
ganeti.cmdlib.LUInstanceStartup.HTYPE
ganeti.cmdlib.LUNetworkAdd.HTYPE
ganeti.cmdlib.LUNetworkConnect.HTYPE
ganeti.cmdlib.LUNetworkDisconnect.HTYPE
ganeti.cmdlib.LUNetworkRemove.HTYPE
ganeti.cmdlib.LUNetworkSetParams.HTYPE
ganeti.cmdlib.LUNodeAdd.HTYPE
ganeti.cmdlib.LUNodeMigrate.HTYPE
ganeti.cmdlib.LUNodeRemove.HTYPE
ganeti.cmdlib.LUNodeSetParams.HTYPE
ganeti.cmdlib.LogicalUnit.HTYPE
ganeti.cmdlib.NoHooksLU.HTYPE" class="py-name" href="#" onclick="return doclink('link-71', 'HTYPE', 'link-71');">HTYPE</a></tt><tt class="py-op">,</tt> <tt class="py-name">cluster_name</tt><tt class="py-op">,</tt> <tt class="py-name">master_name</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://code.google.com/p/ganeti/">Ganeti</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Tue Dec  3 11:32:53 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
