<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.JSON</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Ganeti-JSON.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/JSON.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Infered</td></tr></table><p class="caption">Ganeti.JSON</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">JSON-related functions
</a></li><li><a href="#g:2">Container type (special type for JSON serialisation)
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>JSON utility functions. 
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:JSField">JSField</a> = (String, JSValue)</li><li class="src short"><span class="keyword">type</span> <a href="#t:JSRecord">JSRecord</a> = [<a href="Ganeti-JSON.html#t:JSField">JSField</a>]</li><li class="src short"><a href="#v:fromJResult">fromJResult</a> :: Monad m =&gt; String -&gt; Result a -&gt; m a</li><li class="src short"><a href="#v:readEitherString">readEitherString</a> :: Monad m =&gt; JSValue -&gt; m String</li><li class="src short"><a href="#v:loadJSArray">loadJSArray</a> :: Monad m =&gt; String -&gt; String -&gt; m [JSObject JSValue]</li><li class="src short"><a href="#v:fromObj">fromObj</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; m a</li><li class="src short"><a href="#v:maybeFromObj">maybeFromObj</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; m (Maybe a)</li><li class="src short"><a href="#v:fromObjWithDefault">fromObjWithDefault</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; a -&gt; m a</li><li class="src short"><a href="#v:fromKeyValue">fromKeyValue</a> :: (JSON a, Monad m) =&gt; String -&gt; JSValue -&gt; m a</li><li class="src short"><a href="#v:fromJVal">fromJVal</a> :: (Monad m, JSON a) =&gt; JSValue -&gt; m a</li><li class="src short"><a href="#v:jsonHead">jsonHead</a> :: JSON b =&gt; [a] -&gt; (a -&gt; b) -&gt; JSValue</li><li class="src short"><a href="#v:getMaybeJsonHead">getMaybeJsonHead</a> :: JSON b =&gt; [a] -&gt; (a -&gt; Maybe b) -&gt; JSValue</li><li class="src short"><a href="#v:asJSObject">asJSObject</a> :: Monad m =&gt; JSValue -&gt; m (JSObject JSValue)</li><li class="src short"><a href="#v:asObjectList">asObjectList</a> :: Monad m =&gt; [JSValue] -&gt; m [JSObject JSValue]</li><li class="src short"><a href="#v:tryFromObj">tryFromObj</a> :: JSON a =&gt; String -&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> a</li><li class="src short"><a href="#v:toArray">toArray</a> :: Monad m =&gt; JSValue -&gt; m [JSValue]</li><li class="src short"><a href="#v:optionalJSField">optionalJSField</a> :: JSON a =&gt; String -&gt; Maybe a -&gt; Maybe <a href="Ganeti-JSON.html#t:JSField">JSField</a></li><li class="src short"><a href="#v:optFieldsToObj">optFieldsToObj</a> :: [Maybe <a href="Ganeti-JSON.html#t:JSField">JSField</a>] -&gt; JSValue</li><li class="src short"><span class="keyword">class</span>  <a href="#t:HasStringRepr">HasStringRepr</a> a  <span class="keyword">where</span><ul class="subs"><li><a href="#v:fromStringRepr">fromStringRepr</a> :: Monad m =&gt; String -&gt; m a</li><li><a href="#v:toStringRepr">toStringRepr</a> :: a -&gt; String</li></ul></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:GenericContainer">GenericContainer</a> a b = <a href="#v:GenericContainer">GenericContainer</a> {<ul class="subs"><li><a href="#v:fromContainer">fromContainer</a> :: Map a b</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Container">Container</a> = <a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> String</li><li class="src short"><a href="#v:readContainer">readContainer</a> :: (Monad m, <a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> a, Ord a, JSON b) =&gt; JSObject JSValue -&gt; m (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)</li><li class="src short"><a href="#v:showContainer">showContainer</a> :: (<a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> a, JSON b) =&gt; <a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b -&gt; JSValue</li></ul></div><div id="interface"><h1 id="g:1">JSON-related functions
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:JSField" class="def">JSField</a> = (String, JSValue)<a href="Ganeti/JSON.html#JSField" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:JSRecord" class="def">JSRecord</a> = [<a href="Ganeti-JSON.html#t:JSField">JSField</a>]<a href="Ganeti/JSON.html#JSRecord" class="link">Source</a></p><div class="doc"><p>A type alias for the list-based representation of J.JSObject.
</p></div></div><div class="top"><p class="src"><a name="v:fromJResult" class="def">fromJResult</a> :: Monad m =&gt; String -&gt; Result a -&gt; m a<a href="Ganeti/JSON.html#fromJResult" class="link">Source</a></p><div class="doc"><p>Converts a JSON Result into a monadic value.
</p></div></div><div class="top"><p class="src"><a name="v:readEitherString" class="def">readEitherString</a> :: Monad m =&gt; JSValue -&gt; m String<a href="Ganeti/JSON.html#readEitherString" class="link">Source</a></p><div class="doc"><p>Tries to read a string from a JSON value.
</p><p>In case the value was not a string, we fail the read (in the
 context of the current monad.
</p></div></div><div class="top"><p class="src"><a name="v:loadJSArray" class="def">loadJSArray</a><a href="Ganeti/JSON.html#loadJSArray" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Monad m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; String</td><td class="doc"><p>Operation description (for error reporting)
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>Input message
</p></td></tr><tr><td class="src">-&gt; m [JSObject JSValue]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Converts a JSON message into an array of JSON objects.
</p></div></div><div class="top"><p class="src"><a name="v:fromObj" class="def">fromObj</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; m a<a href="Ganeti/JSON.html#fromObj" class="link">Source</a></p><div class="doc"><p>Reads the value of a key in a JSON object.
</p></div></div><div class="top"><p class="src"><a name="v:maybeFromObj" class="def">maybeFromObj</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; m (Maybe a)<a href="Ganeti/JSON.html#maybeFromObj" class="link">Source</a></p><div class="doc"><p>Reads the value of an optional key in a JSON object. Missing
 keys, or keys that have a 'null' value, will be returned as
 <code>Nothing</code>, otherwise we attempt deserialisation and return a <code>Just</code>
 value.
</p></div></div><div class="top"><p class="src"><a name="v:fromObjWithDefault" class="def">fromObjWithDefault</a> :: (JSON a, Monad m) =&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a> -&gt; String -&gt; a -&gt; m a<a href="Ganeti/JSON.html#fromObjWithDefault" class="link">Source</a></p><div class="doc"><p>Reads the value of a key in a JSON object with a default if
 missing. Note that both missing keys and keys with value 'null'
 will case the default value to be returned.
</p></div></div><div class="top"><p class="src"><a name="v:fromKeyValue" class="def">fromKeyValue</a><a href="Ganeti/JSON.html#fromKeyValue" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (JSON a, Monad m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; String</td><td class="doc"><p>The key name
</p></td></tr><tr><td class="src">-&gt; JSValue</td><td class="doc"><p>The value to read
</p></td></tr><tr><td class="src">-&gt; m a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Reads a JValue, that originated from an object key.
</p></div></div><div class="top"><p class="src"><a name="v:fromJVal" class="def">fromJVal</a> :: (Monad m, JSON a) =&gt; JSValue -&gt; m a<a href="Ganeti/JSON.html#fromJVal" class="link">Source</a></p><div class="doc"><p>Small wrapper over readJSON.
</p></div></div><div class="top"><p class="src"><a name="v:jsonHead" class="def">jsonHead</a> :: JSON b =&gt; [a] -&gt; (a -&gt; b) -&gt; JSValue<a href="Ganeti/JSON.html#jsonHead" class="link">Source</a></p><div class="doc"><p>Helper function that returns Null or first element of the list.
</p></div></div><div class="top"><p class="src"><a name="v:getMaybeJsonHead" class="def">getMaybeJsonHead</a> :: JSON b =&gt; [a] -&gt; (a -&gt; Maybe b) -&gt; JSValue<a href="Ganeti/JSON.html#getMaybeJsonHead" class="link">Source</a></p><div class="doc"><p>Helper for extracting Maybe values from a possibly empty list.
</p></div></div><div class="top"><p class="src"><a name="v:asJSObject" class="def">asJSObject</a> :: Monad m =&gt; JSValue -&gt; m (JSObject JSValue)<a href="Ganeti/JSON.html#asJSObject" class="link">Source</a></p><div class="doc"><p>Converts a JSON value into a JSON object.
</p></div></div><div class="top"><p class="src"><a name="v:asObjectList" class="def">asObjectList</a> :: Monad m =&gt; [JSValue] -&gt; m [JSObject JSValue]<a href="Ganeti/JSON.html#asObjectList" class="link">Source</a></p><div class="doc"><p>Coneverts a list of JSON values into a list of JSON objects.
</p></div></div><div class="top"><p class="src"><a name="v:tryFromObj" class="def">tryFromObj</a><a href="Ganeti/JSON.html#tryFromObj" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: JSON a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; String</td><td class="doc"><p>Textual <a href="owner.html">owner</a> in error messages
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-JSON.html#t:JSRecord">JSRecord</a></td><td class="doc"><p>The object array
</p></td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>The desired key from the object
</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-BasicTypes.html#t:Result">Result</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Try to extract a key from an object with better error reporting
 than fromObj.
</p></div></div><div class="top"><p class="src"><a name="v:toArray" class="def">toArray</a> :: Monad m =&gt; JSValue -&gt; m [JSValue]<a href="Ganeti/JSON.html#toArray" class="link">Source</a></p><div class="doc"><p>Ensure a given JSValue is actually a JSArray.
</p></div></div><div class="top"><p class="src"><a name="v:optionalJSField" class="def">optionalJSField</a> :: JSON a =&gt; String -&gt; Maybe a -&gt; Maybe <a href="Ganeti-JSON.html#t:JSField">JSField</a><a href="Ganeti/JSON.html#optionalJSField" class="link">Source</a></p><div class="doc"><p>Creates a Maybe JSField. If the value string is Nothing, the JSField
 will be Nothing as well.
</p></div></div><div class="top"><p class="src"><a name="v:optFieldsToObj" class="def">optFieldsToObj</a> :: [Maybe <a href="Ganeti-JSON.html#t:JSField">JSField</a>] -&gt; JSValue<a href="Ganeti/JSON.html#optFieldsToObj" class="link">Source</a></p><div class="doc"><p>Creates an object with all the non-Nothing fields of the given list.
</p></div></div><h1 id="g:2">Container type (special type for JSON serialisation)
</h1><div class="top"><p class="src"><span class="keyword">class</span>  <a name="t:HasStringRepr" class="def">HasStringRepr</a> a  <span class="keyword">where</span><a href="Ganeti/JSON.html#HasStringRepr" class="link">Source</a></p><div class="doc"><p>Class of types that can be converted from Strings. This is
 similar to the <code>Read</code> class, but it's using a different
 serialisation format, so we have to define a separate class. Mostly
 useful for custom key types in JSON dictionaries, which have to be
 backed by strings.
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:fromStringRepr" class="def">fromStringRepr</a> :: Monad m =&gt; String -&gt; m a<a href="Ganeti/JSON.html#fromStringRepr" class="link">Source</a></p><p class="src"><a name="v:toStringRepr" class="def">toStringRepr</a> :: a -&gt; String<a href="Ganeti/JSON.html#toStringRepr" class="link">Source</a></p></div><div class="subs instances"><p id="control.i:HasStringRepr" class="caption collapser" onclick="toggleSection('i:HasStringRepr')">Instances</p><div id="section.i:HasStringRepr" class="show"><table><tr><td class="src"><a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> String</td><td class="doc"><p>Trivial instance <code><a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a></code> for <code>String</code>.
</p></td></tr><tr><td class="src"><a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> <a href="Ganeti-Types.html#t:DiskTemplate">DiskTemplate</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:GenericContainer" class="def">GenericContainer</a> a b <a href="Ganeti/JSON.html#GenericContainer" class="link">Source</a></p><div class="doc"><p>The container type, a wrapper over Data.Map
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:GenericContainer" class="def">GenericContainer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:fromContainer" class="def">fromContainer</a> :: Map a b</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:GenericContainer" class="caption collapser" onclick="toggleSection('i:GenericContainer')">Instances</p><div id="section.i:GenericContainer" class="show"><table><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:OsParams">OsParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:ClusterNicParams">ClusterNicParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:ClusterOsParams">ClusterOsParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:ClusterBeParams">ClusterBeParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:OsHvParams">OsHvParams</a></td><td class="doc"><p>No real arbitrary instance for <code><a href="Ganeti-Objects.html#t:OsHvParams">OsHvParams</a></code> yet.
</p></td></tr><tr><td class="src">Arbitrary <a href="Ganeti-Objects.html#t:ClusterHvParams">ClusterHvParams</a></td><td class="doc"><p>No real arbitrary instance for <code><a href="Ganeti-Objects.html#t:ClusterHvParams">ClusterHvParams</a></code> yet.
</p></td></tr><tr><td class="src">(Eq a, Eq b) =&gt; Eq (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(Show a, Show b) =&gt; Show (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(NFData a, NFData b) =&gt; NFData (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> a, Ord a, JSON b) =&gt; JSON (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Container" class="def">Container</a> = <a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> String<a href="Ganeti/JSON.html#Container" class="link">Source</a></p><div class="doc"><p>Type alias for string keys.
</p></div></div><div class="top"><p class="src"><a name="v:readContainer" class="def">readContainer</a> :: (Monad m, <a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> a, Ord a, JSON b) =&gt; JSObject JSValue -&gt; m (<a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b)<a href="Ganeti/JSON.html#readContainer" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:showContainer" class="def">showContainer</a> :: (<a href="Ganeti-JSON.html#t:HasStringRepr">HasStringRepr</a> a, JSON b) =&gt; <a href="Ganeti-JSON.html#t:GenericContainer">GenericContainer</a> a b -&gt; JSValue<a href="Ganeti/JSON.html#showContainer" class="link">Source</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.10.0</p></div></body></html>