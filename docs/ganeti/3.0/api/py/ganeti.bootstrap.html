<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>ganeti.bootstrap</title>
    <meta name="generator" content="pydoctor 22.9.1"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          ganeti/server <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="search-help-button" title="Help" onclick="toggleSearchHelpText()"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div class="hint" id="search-help-box">
          <p class="rst-last">
      
            Search bar offers the following options:
            <ul>   
                <li>
                  <strong>Term presence.</strong> The below example searches for documents that 
                    must contain “foo”, might contain “bar” and must not contain “baz”: <code>+foo bar -baz</code>
                </li> 

                <li>
                  <strong>Wildcards.</strong> The below example searches for documents with words beginning with “foo”: <code>foo*</code>
                </li> 

                <li>
                  <strong>Search in specific fields.</strong> The following search matches all objects 
                  in "twisted.mail" that matches “search”: <code>+qname:twisted.mail.* +search</code>

                  <p>
                    Possible fields: 'name', 'qname' (fully qualified name), 'docstring', and 'kind'.
                    Last two fields are only applicable if "search in docstrings" is enabled.
                  </p>
                </li>

                <li>
                  <strong>Fuzzy matches.</strong> The following search matches all documents 
                  that have a word within 1 edit distance of “foo”: <code>foo~1</code>
                </li>
            </ul>

          </p>
        </div>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 8px;">
          <p>Results provided by <a href="https://lunrjs.com">Lunr.js</a></p>
        </div>
      </div>

    </div>


  </div>
</nav>
    
    <div class="container-fluid">

      <!-- Side navigation -->
      <div class="sidebarcontainer" style="display: none;">
        
        <div class="sidebar"><nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Module</span>
        <code class="thisobject"><a href="ganeti.bootstrap.html" class="internal-link" title="This module">bootstrap</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#FinalizeClusterDestroy" class="internal-link" title="ganeti.bootstrap.FinalizeClusterDestroy"><wbr></wbr>Finalize<wbr></wbr>Cluster<wbr></wbr>Destroy</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#GenerateClusterCrypto" class="internal-link" title="ganeti.bootstrap.GenerateClusterCrypto"><wbr></wbr>Generate<wbr></wbr>Cluster<wbr></wbr>Crypto</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#GenerateHmacKey" class="internal-link" title="ganeti.bootstrap.GenerateHmacKey"><wbr></wbr>Generate<wbr></wbr>Hmac<wbr></wbr>Key</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#GetMaster" class="internal-link" title="ganeti.bootstrap.GetMaster"><wbr></wbr>Get<wbr></wbr>Master</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#InitCluster" class="internal-link" title="ganeti.bootstrap.InitCluster"><wbr></wbr>Init<wbr></wbr>Cluster</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#InitConfig" class="internal-link" title="ganeti.bootstrap.InitConfig"><wbr></wbr>Init<wbr></wbr>Config</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#MajorityHealthy" class="internal-link" title="ganeti.bootstrap.MajorityHealthy"><wbr></wbr>Majority<wbr></wbr>Healthy</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#MasterFailover" class="internal-link" title="ganeti.bootstrap.MasterFailover"><wbr></wbr>Master<wbr></wbr>Failover</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#SetupNodeDaemon" class="internal-link" title="ganeti.bootstrap.SetupNodeDaemon"><wbr></wbr>Setup<wbr></wbr>Node<wbr></wbr>Daemon</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_GatherMasterVotes" class="internal-link" title="ganeti.bootstrap._GatherMasterVotes">_<wbr></wbr>Gather<wbr></wbr>Master<wbr></wbr>Votes</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_InitCheckDrbdHelper" class="internal-link" title="ganeti.bootstrap._InitCheckDrbdHelper">_<wbr></wbr>Init<wbr></wbr>Check<wbr></wbr>Drbd<wbr></wbr>Helper</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_InitCheckEnabledDiskTemplates" class="internal-link" title="ganeti.bootstrap._InitCheckEnabledDiskTemplates">_<wbr></wbr>Init<wbr></wbr>Check<wbr></wbr>Enabled<wbr></wbr>Disk<wbr></wbr>Templates</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_<wbr></wbr>Init<wbr></wbr>File<wbr></wbr>Storage<wbr></wbr>Dir</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_InitGanetiServerSetup" class="internal-link" title="ganeti.bootstrap._InitGanetiServerSetup">_<wbr></wbr>Init<wbr></wbr>Ganeti<wbr></wbr>Server<wbr></wbr>Setup</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_PrepareFileBasedStorage" class="internal-link" title="ganeti.bootstrap._PrepareFileBasedStorage">_<wbr></wbr>Prepare<wbr></wbr>File<wbr></wbr>Based<wbr></wbr>Storage</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_PrepareFileStorage" class="internal-link" title="ganeti.bootstrap._PrepareFileStorage">_<wbr></wbr>Prepare<wbr></wbr>File<wbr></wbr>Storage</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_PrepareGlusterStorage" class="internal-link" title="ganeti.bootstrap._PrepareGlusterStorage">_<wbr></wbr>Prepare<wbr></wbr>Gluster<wbr></wbr>Storage</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_PrepareSharedFileStorage" class="internal-link" title="ganeti.bootstrap._PrepareSharedFileStorage">_<wbr></wbr>Prepare<wbr></wbr>Shared<wbr></wbr>File<wbr></wbr>Storage</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_RestrictIpolicyToEnabledDiskTemplates" class="internal-link" title="ganeti.bootstrap._RestrictIpolicyToEnabledDiskTemplates">_<wbr></wbr>Restrict<wbr></wbr>Ipolicy<wbr></wbr>To<wbr></wbr>Enabled<wbr></wbr>Disk<wbr></wbr>Templates</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_WaitForMasterDaemon" class="internal-link" title="ganeti.bootstrap._WaitForMasterDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Master<wbr></wbr>Daemon</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_WaitForNodeDaemon" class="internal-link" title="ganeti.bootstrap._WaitForNodeDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Node<wbr></wbr>Daemon</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_WaitForSshDaemon" class="internal-link" title="ganeti.bootstrap._WaitForSshDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Ssh<wbr></wbr>Daemon</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_DAEMON_READY_TIMEOUT" class="internal-link" title="ganeti.bootstrap._DAEMON_READY_TIMEOUT">_DAEMON<wbr></wbr>_READY<wbr></wbr>_TIMEOUT</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_INITCONF_ECID" class="internal-link" title="ganeti.bootstrap._INITCONF_ECID">_INITCONF<wbr></wbr>_ECID</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Package</span>
        <code><a href="ganeti.html" class="internal-link" title="The parent of this module">ganeti</a></code> 
      </div>
      
      <div>
        

        <div class="childrenKindTitle">Modules</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.build.html" class="internal-link" title="ganeti.build">build</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.client.html" class="internal-link" title="ganeti.client">client</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.cmdlib.html" class="internal-link" title="ganeti.cmdlib">cmdlib</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.confd.html" class="internal-link" title="ganeti.confd">confd</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.config.html" class="internal-link" title="ganeti.config">config</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.http.html" class="internal-link" title="ganeti.http">http</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.hypervisor.html" class="internal-link" title="ganeti.hypervisor">hypervisor</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.impexpd.html" class="internal-link" title="ganeti.impexpd">impexpd</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.jqueue.html" class="internal-link" title="ganeti.jqueue">jqueue</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.masterd.html" class="internal-link" title="ganeti.masterd">masterd</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.rapi.html" class="internal-link" title="ganeti.rapi">rapi</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.rpc.html" class="internal-link" title="ganeti.rpc">rpc</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.server.html" class="internal-link" title="ganeti.server">server</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.storage.html" class="internal-link" title="ganeti.storage">storage</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.tools.html" class="internal-link" title="ganeti.tools">tools</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.utils.html" class="internal-link" title="ganeti.utils">utils</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.watcher.html" class="internal-link" title="ganeti.watcher">watcher</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.asyncnotifier.html" class="internal-link" title="ganeti.asyncnotifier">asyncnotifier</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.backend.html" class="internal-link" title="ganeti.backend">backend</a></code>
            </div>
        

    </li><li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.bootstrap.html" class="internal-link" title="ganeti.bootstrap">bootstrap</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.cli.html" class="internal-link" title="ganeti.cli">cli</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.cli_opts.html" class="internal-link" title="ganeti.cli_opts">cli<wbr></wbr>_opts</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.compat.html" class="internal-link" title="ganeti.compat">compat</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.constants.html" class="internal-link" title="ganeti.constants">constants</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.daemon.html" class="internal-link" title="ganeti.daemon">daemon</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.errors.html" class="internal-link" title="ganeti.errors">errors</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.hooksmaster.html" class="internal-link" title="ganeti.hooksmaster">hooksmaster</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.ht.html" class="internal-link" title="ganeti.ht">ht</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.jstore.html" class="internal-link" title="ganeti.jstore">jstore</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.locking.html" class="internal-link" title="ganeti.locking">locking</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.luxi.html" class="internal-link" title="ganeti.luxi">luxi</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.mcpu.html" class="internal-link" title="ganeti.mcpu">mcpu</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.metad.html" class="internal-link" title="ganeti.metad">metad</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.netutils.html" class="internal-link" title="ganeti.netutils">netutils</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.network.html" class="internal-link" title="ganeti.network">network</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.objects.html" class="internal-link" title="ganeti.objects">objects</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.opcodes.html" class="internal-link" title="ganeti.opcodes">opcodes</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.opcodes_base.html" class="internal-link" title="ganeti.opcodes_base">opcodes<wbr></wbr>_base</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.outils.html" class="internal-link" title="ganeti.outils">outils</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.ovf.html" class="internal-link" title="ganeti.ovf">ovf</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.pathutils.html" class="internal-link" title="ganeti.pathutils">pathutils</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.qlang.html" class="internal-link" title="ganeti.qlang">qlang</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.query.html" class="internal-link" title="ganeti.query">query</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.rpc_defs.html" class="internal-link" title="ganeti.rpc_defs">rpc<wbr></wbr>_defs</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.runtime.html" class="internal-link" title="ganeti.runtime">runtime</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.serializer.html" class="internal-link" title="ganeti.serializer">serializer</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.ssconf.html" class="internal-link" title="ganeti.ssconf">ssconf</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.ssh.html" class="internal-link" title="ganeti.ssh">ssh</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.uidpool.html" class="internal-link" title="ganeti.uidpool">uidpool</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.vcluster.html" class="internal-link" title="ganeti.vcluster">vcluster</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.wconfd.html" class="internal-link" title="ganeti.wconfd">wconfd</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="ganeti.workerpool.html" class="internal-link" title="ganeti.workerpool">workerpool</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="ganeti._constants.html" class="internal-link" title="ganeti._constants">_constants</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="ganeti._generated_rpc.html" class="internal-link" title="ganeti._generated_rpc">_generated<wbr></wbr>_rpc</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="ganeti._vcsversion.html" class="internal-link" title="ganeti._vcsversion">_vcsversion</a></code>
            </div>
        

    </li>
</ul> 

        
        

        
         

        
         

        
         

        
         
        
      </div>
  </div>

</nav>
        </div>
        <div id="collapseSideBar">
          <a class="btn btn-link" onclick="toggleSideBarCollapse()" title="Toggle Sidebar Collapse">
          </a>
        </div> 
        <script src="sidebartoggle.js" type="text/javascript"></script>
       
      </div>

      <div id="main" class="">
        

        

        <div class="page-header">
          <h1 class="module"><code><code><a href="ganeti.html" class="internal-link">ganeti</a></code><wbr></wbr>.<code><a href="ganeti.bootstrap.html" class="internal-link" title="ganeti.bootstrap">bootstrap</a></code></code></h1>
          <div id="showPrivate">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          module documentation
        </div>

        <div class="extrasDocstring">
          
          <p></p>
        </div>

        <div class="moduleDocstring">
          <div><p>Functions to bootstrap a new cluster.</p>
</div>
        </div>

        <div id="splitTables">
          <table class="children sortable" id="id21">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#FinalizeClusterDestroy" class="internal-link" title="ganeti.bootstrap.FinalizeClusterDestroy"><wbr></wbr>Finalize<wbr></wbr>Cluster<wbr></wbr>Destroy</a></code></td>
    <td>Execute the last steps of cluster destroy</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#GenerateClusterCrypto" class="internal-link" title="ganeti.bootstrap.GenerateClusterCrypto"><wbr></wbr>Generate<wbr></wbr>Cluster<wbr></wbr>Crypto</a></code></td>
    <td>Updates the cluster certificates, keys and secrets.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#GenerateHmacKey" class="internal-link" title="ganeti.bootstrap.GenerateHmacKey"><wbr></wbr>Generate<wbr></wbr>Hmac<wbr></wbr>Key</a></code></td>
    <td>Writes a new HMAC key.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#GetMaster" class="internal-link" title="ganeti.bootstrap.GetMaster"><wbr></wbr>Get<wbr></wbr>Master</a></code></td>
    <td>Returns the current master node.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#InitCluster" class="internal-link" title="ganeti.bootstrap.InitCluster"><wbr></wbr>Init<wbr></wbr>Cluster</a></code></td>
    <td>Initialise the cluster.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#InitConfig" class="internal-link" title="ganeti.bootstrap.InitConfig"><wbr></wbr>Init<wbr></wbr>Config</a></code></td>
    <td>Create the initial cluster configuration.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#MajorityHealthy" class="internal-link" title="ganeti.bootstrap.MajorityHealthy"><wbr></wbr>Majority<wbr></wbr>Healthy</a></code></td>
    <td>Check if the majority of nodes is healthy</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#MasterFailover" class="internal-link" title="ganeti.bootstrap.MasterFailover"><wbr></wbr>Master<wbr></wbr>Failover</a></code></td>
    <td>Failover the master node.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#SetupNodeDaemon" class="internal-link" title="ganeti.bootstrap.SetupNodeDaemon"><wbr></wbr>Setup<wbr></wbr>Node<wbr></wbr>Daemon</a></code></td>
    <td>Add a node to the cluster.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_GatherMasterVotes" class="internal-link" title="ganeti.bootstrap._GatherMasterVotes">_<wbr></wbr>Gather<wbr></wbr>Master<wbr></wbr>Votes</a></code></td>
    <td>Check the agreement on who is the master.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_InitCheckDrbdHelper" class="internal-link" title="ganeti.bootstrap._InitCheckDrbdHelper">_<wbr></wbr>Init<wbr></wbr>Check<wbr></wbr>Drbd<wbr></wbr>Helper</a></code></td>
    <td>Checks the DRBD usermode helper.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_InitCheckEnabledDiskTemplates" class="internal-link" title="ganeti.bootstrap._InitCheckEnabledDiskTemplates">_<wbr></wbr>Init<wbr></wbr>Check<wbr></wbr>Enabled<wbr></wbr>Disk<wbr></wbr>Templates</a></code></td>
    <td>Checks the sanity of the enabled disk templates.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_<wbr></wbr>Init<wbr></wbr>File<wbr></wbr>Storage<wbr></wbr>Dir</a></code></td>
    <td>Initialize if needed the file storage.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_InitGanetiServerSetup" class="internal-link" title="ganeti.bootstrap._InitGanetiServerSetup">_<wbr></wbr>Init<wbr></wbr>Ganeti<wbr></wbr>Server<wbr></wbr>Setup</a></code></td>
    <td>Setup the necessary configuration for the initial node daemon.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_PrepareFileBasedStorage" class="internal-link" title="ganeti.bootstrap._PrepareFileBasedStorage">_<wbr></wbr>Prepare<wbr></wbr>File<wbr></wbr>Based<wbr></wbr>Storage</a></code></td>
    <td>Checks if a file-base storage type is enabled and inits the dir.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_PrepareFileStorage" class="internal-link" title="ganeti.bootstrap._PrepareFileStorage">_<wbr></wbr>Prepare<wbr></wbr>File<wbr></wbr>Storage</a></code></td>
    <td>Checks if file storage is enabled and inits the dir.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_PrepareGlusterStorage" class="internal-link" title="ganeti.bootstrap._PrepareGlusterStorage">_<wbr></wbr>Prepare<wbr></wbr>Gluster<wbr></wbr>Storage</a></code></td>
    <td>Checks if gluster storage is enabled and inits the dir.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_PrepareSharedFileStorage" class="internal-link" title="ganeti.bootstrap._PrepareSharedFileStorage">_<wbr></wbr>Prepare<wbr></wbr>Shared<wbr></wbr>File<wbr></wbr>Storage</a></code></td>
    <td>Checks if shared file storage is enabled and inits the dir.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_RestrictIpolicyToEnabledDiskTemplates" class="internal-link" title="ganeti.bootstrap._RestrictIpolicyToEnabledDiskTemplates">_<wbr></wbr>Restrict<wbr></wbr>Ipolicy<wbr></wbr>To<wbr></wbr>Enabled<wbr></wbr>Disk<wbr></wbr>Templates</a></code></td>
    <td>Restricts the ipolicy's disk templates to the enabled ones.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_WaitForMasterDaemon" class="internal-link" title="ganeti.bootstrap._WaitForMasterDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Master<wbr></wbr>Daemon</a></code></td>
    <td>Wait for master daemon to become responsive.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_WaitForNodeDaemon" class="internal-link" title="ganeti.bootstrap._WaitForNodeDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Node<wbr></wbr>Daemon</a></code></td>
    <td>Wait for node daemon to become responsive.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_WaitForSshDaemon" class="internal-link" title="ganeti.bootstrap._WaitForSshDaemon">_<wbr></wbr>Wait<wbr></wbr>For<wbr></wbr>Ssh<wbr></wbr>Daemon</a></code></td>
    <td>Wait for SSH daemon to become responsive.</td>
  </tr><tr class="constant private">
    
    <td>Constant</td>
    <td><code><a href="#_DAEMON_READY_TIMEOUT" class="internal-link" title="ganeti.bootstrap._DAEMON_READY_TIMEOUT">_DAEMON<wbr></wbr>_READY<wbr></wbr>_TIMEOUT</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant private">
    
    <td>Constant</td>
    <td><code><a href="#_INITCONF_ECID" class="internal-link" title="ganeti.bootstrap._INITCONF_ECID">_INITCONF<wbr></wbr>_ECID</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
          

            
        </div>

        <div id="childList">
          <div class="basefunction">
  
  
  <a name="ganeti.bootstrap.FinalizeClusterDestroy">
    
  </a>
  <a name="FinalizeClusterDestroy">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">FinalizeClusterDestroy</span>(master_uuid):
    
    <a class="headerLink" href="#FinalizeClusterDestroy" title="ganeti.bootstrap.FinalizeClusterDestroy">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Execute the last steps of cluster destroy</p>
<p>This function shuts down all the daemons, completing the destroy begun in cmdlib.LUDestroyOpcode.</p>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.GenerateClusterCrypto">
    
  </a>
  <a name="GenerateClusterCrypto">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">GenerateClusterCrypto</span>(new_cluster_cert, new_rapi_cert, new_spice_cert, new_confd_hmac_key, new_cds, new_client_cert, master_name, rapi_cert_pem=None, spice_cert_pem=None, spice_cacert_pem=None, cds=None, nodecert_file=<a href="ganeti.pathutils.html#NODED_CERT_FILE" class="internal-link" title="ganeti.pathutils.NODED_CERT_FILE">pathutils.NODED_CERT_FILE</a>, clientcert_file=<a href="ganeti.pathutils.html#NODED_CLIENT_CERT_FILE" class="internal-link" title="ganeti.pathutils.NODED_CLIENT_CERT_FILE">pathutils.NODED_CLIENT_CERT_FILE</a>, rapicert_file=<a href="ganeti.pathutils.html#RAPI_CERT_FILE" class="internal-link" title="ganeti.pathutils.RAPI_CERT_FILE">pathutils.RAPI_CERT_FILE</a>, spicecert_file=<a href="ganeti.pathutils.html#SPICE_CERT_FILE" class="internal-link" title="ganeti.pathutils.SPICE_CERT_FILE">pathutils.SPICE_CERT_FILE</a>, spicecacert_file=<a href="ganeti.pathutils.html#SPICE_CACERT_FILE" class="internal-link" title="ganeti.pathutils.SPICE_CACERT_FILE">pathutils.SPICE_CACERT_FILE</a>, hmackey_file=<a href="ganeti.pathutils.html#CONFD_HMAC_KEY" class="internal-link" title="ganeti.pathutils.CONFD_HMAC_KEY">pathutils.CONFD_HMAC_KEY</a>, cds_file=<a href="ganeti.pathutils.html#CLUSTER_DOMAIN_SECRET_FILE" class="internal-link" title="ganeti.pathutils.CLUSTER_DOMAIN_SECRET_FILE">pathutils.CLUSTER_DOMAIN_SECRET_FILE</a>):
    
    <a class="headerLink" href="#GenerateClusterCrypto" title="ganeti.bootstrap.GenerateClusterCrypto">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Updates the cluster certificates, keys and secrets.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_cluster<wbr></wbr>_cert:</span>bool</td><td class="fieldArgDesc">Whether to generate a new cluster certificate</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_rapi<wbr></wbr>_cert:</span>bool</td><td class="fieldArgDesc">Whether to generate a new RAPI certificate</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_spice<wbr></wbr>_cert:</span>bool</td><td class="fieldArgDesc">Whether to generate a new SPICE certificate</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_confd<wbr></wbr>_hmac<wbr></wbr>_key:</span>bool</td><td class="fieldArgDesc">Whether to generate a new HMAC key</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_cds:</span>bool</td><td class="fieldArgDesc">Whether to generate a new cluster domain secret</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">new<wbr></wbr>_client<wbr></wbr>_cert:</span>bool</td><td class="fieldArgDesc">Whether to generate a new client certificate</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">master<wbr></wbr>_name:</span>string</td><td class="fieldArgDesc">FQDN of the master node</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">rapi<wbr></wbr>_cert<wbr></wbr>_pem:</span>string</td><td class="fieldArgDesc">New RAPI certificate in PEM format</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">spice<wbr></wbr>_cert<wbr></wbr>_pem:</span>string</td><td class="fieldArgDesc">New SPICE certificate in PEM format</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">spice<wbr></wbr>_cacert<wbr></wbr>_pem:</span>string</td><td class="fieldArgDesc">Certificate of the CA that signed the SPICE certificate, in PEM format</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cds:</span>string</td><td class="fieldArgDesc">New cluster domain secret</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">nodecert<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">optional override of the node cert file path</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">clientcert<wbr></wbr>_file</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">rapicert<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">optional override of the rapi cert file path</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">spicecert<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">optional override of the spice cert file path</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">spicecacert<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">optional override of the spice CA cert file path</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hmackey<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">optional override of the hmac key file path</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cds<wbr></wbr>_file</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.GenerateHmacKey">
    
  </a>
  <a name="GenerateHmacKey">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">GenerateHmacKey</span>(file_name):
    
    <a class="headerLink" href="#GenerateHmacKey" title="ganeti.bootstrap.GenerateHmacKey">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Writes a new HMAC key.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">file<wbr></wbr>_name:</span>str</td><td class="fieldArgDesc">Path to output file</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.GetMaster">
    
  </a>
  <a name="GetMaster">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">GetMaster</span>():
    
    <a class="headerLink" href="#GetMaster" title="ganeti.bootstrap.GetMaster">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Returns the current master node.</p>
<p>This is a separate function in bootstrap since it's needed by gnt-cluster, and instead of importing directly ssconf, it's better to abstract it in bootstrap, where we do use ssconf in other functions too.</p>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.InitCluster">
    
  </a>
  <a name="InitCluster">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">InitCluster</span>(cluster_name, mac_prefix, master_netmask, master_netdev, file_storage_dir, shared_file_storage_dir, gluster_storage_dir, candidate_pool_size, ssh_key_type, ssh_key_bits, secondary_ip=None, vg_name=None, beparams=None, nicparams=None, ndparams=None, hvparams=None, diskparams=None, enabled_hypervisors=None, modify_etc_hosts=True, modify_ssh_setup=True, maintain_node_health=False, drbd_helper=None, uid_pool=None, default_iallocator=None, default_iallocator_params=None, primary_ip_version=None, ipolicy=None, prealloc_wipe_disks=False, use_external_mip_script=False, hv_state=None, disk_state=None, enabled_disk_templates=None, install_image=None, zeroing_image=None, compression_tools=None, enabled_user_shutdown=False):
    
    <a class="headerLink" href="#InitCluster" title="ganeti.bootstrap.InitCluster">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Initialise the cluster.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cluster<wbr></wbr>_name</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">mac<wbr></wbr>_prefix</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">master<wbr></wbr>_netmask</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">master<wbr></wbr>_netdev</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">file<wbr></wbr>_storage<wbr></wbr>_dir</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">shared<wbr></wbr>_file<wbr></wbr>_storage<wbr></wbr>_dir</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">gluster<wbr></wbr>_storage<wbr></wbr>_dir</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">candidate<wbr></wbr>_pool<wbr></wbr>_size:</span>int</td><td class="fieldArgDesc">master candidate pool size</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ssh<wbr></wbr>_key<wbr></wbr>_type</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ssh<wbr></wbr>_key<wbr></wbr>_bits</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">secondary<wbr></wbr>_ip</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">vg<wbr></wbr>_name</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">beparams</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">nicparams</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ndparams</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hvparams</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">diskparams</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">enabled<wbr></wbr>_hypervisors</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">modify<wbr></wbr>_etc<wbr></wbr>_hosts</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">modify<wbr></wbr>_ssh<wbr></wbr>_setup</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">maintain<wbr></wbr>_node<wbr></wbr>_health</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">drbd<wbr></wbr>_helper</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">uid<wbr></wbr>_pool</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">default<wbr></wbr>_iallocator</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">default<wbr></wbr>_iallocator<wbr></wbr>_params</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">primary<wbr></wbr>_ip<wbr></wbr>_version</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ipolicy</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">prealloc<wbr></wbr>_wipe<wbr></wbr>_disks</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">use<wbr></wbr>_external<wbr></wbr>_mip<wbr></wbr>_script</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hv<wbr></wbr>_state</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">disk<wbr></wbr>_state</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">enabled<wbr></wbr>_disk<wbr></wbr>_templates:</span>list of string</td><td class="fieldArgDesc">list of disk_templates to be used in this cluster</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">install<wbr></wbr>_image</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">zeroing<wbr></wbr>_image</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">compression<wbr></wbr>_tools</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">enabled<wbr></wbr>_user<wbr></wbr>_shutdown:</span>bool</td><td class="fieldArgDesc">whether user shutdown is enabled cluster wide</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.InitConfig">
    
  </a>
  <a name="InitConfig">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">InitConfig</span>(version, cluster_config, master_node_config, cfg_file=<a href="ganeti.pathutils.html#CLUSTER_CONF_FILE" class="internal-link" title="ganeti.pathutils.CLUSTER_CONF_FILE">pathutils.CLUSTER_CONF_FILE</a>):
    
    <a class="headerLink" href="#InitConfig" title="ganeti.bootstrap.InitConfig">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Create the initial cluster configuration.</p>
<p>It will contain the current node, which will also be the master node, and no instances.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">version:</span>int</td><td class="fieldArgDesc">configuration version</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cluster<wbr></wbr>_config:</span><code><a href="ganeti.objects.Cluster.html" class="internal-link" title="ganeti.objects.Cluster">objects.Cluster</a></code></td><td class="fieldArgDesc">cluster configuration</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">master<wbr></wbr>_node<wbr></wbr>_config:</span><code><a href="ganeti.objects.Node.html" class="internal-link" title="ganeti.objects.Node">objects.Node</a></code></td><td class="fieldArgDesc">master node configuration</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cfg<wbr></wbr>_file:</span>string</td><td class="fieldArgDesc">configuration file path</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.MajorityHealthy">
    
  </a>
  <a name="MajorityHealthy">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">MajorityHealthy</span>(ignore_offline_nodes=False):
    
    <a class="headerLink" href="#MajorityHealthy" title="ganeti.bootstrap.MajorityHealthy">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Check if the majority of nodes is healthy</p>
<p>Gather master votes from all nodes known to this node; return True if a strict majority of nodes is reachable and has some opinion on which node is master. Note that this will not guarantee any node to win an election but it ensures that a standard master-failover is still possible.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2">tuple of (boolean, [str]); the first is if a majority of nodes are healthy, the second is a list of the node names that are not considered healthy.</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.MasterFailover">
    
  </a>
  <a name="MasterFailover">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">MasterFailover</span>(no_voting=False):
    
    <a class="headerLink" href="#MasterFailover" title="ganeti.bootstrap.MasterFailover">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Failover the master node.</p>
<p>This checks that we are not already the master, and will cause the current master to cease being master, and the non-master to become new master.</p>
<p>Note: The call to MasterFailover from lib/client/gnt_cluster.py checks that a majority of nodes are healthy and responding before calling this. If this function is called from somewhere else, the caller should also verify that a majority of nodes are healthy.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">no<wbr></wbr>_voting:</span>boolean</td><td class="fieldArgDesc">force the operation without remote nodes agreement (dangerous)</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2">the pair of an exit code and warnings to display</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="ganeti.bootstrap.SetupNodeDaemon">
    
  </a>
  <a name="SetupNodeDaemon">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">SetupNodeDaemon</span>(opts, cluster_name, node, ssh_port):
    
    <a class="headerLink" href="#SetupNodeDaemon" title="ganeti.bootstrap.SetupNodeDaemon">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Add a node to the cluster.</p>
<p>This function must be called before the actual opcode, and will ssh to the remote node, copy the needed files, and start ganeti-noded, allowing the master to do the rest via normal rpc calls.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">opts</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cluster<wbr></wbr>_name</span></td><td class="fieldArgDesc">the cluster name</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">node</span></td><td class="fieldArgDesc">the name of the new node</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ssh<wbr></wbr>_port</span></td><td class="fieldArgDesc">the SSH port of the new node</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._GatherMasterVotes">
    
  </a>
  <a name="_GatherMasterVotes">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_GatherMasterVotes</span>(node_names):
    
    <a class="headerLink" href="#_GatherMasterVotes" title="ganeti.bootstrap._GatherMasterVotes">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Check the agreement on who is the master.</p>
<p>This function will return a list of (node, number of votes), ordered by the number of votes.</p>
<p>Note that the sum of votes is the number of nodes this machine knows, whereas the number of entries in the list could be different (if some nodes vote for another master).</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">node<wbr></wbr>_names:</span>list</td><td class="fieldArgDesc">the list of nodes to query for master info</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer">list</td><td class="fieldArgDesc">list of (node, votes)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._InitCheckDrbdHelper">
    
  </a>
  <a name="_InitCheckDrbdHelper">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_InitCheckDrbdHelper</span>(drbd_helper, drbd_enabled):
    
    <a class="headerLink" href="#_InitCheckDrbdHelper" title="ganeti.bootstrap._InitCheckDrbdHelper">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks the DRBD usermode helper.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">drbd<wbr></wbr>_helper:</span>string</td><td class="fieldArgDesc">name of the DRBD usermode helper that the system should use</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">drbd<wbr></wbr>_enabled</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._InitCheckEnabledDiskTemplates">
    
  </a>
  <a name="_InitCheckEnabledDiskTemplates">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_InitCheckEnabledDiskTemplates</span>(enabled_disk_templates):
    
    <a class="headerLink" href="#_InitCheckEnabledDiskTemplates" title="ganeti.bootstrap._InitCheckEnabledDiskTemplates">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks the sanity of the enabled disk templates.</p>
</div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._InitFileStorageDir">
    
  </a>
  <a name="_InitFileStorageDir">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_InitFileStorageDir</span>(file_storage_dir):
    
    <a class="headerLink" href="#_InitFileStorageDir" title="ganeti.bootstrap._InitFileStorageDir">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Initialize if needed the file storage.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">file<wbr></wbr>_storage<wbr></wbr>_dir</span></td><td class="fieldArgDesc">the user-supplied value</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2">either empty string (if file storage was disabled at build time) or the normalized path to the storage directory</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._InitGanetiServerSetup">
    
  </a>
  <a name="_InitGanetiServerSetup">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_InitGanetiServerSetup</span>(master_name, cfg):
    
    <a class="headerLink" href="#_InitGanetiServerSetup" title="ganeti.bootstrap._InitGanetiServerSetup">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Setup the necessary configuration for the initial node daemon.</p>
<p>This creates the nodepass file containing the shared password for the cluster, generates the SSL certificate and starts the node daemon.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">master<wbr></wbr>_name:</span>str</td><td class="fieldArgDesc">Name of the master node</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cfg:</span>ConfigWriter</td><td class="fieldArgDesc">the configuration writer</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._PrepareFileBasedStorage">
    
  </a>
  <a name="_PrepareFileBasedStorage">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_PrepareFileBasedStorage</span>(enabled_disk_templates, file_storage_dir, default_dir, file_disk_template, _storage_path_acceptance_fn, init_fn=<a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_InitFileStorageDir</a>, acceptance_fn=None):
    
    <a class="headerLink" href="#_PrepareFileBasedStorage" title="ganeti.bootstrap._PrepareFileBasedStorage">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks if a file-base storage type is enabled and inits the dir.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">enabled<wbr></wbr>_disk<wbr></wbr>_templates:</span>list of string</td><td class="fieldArgDesc">list of enabled disk templates</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">file<wbr></wbr>_storage<wbr></wbr>_dir:</span>string</td><td class="fieldArgDesc">the file storage directory</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">default<wbr></wbr>_dir:</span>string</td><td class="fieldArgDesc">default file storage directory when <tt class="rst-docutils literal">file_storage_dir</tt> is 'None'</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">file<wbr></wbr>_disk<wbr></wbr>_template:</span>string</td><td class="fieldArgDesc">a disk template whose storage type is 'ST_FILE', 'ST_SHARED_FILE' or 'ST_GLUSTER'</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">_storage<wbr></wbr>_path<wbr></wbr>_acceptance<wbr></wbr>_fn:</span>function</td><td class="fieldArgDesc">checks whether the given file-based storage directory is acceptable</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">init<wbr></wbr>_fn</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">acceptance<wbr></wbr>_fn</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer">string</td><td class="fieldArgDesc">the name of the actual file storage directory</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">See Also</td></tr><tr><td colspan="2"><tt class="rst-docutils literal">cluster.CheckFileBasedStoragePathVsEnabledDiskTemplates</tt> for details</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._PrepareFileStorage">
    
  </a>
  <a name="_PrepareFileStorage">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_PrepareFileStorage</span>(enabled_disk_templates, file_storage_dir, init_fn=<a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_InitFileStorageDir</a>, acceptance_fn=None):
    
    <a class="headerLink" href="#_PrepareFileStorage" title="ganeti.bootstrap._PrepareFileStorage">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks if file storage is enabled and inits the dir.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">See Also</td></tr><tr><td colspan="2"><tt class="rst-docutils literal">_PrepareFileBasedStorage</tt></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._PrepareGlusterStorage">
    
  </a>
  <a name="_PrepareGlusterStorage">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_PrepareGlusterStorage</span>(enabled_disk_templates, file_storage_dir, init_fn=<a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_InitFileStorageDir</a>, acceptance_fn=None):
    
    <a class="headerLink" href="#_PrepareGlusterStorage" title="ganeti.bootstrap._PrepareGlusterStorage">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks if gluster storage is enabled and inits the dir.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">See Also</td></tr><tr><td colspan="2"><tt class="rst-docutils literal">_PrepareFileBasedStorage</tt></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._PrepareSharedFileStorage">
    
  </a>
  <a name="_PrepareSharedFileStorage">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_PrepareSharedFileStorage</span>(enabled_disk_templates, file_storage_dir, init_fn=<a href="#_InitFileStorageDir" class="internal-link" title="ganeti.bootstrap._InitFileStorageDir">_InitFileStorageDir</a>, acceptance_fn=None):
    
    <a class="headerLink" href="#_PrepareSharedFileStorage" title="ganeti.bootstrap._PrepareSharedFileStorage">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks if shared file storage is enabled and inits the dir.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">See Also</td></tr><tr><td colspan="2"><tt class="rst-docutils literal">_PrepareFileBasedStorage</tt></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._RestrictIpolicyToEnabledDiskTemplates">
    
  </a>
  <a name="_RestrictIpolicyToEnabledDiskTemplates">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_RestrictIpolicyToEnabledDiskTemplates</span>(ipolicy, enabled_disk_templates):
    
    <a class="headerLink" href="#_RestrictIpolicyToEnabledDiskTemplates" title="ganeti.bootstrap._RestrictIpolicyToEnabledDiskTemplates">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Restricts the ipolicy's disk templates to the enabled ones.</p>
<p>This function clears the ipolicy's list of allowed disk templates from the ones that are not enabled by the cluster.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">ipolicy:</span>dict</td><td class="fieldArgDesc">the instance policy</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">enabled<wbr></wbr>_disk<wbr></wbr>_templates:</span>list of string</td><td class="fieldArgDesc">the list of cluster-wide enabled disk templates</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._WaitForMasterDaemon">
    
  </a>
  <a name="_WaitForMasterDaemon">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_WaitForMasterDaemon</span>():
    
    <a class="headerLink" href="#_WaitForMasterDaemon" title="ganeti.bootstrap._WaitForMasterDaemon">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Wait for master daemon to become responsive.</p>
</div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._WaitForNodeDaemon">
    
  </a>
  <a name="_WaitForNodeDaemon">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_WaitForNodeDaemon</span>(node_name):
    
    <a class="headerLink" href="#_WaitForNodeDaemon" title="ganeti.bootstrap._WaitForNodeDaemon">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Wait for node daemon to become responsive.</p>
</div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="ganeti.bootstrap._WaitForSshDaemon">
    
  </a>
  <a name="_WaitForSshDaemon">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_WaitForSshDaemon</span>(hostname, port):
    
    <a class="headerLink" href="#_WaitForSshDaemon" title="ganeti.bootstrap._WaitForSshDaemon">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Wait for SSH daemon to become responsive.</p>
</div>
  </div>
</div><div class="baseconstant private">
  
  
  <a name="ganeti.bootstrap._DAEMON_READY_TIMEOUT">
    
  </a>
  <a name="_DAEMON_READY_TIMEOUT">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_DAEMON_READY_TIMEOUT</span>: <code>float</code> =
    
    <a class="headerLink" href="#_DAEMON_READY_TIMEOUT" title="ganeti.bootstrap._DAEMON_READY_TIMEOUT">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code>10.0</code></pre></td></tr></table>
  </div>
</div><div class="baseconstant private">
  
  
  <a name="ganeti.bootstrap._INITCONF_ECID">
    
  </a>
  <a name="_INITCONF_ECID">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_INITCONF_ECID</span>: <code>str</code> =
    
    <a class="headerLink" href="#_INITCONF_ECID" title="ganeti.bootstrap._INITCONF_ECID">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><span class="rst-variable-quote">'</span><span class="rst-variable-string">initconfig-ecid</span><span class="rst-variable-quote">'</span></code></pre></td></tr></table>
  </div>
</div>
        </div>
      
      </div>
    </div>

    <footer class="navbar navbar-default">

  
  <div class="container">
    <a href="index.html">API Documentation</a> for ganeti/server,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.9.1 at 2024-05-06 13:21:37.
  </div>

  <!-- Search related scripts needs to be loaded at the end of HTML 
    parsing not to introduce overhead and display HTML data asap -->
  <script src="ajax.js" type="text/javascript"></script>
  <script src="searchlib.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>