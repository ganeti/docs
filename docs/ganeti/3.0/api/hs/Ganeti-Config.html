<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ganeti.Config</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ganeti</span><ul class="links" id="page-menu"><li><a href="Ganeti/Config.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.Config</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Operations on the whole configuration</a></li><li><a href="#g:2">Query functions</a></li><li><a href="#g:3">Network</a><ul><li><a href="#g:4">MACs</a></li><li><a href="#g:5">DRBD secrets</a></li><li><a href="#g:6">LVs</a></li></ul></li><li><a href="#g:7">ND params</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of the Ganeti configuration database.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:LinkIpMap">LinkIpMap</a> = Map String (Map String String)</li><li class="src short"><a href="#v:readConfig">readConfig</a> :: FilePath -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> String)</li><li class="src short"><a href="#v:parseConfig">parseConfig</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a></li><li class="src short"><a href="#v:encodeConfig">encodeConfig</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String</li><li class="src short"><a href="#v:loadConfig">loadConfig</a> :: FilePath -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a>)</li><li class="src short"><a href="#v:saveConfig">saveConfig</a> :: Handle -&gt; <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; IO ()</li><li class="src short"><a href="#v:withMissingParam">withMissingParam</a> :: String -&gt; (a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> b) -&gt; Maybe a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> b</li><li class="src short"><a href="#v:computeDiskNodes">computeDiskNodes</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; Set String</li><li class="src short"><a href="#v:instDiskNodes">instDiskNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; Set String</li><li class="src short"><a href="#v:instNodes">instNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; Set String</li><li class="src short"><a href="#v:computeDiskSecondaryNode">computeDiskSecondaryNode</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; String -&gt; Maybe String</li><li class="src short"><a href="#v:getNodeInstances">getNodeInstances</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; ([<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>], [<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>])</li><li class="src short"><a href="#v:getNodeRole">getNodeRole</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; <a href="Ganeti-Types.html#t:NodeRole" title="Ganeti.Types">NodeRole</a></li><li class="src short"><a href="#v:getMasterNodes">getMasterNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getMasterCandidates">getMasterCandidates</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getMasterOrCandidates">getMasterOrCandidates</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getMasterNetworkParameters">getMasterNetworkParameters</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:MasterNetworkParameters" title="Ganeti.Objects">MasterNetworkParameters</a></li><li class="src short"><a href="#v:getOnlineNodes">getOnlineNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getDefaultNicLink">getDefaultNicLink</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String</li><li class="src short"><a href="#v:getDefaultHypervisor">getDefaultHypervisor</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Types.html#t:Hypervisor" title="Ganeti.Types">Hypervisor</a></li><li class="src short"><a href="#v:getInstancesIpByLink">getInstancesIpByLink</a> :: <a href="Ganeti-Config.html#t:LinkIpMap" title="Ganeti.Config">LinkIpMap</a> -&gt; String -&gt; [String]</li><li class="src short"><a href="#v:getItem">getItem</a> :: String -&gt; String -&gt; Map String a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> a</li><li class="src short"><a href="#v:getItem-39-">getItem'</a> :: String -&gt; String -&gt; Map ByteString a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> a</li><li class="src short"><a href="#v:getNode">getNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a></li><li class="src short"><a href="#v:getInstance">getInstance</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a></li><li class="src short"><a href="#v:getInstanceByName">getInstanceByName</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a></li><li class="src short"><a href="#v:getDisk">getDisk</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a></li><li class="src short"><a href="#v:getFilterRule">getFilterRule</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a></li><li class="src short"><a href="#v:getGroup">getGroup</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a></li><li class="src short"><a href="#v:getGroupNdParams">getGroupNdParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a></li><li class="src short"><a href="#v:getGroupIpolicy">getGroupIpolicy</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:FilledIPolicy" title="Ganeti.Objects">FilledIPolicy</a></li><li class="src short"><a href="#v:getGroupDiskParams">getGroupDiskParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:GroupDiskParams" title="Ganeti.Objects">GroupDiskParams</a></li><li class="src short"><a href="#v:getGroupNodes">getGroupNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getGroupInstances">getGroupInstances</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; ([<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>], [<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>])</li><li class="src short"><a href="#v:getFilledInstHvParams">getFilledInstHvParams</a> :: [String] -&gt; <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Types.html#t:HvParams" title="Ganeti.Types">HvParams</a></li><li class="src short"><a href="#v:getFilledInstBeParams">getFilledInstBeParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:FilledBeParams" title="Ganeti.Objects.Instance">FilledBeParams</a></li><li class="src short"><a href="#v:getFilledInstOsParams">getFilledInstOsParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Types.html#t:OsParams" title="Ganeti.Types">OsParams</a></li><li class="src short"><a href="#v:getInstPrimaryNode">getInstPrimaryNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a></li><li class="src short"><a href="#v:getDrbdDiskNodes">getDrbdDiskNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getInstAllNodes">getInstAllNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>]</li><li class="src short"><a href="#v:getInstDisks">getInstDisks</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a>]</li><li class="src short"><a href="#v:getInstDisksFromObj">getInstDisksFromObj</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a>]</li><li class="src short"><a href="#v:collectFromDrbdDisks">collectFromDrbdDisks</a> :: Monoid a =&gt; (String -&gt; String -&gt; Int -&gt; Int -&gt; Int -&gt; <a href="Ganeti-Types.html#t:Private" title="Ganeti.Types">Private</a> <a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a> -&gt; a) -&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; a</li><li class="src short"><a href="#v:getDrbdSecretsForDisk">getDrbdSecretsForDisk</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [<a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a>]</li><li class="src short"><a href="#v:getDrbdMinorsForDisk">getDrbdMinorsForDisk</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [(Int, String)]</li><li class="src short"><a href="#v:getDrbdMinorsForNode">getDrbdMinorsForNode</a> :: String -&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [(Int, String)]</li><li class="src short"><a href="#v:getDrbdMinorsForInstance">getDrbdMinorsForInstance</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [(Int, String)]</li><li class="src short"><a href="#v:rolePrimary">rolePrimary</a> :: String</li><li class="src short"><a href="#v:roleSecondary">roleSecondary</a> :: String</li><li class="src short"><a href="#v:getInstMinorsForNode">getInstMinorsForNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; [(String, Int, String, String, String, String)]</li><li class="src short"><a href="#v:buildLinkIpInstnameMap">buildLinkIpInstnameMap</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Config.html#t:LinkIpMap" title="Ganeti.Config">LinkIpMap</a></li><li class="src short"><a href="#v:getGroupOfNode">getGroupOfNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a></li><li class="src short"><a href="#v:getNodeNdParams">getNodeNdParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a></li><li class="src short"><a href="#v:getNetwork">getNetwork</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Network" title="Ganeti.Objects">Network</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:MAC">MAC</a> = String</li><li class="src short"><a href="#v:getAllMACs">getAllMACs</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Config.html#t:MAC" title="Ganeti.Config">MAC</a>]</li><li class="src short"><a href="#v:getAllDrbdSecrets">getAllDrbdSecrets</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:NodeLVsMap">NodeLVsMap</a> = <a href="Ganeti-Utils-MultiMap.html#t:MultiMap" title="Ganeti.Utils.MultiMap">MultiMap</a> String <a href="Ganeti-Objects-Disk.html#t:LogicalVolume" title="Ganeti.Objects.Disk">LogicalVolume</a></li><li class="src short"><a href="#v:getInstanceLVsByNode">getInstanceLVsByNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Config.html#t:NodeLVsMap" title="Ganeti.Config">NodeLVsMap</a></li><li class="src short"><a href="#v:getAllLVs">getAllLVs</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> (Set <a href="Ganeti-Objects-Disk.html#t:LogicalVolume" title="Ganeti.Objects.Disk">LogicalVolume</a>)</li><li class="src short"><span class="keyword">class</span> <a href="#t:NdParamObject">NdParamObject</a> a <span class="keyword">where</span><ul class="subs"><li><a href="#v:getNdParamsOf">getNdParamsOf</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; a -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a></li></ul></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:LinkIpMap" class="def">LinkIpMap</a> = Map String (Map String String) <a href="Ganeti/Config.html#LinkIpMap" class="link">Source</a> <a href="#t:LinkIpMap" class="selflink">#</a></p><div class="doc"><p>Type alias for the link and ip map.</p></div></div><a href="#g:1" id="g:1"><h1>Operations on the whole configuration</h1></a><div class="top"><p class="src"><a id="v:readConfig" class="def">readConfig</a> :: FilePath -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> String) <a href="Ganeti/Config.html#readConfig" class="link">Source</a> <a href="#v:readConfig" class="selflink">#</a></p><div class="doc"><p>Reads the config file.</p></div></div><div class="top"><p class="src"><a id="v:parseConfig" class="def">parseConfig</a> :: String -&gt; <a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> <a href="Ganeti/Config.html#parseConfig" class="link">Source</a> <a href="#v:parseConfig" class="selflink">#</a></p><div class="doc"><p>Parses the configuration file.</p></div></div><div class="top"><p class="src"><a id="v:encodeConfig" class="def">encodeConfig</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String <a href="Ganeti/Config.html#encodeConfig" class="link">Source</a> <a href="#v:encodeConfig" class="selflink">#</a></p><div class="doc"><p>Encodes the configuration file.</p></div></div><div class="top"><p class="src"><a id="v:loadConfig" class="def">loadConfig</a> :: FilePath -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a>) <a href="Ganeti/Config.html#loadConfig" class="link">Source</a> <a href="#v:loadConfig" class="selflink">#</a></p><div class="doc"><p>Wrapper over <code><a href="Ganeti-Config.html#v:readConfig" title="Ganeti.Config">readConfig</a></code> and <code><a href="Ganeti-Config.html#v:parseConfig" title="Ganeti.Config">parseConfig</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:saveConfig" class="def">saveConfig</a> :: Handle -&gt; <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; IO () <a href="Ganeti/Config.html#saveConfig" class="link">Source</a> <a href="#v:saveConfig" class="selflink">#</a></p><div class="doc"><p>Wrapper over <code>hPutStr</code> and <code><a href="Ganeti-Config.html#v:encodeConfig" title="Ganeti.Config">encodeConfig</a></code>.</p></div></div><a href="#g:2" id="g:2"><h1>Query functions</h1></a><div class="top"><p class="src"><a id="v:withMissingParam" class="def">withMissingParam</a> :: String -&gt; (a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> b) -&gt; Maybe a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> b <a href="Ganeti/Config.html#withMissingParam" class="link">Source</a> <a href="#v:withMissingParam" class="selflink">#</a></p><div class="doc"><p>Annotate Nothing as missing parameter and apply the given
 transformation otherwise</p></div></div><div class="top"><p class="src"><a id="v:computeDiskNodes" class="def">computeDiskNodes</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; Set String <a href="Ganeti/Config.html#computeDiskNodes" class="link">Source</a> <a href="#v:computeDiskNodes" class="selflink">#</a></p><div class="doc"><p>Computes the nodes covered by a disk.</p></div></div><div class="top"><p class="src"><a id="v:instDiskNodes" class="def">instDiskNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; Set String <a href="Ganeti/Config.html#instDiskNodes" class="link">Source</a> <a href="#v:instDiskNodes" class="selflink">#</a></p><div class="doc"><p>Computes all disk-related nodes of an instance. For non-DRBD,
 this will be empty, for DRBD it will contain both the primary and
 the secondaries.</p></div></div><div class="top"><p class="src"><a id="v:instNodes" class="def">instNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; Set String <a href="Ganeti/Config.html#instNodes" class="link">Source</a> <a href="#v:instNodes" class="selflink">#</a></p><div class="doc"><p>Computes all nodes of an instance.</p></div></div><div class="top"><p class="src"><a id="v:computeDiskSecondaryNode" class="def">computeDiskSecondaryNode</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; String -&gt; Maybe String <a href="Ganeti/Config.html#computeDiskSecondaryNode" class="link">Source</a> <a href="#v:computeDiskSecondaryNode" class="selflink">#</a></p><div class="doc"><p>Computes the secondary node UUID for a DRBD disk</p></div></div><div class="top"><p class="src"><a id="v:getNodeInstances" class="def">getNodeInstances</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; ([<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>], [<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>]) <a href="Ganeti/Config.html#getNodeInstances" class="link">Source</a> <a href="#v:getNodeInstances" class="selflink">#</a></p><div class="doc"><p>Get instances of a given node.
 The node is specified through its UUID.
 The secondary calculation is expensive and frequently called, so optimise
 this to allocate fewer temporary values</p></div></div><div class="top"><p class="src"><a id="v:getNodeRole" class="def">getNodeRole</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; <a href="Ganeti-Types.html#t:NodeRole" title="Ganeti.Types">NodeRole</a> <a href="Ganeti/Config.html#getNodeRole" class="link">Source</a> <a href="#v:getNodeRole" class="selflink">#</a></p><div class="doc"><p>Computes the role of a node.</p></div></div><div class="top"><p class="src"><a id="v:getMasterNodes" class="def">getMasterNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getMasterNodes" class="link">Source</a> <a href="#v:getMasterNodes" class="selflink">#</a></p><div class="doc"><p>Get the list of the master nodes (usually one).</p></div></div><div class="top"><p class="src"><a id="v:getMasterCandidates" class="def">getMasterCandidates</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getMasterCandidates" class="link">Source</a> <a href="#v:getMasterCandidates" class="selflink">#</a></p><div class="doc"><p>Get the list of master candidates, <em>not including</em> the master itself.</p></div></div><div class="top"><p class="src"><a id="v:getMasterOrCandidates" class="def">getMasterOrCandidates</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getMasterOrCandidates" class="link">Source</a> <a href="#v:getMasterOrCandidates" class="selflink">#</a></p><div class="doc"><p>Get the list of master candidates, <em>including</em> the master.</p></div></div><div class="top"><p class="src"><a id="v:getMasterNetworkParameters" class="def">getMasterNetworkParameters</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:MasterNetworkParameters" title="Ganeti.Objects">MasterNetworkParameters</a> <a href="Ganeti/Config.html#getMasterNetworkParameters" class="link">Source</a> <a href="#v:getMasterNetworkParameters" class="selflink">#</a></p><div class="doc"><p>Get the network parameters for the master IP address.</p></div></div><div class="top"><p class="src"><a id="v:getOnlineNodes" class="def">getOnlineNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getOnlineNodes" class="link">Source</a> <a href="#v:getOnlineNodes" class="selflink">#</a></p><div class="doc"><p>Get the list of online nodes.</p></div></div><div class="top"><p class="src"><a id="v:getDefaultNicLink" class="def">getDefaultNicLink</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String <a href="Ganeti/Config.html#getDefaultNicLink" class="link">Source</a> <a href="#v:getDefaultNicLink" class="selflink">#</a></p><div class="doc"><p>Returns the default cluster link.</p></div></div><div class="top"><p class="src"><a id="v:getDefaultHypervisor" class="def">getDefaultHypervisor</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Types.html#t:Hypervisor" title="Ganeti.Types">Hypervisor</a> <a href="Ganeti/Config.html#getDefaultHypervisor" class="link">Source</a> <a href="#v:getDefaultHypervisor" class="selflink">#</a></p><div class="doc"><p>Returns the default cluster hypervisor.</p></div></div><div class="top"><p class="src"><a id="v:getInstancesIpByLink" class="def">getInstancesIpByLink</a> :: <a href="Ganeti-Config.html#t:LinkIpMap" title="Ganeti.Config">LinkIpMap</a> -&gt; String -&gt; [String] <a href="Ganeti/Config.html#getInstancesIpByLink" class="link">Source</a> <a href="#v:getInstancesIpByLink" class="selflink">#</a></p><div class="doc"><p>Returns instances of a given link.</p></div></div><div class="top"><p class="src"><a id="v:getItem" class="def">getItem</a> :: String -&gt; String -&gt; Map String a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> a <a href="Ganeti/Config.html#getItem" class="link">Source</a> <a href="#v:getItem" class="selflink">#</a></p><div class="doc"><p>Generic lookup function that converts from a possible abbreviated
 name to a full name.</p></div></div><div class="top"><p class="src"><a id="v:getItem-39-" class="def">getItem'</a> :: String -&gt; String -&gt; Map ByteString a -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> a <a href="Ganeti/Config.html#getItem%27" class="link">Source</a> <a href="#v:getItem-39-" class="selflink">#</a></p><div class="doc"><p>Simple lookup function, insisting on exact matches and using
 byte strings.</p></div></div><div class="top"><p class="src"><a id="v:getNode" class="def">getNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> <a href="Ganeti/Config.html#getNode" class="link">Source</a> <a href="#v:getNode" class="selflink">#</a></p><div class="doc"><p>Looks up a node by name or uuid.</p></div></div><div class="top"><p class="src"><a id="v:getInstance" class="def">getInstance</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> <a href="Ganeti/Config.html#getInstance" class="link">Source</a> <a href="#v:getInstance" class="selflink">#</a></p><div class="doc"><p>Looks up an instance by name or uuid.</p></div></div><div class="top"><p class="src"><a id="v:getInstanceByName" class="def">getInstanceByName</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> <a href="Ganeti/Config.html#getInstanceByName" class="link">Source</a> <a href="#v:getInstanceByName" class="selflink">#</a></p><div class="doc"><p>Looks up an instance by exact name match</p></div></div><div class="top"><p class="src"><a id="v:getDisk" class="def">getDisk</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> <a href="Ganeti/Config.html#getDisk" class="link">Source</a> <a href="#v:getDisk" class="selflink">#</a></p><div class="doc"><p>Looks up a disk by uuid.</p></div></div><div class="top"><p class="src"><a id="v:getFilterRule" class="def">getFilterRule</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> <a href="Ganeti/Config.html#getFilterRule" class="link">Source</a> <a href="#v:getFilterRule" class="selflink">#</a></p><div class="doc"><p>Looks up a filter by uuid.</p></div></div><div class="top"><p class="src"><a id="v:getGroup" class="def">getGroup</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> <a href="Ganeti/Config.html#getGroup" class="link">Source</a> <a href="#v:getGroup" class="selflink">#</a></p><div class="doc"><p>Looks up a node group by name or uuid.</p></div></div><div class="top"><p class="src"><a id="v:getGroupNdParams" class="def">getGroupNdParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getGroupNdParams" class="link">Source</a> <a href="#v:getGroupNdParams" class="selflink">#</a></p><div class="doc"><p>Computes a node group's node params.</p></div></div><div class="top"><p class="src"><a id="v:getGroupIpolicy" class="def">getGroupIpolicy</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:FilledIPolicy" title="Ganeti.Objects">FilledIPolicy</a> <a href="Ganeti/Config.html#getGroupIpolicy" class="link">Source</a> <a href="#v:getGroupIpolicy" class="selflink">#</a></p><div class="doc"><p>Computes a node group's ipolicy.</p></div></div><div class="top"><p class="src"><a id="v:getGroupDiskParams" class="def">getGroupDiskParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; <a href="Ganeti-Objects.html#t:GroupDiskParams" title="Ganeti.Objects">GroupDiskParams</a> <a href="Ganeti/Config.html#getGroupDiskParams" class="link">Source</a> <a href="#v:getGroupDiskParams" class="selflink">#</a></p><div class="doc"><p>Computes a group's (merged) disk params.</p></div></div><div class="top"><p class="src"><a id="v:getGroupNodes" class="def">getGroupNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getGroupNodes" class="link">Source</a> <a href="#v:getGroupNodes" class="selflink">#</a></p><div class="doc"><p>Get nodes of a given node group.</p></div></div><div class="top"><p class="src"><a id="v:getGroupInstances" class="def">getGroupInstances</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; ([<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>], [<a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a>]) <a href="Ganeti/Config.html#getGroupInstances" class="link">Source</a> <a href="#v:getGroupInstances" class="selflink">#</a></p><div class="doc"><p>Get (primary, secondary) instances of a given node group.</p></div></div><div class="top"><p class="src"><a id="v:getFilledInstHvParams" class="def">getFilledInstHvParams</a> :: [String] -&gt; <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Types.html#t:HvParams" title="Ganeti.Types">HvParams</a> <a href="Ganeti/Config.html#getFilledInstHvParams" class="link">Source</a> <a href="#v:getFilledInstHvParams" class="selflink">#</a></p><div class="doc"><p>Retrieves the instance hypervisor params, missing values filled with
 cluster defaults.</p></div></div><div class="top"><p class="src"><a id="v:getFilledInstBeParams" class="def">getFilledInstBeParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects-Instance.html#t:FilledBeParams" title="Ganeti.Objects.Instance">FilledBeParams</a> <a href="Ganeti/Config.html#getFilledInstBeParams" class="link">Source</a> <a href="#v:getFilledInstBeParams" class="selflink">#</a></p><div class="doc"><p>Retrieves the instance backend params, missing values filled with cluster
 defaults.</p></div></div><div class="top"><p class="src"><a id="v:getFilledInstOsParams" class="def">getFilledInstOsParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Types.html#t:OsParams" title="Ganeti.Types">OsParams</a> <a href="Ganeti/Config.html#getFilledInstOsParams" class="link">Source</a> <a href="#v:getFilledInstOsParams" class="selflink">#</a></p><div class="doc"><p>Retrieves the instance os params, missing values filled with cluster
 defaults. This does NOT include private and secret parameters.</p></div></div><div class="top"><p class="src"><a id="v:getInstPrimaryNode" class="def">getInstPrimaryNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> <a href="Ganeti/Config.html#getInstPrimaryNode" class="link">Source</a> <a href="#v:getInstPrimaryNode" class="selflink">#</a></p><div class="doc"><p>Looks up an instance's primary node.</p></div></div><div class="top"><p class="src"><a id="v:getDrbdDiskNodes" class="def">getDrbdDiskNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getDrbdDiskNodes" class="link">Source</a> <a href="#v:getDrbdDiskNodes" class="selflink">#</a></p><div class="doc"><p>Retrieves all nodes hosting a DRBD disk</p></div></div><div class="top"><p class="src"><a id="v:getInstAllNodes" class="def">getInstAllNodes</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a>] <a href="Ganeti/Config.html#getInstAllNodes" class="link">Source</a> <a href="#v:getInstAllNodes" class="selflink">#</a></p><div class="doc"><p>Retrieves all the nodes of the instance.</p><p>As instances not using DRBD can be sent as a parameter as well,
 the primary node has to be appended to the results.</p></div></div><div class="top"><p class="src"><a id="v:getInstDisks" class="def">getInstDisks</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a>] <a href="Ganeti/Config.html#getInstDisks" class="link">Source</a> <a href="#v:getInstDisks" class="selflink">#</a></p><div class="doc"><p>Get disks for a given instance.
 The instance is specified by name or uuid.</p></div></div><div class="top"><p class="src"><a id="v:getInstDisksFromObj" class="def">getInstDisksFromObj</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [<a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a>] <a href="Ganeti/Config.html#getInstDisksFromObj" class="link">Source</a> <a href="#v:getInstDisksFromObj" class="selflink">#</a></p><div class="doc"><p>Get disks for a given instance object.</p></div></div><div class="top"><p class="src"><a id="v:collectFromDrbdDisks" class="def">collectFromDrbdDisks</a> <a href="Ganeti/Config.html#collectFromDrbdDisks" class="link">Source</a> <a href="#v:collectFromDrbdDisks" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Monoid a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (String -&gt; String -&gt; Int -&gt; Int -&gt; Int -&gt; <a href="Ganeti-Types.html#t:Private" title="Ganeti.Types">Private</a> <a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a> -&gt; a)</td><td class="doc"><p>NodeA, NodeB, Port, MinorA, MinorB, Secret</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Collects a value for all DRBD disks</p></div></div><div class="top"><p class="src"><a id="v:getDrbdSecretsForDisk" class="def">getDrbdSecretsForDisk</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [<a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a>] <a href="Ganeti/Config.html#getDrbdSecretsForDisk" class="link">Source</a> <a href="#v:getDrbdSecretsForDisk" class="selflink">#</a></p><div class="doc"><p>Returns the DRBD secrets of a given <code><a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a></code></p></div></div><div class="top"><p class="src"><a id="v:getDrbdMinorsForDisk" class="def">getDrbdMinorsForDisk</a> :: <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [(Int, String)] <a href="Ganeti/Config.html#getDrbdMinorsForDisk" class="link">Source</a> <a href="#v:getDrbdMinorsForDisk" class="selflink">#</a></p><div class="doc"><p>Returns the DRBD minors of a given <code><a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a></code></p></div></div><div class="top"><p class="src"><a id="v:getDrbdMinorsForNode" class="def">getDrbdMinorsForNode</a> :: String -&gt; <a href="Ganeti-Objects-Disk.html#t:Disk" title="Ganeti.Objects.Disk">Disk</a> -&gt; [(Int, String)] <a href="Ganeti/Config.html#getDrbdMinorsForNode" class="link">Source</a> <a href="#v:getDrbdMinorsForNode" class="selflink">#</a></p><div class="doc"><p>Filters DRBD minors for a given node.</p></div></div><div class="top"><p class="src"><a id="v:getDrbdMinorsForInstance" class="def">getDrbdMinorsForInstance</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> [(Int, String)] <a href="Ganeti/Config.html#getDrbdMinorsForInstance" class="link">Source</a> <a href="#v:getDrbdMinorsForInstance" class="selflink">#</a></p><div class="doc"><p>Returns the DRBD minors of a given instance</p></div></div><div class="top"><p class="src"><a id="v:rolePrimary" class="def">rolePrimary</a> :: String <a href="Ganeti/Config.html#rolePrimary" class="link">Source</a> <a href="#v:rolePrimary" class="selflink">#</a></p><div class="doc"><p>String for primary role.</p></div></div><div class="top"><p class="src"><a id="v:roleSecondary" class="def">roleSecondary</a> :: String <a href="Ganeti/Config.html#roleSecondary" class="link">Source</a> <a href="#v:roleSecondary" class="selflink">#</a></p><div class="doc"><p>String for secondary role.</p></div></div><div class="top"><p class="src"><a id="v:getInstMinorsForNode" class="def">getInstMinorsForNode</a> <a href="Ganeti/Config.html#getInstMinorsForNode" class="link">Source</a> <a href="#v:getInstMinorsForNode" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; String</td><td class="doc"><p>The UUID of a node.</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [(String, Int, String, String, String, String)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Gets the list of DRBD minors for an instance that are related to
 a given node.</p></div></div><div class="top"><p class="src"><a id="v:buildLinkIpInstnameMap" class="def">buildLinkIpInstnameMap</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Config.html#t:LinkIpMap" title="Ganeti.Config">LinkIpMap</a> <a href="Ganeti/Config.html#buildLinkIpInstnameMap" class="link">Source</a> <a href="#v:buildLinkIpInstnameMap" class="selflink">#</a></p><div class="doc"><p>Builds link -&gt; ip -&gt; instname map.
 For instances without a name, we insert the uuid instead.</p><p>TODO: improve this by splitting it into multiple independent functions:</p><ul><li>abstract the &quot;fetch instance with filled params&quot; functionality</li><li>abstsract the [instance] -&gt; [(nic, instance_name)] part</li><li>etc.</li></ul></div></div><div class="top"><p class="src"><a id="v:getGroupOfNode" class="def">getGroupOfNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> <a href="Ganeti/Config.html#getGroupOfNode" class="link">Source</a> <a href="#v:getGroupOfNode" class="selflink">#</a></p><div class="doc"><p>Returns a node's group, with optional failure if we can't find it
 (configuration corrupt).</p></div></div><div class="top"><p class="src"><a id="v:getNodeNdParams" class="def">getNodeNdParams</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getNodeNdParams" class="link">Source</a> <a href="#v:getNodeNdParams" class="selflink">#</a></p><div class="doc"><p>Returns a node's ndparams, filled.</p></div></div><a href="#g:3" id="g:3"><h1>Network</h1></a><div class="top"><p class="src"><a id="v:getNetwork" class="def">getNetwork</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; String -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Objects.html#t:Network" title="Ganeti.Objects">Network</a> <a href="Ganeti/Config.html#getNetwork" class="link">Source</a> <a href="#v:getNetwork" class="selflink">#</a></p><div class="doc"><p>Looks up a network. If looking up by uuid fails, we look up
 by name.</p></div></div><a href="#g:4" id="g:4"><h2>MACs</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MAC" class="def">MAC</a> = String <a href="Ganeti/Config.html#MAC" class="link">Source</a> <a href="#t:MAC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getAllMACs" class="def">getAllMACs</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Config.html#t:MAC" title="Ganeti.Config">MAC</a>] <a href="Ganeti/Config.html#getAllMACs" class="link">Source</a> <a href="#v:getAllMACs" class="selflink">#</a></p><div class="doc"><p>Returns all MAC addresses used in the cluster.</p></div></div><a href="#g:5" id="g:5"><h2>DRBD secrets</h2></a><div class="top"><p class="src"><a id="v:getAllDrbdSecrets" class="def">getAllDrbdSecrets</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; [<a href="Ganeti-Objects-Disk.html#t:DRBDSecret" title="Ganeti.Objects.Disk">DRBDSecret</a>] <a href="Ganeti/Config.html#getAllDrbdSecrets" class="link">Source</a> <a href="#v:getAllDrbdSecrets" class="selflink">#</a></p></div><a href="#g:6" id="g:6"><h2>LVs</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:NodeLVsMap" class="def">NodeLVsMap</a> = <a href="Ganeti-Utils-MultiMap.html#t:MultiMap" title="Ganeti.Utils.MultiMap">MultiMap</a> String <a href="Ganeti-Objects-Disk.html#t:LogicalVolume" title="Ganeti.Objects.Disk">LogicalVolume</a> <a href="Ganeti/Config.html#NodeLVsMap" class="link">Source</a> <a href="#t:NodeLVsMap" class="selflink">#</a></p><div class="doc"><p>A map from node UUIDs to</p><p>FIXME: After adding designated types for UUIDs,
 use them to replace <code>String</code> here.</p></div></div><div class="top"><p class="src"><a id="v:getInstanceLVsByNode" class="def">getInstanceLVsByNode</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects-Instance.html#t:Instance" title="Ganeti.Objects.Instance">Instance</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> <a href="Ganeti-Config.html#t:NodeLVsMap" title="Ganeti.Config">NodeLVsMap</a> <a href="Ganeti/Config.html#getInstanceLVsByNode" class="link">Source</a> <a href="#v:getInstanceLVsByNode" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getAllLVs" class="def">getAllLVs</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> (Set <a href="Ganeti-Objects-Disk.html#t:LogicalVolume" title="Ganeti.Objects.Disk">LogicalVolume</a>) <a href="Ganeti/Config.html#getAllLVs" class="link">Source</a> <a href="#v:getAllLVs" class="selflink">#</a></p></div><a href="#g:7" id="g:7"><h1>ND params</h1></a><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:NdParamObject" class="def">NdParamObject</a> a <span class="keyword">where</span> <a href="Ganeti/Config.html#NdParamObject" class="link">Source</a> <a href="#t:NdParamObject" class="selflink">#</a></p><div class="doc"><p>Type class denoting objects which have node parameters.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:getNdParamsOf" class="def">getNdParamsOf</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; a -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getNdParamsOf" class="link">Source</a> <a href="#v:getNdParamsOf" class="selflink">#</a></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:NdParamObject">Instances</h4><details id="i:NdParamObject" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:NdParamObject:NdParamObject:1"></span> <a href="Ganeti-Config.html#t:NdParamObject" title="Ganeti.Config">NdParamObject</a> <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a></span> <a href="#t:NdParamObject" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:NdParamObject:NdParamObject:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Config.html">Ganeti.Config</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getNdParamsOf">getNdParamsOf</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Node" title="Ganeti.Objects">Node</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getNdParamsOf" class="link">Source</a> <a href="#v:getNdParamsOf" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:NdParamObject:NdParamObject:2"></span> <a href="Ganeti-Config.html#t:NdParamObject" title="Ganeti.Config">NdParamObject</a> <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a></span> <a href="#t:NdParamObject" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:NdParamObject:NdParamObject:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Config.html">Ganeti.Config</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getNdParamsOf">getNdParamsOf</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:NodeGroup" title="Ganeti.Objects">NodeGroup</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getNdParamsOf" class="link">Source</a> <a href="#v:getNdParamsOf" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:NdParamObject:NdParamObject:3"></span> <a href="Ganeti-Config.html#t:NdParamObject" title="Ganeti.Config">NdParamObject</a> <a href="Ganeti-Objects.html#t:Cluster" title="Ganeti.Objects">Cluster</a></span> <a href="#t:NdParamObject" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:NdParamObject:NdParamObject:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Config.html">Ganeti.Config</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getNdParamsOf">getNdParamsOf</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; <a href="Ganeti-Objects.html#t:Cluster" title="Ganeti.Objects">Cluster</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilledNDParams" title="Ganeti.Objects">FilledNDParams</a> <a href="Ganeti/Config.html#getNdParamsOf" class="link">Source</a> <a href="#v:getNdParamsOf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>