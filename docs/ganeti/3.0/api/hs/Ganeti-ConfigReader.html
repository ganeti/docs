<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.ConfigReader</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/ConfigReader.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.ConfigReader</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Configuration handling</a><ul><li><a href="#g:2">Helper functions</a></li><li><a href="#g:3">Configuration loading</a></li><li><a href="#g:4">Watcher threads</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of configuration reader with watching support.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:ConfigReader">ConfigReader</a> = IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a>)</li><li class="src short"><a href="#v:initConfigReader">initConfigReader</a> :: (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; IO ()) -&gt; IO ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ConfigReader" class="def">ConfigReader</a> = IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a>) <a href="Ganeti/ConfigReader.html#ConfigReader" class="link">Source</a> <a href="#t:ConfigReader" class="selflink">#</a></p><div class="doc"><p>A type for functions that can return the configuration when
 executed.</p></div></div><a href="#g:1" id="g:1"><h1>Configuration handling</h1></a><a href="#g:2" id="g:2"><h2>Helper functions</h2></a><a href="#g:3" id="g:3"><h2>Configuration loading</h2></a><a href="#g:4" id="g:4"><h2>Watcher threads</h2></a><div class="doc"><p>We have three threads/functions that can mutate the server state:</p><ol><li>the long-interval watcher (<code>onWatcherTimer</code>)</li><li>the polling watcher (<code>onPollTimer</code>)</li><li>the inotify event handler (<code>onInotify</code>)</li></ol><p>All of these will mutate the server state under <code>modifyMVar</code> or
 <code>modifyMVar_</code>, so that server transitions are more or less
 atomic. The inotify handler remains active during polling mode, but
 checks for polling mode and doesn't do anything in this case (this
 check is needed even if we would unregister the event handler due
 to how events are serialised).</p></div><div class="top"><p class="src"><a id="v:initConfigReader" class="def">initConfigReader</a> :: (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; IO ()) -&gt; IO () <a href="Ganeti/ConfigReader.html#initConfigReader" class="link">Source</a> <a href="#v:initConfigReader" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>