<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Test.Ganeti.Locking.Allocation</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ganeti</span><ul class="links" id="page-menu"><li><a href="Test/Ganeti/Locking/Allocation.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Test.Ganeti.Locking.Allocation</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#section.orphans">Orphan instances</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Tests for lock allocation.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:TestOwner">TestOwner</a> = <a href="#v:TestOwner">TestOwner</a> Int</li><li class="src short"><span class="keyword">data</span> <a href="#t:TestLock">TestLock</a><ul class="subs"><li>= <a href="#v:TestBigLock">TestBigLock</a></li><li>| <a href="#v:TestCollectionLockA">TestCollectionLockA</a></li><li>| <a href="#v:TestLockA">TestLockA</a> Int</li><li>| <a href="#v:TestCollectionLockB">TestCollectionLockB</a></li><li>| <a href="#v:TestLockB">TestLockB</a> Int</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:UpdateRequest">UpdateRequest</a> b a<ul class="subs"><li>= <a href="#v:UpdateRequest">UpdateRequest</a> b [<a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a]</li><li>| <a href="#v:FreeLockRequest">FreeLockRequest</a> b</li></ul></li><li class="src short"><a href="#v:asAllocTrans">asAllocTrans</a> :: (<a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> a, Ord b, Show b) =&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:UpdateRequest" title="Test.Ganeti.Locking.Allocation">UpdateRequest</a> b a -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b</li><li class="src short"><a href="#v:foldUpdates">foldUpdates</a> :: (<a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> a, Ord b, Show b) =&gt; [<a href="Test-Ganeti-Locking-Allocation.html#t:UpdateRequest" title="Test.Ganeti.Locking.Allocation">UpdateRequest</a> b a] -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b</li><li class="src short"><a href="#v:prop_LocksDisjoint">prop_LocksDisjoint</a> :: Property</li><li class="src short"><a href="#v:prop_LockslistComplete">prop_LockslistComplete</a> :: Property</li><li class="src short"><a href="#v:prop_LocksAllOwnersSubsetLockslist">prop_LocksAllOwnersSubsetLockslist</a> :: Property</li><li class="src short"><a href="#v:prop_LocksAllOwnersComplete">prop_LocksAllOwnersComplete</a> :: Property</li><li class="src short"><a href="#v:prop_LocksAllOwnersSound">prop_LocksAllOwnersSound</a> :: Property</li><li class="src short"><a href="#v:prop_LockImplicationX">prop_LockImplicationX</a> :: Property</li><li class="src short"><a href="#v:prop_LockImplicationS">prop_LockImplicationS</a> :: Property</li><li class="src short"><a href="#v:prop_LocksStable">prop_LocksStable</a> :: Property</li><li class="src short"><a href="#v:requestSucceeded">requestSucceeded</a> :: Ord a =&gt; Map a <a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a> -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a -&gt; Bool</li><li class="src short"><a href="#v:prop_LockupdateAtomic">prop_LockupdateAtomic</a> :: Property</li><li class="src short"><a href="#v:prop_LockReleaseSucceeds">prop_LockReleaseSucceeds</a> :: Property</li><li class="src short"><a href="#v:prop_BlockSufficient">prop_BlockSufficient</a> :: Property</li><li class="src short"><a href="#v:prop_BlockNecessary">prop_BlockNecessary</a> :: Property</li><li class="src short"><a href="#v:prop_ReadShow">prop_ReadShow</a> :: Property</li><li class="src short"><a href="#v:prop_OwnerComplete">prop_OwnerComplete</a> :: Property</li><li class="src short"><a href="#v:prop_OwnerSound">prop_OwnerSound</a> :: Property</li><li class="src short"><a href="#v:prop_ReadShowRequest">prop_ReadShowRequest</a> :: Property</li><li class="src short"><a href="#v:testLocking_Allocation">testLocking_Allocation</a> :: Test</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TestOwner" class="def">TestOwner</a> <a href="Test/Ganeti/Locking/Allocation.html#TestOwner" class="link">Source</a> <a href="#t:TestOwner" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TestOwner" class="def">TestOwner</a> Int</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TestOwner">Instances</h4><details id="i:TestOwner" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestOwner:Eq:1"></span> Eq <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></span> <a href="#t:TestOwner" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestOwner:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestOwner:Ord:2"></span> Ord <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></span> <a href="#t:TestOwner" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestOwner:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Ordering</p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; Bool</p><p class="src"><a href="#v:max">max</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestOwner:Show:3"></span> Show <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></span> <a href="#t:TestOwner" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestOwner:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestOwner:JSON:4"></span> JSON <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></span> <a href="#t:TestOwner" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestOwner:JSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readJSON">readJSON</a> :: JSValue -&gt; Result <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></p><p class="src"><a href="#v:showJSON">showJSON</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; JSValue</p><p class="src"><a href="#v:readJSONs">readJSONs</a> :: JSValue -&gt; Result [<a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a>]</p><p class="src"><a href="#v:showJSONs">showJSONs</a> :: [<a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a>] -&gt; JSValue</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestOwner:Arbitrary:5"></span> Arbitrary <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></span> <a href="#t:TestOwner" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestOwner:Arbitrary:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:arbitrary">arbitrary</a> :: Gen <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a></p><p class="src"><a href="#v:shrink">shrink</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a> -&gt; [<a href="Test-Ganeti-Locking-Allocation.html#t:TestOwner" title="Test.Ganeti.Locking.Allocation">TestOwner</a>]</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TestLock" class="def">TestLock</a> <a href="Test/Ganeti/Locking/Allocation.html#TestLock" class="link">Source</a> <a href="#t:TestLock" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TestBigLock" class="def">TestBigLock</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TestCollectionLockA" class="def">TestCollectionLockA</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TestLockA" class="def">TestLockA</a> Int</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TestCollectionLockB" class="def">TestCollectionLockB</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TestLockB" class="def">TestLockB</a> Int</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TestLock">Instances</h4><details id="i:TestLock" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Eq:1"></span> Eq <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Ord:2"></span> Ord <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Ordering</p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; Bool</p><p class="src"><a href="#v:max">max</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Read:3"></span> Read <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Read:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Show:4"></span> Show <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Show:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:JSON:5"></span> JSON <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:JSON:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readJSON">readJSON</a> :: JSValue -&gt; Result <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p><p class="src"><a href="#v:showJSON">showJSON</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; JSValue</p><p class="src"><a href="#v:readJSONs">readJSONs</a> :: JSValue -&gt; Result [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>]</p><p class="src"><a href="#v:showJSONs">showJSONs</a> :: [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>] -&gt; JSValue</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Lock:6"></span> <a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Lock:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:lockImplications">lockImplications</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>] <a href="Ganeti/Locking/Types.html#lockImplications" class="link">Source</a> <a href="#v:lockImplications" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TestLock:Arbitrary:7"></span> Arbitrary <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></span> <a href="#t:TestLock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TestLock:Arbitrary:7"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-Ganeti-Locking-Allocation.html">Test.Ganeti.Locking.Allocation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:arbitrary">arbitrary</a> :: Gen <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a></p><p class="src"><a href="#v:shrink">shrink</a> :: <a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a> -&gt; [<a href="Test-Ganeti-Locking-Allocation.html#t:TestLock" title="Test.Ganeti.Locking.Allocation">TestLock</a>]</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UpdateRequest" class="def">UpdateRequest</a> b a <a href="Test/Ganeti/Locking/Allocation.html#UpdateRequest" class="link">Source</a> <a href="#t:UpdateRequest" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UpdateRequest" class="def">UpdateRequest</a> b [<a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:FreeLockRequest" class="def">FreeLockRequest</a> b</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:asAllocTrans" class="def">asAllocTrans</a> :: (<a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> a, Ord b, Show b) =&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b -&gt; <a href="Test-Ganeti-Locking-Allocation.html#t:UpdateRequest" title="Test.Ganeti.Locking.Allocation">UpdateRequest</a> b a -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b <a href="Test/Ganeti/Locking/Allocation.html#asAllocTrans" class="link">Source</a> <a href="#v:asAllocTrans" class="selflink">#</a></p><div class="doc"><p>Transform an UpdateRequest into the corresponding state transformer.</p></div></div><div class="top"><p class="src"><a id="v:foldUpdates" class="def">foldUpdates</a> :: (<a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> a, Ord b, Show b) =&gt; [<a href="Test-Ganeti-Locking-Allocation.html#t:UpdateRequest" title="Test.Ganeti.Locking.Allocation">UpdateRequest</a> b a] -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b <a href="Test/Ganeti/Locking/Allocation.html#foldUpdates" class="link">Source</a> <a href="#v:foldUpdates" class="selflink">#</a></p><div class="doc"><p>Fold a sequence of requests to transform a lock allocation onto the empty
 allocation. As we consider all exported LockAllocation transformers, any
 LockAllocation definable is obtained in this way.</p></div></div><div class="top"><p class="src"><a id="v:prop_LocksDisjoint" class="def">prop_LocksDisjoint</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LocksDisjoint" class="link">Source</a> <a href="#v:prop_LocksDisjoint" class="selflink">#</a></p><div class="doc"><p>Basic property of locking: the exclusive locks of one user
 are disjoint from any locks of any other user.</p></div></div><div class="top"><p class="src"><a id="v:prop_LockslistComplete" class="def">prop_LockslistComplete</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LockslistComplete" class="link">Source</a> <a href="#v:prop_LockslistComplete" class="selflink">#</a></p><div class="doc"><p>Verify that the list of active locks indeed contains all locks that
 are owned by someone.</p></div></div><div class="top"><p class="src"><a id="v:prop_LocksAllOwnersSubsetLockslist" class="def">prop_LocksAllOwnersSubsetLockslist</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LocksAllOwnersSubsetLockslist" class="link">Source</a> <a href="#v:prop_LocksAllOwnersSubsetLockslist" class="selflink">#</a></p><div class="doc"><p>Verify that the list of all locks with states is contained in the list
 of all locks.</p></div></div><div class="top"><p class="src"><a id="v:prop_LocksAllOwnersComplete" class="def">prop_LocksAllOwnersComplete</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LocksAllOwnersComplete" class="link">Source</a> <a href="#v:prop_LocksAllOwnersComplete" class="selflink">#</a></p><div class="doc"><p>Verify that all locks of all owners are mentioned in the list of all locks'
 owner's state.</p></div></div><div class="top"><p class="src"><a id="v:prop_LocksAllOwnersSound" class="def">prop_LocksAllOwnersSound</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LocksAllOwnersSound" class="link">Source</a> <a href="#v:prop_LocksAllOwnersSound" class="selflink">#</a></p><div class="doc"><p>Verify that all lock owners mentioned in the list of all locks' owner's
 state actually own their lock.</p></div></div><div class="top"><p class="src"><a id="v:prop_LockImplicationX" class="def">prop_LockImplicationX</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LockImplicationX" class="link">Source</a> <a href="#v:prop_LockImplicationX" class="selflink">#</a></p><div class="doc"><p>Verify that exclusive group locks are honored, i.e., verify that if someone
 holds a lock, then no one else can hold a lock on an exclusive lock on an
 implied lock.</p></div></div><div class="top"><p class="src"><a id="v:prop_LockImplicationS" class="def">prop_LockImplicationS</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LockImplicationS" class="link">Source</a> <a href="#v:prop_LockImplicationS" class="selflink">#</a></p><div class="doc"><p>Verify that shared group locks are honored, i.e., verify that if someone
 holds an exclusive lock, then no one else can hold any form on lock on an
 implied lock.</p></div></div><div class="top"><p class="src"><a id="v:prop_LocksStable" class="def">prop_LocksStable</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LocksStable" class="link">Source</a> <a href="#v:prop_LocksStable" class="selflink">#</a></p><div class="doc"><p>Verify that locks can only be modified by updates of the owner.</p></div></div><div class="top"><p class="src"><a id="v:requestSucceeded" class="def">requestSucceeded</a> :: Ord a =&gt; Map a <a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a> -&gt; <a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a -&gt; Bool <a href="Test/Ganeti/Locking/Allocation.html#requestSucceeded" class="link">Source</a> <a href="#v:requestSucceeded" class="selflink">#</a></p><div class="doc"><p>Verify that a given request is statisfied in list of owned locks</p></div></div><div class="top"><p class="src"><a id="v:prop_LockupdateAtomic" class="def">prop_LockupdateAtomic</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LockupdateAtomic" class="link">Source</a> <a href="#v:prop_LockupdateAtomic" class="selflink">#</a></p><div class="doc"><p>Verify that lock updates are atomic, i.e., either we get all the required
 locks, or the state is completely unchanged.</p></div></div><div class="top"><p class="src"><a id="v:prop_LockReleaseSucceeds" class="def">prop_LockReleaseSucceeds</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_LockReleaseSucceeds" class="link">Source</a> <a href="#v:prop_LockReleaseSucceeds" class="selflink">#</a></p><div class="doc"><p>Verify that releasing a lock always succeeds.</p></div></div><div class="top"><p class="src"><a id="v:prop_BlockSufficient" class="def">prop_BlockSufficient</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_BlockSufficient" class="link">Source</a> <a href="#v:prop_BlockSufficient" class="selflink">#</a></p><div class="doc"><p>Verify the property that only the blocking owners prevent
 lock allocation. We deliberatly go for the expensive variant
 restraining by suchThat, as otherwise the number of cases actually
 covered is too small.</p></div></div><div class="top"><p class="src"><a id="v:prop_BlockNecessary" class="def">prop_BlockNecessary</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_BlockNecessary" class="link">Source</a> <a href="#v:prop_BlockNecessary" class="selflink">#</a></p><div class="doc"><p>Verify the property that every blocking owner is necessary, i.e., even
 if we only keep the locks of one of the blocking owners, the request still
 will be blocked. We deliberatly use the expensive variant of restraining
 to ensure good coverage. To make sure the request can always be blocked
 by two owners, for a shared request we request two different locks.</p></div></div><div class="top"><p class="src"><a id="v:prop_ReadShow" class="def">prop_ReadShow</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_ReadShow" class="link">Source</a> <a href="#v:prop_ReadShow" class="selflink">#</a></p><div class="doc"><p>Verify that for LockAllocation we have readJSON . showJSON = Ok.</p></div></div><div class="top"><p class="src"><a id="v:prop_OwnerComplete" class="def">prop_OwnerComplete</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_OwnerComplete" class="link">Source</a> <a href="#v:prop_OwnerComplete" class="selflink">#</a></p><div class="doc"><p>Verify that the list of lock owners is complete.</p></div></div><div class="top"><p class="src"><a id="v:prop_OwnerSound" class="def">prop_OwnerSound</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_OwnerSound" class="link">Source</a> <a href="#v:prop_OwnerSound" class="selflink">#</a></p><div class="doc"><p>Verify that each owner actually owns a lock.</p></div></div><div class="top"><p class="src"><a id="v:prop_ReadShowRequest" class="def">prop_ReadShowRequest</a> :: Property <a href="Test/Ganeti/Locking/Allocation.html#prop_ReadShowRequest" class="link">Source</a> <a href="#v:prop_ReadShowRequest" class="selflink">#</a></p><div class="doc"><p>Verify that for LockRequest we have readJSON . showJSON = Ok.</p></div></div><div class="top"><p class="src"><a id="v:testLocking_Allocation" class="def">testLocking_Allocation</a> :: Test <a href="Test/Ganeti/Locking/Allocation.html#testLocking_Allocation" class="link">Source</a> <a href="#v:testLocking_Allocation" class="selflink">#</a></p></div><h1>Orphan instances</h1><div id="section.orphans"><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:Arbitrary:Arbitrary:1"></span> Arbitrary <a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a></span> <a href="#v:-36-fArbitraryOwnerState" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:o:ic:Arbitrary:Arbitrary:1"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:arbitrary">arbitrary</a> :: Gen <a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a></p><p class="src"><a href="#v:shrink">shrink</a> :: <a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a> -&gt; [<a href="Ganeti-Locking-Allocation.html#t:OwnerState" title="Ganeti.Locking.Allocation">OwnerState</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:Arbitrary:Arbitrary:2"></span> Arbitrary a =&gt; Arbitrary (<a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a)</span> <a href="#v:-36-fArbitraryLockRequest" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:o:ic:Arbitrary:Arbitrary:2"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:arbitrary">arbitrary</a> :: Gen (<a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a)</p><p class="src"><a href="#v:shrink">shrink</a> :: <a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a -&gt; [<a href="Ganeti-Locking-Allocation.html#t:LockRequest" title="Ganeti.Locking.Allocation">LockRequest</a> a]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:Arbitrary:Arbitrary:3"></span> (Arbitrary a, <a href="Ganeti-Locking-Types.html#t:Lock" title="Ganeti.Locking.Types">Lock</a> a, Arbitrary b, Ord b, Show b) =&gt; Arbitrary (<a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b)</span> <a href="#v:-36-fArbitraryLockAllocation" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:o:ic:Arbitrary:Arbitrary:3"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:arbitrary">arbitrary</a> :: Gen (<a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b)</p><p class="src"><a href="#v:shrink">shrink</a> :: <a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b -&gt; [<a href="Ganeti-Locking-Allocation.html#t:LockAllocation" title="Ganeti.Locking.Allocation">LockAllocation</a> a b]</p></div></details></td></tr></table></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>