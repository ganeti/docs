<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ganeti.Query.Filter</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ganeti</span><ul class="links" id="page-menu"><li><a href="Ganeti/Query/Filter.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.Query.Filter</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of the Ganeti Query2 filterning.</p><p>The filtering of results should be done in two phases.</p><p>In the first phase, before contacting any remote nodes for runtime
data, the filtering should be executed with <code>Nothing</code> for the runtime
context. This will make all non-runtime filters filter correctly,
whereas all runtime filters will respond successfully. As described in
the Python version too, this makes for example <em>Or</em> filters very
inefficient if they contain runtime fields.</p><p>Once this first filtering phase has been done, we hopefully eliminated
some remote nodes out of the list of candidates, we run the remote
data gathering, and we evaluate the filter again, this time with a
<code>Just</code> runtime context. This will make all filters work correctly.</p><p>Note that the second run will re-evaluate the config/simple fields,
without caching; this is not perfect, but we consider config accesses
very cheap (and the configuration snapshot we have won't change
between the two runs, hence we will not get inconsistent results).</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:compileFilter">compileFilter</a> :: <a href="Ganeti-Query-Types.html#t:FieldMap" title="Ganeti.Query.Types">FieldMap</a> a b -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> (<a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>))</li><li class="src short"><a href="#v:qffField">qffField</a> :: <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> JSValue</li><li class="src short"><a href="#v:wrapGetter">wrapGetter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>) -&gt; (JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool) -&gt; MaybeT <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:trueFilter">trueFilter</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><span class="keyword">type</span> <a href="#t:Comparator">Comparator</a> = <span class="keyword">forall</span> a. (Eq a, Ord a) =&gt; a -&gt; a -&gt; Bool</li><li class="src short"><a href="#v:eqFilter">eqFilter</a> :: <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a> -&gt; <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:binOpFilter">binOpFilter</a> :: <a href="Ganeti-Query-Filter.html#t:Comparator" title="Ganeti.Query.Filter">Comparator</a> -&gt; <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:regexpFilter">regexpFilter</a> :: <a href="Ganeti-Query-Language.html#t:FilterRegex" title="Ganeti.Query.Language">FilterRegex</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:containsFilter">containsFilter</a> :: <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><span class="keyword">data</span> <a href="#t:Comparison">Comparison</a><ul class="subs"><li>= <a href="#v:Eq">Eq</a></li><li>| <a href="#v:Lt">Lt</a></li><li>| <a href="#v:Le">Le</a></li><li>| <a href="#v:Gt">Gt</a></li><li>| <a href="#v:Ge">Ge</a></li></ul></li><li class="src short"><a href="#v:toCompFun">toCompFun</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparator" title="Ganeti.Query.Filter">Comparator</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:FilterOp">FilterOp</a> field val <span class="keyword">where</span><ul class="subs"><li><a href="#v:Truth">Truth</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field ()</li><li><a href="#v:Comp">Comp</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a></li><li><a href="#v:Regex">Regex</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterRegex" title="Ganeti.Query.Language">FilterRegex</a></li><li><a href="#v:Contains">Contains</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a></li></ul></li><li class="src short"><a href="#v:evaluateFilterM">evaluateFilterM</a> :: (Monad m, Applicative m) =&gt; (<span class="keyword">forall</span> val. <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; field -&gt; val -&gt; m Bool) -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> field -&gt; m Bool</li><li class="src short"><a href="#v:evaluateQueryFilter">evaluateQueryFilter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>) -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:evaluateFilterJSON">evaluateFilterJSON</a> :: <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool</li><li class="src short"><a href="#v:tryGetter">tryGetter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; <a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b -&gt; Maybe <a href="Ganeti-Query-Language.html#t:ResultEntry" title="Ganeti.Query.Language">ResultEntry</a></li><li class="src short"><a href="#v:requestedNames">requestedNames</a> :: <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; Maybe [<a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a>]</li><li class="src short"><a href="#v:makeSimpleFilter">makeSimpleFilter</a> :: String -&gt; [Either String Integer] -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:compileFilter" class="def">compileFilter</a> :: <a href="Ganeti-Query-Types.html#t:FieldMap" title="Ganeti.Query.Types">FieldMap</a> a b -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> (<a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>)) <a href="Ganeti/Query/Filter.html#compileFilter" class="link">Source</a> <a href="#v:compileFilter" class="selflink">#</a></p><div class="doc"><p>Compiles a filter based on field names to one based on getters.</p></div></div><div class="top"><p class="src"><a id="v:qffField" class="def">qffField</a> :: <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> JSValue <a href="Ganeti/Query/Filter.html#qffField" class="link">Source</a> <a href="#v:qffField" class="selflink">#</a></p><div class="doc"><p>Processes a field value given a QffMode.</p></div></div><div class="top"><p class="src"><a id="v:wrapGetter" class="def">wrapGetter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>) -&gt; (JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool) -&gt; MaybeT <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#wrapGetter" class="link">Source</a> <a href="#v:wrapGetter" class="selflink">#</a></p><div class="doc"><p>Wraps a getter, filter pair. If the getter is <code><a href="Ganeti-Query-Types.html#v:FieldRuntime" title="Ganeti.Query.Types">FieldRuntime</a></code> but
 we don't have a runtime context, we skip the filtering, returning
 <code>Nothing</code> in the MaybeT. Otherwise, we pass the actual value to the filter.</p></div></div><div class="top"><p class="src"><a id="v:trueFilter" class="def">trueFilter</a> :: JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#trueFilter" class="link">Source</a> <a href="#v:trueFilter" class="selflink">#</a></p><div class="doc"><p>Helper to evaluate a filter getter (and the value it generates) in
 a boolean context.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Comparator" class="def">Comparator</a> = <span class="keyword">forall</span> a. (Eq a, Ord a) =&gt; a -&gt; a -&gt; Bool <a href="Ganeti/Query/Filter.html#Comparator" class="link">Source</a> <a href="#t:Comparator" class="selflink">#</a></p><div class="doc"><p>A type synonim for a rank-2 comparator function. This is used so
 that we can pass the usual <code>&lt;=</code>, <code>&gt;</code>, <code>==</code> functions to <code><a href="Ganeti-Query-Filter.html#v:binOpFilter" title="Ganeti.Query.Filter">binOpFilter</a></code>
 and for them to be used in multiple contexts.</p></div></div><div class="top"><p class="src"><a id="v:eqFilter" class="def">eqFilter</a> :: <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a> -&gt; <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#eqFilter" class="link">Source</a> <a href="#v:eqFilter" class="selflink">#</a></p><div class="doc"><p>Equality checker.</p><p>This will handle hostnames correctly, if the mode is set to
 <code><a href="Ganeti-Query-Types.html#v:QffHostname" title="Ganeti.Query.Types">QffHostname</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:binOpFilter" class="def">binOpFilter</a> :: <a href="Ganeti-Query-Filter.html#t:Comparator" title="Ganeti.Query.Filter">Comparator</a> -&gt; <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#binOpFilter" class="link">Source</a> <a href="#v:binOpFilter" class="selflink">#</a></p><div class="doc"><p>Helper to evaluate a filder getter (and the value it generates)
 in a boolean context. Note the order of arguments is reversed from
 the filter definitions (due to the call chain), make sure to
 compare in the reverse order too!.</p></div></div><div class="top"><p class="src"><a id="v:regexpFilter" class="def">regexpFilter</a> :: <a href="Ganeti-Query-Language.html#t:FilterRegex" title="Ganeti.Query.Language">FilterRegex</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#regexpFilter" class="link">Source</a> <a href="#v:regexpFilter" class="selflink">#</a></p><div class="doc"><p>Implements the <code><a href="Ganeti-Query-Language.html#v:RegexpFilter" title="Ganeti.Query.Language">RegexpFilter</a></code> matching.</p></div></div><div class="top"><p class="src"><a id="v:containsFilter" class="def">containsFilter</a> :: <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a> -&gt; JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#containsFilter" class="link">Source</a> <a href="#v:containsFilter" class="selflink">#</a></p><div class="doc"><p>Implements the <code><a href="Ganeti-Query-Language.html#v:ContainsFilter" title="Ganeti.Query.Language">ContainsFilter</a></code> matching.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Comparison" class="def">Comparison</a> <a href="Ganeti/Query/Filter.html#Comparison" class="link">Source</a> <a href="#t:Comparison" class="selflink">#</a></p><div class="doc"><p>Ways we can compare things in the filter language.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Eq" class="def">Eq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Lt" class="def">Lt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Le" class="def">Le</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Gt" class="def">Gt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Ge" class="def">Ge</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Comparison">Instances</h4><details id="i:Comparison" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Comparison:Eq:1"></span> Eq <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a></span> <a href="#t:Comparison" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Comparison:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Query-Filter.html">Ganeti.Query.Filter</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Comparison:Ord:2"></span> Ord <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a></span> <a href="#t:Comparison" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Comparison:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Query-Filter.html">Ganeti.Query.Filter</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Ordering</p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; Bool</p><p class="src"><a href="#v:max">max</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Comparison:Show:3"></span> Show <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a></span> <a href="#t:Comparison" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Comparison:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Query-Filter.html">Ganeti.Query.Filter</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:toCompFun" class="def">toCompFun</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:Comparator" title="Ganeti.Query.Filter">Comparator</a> <a href="Ganeti/Query/Filter.html#toCompFun" class="link">Source</a> <a href="#v:toCompFun" class="selflink">#</a></p><div class="doc"><p>Turns a comparison into the corresponding Haskell function.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FilterOp" class="def">FilterOp</a> field val <span class="keyword">where</span> <a href="Ganeti/Query/Filter.html#FilterOp" class="link">Source</a> <a href="#t:FilterOp" class="selflink">#</a></p><div class="doc"><p>Operations in the leaves of the Ganeti filter language.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Truth" class="def">Truth</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field ()</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Comp" class="def">Comp</a> :: <a href="Ganeti-Query-Filter.html#t:Comparison" title="Ganeti.Query.Filter">Comparison</a> -&gt; <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Regex" class="def">Regex</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterRegex" title="Ganeti.Query.Language">FilterRegex</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Contains" class="def">Contains</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field <a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:FilterOp">Instances</h4><details id="i:FilterOp" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilterOp:Eq:1"></span> Eq (<a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val)</span> <a href="#t:FilterOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilterOp:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Query-Filter.html">Ganeti.Query.Filter</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilterOp:Show:2"></span> Show (<a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val)</span> <a href="#t:FilterOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilterOp:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Ganeti-Query-Filter.html">Ganeti.Query.Filter</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:evaluateFilterM" class="def">evaluateFilterM</a> :: (Monad m, Applicative m) =&gt; (<span class="keyword">forall</span> val. <a href="Ganeti-Query-Filter.html#t:FilterOp" title="Ganeti.Query.Filter">FilterOp</a> field val -&gt; field -&gt; val -&gt; m Bool) -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> field -&gt; m Bool <a href="Ganeti/Query/Filter.html#evaluateFilterM" class="link">Source</a> <a href="#v:evaluateFilterM" class="selflink">#</a></p><div class="doc"><p>Checks if a filter matches.</p><p>The leaves of the filter are evaluated against an object using the passed
 <code>opFun</code>; that is why the object need not be passed in.</p><p>The <code>field</code> type describes the &quot;accessors&quot; that are used to query
 values from the object; those values are to be matched against the
 <code>val</code> type in the filter leaves.</p><p>Useful monads <code>m</code> for this are <code><a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a></code> and <code>Maybe</code>.</p></div></div><div class="top"><p class="src"><a id="v:evaluateQueryFilter" class="def">evaluateQueryFilter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> (<a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b, <a href="Ganeti-Query-Types.html#t:QffMode" title="Ganeti.Query.Types">QffMode</a>) -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#evaluateQueryFilter" class="link">Source</a> <a href="#v:evaluateQueryFilter" class="selflink">#</a></p><div class="doc"><p>Verifies if a given item passes a filter. The runtime context
 might be missing, in which case most of the filters will consider
 this as passing the filter.</p></div></div><div class="top"><p class="src"><a id="v:evaluateFilterJSON" class="def">evaluateFilterJSON</a> :: <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> JSValue -&gt; <a href="Ganeti-Errors.html#t:ErrorResult" title="Ganeti.Errors">ErrorResult</a> Bool <a href="Ganeti/Query/Filter.html#evaluateFilterJSON" class="link">Source</a> <a href="#v:evaluateFilterJSON" class="selflink">#</a></p><div class="doc"><p>Evaluates a <code><a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a></code> on a JSON object.</p></div></div><div class="top"><p class="src"><a id="v:tryGetter" class="def">tryGetter</a> :: <a href="Ganeti-Objects.html#t:ConfigData" title="Ganeti.Objects">ConfigData</a> -&gt; Maybe b -&gt; a -&gt; <a href="Ganeti-Query-Types.html#t:FieldGetter" title="Ganeti.Query.Types">FieldGetter</a> a b -&gt; Maybe <a href="Ganeti-Query-Language.html#t:ResultEntry" title="Ganeti.Query.Language">ResultEntry</a> <a href="Ganeti/Query/Filter.html#tryGetter" class="link">Source</a> <a href="#v:tryGetter" class="selflink">#</a></p><div class="doc"><p>Runs a getter with potentially missing runtime context.</p></div></div><div class="top"><p class="src"><a id="v:requestedNames" class="def">requestedNames</a> :: <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> -&gt; Maybe [<a href="Ganeti-Query-Language.html#t:FilterValue" title="Ganeti.Query.Language">FilterValue</a>] <a href="Ganeti/Query/Filter.html#requestedNames" class="link">Source</a> <a href="#v:requestedNames" class="selflink">#</a></p><div class="doc"><p>Computes the requested names, if only names were requested (and
 with equality). Otherwise returns <code>Nothing</code>.</p></div></div><div class="top"><p class="src"><a id="v:makeSimpleFilter" class="def">makeSimpleFilter</a> :: String -&gt; [Either String Integer] -&gt; <a href="Ganeti-Query-Language.html#t:Filter" title="Ganeti.Query.Language">Filter</a> <a href="Ganeti-Query-Language.html#t:FilterField" title="Ganeti.Query.Language">FilterField</a> <a href="Ganeti/Query/Filter.html#makeSimpleFilter" class="link">Source</a> <a href="#v:makeSimpleFilter" class="selflink">#</a></p><div class="doc"><p>Builds a simple filter from a list of names.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>