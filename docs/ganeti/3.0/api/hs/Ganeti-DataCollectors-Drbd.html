<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Ganeti.DataCollectors.Drbd</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ganeti</span><ul class="links" id="page-menu"><li><a href="Ganeti/DataCollectors/Drbd.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.DataCollectors.Drbd</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Command line options</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>DRBD data collector.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:defaultFile">defaultFile</a> :: FilePath</li><li class="src short"><a href="#v:defaultCharNum">defaultCharNum</a> :: Int</li><li class="src short"><a href="#v:dcName">dcName</a> :: String</li><li class="src short"><a href="#v:dcVersion">dcVersion</a> :: <a href="Ganeti-DataCollectors-Types.html#t:DCVersion" title="Ganeti.DataCollectors.Types">DCVersion</a></li><li class="src short"><a href="#v:dcFormatVersion">dcFormatVersion</a> :: Int</li><li class="src short"><a href="#v:dcCategory">dcCategory</a> :: Maybe <a href="Ganeti-DataCollectors-Types.html#t:DCCategory" title="Ganeti.DataCollectors.Types">DCCategory</a></li><li class="src short"><a href="#v:dcKind">dcKind</a> :: <a href="Ganeti-DataCollectors-Types.html#t:DCKind" title="Ganeti.DataCollectors.Types">DCKind</a></li><li class="src short"><a href="#v:dcReport">dcReport</a> :: IO <a href="Ganeti-DataCollectors-Types.html#t:DCReport" title="Ganeti.DataCollectors.Types">DCReport</a></li><li class="src short"><a href="#v:options">options</a> :: IO [<a href="Ganeti-DataCollectors-CLI.html#t:OptType" title="Ganeti.DataCollectors.CLI">OptType</a>]</li><li class="src short"><a href="#v:arguments">arguments</a> :: [<a href="Ganeti-Common.html#t:ArgCompletion" title="Ganeti.Common">ArgCompletion</a>]</li><li class="src short"><a href="#v:getPairingInfo">getPairingInfo</a> :: Maybe String -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> [<a href="Ganeti-Storage-Drbd-Types.html#t:DrbdInstMinor" title="Ganeti.Storage.Drbd.Types">DrbdInstMinor</a>])</li><li class="src short"><a href="#v:computeStatus">computeStatus</a> :: <a href="Ganeti-Storage-Drbd-Types.html#t:DRBDStatus" title="Ganeti.Storage.Drbd.Types">DRBDStatus</a> -&gt; <a href="Ganeti-DataCollectors-Types.html#t:DCStatus" title="Ganeti.DataCollectors.Types">DCStatus</a></li><li class="src short"><a href="#v:computeDevStatus">computeDevStatus</a> :: <a href="Ganeti-Storage-Drbd-Types.html#t:DeviceInfo" title="Ganeti.Storage.Drbd.Types">DeviceInfo</a> -&gt; (<a href="Ganeti-DataCollectors-Types.html#t:DCStatusCode" title="Ganeti.DataCollectors.Types">DCStatusCode</a>, String)</li><li class="src short"><a href="#v:buildJsonReport">buildJsonReport</a> :: FilePath -&gt; Maybe FilePath -&gt; IO JSValue</li><li class="src short"><a href="#v:buildDCReport">buildDCReport</a> :: FilePath -&gt; Maybe FilePath -&gt; IO <a href="Ganeti-DataCollectors-Types.html#t:DCReport" title="Ganeti.DataCollectors.Types">DCReport</a></li><li class="src short"><a href="#v:main">main</a> :: <a href="Ganeti-DataCollectors-CLI.html#t:Options" title="Ganeti.DataCollectors.CLI">Options</a> -&gt; [String] -&gt; IO ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:defaultFile" class="def">defaultFile</a> :: FilePath <a href="Ganeti/DataCollectors/Drbd.html#defaultFile" class="link">Source</a> <a href="#v:defaultFile" class="selflink">#</a></p><div class="doc"><p>The default path of the DRBD status file.
 It is hardcoded because it is not likely to change.</p></div></div><div class="top"><p class="src"><a id="v:defaultCharNum" class="def">defaultCharNum</a> :: Int <a href="Ganeti/DataCollectors/Drbd.html#defaultCharNum" class="link">Source</a> <a href="#v:defaultCharNum" class="selflink">#</a></p><div class="doc"><p>The default setting for the maximum amount of not parsed character to
 print in case of error.
 It is set to use most of the screen estate on a standard 80x25 terminal.
 TODO: add the possibility to set this with a command line parameter.</p></div></div><div class="top"><p class="src"><a id="v:dcName" class="def">dcName</a> :: String <a href="Ganeti/DataCollectors/Drbd.html#dcName" class="link">Source</a> <a href="#v:dcName" class="selflink">#</a></p><div class="doc"><p>The name of this data collector.</p></div></div><div class="top"><p class="src"><a id="v:dcVersion" class="def">dcVersion</a> :: <a href="Ganeti-DataCollectors-Types.html#t:DCVersion" title="Ganeti.DataCollectors.Types">DCVersion</a> <a href="Ganeti/DataCollectors/Drbd.html#dcVersion" class="link">Source</a> <a href="#v:dcVersion" class="selflink">#</a></p><div class="doc"><p>The version of this data collector.</p></div></div><div class="top"><p class="src"><a id="v:dcFormatVersion" class="def">dcFormatVersion</a> :: Int <a href="Ganeti/DataCollectors/Drbd.html#dcFormatVersion" class="link">Source</a> <a href="#v:dcFormatVersion" class="selflink">#</a></p><div class="doc"><p>The version number for the data format of this data collector.</p></div></div><div class="top"><p class="src"><a id="v:dcCategory" class="def">dcCategory</a> :: Maybe <a href="Ganeti-DataCollectors-Types.html#t:DCCategory" title="Ganeti.DataCollectors.Types">DCCategory</a> <a href="Ganeti/DataCollectors/Drbd.html#dcCategory" class="link">Source</a> <a href="#v:dcCategory" class="selflink">#</a></p><div class="doc"><p>The category of this data collector.</p></div></div><div class="top"><p class="src"><a id="v:dcKind" class="def">dcKind</a> :: <a href="Ganeti-DataCollectors-Types.html#t:DCKind" title="Ganeti.DataCollectors.Types">DCKind</a> <a href="Ganeti/DataCollectors/Drbd.html#dcKind" class="link">Source</a> <a href="#v:dcKind" class="selflink">#</a></p><div class="doc"><p>The kind of this data collector.</p></div></div><div class="top"><p class="src"><a id="v:dcReport" class="def">dcReport</a> :: IO <a href="Ganeti-DataCollectors-Types.html#t:DCReport" title="Ganeti.DataCollectors.Types">DCReport</a> <a href="Ganeti/DataCollectors/Drbd.html#dcReport" class="link">Source</a> <a href="#v:dcReport" class="selflink">#</a></p><div class="doc"><p>The data exported by the data collector, taken from the default location.</p></div></div><a href="#g:1" id="g:1"><h1>Command line options</h1></a><div class="top"><p class="src"><a id="v:options" class="def">options</a> :: IO [<a href="Ganeti-DataCollectors-CLI.html#t:OptType" title="Ganeti.DataCollectors.CLI">OptType</a>] <a href="Ganeti/DataCollectors/Drbd.html#options" class="link">Source</a> <a href="#v:options" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:arguments" class="def">arguments</a> :: [<a href="Ganeti-Common.html#t:ArgCompletion" title="Ganeti.Common">ArgCompletion</a>] <a href="Ganeti/DataCollectors/Drbd.html#arguments" class="link">Source</a> <a href="#v:arguments" class="selflink">#</a></p><div class="doc"><p>The list of arguments supported by the program.</p></div></div><div class="top"><p class="src"><a id="v:getPairingInfo" class="def">getPairingInfo</a> :: Maybe String -&gt; IO (<a href="Ganeti-BasicTypes.html#t:Result" title="Ganeti.BasicTypes">Result</a> [<a href="Ganeti-Storage-Drbd-Types.html#t:DrbdInstMinor" title="Ganeti.Storage.Drbd.Types">DrbdInstMinor</a>]) <a href="Ganeti/DataCollectors/Drbd.html#getPairingInfo" class="link">Source</a> <a href="#v:getPairingInfo" class="selflink">#</a></p><div class="doc"><p>Get information about the pairing of DRBD minors and Ganeti instances
 on the current node. The information is taken from the Confd client
 or, if a filename is specified, from a JSON encoded file (for testing
 purposes).</p></div></div><div class="top"><p class="src"><a id="v:computeStatus" class="def">computeStatus</a> :: <a href="Ganeti-Storage-Drbd-Types.html#t:DRBDStatus" title="Ganeti.Storage.Drbd.Types">DRBDStatus</a> -&gt; <a href="Ganeti-DataCollectors-Types.html#t:DCStatus" title="Ganeti.DataCollectors.Types">DCStatus</a> <a href="Ganeti/DataCollectors/Drbd.html#computeStatus" class="link">Source</a> <a href="#v:computeStatus" class="selflink">#</a></p><div class="doc"><p>Compute the status code and message, given the current DRBD data
 The final state will have the code corresponding to the worst code of
 all the devices, and the error message given from the concatenation of the
 non-empty error messages.</p></div></div><div class="top"><p class="src"><a id="v:computeDevStatus" class="def">computeDevStatus</a> :: <a href="Ganeti-Storage-Drbd-Types.html#t:DeviceInfo" title="Ganeti.Storage.Drbd.Types">DeviceInfo</a> -&gt; (<a href="Ganeti-DataCollectors-Types.html#t:DCStatusCode" title="Ganeti.DataCollectors.Types">DCStatusCode</a>, String) <a href="Ganeti/DataCollectors/Drbd.html#computeDevStatus" class="link">Source</a> <a href="#v:computeDevStatus" class="selflink">#</a></p><div class="doc"><p>Compute the status of a DRBD device and its error message.</p></div></div><div class="top"><p class="src"><a id="v:buildJsonReport" class="def">buildJsonReport</a> :: FilePath -&gt; Maybe FilePath -&gt; IO JSValue <a href="Ganeti/DataCollectors/Drbd.html#buildJsonReport" class="link">Source</a> <a href="#v:buildJsonReport" class="selflink">#</a></p><div class="doc"><p>This function computes the JSON representation of the DRBD status.</p></div></div><div class="top"><p class="src"><a id="v:buildDCReport" class="def">buildDCReport</a> :: FilePath -&gt; Maybe FilePath -&gt; IO <a href="Ganeti-DataCollectors-Types.html#t:DCReport" title="Ganeti.DataCollectors.Types">DCReport</a> <a href="Ganeti/DataCollectors/Drbd.html#buildDCReport" class="link">Source</a> <a href="#v:buildDCReport" class="selflink">#</a></p><div class="doc"><p>This function computes the DCReport for the DRBD status.</p></div></div><div class="top"><p class="src"><a id="v:main" class="def">main</a> :: <a href="Ganeti-DataCollectors-CLI.html#t:Options" title="Ganeti.DataCollectors.CLI">Options</a> -&gt; [String] -&gt; IO () <a href="Ganeti/DataCollectors/Drbd.html#main" class="link">Source</a> <a href="#v:main" class="selflink">#</a></p><div class="doc"><p>Main function.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>