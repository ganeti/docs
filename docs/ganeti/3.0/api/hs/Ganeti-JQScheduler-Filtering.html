<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ganeti.JQScheduler.Filtering</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="Ganeti/JQScheduler/Filtering.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">ganeti</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Ganeti.JQScheduler.Filtering</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Filtering of jobs for the Ganeti job queue.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:matchPredicate">matchPredicate</a> :: <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a> -&gt; <a href="Ganeti-Types.html#t:JobId" title="Ganeti.Types">JobId</a> -&gt; <a href="Ganeti-Objects.html#t:FilterPredicate" title="Ganeti.Objects">FilterPredicate</a> -&gt; Bool</li><li class="src short"><a href="#v:matches">matches</a> :: <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a> -&gt; <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; Bool</li><li class="src short"><a href="#v:applyingFilter">applyingFilter</a> :: Set <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a></li><li class="src short"><a href="#v:jobFiltering">jobFiltering</a> :: <a href="Ganeti-JQScheduler-Types.html#t:Queue" title="Ganeti.JQScheduler.Types">Queue</a> -&gt; Set <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; [<a href="Ganeti-JQScheduler-Types.html#t:JobWithStat" title="Ganeti.JQScheduler.Types">JobWithStat</a>] -&gt; [<a href="Ganeti-JQScheduler-Types.html#t:JobWithStat" title="Ganeti.JQScheduler.Types">JobWithStat</a>]</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:matchPredicate" class="def">matchPredicate</a> <a href="Ganeti/JQScheduler/Filtering.html#matchPredicate" class="link">Source</a> <a href="#v:matchPredicate" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Ganeti-Types.html#t:JobId" title="Ganeti.Types">JobId</a></td><td class="doc"><p>the watermark to compare against
   if the predicate references it</p></td></tr><tr><td class="src">-&gt; <a href="Ganeti-Objects.html#t:FilterPredicate" title="Ganeti.Objects">FilterPredicate</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Bool</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Whether a <code><a href="Ganeti-Objects.html#t:FilterPredicate" title="Ganeti.Objects">FilterPredicate</a></code> is true for a job.</p></div></div><div class="top"><p class="src"><a id="v:matches" class="def">matches</a> :: <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a> -&gt; <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; Bool <a href="Ganeti/JQScheduler/Filtering.html#matches" class="link">Source</a> <a href="#v:matches" class="selflink">#</a></p><div class="doc"><p>Whether all predicates of the filter rule are true for the job.</p></div></div><div class="top"><p class="src"><a id="v:applyingFilter" class="def">applyingFilter</a> :: Set <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; <a href="Ganeti-JQueue-Objects.html#t:QueuedJob" title="Ganeti.JQueue.Objects">QueuedJob</a> -&gt; Maybe <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> <a href="Ganeti/JQScheduler/Filtering.html#applyingFilter" class="link">Source</a> <a href="#v:applyingFilter" class="selflink">#</a></p><div class="doc"><p>Finds the first filter whose predicates all match the job and whose
 action is not <code><a href="Ganeti-Objects.html#v:Continue" title="Ganeti.Objects">Continue</a></code>. This is the <em>applying</em> filter.</p></div></div><div class="top"><p class="src"><a id="v:jobFiltering" class="def">jobFiltering</a> :: <a href="Ganeti-JQScheduler-Types.html#t:Queue" title="Ganeti.JQScheduler.Types">Queue</a> -&gt; Set <a href="Ganeti-Objects.html#t:FilterRule" title="Ganeti.Objects">FilterRule</a> -&gt; [<a href="Ganeti-JQScheduler-Types.html#t:JobWithStat" title="Ganeti.JQScheduler.Types">JobWithStat</a>] -&gt; [<a href="Ganeti-JQScheduler-Types.html#t:JobWithStat" title="Ganeti.JQScheduler.Types">JobWithStat</a>] <a href="Ganeti/JQScheduler/Filtering.html#jobFiltering" class="link">Source</a> <a href="#v:jobFiltering" class="selflink">#</a></p><div class="doc"><p>Implements job filtering as specified in `doc/design-optables.rst`.</p><p>Importantly, the filter that *applies* is the first one of which all
 predicates match; this is implemented in <code><a href="Ganeti-JQScheduler-Filtering.html#v:applyingFilter" title="Ganeti.JQScheduler.Filtering">applyingFilter</a></code>.</p><p>The initial <code>FilterChainState</code> is currently not cached across
 <code>selectJobsToRun</code> invocations because the number of running jobs is
 typically small (&lt; 100).</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>